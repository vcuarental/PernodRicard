<apex:page standardController="ASI_HK_CRM_Pre_Approval_Form__c" extensions="ASI_CRM_TW_PAF_EditDetail_Ctrl" sidebar="FALSE">
    <apex:includeScript value="/soap/ajax/21.0/connection.js"/>
    <apex:includeScript value="/soap/ajax/21.0/apex.js"/>
    
    
    
    <style type="text/css">
        body .bPageBlock .pbBody .pbSubheader {
            background-color: #65B68A;
        }
        
        table.table-style-two {
            color: #333333;
            border-width: 1px;
            border-color: #E6E6E6;
            border-collapse: collapse;
        }
     
        table.table-style-two th {
            font-family: verdana, arial, sans-serif;
            font-size: 8px !important;
            border-width: 1px;
            padding: 7px;
            border-style: solid;
            border-color: #E6E6E6;
            background-color: #F2F2F2;
        }
     
        table.table-style-two tr:hover td {
            background-color: #DFEBF1;
        }
     
        table.table-style-two td {
            border-width: 1px;
            padding: 5px;
            border-style: solid;
            border-color: #E6E6E6;
            background-color: #ffffff;
        }
    </style>
    
    <apex:form id="form1">
        <apex:sectionHeader title="Contract P&L"/>
        <apex:pageMessages id="errormsg"/>
            <!--editable version-->
        <apex:pageBlock rendered="{!!nonEditable}" id="block1">
                <apex:pageBlockButtons >
                    <apex:actionStatus id="SaveButtonStatus">
                        <apex:facet name="stop">
                            <apex:outputPanel >
                                <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_Save}" action="{!Save}" status="SaveButtonStatus" rerender="errormsg"/>
                                <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_QuickSave}" action="{!QuickSave}" status="SaveButtonStatus" rerender="errormsg"/>
                                <apex:commandButton value="{!IF(userLanguage=='zh_TW', '重新設置', 'Reset')}" action="{!init}" immediate="TRUE"/>
                                <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_Back}" action="/{!preAppFormId}" immediate="TRUE"/>
                            </apex:outputPanel>
                        </apex:facet>
                        <apex:facet name="start">
                            <apex:outputPanel >
                                <apex:commandButton value="{!IF(userLanguage=='zh_TW', '正在儲存...', 'Saving...')}" disabled="true"/>
                                <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_QuickSave}" disabled="true"/>
                                <apex:commandButton value="{!IF(userLanguage=='zh_TW', '重新設置', 'Reset')}" disabled="true"/>
                                <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_Back}" disabled="true"/>
                            </apex:outputPanel>
                        </apex:facet>
                    </apex:actionStatus>
                </apex:pageBlockButtons>
                
                <apex:pageBlockSection title="{!IF(userLanguage=='zh_TW', '基本資料', 'Basic Information')}" columns="2" id="header_section">
                    <apex:outputField value="{!preAppForm[0].ASI_HK_CRM_PAF_Customer__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Sales_Representative__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Region__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Outlet_Image__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Outlet_Type__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Channel__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Outlet_Grade__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Sub_Channel__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Sales_Potential__c}"/>
                    <apex:inputField value="{!preAppForm[0].ASI_CRM_Valid_Invoice__c}"/>
                    <apex:inputField value="{!preAppForm[0].ASI_HK_CRM_PAF_Start_Date__c}" required="TRUE"/>
                    <apex:inputField value="{!preAppForm[0].ASI_HK_CRM_PAF_End_Date__c}" required="TRUE" id="EndDate"/>
                    <apex:outputText value="{0,date,MM/dd/yy}">
                        <apex:param value="{!ASI_HK_CRM_Pre_Approval_Form__c.ASI_HK_CRM_PAF_End_Date__c}" />
                    </apex:outputText> 
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form__c.fields.ASI_CRM_TW_Supplier__c.Label}"/>
                        <apex:selectList style="height:auto !important;padding:0px !important; width:300px" value="{!selectedSupplier}" size="5" multiselect="true">
                            <apex:selectOptions value="{!SupplierList}" ></apex:selectOptions>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                
                <br/>
                <center>
                
                <table class="table-style-two" width="95%">
                    <tr>
                        <td style="background:#f2f3f3;width:10%;font-weight:bold;" rowspan="{!listQueryPreAppFormCustomer.size+1}">{!IF(userLanguage=='zh_TW', '店家或子客戶', 'Outlet/Child')}</td>
                        <td style="background:#f2f3f3;"><apex:outputText value="{!IF(userLanguage=='zh_TW', '編號', 'ID')}"/></td>
                        <td style="background:#f2f3f3;"><apex:outputText value="{!IF(userLanguage=='zh_TW', '名字', 'Name')}"/></td>
                    </tr>
                    <apex:repeat value="{!listQueryPreAppFormCustomer}" var="cust" >
                        <tr>
                            <td><apex:outputText value="{!cust.ASI_CRM_JDE_Account_Number__c}"/></td>
                            <td><apex:outputText value="{!cust.ASI_CRM_HK_Customer__r.Name}"/></td>
                        </tr>
                    </apex:repeat>
                </table>
                
                <br/>
                <table class="table-style-two" width="95%">
                    <tr>
                        <td style="background:#f2f3f3;width:10%;font-weight:bold;" rowspan="{!intMapCapacitySize+1}">{!IF(userLanguage=='zh_TW', '容納量 (瓶數)', 'Capacity')}</td>
                        <td style="background:#f2f3f3;font-weight:bold;"><apex:outputText value="{!IF(userLanguage=='zh_TW', '競爭對手', 'Competitors')}"/></td>
                        <apex:repeat value="{!mapPC}" var="pc" >
                            <td style="background:#f2f3f3;text-align:center;"><apex:outputText value="{!mapPC[pc].Name}"/></td>
                        </apex:repeat>
                    </tr>
                    <apex:repeat value="{!mapCapacity}" var="competitor">
                        <tr>
                            <td style="background:#f2f3f3;">{!mapCompetitorLable[competitor]}</td>
                            <apex:repeat value="{!mapCapacity[competitor]}" var="pc">
                                <td style="border-width:0px;text-align:center;"><apex:inputField value="{!mapCapacity[competitor][pc].ASI_CRM_Bottle__c}"/></td>
                            </apex:repeat>
                        </tr>
                    </apex:repeat>
                </table>
                </center>
                <br/><br/>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '單瓶獎勵(目標量)', 'Variable Investment')}" columns="1" id="variable_section">   
                    <apex:variable value="{!1}" var="count_variable"/>
                  
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Variable}" var="itm">
                            <apex:column style="width:20px"> 
                                <apex:facet name="header">#</apex:facet>
                                <apex:outputText value="{!count_variable}"></apex:outputText>
                                <apex:variable var="count_variable" value="{!count_variable+1}"/>
                            </apex:column>
                            
                            <apex:column style="width:100px"> 
                                <apex:facet name="header">
                                    <apex:commandLink value="{!IF(userLanguage=='zh_TW', '添加', 'Add New')}" status="LoadingStatus" style="text-decoration:underline;" action="{!addPAFItems}" rerender="variable_section">
                                        <apex:param assignTo="{!PAFItemType}" value="variable" name="assignPAFItemType"/>
                                    </apex:commandLink>
                                </apex:facet>   
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '複製', 'Clone')}" action="{!clonePAFItems}" status="LoadingStatus" rerender="variable_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex" />
                                    <apex:param assignTo="{!PAFItemType}" value="variable" name="assignPAFItemType"/>
                                </apex:commandLink>
                                <apex:outputText value=" / "></apex:outputText>
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '刪除', 'Delete')}" immediate="TRUE" action="{!deletePAFItems}" status="LoadingStatus" rerender="variable_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex" />
                                    <apex:param assignTo="{!PAFItemType}" value="variable" name="assignPAFItemType"/>
                                </apex:commandLink>
                            </apex:column>

                            
                            <apex:column style="width:100px"> 
                                <apex:facet name="header">
                                    <apex:commandLink value="{!IF(userLanguage=='zh_TW', 'Clear All Target Volume Qty', 'Clear All Target Volume Qty')}" status="LoadingStatus" style="text-decoration:underline;" action="{!clearAllTargetVolumeQty}" rerender="variable_section">
                                    </apex:commandLink>
                                </apex:facet>   
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', 'Clear Target Volume Qty', 'Clear Target Volume Qty')}" action="{!clearTargetVolumeQty}" status="LoadingStatus" rerender="variable_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex" />
                                </apex:commandLink>
                            </apex:column>
                            
                            <apex:column style="width:350px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Contracted_Item__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Variable[itm].ASI_CRM_Contracted_Item__c}"/>-->
                                <apex:selectList styleClass="pickVal" value="{!mapPAFItem_Variable[itm].ASI_CRM_Contracted_Item__c}" size="1" required="TRUE" onchange="AutoFill(this, {!itm})">
                                    <apex:selectOptions value="{!listItemGroupPicklist}"/>
                                </apex:selectList>
                            </apex:column>
                            <apex:column style="width:350px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Item__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Variable[itm].ASI_CRM_Contracted_Item__c}"/>-->
                                <apex:selectList value="{!mapPAFItem_Variable[itm].ASI_CRM_FOC_Item__c}" size="1" required="FALSE">
                                    <apex:selectOptions value="{!listItemGroupPicklist}"/>
                                </apex:selectList>
                            </apex:column>
                            <apex:column style="width:500px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Target_Volume_Qty__c.label}</apex:facet>
                                <apex:pageBlockSection columns="10">
                                    <apex:inputField style="width:40px" label="P1: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P1__c}"/>  
                                    <apex:inputField style="width:40px" label="P2: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P2__c}"/>  
                                    <apex:inputField style="width:40px" label="P3: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P3__c}"/>  
                                    <apex:inputField style="width:40px" label="P4: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P4__c}"/>  
                                    <apex:inputField style="width:40px" label="P5: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P5__c}"/>  
                                    <apex:inputField style="width:40px" label="P6: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P6__c}"/> 
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:inputField style="width:40px" label="P7: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P7__c}"/>  
                                    <apex:inputField style="width:40px" label="P8: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P8__c}"/>  
                                    <apex:inputField style="width:40px" label="P9: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P9__c}"/>  
                                    <apex:inputField style="width:40px" label="P10: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P10__c}"/>  
                                    <apex:inputField style="width:40px" label="P11: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P11__c}"/> 
                                    <apex:inputField style="width:40px" label="P12: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P12__c}"/>   
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                </apex:pageBlockSection>
                            </apex:column>
                            <apex:column style="width:100px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Target_Volume_Qty__c.label}</apex:facet>
                                <apex:inputField style="width:50px" value="{!mapPAFItem_Variable[itm].ASI_HK_CRM_Target_Volume_Qty__c}"/>     
                            </apex:column>
                            <apex:column style="width:150px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable[itm].ASI_CRM_AD_or_AP__c}" required="TRUE"/>     
                            </apex:column>
                            <apex:column style="width:150px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable[itm].ASI_CRM_Cash_or_FOC__c}" required="TRUE"/>     
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Per_Bottle_w_VAT__c.label}</apex:facet>
                                <apex:inputField style="width:100px" value="{!mapPAFItem_Variable[itm].ASI_CRM_Cash_Per_Bottle_w_VAT__c}"/>     
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'FOC條件', 'FOC Term')}</apex:facet>
                                <apex:pageBlockSection columns="2" collapsible="true">
                                    <apex:inputField style="width:40px;" styleClass="BuyBottle" id="BuyBottle" label="Buy" value="{!mapPAFItem_Variable[itm].ASI_HK_CRM_FOC_Buy_Bottle_Option_1__c}"/>     
                                    <apex:inputField style="width:40px;" styleClass="FreeBottle" id="FreeBottle" label="Free" value="{!mapPAFItem_Variable[itm].ASI_HK_CRM_FOC_Free_Bottle_Option_1__c}"/>    
                                </apex:pageBlockSection>
                            </apex:column>
                            <!--apex:column style="width:150px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Key_Limited_SKU__c.label}</apex:facet>
                                <apex:inputField styleClass="KeyLimitedSKU" value="{!mapPAFItem_Variable[itm].ASI_CRM_Key_Limited_SKU__c}" />     
                            </apex:column-->
                            <!--<apex:column style="width:200px">
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'T1 FOC條件', 'T1 FOC Term')}</apex:facet>
                                <apex:pageBlockSection columns="2" collapsible="true">
                                    <apex:inputField style="width:40px;" label="Buy" value="{!mapPAFItem_Variable[itm].ASI_CRM_FOC_Buy_Bottle__c}"/>     
                                    <apex:inputField style="width:40px;" label="Free" value="{!mapPAFItem_Variable[itm].ASI_CRM_FOC_Free_Bottle__c}"/>    
                                </apex:pageBlockSection>
                            </apex:column>-->
                            <apex:column >
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'T1隨貨搭', 'T1隨貨搭')}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable[itm].ASI_CRM_FOC_with_Orders__c}"/>     
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '有條件的贊助', 'Conditional Investment')}" columns="1" id="conditional_section">
                    <apex:variable value="{!1}" var="count_conditional"/>
              
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Conditional}" var="itm" >
                            <apex:column style="width:20px"> 
                                <apex:facet name="header">#</apex:facet>
                                <apex:outputText value="{!count_conditional}"></apex:outputText>
                                <apex:variable var="count_conditional" value="{!count_conditional+1}"/>
                            </apex:column>
                            
                            <apex:column style="width:100px"> 
                                <apex:facet name="header">
                                    <apex:commandLink value="{!IF(userLanguage=='zh_TW', '添加', 'Add New')}" status="LoadingStatus" style="text-decoration:underline;" action="{!addPAFItems}" rerender="conditional_section">
                                        <apex:param assignTo="{!PAFItemType}" value="conditional" name="assignPAFItemType"/>
                                    </apex:commandLink>
                                </apex:facet>   
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '複製', 'Clone')}" action="{!clonePAFItems}" status="LoadingStatus" rerender="conditional_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex"/>
                                    <apex:param assignTo="{!PAFItemType}" value="conditional" name="assignPAFItemType"/>
                                </apex:commandLink>
                                <apex:outputText value=" / "></apex:outputText>
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '刪除', 'Delete')}" immediate="TRUE" action="{!deletePAFItems}" status="LoadingStatus" rerender="conditional_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex"/>
                                    <apex:param assignTo="{!PAFItemType}" value="conditional" name="assignPAFItemType"/>
                                </apex:commandLink>
                            </apex:column>
                            
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Mechanic__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Conditional[itm].ASI_HK_CRM_Mechanic__c}"/>-->
                                <apex:selectList value="{!mapPAFItem_Conditional[itm].ASI_HK_CRM_Mechanic__c}" size="1" required="TRUE">
                                    <apex:selectOptions value="{!listMachnicPicklist}"/>
                                </apex:selectList>
                            </apex:column>
                            <apex:column style="width:300px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Mechanic_Detail__c.label}</apex:facet>
                                <apex:inputField style="width:300px;" value="{!mapPAFItem_Conditional[itm].ASI_CRM_Mechanic_Detail__c}" required="TRUE" />
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_AD_or_AP__c}"/>     
                            </apex:column>
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Expenses_Product__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Expenses_Product__c}"/>-->
                                <apex:selectList value="{!mapPAFItem_Conditional[itm].ASI_CRM_Expenses_Product__c}" size="1">
                                    <apex:selectOptions value="{!listItemGroupPicklist}"/>
                                </apex:selectList>   
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_or_FOC__c}" required="TRUE"/>     
                            </apex:column>
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Reward_Method__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Reward_Method__c}"/>
                            </apex:column>
                            <apex:column style="width:200px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Amounts_w_VAT__c.label}</apex:facet>
                                <apex:pageBlockSection columns="4" collapsible="true">
                                    <apex:inputField style="width:40px" label="P1: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P1__c}"/>  
                                    <apex:inputField style="width:40px" label="P2: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P2__c}"/>  
                                    <apex:inputField style="width:40px" label="P3: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P3__c}"/>  
                                    <apex:outputText style="width:5px" value=""/>
                                    <apex:inputField style="width:40px" label="P4: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P4__c}"/> 
                                    <apex:inputField style="width:40px" label="P5: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P5__c}"/>  
                                    <apex:inputField style="width:40px" label="P6: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P6__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>
                                    <apex:inputField style="width:40px" label="P7: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P7__c}"/>  
                                    <apex:inputField style="width:40px" label="P8: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P8__c}"/>   
                                    <apex:inputField style="width:40px" label="P9: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P9__c}"/> 
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P10: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P10__c}"/>  
                                    <apex:inputField style="width:40px" label="P11: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P11__c}"/> 
                                    <apex:inputField style="width:40px" label="P12: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>
                            </apex:column>
                            <apex:column style="width:100px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Amounts_w_VAT__c.label}</apex:facet>
                                <apex:inputField style="width:50px" value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT__c}"/>     
                            </apex:column>
                            <apex:column style="width:200px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Volume__c.label}</apex:facet>
                                <apex:pageBlockSection columns="4" collapsible="true">
                                    <apex:inputField style="width:40px" label="P1: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P1__c}"/>  
                                    <apex:inputField style="width:40px" label="P2: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P2__c}"/>  
                                    <apex:inputField style="width:40px" label="P3: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P3__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P4: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P4__c}"/>  
                                    <apex:inputField style="width:40px" label="P5: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P5__c}"/>  
                                    <apex:inputField style="width:40px" label="P6: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P6__c}"/> 
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P7: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P7__c}"/>  
                                    <apex:inputField style="width:40px" label="P8: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P8__c}"/>  
                                    <apex:inputField style="width:40px" label="P9: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P9__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P10: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P10__c}"/>  
                                    <apex:inputField style="width:40px" label="P11: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P11__c}"/> 
                                    <apex:inputField style="width:40px" label="P12: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>   
                            </apex:column>
                            <apex:column style="width:100px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Volume__c.label}</apex:facet>
                                <apex:inputField style="width:50px" value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume__c}"/>     
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '固定贊助', 'Fixed Investment')}" columns="1" id="fixed_section">
                    <apex:variable value="{!1}" var="count_fixed"/>
                    
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Fixed}" var="itm">
                            <apex:column style="width:20px"> 
                                <apex:facet name="header">#</apex:facet>
                                <apex:outputText value="{!count_fixed}"></apex:outputText>
                                <apex:variable var="count_fixed" value="{!count_fixed+1}"/>
                            </apex:column>
                            
                            <apex:column style="width:100px"> 
                                <apex:facet name="header">
                                    <apex:commandLink value="{!IF(userLanguage=='zh_TW', '添加', 'Add New')}" status="LoadingStatus" style="text-decoration:underline;" action="{!addPAFItems}" rerender="fixed_section">
                                        <apex:param assignTo="{!PAFItemType}" value="fixed" name="assignPAFItemType"/>
                                    </apex:commandLink>
                                </apex:facet>   
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '複製', 'Clone')}" action="{!clonePAFItems}" status="LoadingStatus" rerender="fixed_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex"/>
                                    <apex:param assignTo="{!PAFItemType}" value="fixed" name="assignPAFItemType"/>
                                </apex:commandLink>
                                <apex:outputText value=" / "></apex:outputText>
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '刪除', 'Delete')}" immediate="TRUE" action="{!deletePAFItems}" status="LoadingStatus" rerender="fixed_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex"/>
                                    <apex:param assignTo="{!PAFItemType}" value="fixed" name="assignPAFItemType"/>
                                </apex:commandLink>
                            </apex:column>
                            
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Mechanic__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Fixed[itm].ASI_HK_CRM_Mechanic__c}"/>-->
                                <apex:selectList value="{!mapPAFItem_Fixed[itm].ASI_HK_CRM_Mechanic__c}" size="1" required="TRUE">
                                    <apex:selectOptions value="{!listMachnicPicklist}"/>
                                </apex:selectList>
                            </apex:column>
                            <apex:column style="width:300px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Mechanic_Detail__c.label}</apex:facet>
                                <apex:inputField style="width:300px;" value="{!mapPAFItem_Fixed[itm].ASI_CRM_Mechanic_Detail__c}" required="TRUE"/>
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_AD_or_AP__c}"/>     
                            </apex:column>
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Expenses_Product__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Expenses_Product__c}"/>-->  
                                <apex:selectList value="{!mapPAFItem_Fixed[itm].ASI_CRM_Expenses_Product__c}" size="1">
                                    <apex:selectOptions value="{!listItemGroupPicklist}"/>
                                </apex:selectList>     
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_or_FOC__c}" required="TRUE"/>     
                            </apex:column>
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Reward_Method__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Reward_Method__c}"/>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Amounts_w_VAT__c.label}</apex:facet>
                                <apex:pageBlockSection columns="4" collapsible="true">
                                    <apex:inputField style="width:40px" label="P1: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P1__c}"/>  
                                    <apex:inputField style="width:40px" label="P2: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P2__c}"/>  
                                    <apex:inputField style="width:40px" label="P3: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P3__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>  
                                    <apex:inputField style="width:40px" label="P4: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P4__c}"/>  
                                    <apex:inputField style="width:40px" label="P5: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P5__c}"/>  
                                    <apex:inputField style="width:40px" label="P6: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P6__c}"/> 
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P7: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P7__c}"/>  
                                    <apex:inputField style="width:40px" label="P8: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P8__c}"/>  
                                    <apex:inputField style="width:40px" label="P9: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P9__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>  
                                    <apex:inputField style="width:40px" label="P10: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P10__c}"/>  
                                    <apex:inputField style="width:40px" label="P11: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P11__c}"/> 
                                    <apex:inputField style="width:40px" label="P12: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>
                            </apex:column>
                            <apex:column style="width:100px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Amounts_w_VAT__c.label}</apex:facet>
                                <apex:inputField style="width:50px" value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT__c}"/>     
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Volume__c.label}</apex:facet>
                                <apex:pageBlockSection columns="4" collapsible="true">
                                    <apex:inputField style="width:40px" label="P1: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P1__c}"/>  
                                    <apex:inputField style="width:40px" label="P2: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P2__c}"/>  
                                    <apex:inputField style="width:40px" label="P3: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P3__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P4: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P4__c}"/>  
                                    <apex:inputField style="width:40px" label="P5: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P5__c}"/>  
                                    <apex:inputField style="width:40px" label="P6: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P6__c}"/> 
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P7: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P7__c}"/>  
                                    <apex:inputField style="width:40px" label="P8: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P8__c}"/>  
                                    <apex:inputField style="width:40px" label="P9: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P9__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:inputField style="width:40px" label="P10: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P10__c}"/>  
                                    <apex:inputField style="width:40px" label="P11: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P11__c}"/> 
                                    <apex:inputField style="width:40px" label="P12: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>   
                            </apex:column>
                            <apex:column style="width:100px;">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Volume__c.label}</apex:facet>
                                <apex:inputField style="width:50px" value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume__c}"/>     
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '經分銷商獎勵 (非直接給予店家)', 'Global Promotion Setting - Variable Investment')}" columns="1" id="global_variable_section">
                    <apex:variable value="{!1}" var="count_gobalVariable"/>
                    
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Variable_Global}" var="itm">
                            <apex:column style="width:20px"> 
                                <apex:facet name="header">#</apex:facet>
                                <apex:outputText value="{!count_gobalVariable}"></apex:outputText>
                                <apex:variable var="count_gobalVariable" value="{!count_gobalVariable+1}"/>
                            </apex:column>
                            
                            <apex:column > 
                                <apex:facet name="header">
                                    <apex:commandLink value="{!IF(userLanguage=='zh_TW', '添加', 'Add New')}" status="LoadingStatus" style="text-decoration:underline;" action="{!addPAFItems}" rerender="global_variable_section">
                                        <apex:param assignTo="{!PAFItemType}" value="global_variable" name="assignPAFItemType"/>
                                    </apex:commandLink>
                                </apex:facet>   
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '複製', 'Clone')}" action="{!clonePAFItems}" status="LoadingStatus" rerender="global_variable_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex" />
                                    <apex:param assignTo="{!PAFItemType}" value="global_variable" name="assignPAFItemType"/>
                                </apex:commandLink>
                                <apex:outputText value=" / "></apex:outputText>
                                <apex:commandLink value="{!IF(userLanguage=='zh_TW', '刪除', 'Delete')}" immediate="TRUE" action="{!deletePAFItems}" status="LoadingStatus" rerender="global_variable_section">
                                    <apex:param assignTo="{!intRowid}" value="{!itm}" name="assignRowIndex" />
                                    <apex:param assignTo="{!PAFItemType}" value="global_variable" name="assignPAFItemType"/>
                                </apex:commandLink>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Contracted_Item__c.label}</apex:facet>
                                <!--<apex:inputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Contracted_Item__c}"/>-->
                                <apex:selectList value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Contracted_Item__c}" size="1" required="TRUE">
                                    <apex:selectOptions value="{!listItemGroupPicklist}"/>
                                </apex:selectList>
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Target_Volume_Qty__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable_Global[itm].ASI_HK_CRM_Target_Volume_Qty__c}" required="TRUE"/>  
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_AD_or_AP__c}" required="TRUE"/>     
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Cash_or_FOC__c}" required="TRUE"/>     
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Per_Bottle_w_VAT__c.label}</apex:facet>
                                <apex:inputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Cash_Per_Bottle_w_VAT__c}"/>     
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'FOC條件', 'FOC Term')}</apex:facet>
                                <apex:pageBlockSection columns="2" collapsible="true">
                                    <apex:inputField style="width:40px;" label="Buy" value="{!mapPAFItem_Variable_Global[itm].ASI_HK_CRM_FOC_Buy_Bottle_Option_1__c}"/>     
                                    <apex:inputField style="width:40px;" label="Free" value="{!mapPAFItem_Variable_Global[itm].ASI_HK_CRM_FOC_Free_Bottle_Option_1__c}"/>    
                                </apex:pageBlockSection>    
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', 'PG 費用', 'PG Costs')}" columns="1" id="pg_section">
                    <apex:pageblocktable value="{!listPAFItem_PGCosts}" var="pg">
                        <apex:column style="font-size:.9em;padding:5px 2px 4px 5px;font-weight:bold;background:#f2f3f3;border-width:0 0 1px 1px;border-color: #e0e3e5;color: #000;">
                            <apex:facet name="header">{!IF(userLanguage=='zh_TW', '季度', 'Quarter')}</apex:facet>
                            <apex:outputText value="{!IF(userLanguage=='zh_TW', '時數', 'Hours')}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q1_hrs__c.label}</apex:facet>
                            <apex:inputField value="{!pg.ASI_CRM_Q1_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q2_hrs__c.label}</apex:facet>
                            <apex:inputField value="{!pg.ASI_CRM_Q2_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q3_hrs__c.label}</apex:facet>
                            <apex:inputField value="{!pg.ASI_CRM_Q3_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q4_hrs__c.label}</apex:facet>
                            <apex:inputField value="{!pg.ASI_CRM_Q4_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Sub_Total_hrs__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Sub_Total_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cost_Hr_w_VAT__c.label}</apex:facet>
                            <apex:inputField value="{!pg.ASI_CRM_Cost_Hr_w_VAT__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Total_PG_Cost__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Total_PG_Cost__c}"/>     
                        </apex:column>
                    </apex:pageblocktable>
                </apex:pageblocksection>
        </apex:pageBlock>
        
        
        <!--Non-Editable version-->
        <apex:pageblock rendered="{!nonEditable}">
                <apex:pageBlockButtons >
                    <apex:outputPanel >
                        <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_Back}" action="/{!preAppFormId}" immediate="TRUE"/>
                    </apex:outputPanel>
                </apex:pageBlockButtons>
                
                <apex:pageBlockSection title="{!IF(userLanguage=='zh_TW', '基本資料', 'Basic Information')}" columns="2" id="header_section">
                    <apex:outputField value="{!preAppForm[0].ASI_HK_CRM_PAF_Customer__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Sales_Representative__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Region__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Outlet_Image__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Outlet_Type__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Channel__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Outlet_Grade__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Sub_Channel__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Sales_Potential__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_CRM_Valid_Invoice__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_HK_CRM_PAF_Start_Date__c}"/>
                    <apex:outputField value="{!preAppForm[0].ASI_HK_CRM_PAF_End_Date__c}"/>
            </apex:pageBlockSection>
                
                <br/>
                <center>
                
                <table class="table-style-two" width="95%">
                    <tr>
                        <td style="background:#f2f3f3;width:10%;font-weight:bold;" rowspan="{!listQueryPreAppFormCustomer.size+1}">{!IF(userLanguage=='zh_TW', '店家或子客戶', 'Outlet/Child')}</td>
                        <td style="background:#f2f3f3;"><apex:outputText value="{!IF(userLanguage=='zh_TW', '編號', 'ID')}"/></td>
                        <td style="background:#f2f3f3;"><apex:outputText value="{!IF(userLanguage=='zh_TW', '名字', 'Name')}"/></td>
                    </tr>
                    <apex:repeat value="{!listQueryPreAppFormCustomer}" var="cust" >
                        <tr>
                            <td><apex:outputText value="{!cust.ASI_CRM_JDE_Account_Number__c}"/></td>
                            <td><apex:outputText value="{!cust.ASI_CRM_HK_Customer__r.Name}"/></td>
                        </tr>
                    </apex:repeat>
                </table>
                
                <br/>
                <table class="table-style-two" width="95%">
                    <tr>
                        <td style="background:#f2f3f3;width:10%;font-weight:bold;" rowspan="{!intMapCapacitySize+1}">{!IF(userLanguage=='zh_TW', '容納量 (瓶數)', 'Capacity')}</td>
                        <td style="background:#f2f3f3;font-weight:bold;"><apex:outputText value="{!IF(userLanguage=='zh_TW', '競爭對手', 'Competitors')}"/></td>
                        <apex:repeat value="{!mapPC}" var="pc" >
                            <td style="background:#f2f3f3;text-align:center;"><apex:outputText value="{!mapPC[pc].Name}"/></td>
                        </apex:repeat>
                    </tr>
                    <apex:repeat value="{!mapCapacity}" var="competitor">
                        <tr>
                            <td style="background:#f2f3f3;">{!mapCompetitorLable[competitor]}</td>
                            <apex:repeat value="{!mapCapacity[competitor]}" var="pc">
                                <td style="border-width:0px;text-align:center;"><apex:outputField value="{!mapCapacity[competitor][pc].ASI_CRM_Bottle__c}"/></td>
                            </apex:repeat>
                        </tr>
                    </apex:repeat>
                </table>
                </center>
                <br/><br/>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '單瓶獎勵', 'Variable Investment')}" columns="1" id="variable_section">
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Variable}" var="itm">
                            <apex:column style="width:400px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Contracted_Item__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_CRM_Contracted_Item__c}"/> 
                            </apex:column>
                            <apex:column style="width:400px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Item__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_CRM_FOC_Item__c}"/> 
                            </apex:column>
                            <apex:column style="width:300px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Target_Volume_Qty__c.label}</apex:facet>
                                <apex:pageBlockSection columns="10">
                                    <apex:outputField style="width:40px" label="P1: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P1__c}"/>  
                                    <apex:outputField style="width:40px" label="P2: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P2__c}"/>  
                                    <apex:outputField style="width:40px" label="P3: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P3__c}"/>  
                                    <apex:outputField style="width:40px" label="P4: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P4__c}"/>  
                                    <apex:outputField style="width:40px" label="P5: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P5__c}"/>  
                                    <apex:outputField style="width:40px" label="P6: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P6__c}"/> 
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputField style="width:40px" label="P7: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P7__c}"/>  
                                    <apex:outputField style="width:40px" label="P8: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P8__c}"/>  
                                    <apex:outputField style="width:40px" label="P9: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P9__c}"/>  
                                    <apex:outputField style="width:40px" label="P10: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P10__c}"/>  
                                    <apex:outputField style="width:40px" label="P11: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P11__c}"/> 
                                    <apex:outputField style="width:40px" label="P12: " value="{!mapPAFItem_Variable[itm].ASI_CRM_Target_Volume_Qty_P12__c}"/>   
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                    <apex:outputText style="width:20px">&nbsp;</apex:outputText>
                                </apex:pageBlockSection> 
                            </apex:column>
                            <apex:column style="width:100px;">
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_HK_CRM_Target_Volume_Qty__c}"/>     
                            </apex:column>
                            <apex:column style="width:150px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_CRM_AD_or_AP__c}"/>     
                            </apex:column>
                            <apex:column style="width:150px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_CRM_Cash_or_FOC__c}"/>     
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Per_Bottle_w_VAT__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_CRM_Cash_Per_Bottle_w_VAT__c}"/>     
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'FOC條件', 'FOC Term')}</apex:facet>
                                <apex:pageBlockSection columns="2" collapsible="true">
                                    <apex:outputField style="width:40px;" label="Buy" value="{!mapPAFItem_Variable[itm].ASI_HK_CRM_FOC_Buy_Bottle_Option_1__c}"/>     
                                    <apex:outputField style="width:40px;" label="Free" value="{!mapPAFItem_Variable[itm].ASI_HK_CRM_FOC_Free_Bottle_Option_1__c}"/>    
                                </apex:pageBlockSection>
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'T1隨貨搭', 'T1隨貨搭')}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable[itm].ASI_CRM_FOC_with_Orders__c}"/>     
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '有條件的贊助', 'Conditional Investment')}" columns="1" id="conditional_section">
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Conditional}" var="itm">
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Mechanic__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_HK_CRM_Mechanic__c}"/>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Mechanic_Detail__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Mechanic_Detail__c}"/>
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_AD_or_AP__c}"/>     
                            </apex:column>
                            <apex:column style="width:300px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Expenses_Product__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Expenses_Product__c}"/> 
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_or_FOC__c}"/>     
                            </apex:column>
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Reward_Method__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Conditional[itm].ASI_CRM_Reward_Method__c}"/>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Amounts_w_VAT__c.label}</apex:facet>
                                <apex:pageBlockSection columns="5" collapsible="true">
                                    <apex:outputField style="width:40px" label="P1: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P1__c}"/>  
                                    <apex:outputField style="width:40px" label="P2: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P2__c}"/>  
                                    <apex:outputField style="width:40px" label="P3: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P3__c}"/>  
                                    <apex:outputField style="width:40px" label="P4: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P4__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>  
                                    <apex:outputField style="width:40px" label="P5: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P5__c}"/>  
                                    <apex:outputField style="width:40px" label="P6: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P6__c}"/> 
                                    <apex:outputField style="width:40px" label="P7: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P7__c}"/>  
                                    <apex:outputField style="width:40px" label="P8: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P8__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>  
                                    <apex:outputField style="width:40px" label="P9: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P9__c}"/>  
                                    <apex:outputField style="width:40px" label="P10: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P10__c}"/>  
                                    <apex:outputField style="width:40px" label="P11: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P11__c}"/> 
                                    <apex:outputField style="width:40px" label="P12: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_Cash_Amounts_w_VAT_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Volume__c.label}</apex:facet>
                                <apex:pageBlockSection columns="5" collapsible="true">
                                    <apex:outputField style="width:40px" label="P1: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P1__c}"/>  
                                    <apex:outputField style="width:40px" label="P2: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P2__c}"/>  
                                    <apex:outputField style="width:40px" label="P3: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P3__c}"/>  
                                    <apex:outputField style="width:40px" label="P4: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P4__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:outputField style="width:40px" label="P5: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P5__c}"/>  
                                    <apex:outputField style="width:40px" label="P6: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P6__c}"/> 
                                    <apex:outputField style="width:40px" label="P7: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P7__c}"/>  
                                    <apex:outputField style="width:40px" label="P8: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P8__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:outputField style="width:40px" label="P9: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P9__c}"/>  
                                    <apex:outputField style="width:40px" label="P10: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P10__c}"/>  
                                    <apex:outputField style="width:40px" label="P11: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P11__c}"/> 
                                    <apex:outputField style="width:40px" label="P12: " value="{!mapPAFItem_Conditional[itm].ASI_CRM_FOC_Volume_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>   
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', '固定贊助', 'Fixed Investment')}" columns="1" id="fixed_section">
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Fixed}" var="itm">
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Mechanic__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_HK_CRM_Mechanic__c}"/>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Mechanic_Detail__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Mechanic_Detail__c}"/>
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_AD_or_AP__c}"/>     
                            </apex:column>
                            <apex:column style="width:300px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Expenses_Product__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Expenses_Product__c}"/>  
                            </apex:column>
                            <apex:column style="width:100px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_or_FOC__c}"/>     
                            </apex:column>
                            <apex:column style="width:250px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Reward_Method__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Fixed[itm].ASI_CRM_Reward_Method__c}"/>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Amounts_w_VAT__c.label}</apex:facet>
                                <apex:pageBlockSection columns="5" collapsible="true">
                                    <apex:outputField style="width:40px" label="P1: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P1__c}"/>  
                                    <apex:outputField style="width:40px" label="P2: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P2__c}"/>  
                                    <apex:outputField style="width:40px" label="P3: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P3__c}"/>  
                                    <apex:outputField style="width:40px" label="P4: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P4__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>  
                                    <apex:outputField style="width:40px" label="P5: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P5__c}"/>  
                                    <apex:outputField style="width:40px" label="P6: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P6__c}"/> 
                                    <apex:outputField style="width:40px" label="P7: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P7__c}"/>  
                                    <apex:outputField style="width:40px" label="P8: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P8__c}"/> 
                                    <apex:outputText style="width:5px" value=""/>  
                                    <apex:outputField style="width:40px" label="P9: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P9__c}"/>  
                                    <apex:outputField style="width:40px" label="P10: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P10__c}"/>  
                                    <apex:outputField style="width:40px" label="P11: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P11__c}"/> 
                                    <apex:outputField style="width:40px" label="P12: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_Cash_Amounts_w_VAT_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>
                            </apex:column>
                            <apex:column style="width:200px">
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_FOC_Volume__c.label}</apex:facet>
                                <apex:pageBlockSection columns="5" collapsible="true">
                                    <apex:outputField style="width:40px" label="P1: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P1__c}"/>  
                                    <apex:outputField style="width:40px" label="P2: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P2__c}"/>  
                                    <apex:outputField style="width:40px" label="P3: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P3__c}"/>  
                                    <apex:outputField style="width:40px" label="P4: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P4__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:outputField style="width:40px" label="P5: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P5__c}"/>  
                                    <apex:outputField style="width:40px" label="P6: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P6__c}"/> 
                                    <apex:outputField style="width:40px" label="P7: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P7__c}"/>  
                                    <apex:outputField style="width:40px" label="P8: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P8__c}"/>  
                                    <apex:outputText style="width:5px" value=""/> 
                                    <apex:outputField style="width:40px" label="P9: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P9__c}"/>  
                                    <apex:outputField style="width:40px" label="P10: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P10__c}"/>  
                                    <apex:outputField style="width:40px" label="P11: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P11__c}"/> 
                                    <apex:outputField style="width:40px" label="P12: " value="{!mapPAFItem_Fixed[itm].ASI_CRM_FOC_Volume_P12__c}"/>   
                                    <apex:outputText style="width:5px" value=""/>
                                </apex:pageBlockSection>   
                            </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', 'Global Promotion Setting - 單瓶獎勵', 'Global Promotion Setting - Variable Investment')}" columns="1" id="global_variable_section">
                    <apex:actionRegion >
                        <apex:pageblocktable value="{!mapPAFItem_Variable_Global}" var="itm">
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Contracted_Item__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Contracted_Item__c}"/> 
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_HK_CRM_Target_Volume_Qty__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable_Global[itm].ASI_HK_CRM_Target_Volume_Qty__c}"/>  
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_AD_or_AP__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_AD_or_AP__c}"/>     
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_or_FOC__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Cash_or_FOC__c}"/>     
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cash_Per_Bottle_w_VAT__c.label}</apex:facet>
                                <apex:outputField value="{!mapPAFItem_Variable_Global[itm].ASI_CRM_Cash_Per_Bottle_w_VAT__c}"/>     
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">{!IF(userLanguage=='zh_TW', 'FOC條件', 'FOC Term')}</apex:facet>
                                <apex:pageBlockSection columns="2" collapsible="true">
                                    <apex:outputField style="width:40px;" label="Buy" value="{!mapPAFItem_Variable_Global[itm].ASI_HK_CRM_FOC_Buy_Bottle_Option_1__c}"/>     
                                    <apex:outputField style="width:40px;" label="Free" value="{!mapPAFItem_Variable_Global[itm].ASI_HK_CRM_FOC_Free_Bottle_Option_1__c}"/>    
                                </apex:pageBlockSection>
                                </apex:column>
                        </apex:pageblocktable>
                    </apex:actionRegion>
                </apex:pageblocksection>
                
                <apex:pageblocksection title="{!IF(userLanguage=='zh_TW', 'PG 費用', 'PG Costs')}" columns="1" id="pg_section">
                    <apex:pageblocktable value="{!listPAFItem_PGCosts}" var="pg">
                        <apex:column style="font-size:.9em;padding:5px 2px 4px 5px;font-weight:bold;background:#f2f3f3;border-width:0 0 1px 1px;border-color: #e0e3e5;color: #000;">
                            <apex:facet name="header">{!IF(userLanguage=='zh_TW', '季度', 'Quarter')}</apex:facet>
                            <apex:outputText value="{!IF(userLanguage=='zh_TW', '時數', 'Hours')}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q1_hrs__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Q1_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q2_hrs__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Q2_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q3_hrs__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Q3_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Q4_hrs__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Q4_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Sub_Total_hrs__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Sub_Total_hrs__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Cost_Hr_w_VAT__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Cost_Hr_w_VAT__c}"/>     
                        </apex:column>
                        <apex:column >
                            <apex:facet name="header">{!$ObjectType.ASI_HK_CRM_Pre_Approval_Form_Item__c.fields.ASI_CRM_Total_PG_Cost__c.label}</apex:facet>
                            <apex:outputField value="{!pg.ASI_CRM_Total_PG_Cost__c}"/>     
                        </apex:column>
                    </apex:pageblocktable>
                </apex:pageblocksection>
        </apex:pageblock>
    </apex:form>
    
    <apex:actionStatus id="LoadingStatus" >
        <apex:facet name="start">
            <c:ASI_CRM_TW_LoadingStatus BackColor="#ffffff"
                                    borderColor="#6B6B6B"
                                    borderSize="1"
                                    height="50px"
                                    width="150px"
                                    margintop="-25px"
                                    marginleft="-60px"
                                    ImageUrl="{!$Resource.loadingStatus}"
                                    Message="Please Wait..."/>
        </apex:facet>
    </apex:actionStatus>
    <script type="text/javascript">
    
    function AutoFill(SelectedGroup, Row){
        sforce.connection.sessionId = "{!$Api.Session_ID}";
        console.log('ROW : ' + Row);
        
        var ItemId = document.getElementsByClassName('pickVal')[Row].value;
        console.log('SelectedGroup : ' + ItemId);
        var PAF_EndDate = document.getElementById('{!$Component.form1.block1.header_section.EndDate}').value;
        console.log('PAF_EndDate : ' + PAF_EndDate);
        
        var EndDate=''
        dArr = PAF_EndDate.split("/");
        var Month = '';
        var Year = '';
        var Day = '';
        if(dArr[0].length == 4){
            Year = dArr[0];
            Month = dArr[1];
            Day = dArr[2];
        }    
        else{
            Year = dArr[2];
            Month = dArr[1];
            Day = dArr[0];
        }
        if(Month.length<2)
            Month = "0"+Month;
        if(Day.length<2)
            Day = "0"+Day; 
            
        EndDate = Year+"-"+Month+"-"+Day;
        var ChannelCode = '{!preAppForm[0].ASI_CRM_Channel__r.ASI_CRM_CN_Channel_Code__c}';
        try{
            /*var result = sforce.apex.execute("ASI_CRM_TW_PAF_Edit_WebService","GetKey_Limited_SKU",{itemId:a});
            
            if(result[0] != 'NULL'){
                var KeyLimitedSKUval = result[0];
                console.log('KeyLimitedSKUval : ' + KeyLimitedSKUval);
            }
            if(result[0] != 'NULL'){
                var Buy_val = result[1];
                console.log('Buy_val : ' + Buy_val);
            }
            if(result[0] != 'NULL'){
                var Free_val = result[2];
                console.log('Free_val : ' + Free_val);
            }*/

            var sQuery = "Select Id, ASI_CRM_Key_Limited_SKU__c, ASI_CRM_Free__c, ASI_CRM_Buy__c "+
                "FROM ASI_CRM_MY_SKUPriceCost__c where ASI_CRM_Type__c = 'Product Selection'"+
                "AND ASI_CRM_Applied_To__c includes ('"+ChannelCode+"') "+
                "AND ASI_CRM_EffectiveDate__c <= "+EndDate+" "+
                "AND ASI_CRM_Item_Group__c = '"+ ItemId + "' ORDER BY ASI_CRM_EffectiveDate__c DESC Limit 1";
            console.log('sQuery : ' + sQuery);
            
            var result = sforce.connection.query(sQuery);
            if(result.size > 0){
                console.log('result : ' + result);
                var records = result.getArray('records');
                var KeyLimitedSKUval = records[0].ASI_CRM_Key_Limited_SKU__c;
                var Buy_val = Math.round(records[0].ASI_CRM_Buy__c);
                var Free_val = Math.round(records[0].ASI_CRM_Free__c);
                console.log('KeyLimitedSKUval : ' + KeyLimitedSKUval);
                console.log('Buy_val : ' + Buy_val);
                console.log('Free_val : ' + Free_val);
                document.getElementsByClassName('BuyBottle')[Row].value = Buy_val;
                document.getElementsByClassName('FreeBottle')[Row].value = Free_val;
                //document.getElementsByClassName('KeyLimitedSKU')[Row].value = KeyLimitedSKUval;

                //if Null Updagte what
                //First Time
                //choose which onchange
            }
            else{
                /*
                document.getElementsByClassName('BuyBottle')[Row].value = 0;
                document.getElementsByClassName('FreeBottle')[Row].value = 0;
                document.getElementsByClassName('KeyLimitedSKU')[Row].value = '';*/
                console.log('no result');
            }
            
		}catch(e) 
        {
          alert('Exception'+e)
        }
    }
    </script>
</apex:page>