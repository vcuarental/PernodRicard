<apex:page controller="BMCServiceDesk.RequestDefController" showHeader="false"
    sidebar="false" id="thePage" contentType="{!contetnTypeForIE}"
    lightningStylesheets="true" applyHtmlTag="false">
<html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en" class="slds-scope rf-html-clear">    
    <apex:stylesheet value="{!URLFOR($Resource.BMCServiceDesk__SDEFStyles, 'RFAdminExt4Common.css')}" />
    <!--link rel="Stylesheet" type="text/css" href="{!$Resource.SDEFStyles}/BMCStyleSheet.css" /-->
    <c:CommonIncludes isExtJS4="true" />
    <apex:slds />
    <script type="text/javascript" src="{!$Resource.SelfServiceMyITUI}/SelfService/scripts/vendor/jquery/jquery.min.js"></script>
    
    <script type="text/javascript"
        src="{!$Resource.SDEFExtJS}/ex/ux/CheckColumn.js"></script>
    
    <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/LexItemSelector.js"/>
    <link rel="stylesheet" href="{!$Resource.Salesforce1}/SelfService/DPLLibraries/css/Salesforce-Font.css" />
    <script type="text/javascript" src="{!$Resource.SDEFCommonJS}/Vtabpanel.js"></script>
    <link rel="Stylesheet" type="text/css" href="{!$Resource.SDEFStyles}/bmc-dpl-common.css" />
    <link rel="stylesheet" href="{!URLFOR($Resource.Salesforce1, 'SelfService/DPLLibraries/css/dpl-iconfont.css')}" type="text/css"/>
    <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/JSCommon.js"
        id="JSCommon-js" />
    <apex:includeScript value="{!$Resource.BMCServiceDesk__ExtJS4_1_3}/src/form/field/Spinner.js" />
    <script type="text/javascript" src="{!$Resource.SDEFCommonJS}/HTML_ENCODE_DECODE.js"></script>
	<script type="text/javascript"
        src="{!$Resource.SDEFCommonJS}/ReqDefPage.js"></script>
    <script type="text/javascript" src="{!$Resource.SDEFCommonJS}/svgForIE11.js"></script>

    <apex:outputpanel id="sldsAlert">
        <c:RFMessagingComponent />
    </apex:outputpanel>
    <script>
	   var isReqDefForm = true;
       var entitlementOptionSelected,console_entitlementOptionSelected;
       var isInputDetailDirty = false;
       var isforIncidentTemplateLookup =false;     
       var accLeftStoreData, accRightStoreData;
	   var profileRightStoreData, profileLeftStoreData;
	   var permissionsetLeftStoreData, permissionsetRightStoreData;
	   var console_accLeftStoreData, console_accRightStoreData;
	   var console_profileRightStoreData, console_profileLeftStoreData;
	   var console_permissionsetLeftStoreData, console_permissionsetRightStoreData;
	   var allAccountInputOption, console_allAccountInputOption;
	   var restrictCheckboxValue;
	   var currentConfig = 'SelfService';
       var NAMESPACE_PREFIX = 'BMCServiceDesk__';
	   var pleaseWaitMsg = '{!JSENCODE($Label.PleaseWait)}';
       var preFirstBtn,nextLastBtn;
       var isCalledFromRD = true;
	   Ext.ns("RequestDefPage");
            RequestDefPage.Labels = {
            PM_PageLoad: '{!JSENCODE($Label.PM_PageLoad)}',
            PM_netwokLatency: '{!JSENCODE($Label.PM_netwokLatency)}'
            }
        var deleteIconPath = "{!URLFOR($Resource.SDEFStyles,'/SDEFbuttons/Delete_Disabled.png')}";
        var closeIconPath = "{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#close')}";
             var stime = '{!serverstarttime}';
             var etime = '{!serverendtime}';
             var accountHeaderInfo ='';
             if({!isNoaccountEntitlementEnabled}){
             	accountHeaderInfo = ' {!JSENCODE($Label.SelectedAccountInfo1)}'
             }else{
             	accountHeaderInfo = ' {!JSENCODE($Label.SelectedAccountInfo2)}'
             }
             accountHeaderInfo = '<b>'+'{!JSENCODE($Label.Allprofiles)}'+': </b>'+' {!JSENCODE($Label.ProfileEntitlement)}'+'<br/><b>'+'{!JSENCODE($Label.SelectedAccounts)}'+': </b>'+accountHeaderInfo;
             var data = '';
             data += '{!JSENCODE($Label.PM_servertime)}';
             if(etime - stime == 0){
                data += 0;
             }
           var labelSavedSuccessfully = '{!JSENCODE($Label.SavedSuccessfully)}',            
        	labelClone = '{!JSENCODE($Label.Clone)}',
            labelDelete = '{!JSENCODE($Label.Delete)}',
            labelEdit = '{!JSENCODE($Label.CMDBEdit)}',
            labelMoreAction = '{!JSENCODE($Label.moreAction)}',
            labelSrch = '{!JSENCODE($Label.search)}',
            labelNoRecord = '{!JSENCODE($Label.MsgNoRecordFoundSearchPage)}',
            labelQuestion = '{!JSENCODE($Label.Question)}',
            labelWarning = '{!JSENCODE($Label.Warning)}',
            labelError = '{!JSENCODE($Label.Error)}',
            labelInfo = '{!JSENCODE($Label.Information)}',
            labelMinChar = '{!JSENCODE($Label.GsErrorMsg)}',
            labelNew = '{!JSENCODE($Label.New)}',
            labelSave = '{!JSENCODE($Label.Save)}',
            labelOK = '{!JSENCODE($Label.OK)}',
            labelCancel = '{!JSENCODE($Label.Cancel)}',
            labelCopy = '{!JSENCODE($Label.Copy)}',
            labelMapMoreInputs = '{!JSENCODE($Label.SRDMapMoreInputs)}',
            labelConditionalHeader = '{!$ObjectType.SRM_FulfillmentInputs__c.fields.Conditional__c.label}',
            lableInvokeTemplateHeader = '{!$Label.invoketemplate}',
            labelReset = '{!JSENCODE($Label.Reset)}', 
            labelRefresh = '{!JSENCODE($Label.Refresh)}',           
            labelPreviousRecord = '{!JSENCODE($Label.PreviousRecord)}',
            labelInactive ='{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.inactive__c.label)}',
            labelInsert =  '{!JSENCODE($Label.Insert)}',
            labelNextRecord = '{!JSENCODE($Label.NextRecord)}',
			labelPrevious = '{!JSENCODE($Label.PreviousPage)}',
			labelNext = '{!JSENCODE($Label.NextPage)}',
            PreviousLabel = '{!JSENCODE($Label.Previous)}',
            NextLabel = '{!JSENCODE($Label.Next)}',
            labelNextStep = '{!JSENCODE($Label.NextStep)}',
			labelUp='{!JSENCODE($Label.IconUp)}',
			labelDown='{!JSENCODE($Label.IconDown)}',
            labelMapInputToField =  '{!JSENCODE($Label.MapInputToField)}',
            labelDownloadChatbotJSON='{!JSENCODE($Label.DownloadChatBotJson)}',
            AvailableAccounts = '{!JSENCODE($Label.AvailableAccounts)}',
            SelectedAccounts = '{!JSENCODE($Label.SelectedAccounts)}',
            SelectedProfile = '{!JSENCODE($Label.SelectedProfile)}',
            AvailableProfile = '{!JSENCODE($Label.AvailableProfile)}',
            AvailablePermissionSets = '{!JSENCODE($Label.AvailablePermissionsetsSRD)}',
            SelectedPermissionSets =  '{!JSENCODE($Label.SelectedPermissionsetsSRD)}',
            targetInDays = '{!reqDefBean.targetInDays}',
            targetInHours = '{!reqDefBean.targetInHours}',
            LabelOptions = '{!JSENCODE($Label.DisplayOptions)}',
            labelDeleteConfirm = '{!JSENCODE($Label.DeleteConfirmMessage)}',
            invalidurl = '{!JSENCODE($Label.invalidURL)}',
        	errorboxtitle= '{!JSENCODE($Label.Error)}',
            reqDefWindowHeader = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.label)}',
            fulfillmentInputWindowHeader = '{!JSENCODE($Label.fulfillmentInput)}',
            taskTemplateExecutionOrder = '{!JSENCODE($Label.taskTemplateExecutionOrder)}',
            close = '{!JSENCODE($Label.Close)}',
            TextAreaOverflow = '{!JSENCODE($Label.TextAreaOverflow)}',
			CreateNewRequestDetailTemplate = '{!JSENCODE($Label.Create_New_Request_Defination_Template)}',
			labelInputTabTitle = '{!JSENCODE($Label.InputNameLabel)}',
            labelFulfillmentTabTitle = '{!JSENCODE($Label.Fulfillment)}',
            labelGeneralInfoTabTitle = '{!JSENCODE($Label.SLM_General_Information)}',
            labelEntitlementTabTitle = '{!JSENCODE($Label.Entitlement)}',
            labelSearchLookup = '{!JSENCODE($Label.SRDSearchOption)}',
            SelectField = '{!JSENCODE($Label.SelectField)}',
            labelCreateNewLookup = '{!JSENCODE($Label.SRDNewRecordOption)}',
            labelSaveAndNext = '{!JSENCODE($Label.SRDSaveAndNext)}',
            labelFieldCategory = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.FKCategory__c.label)}',
            labelFieldService = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.FKBusinessService__c.label)}',
            labelFieldOffering = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.FKServiceOffering__c.label)}',
            labelFieldINTemplate = '{!JSENCODE($Label.incidenttemplate)}',
            labelFieldSRTemplate = '{!JSENCODE($Label.servicerequesttemplatelookuplabel)}',
			labelNewTemplate = '{!JSENCODE($Label.New)}'+' '+'{!JSENCODE($Label.Template)}',
			labelExistingTemplate = '{!JSENCODE($Label.ExistingTemplate)}',
			labelRequired = '{!JSENCODE($Label.Required)}',
			labelType = '{!JSENCODE($Label.Type)}',
			labelWarningTitle = '{!JSENCODE($Label.Warning)}',
			labelUnsavedFulfillmentInputWarning = '{!JSENCODE($Label.UnsavedFulfillmentInput_Warning)}',
			labelFulfillmentCriteria = '{!JSENCODE($Label.Fulfillment_Criteria_CI_Asset)}',
			labelProfileInfo = '{!JSENCODE($Label.EntitlementInstructions)}',
            labelUserInstructions = '{!JSENCODE($Label.Rich_Text_Instructions)}',
            labelRichTextDescription = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.Description_Rich_Text__c.label)}',
            labelMsgDeleteMapping = '{!JSENCODE($Label.MsgDeleteMapping)}',
            labelFulfillmentInputStep = '{!JSENCODE($Label.FulfillmentInputStep)}',
            labelRequestInput = '{!JSENCODE($Label.RequestInput)}',
            labelFulfillmentProcessInfo = '{!JSENCODE($Label.SRDFulfilmentProcessInfo)}',
            labelProcessType = '{!JSENCODE($Label.SRDProcessType)}',
            labelTask = '{!JSENCODE($ObjectType.Task__c.label)}',
            labelChangeRequest = '{!JSENCODE($ObjectType.Change_Request__c.label)}',
            labelMappingInfo = '{!JSENCODE($Label.SRDMappingInfo)}',
            labelMappingNote = '{!JSENCODE($Label.SRDMappingNote)}',
            labelMappingInstructions = '{!JSENCODE($Label.FulfillmentMappingInstructions)}',
            labelMappedInputs = '{!JSENCODE($Label.mapped_fields_for_selected_template)}',
            labelMultiple = '{!JSENCODE($Label.Multiple)}',
            labelUp = '{!JSENCODE($Label.Up)}',
            labelDown = '{!JSENCODE($Label.Down)}',
            labelRemove = '{!JSENCODE($Label.Remove)}',
            labelClose = '{!JSENCODE($Label.close)}',
            labelSeeAll = '{!JSENCODE($Label.SeeAll)}',
            labelAvailableInputs = '{!JSENCODE($Label.SRDAvailableInputs)}',
            labelPrefixPromptNote = '{!JSENCODE($Label.SRDPrefixPromptNote)}',
            labelCMDBNote = '{!JSENCODE($Label.FulfillmentCriteriaInstructions)}',
            labelRequestInputEdit = '{!JSENCODE($Label.RequestInputEdit)}',
            labelChooseDataType = '{!JSENCODE($Label.ChooseDataType)}',
            labelRequestInputCreate = '{!JSENCODE($Label.RequestInputCreate)}',
			labelActivate = '{!JSENCODE($Label.Activate)}',
            labelDeactivate = '{!JSENCODE($Label.Deactivate)}',
            labelImageHelpText = '{!JSENCODE($Label.SRDImageHelpText)}',
            labelApprovalHelpText = '{!JSENCODE($Label.SRDApprovalHelpText)}',
            labelOnlineHelpText = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.Online__c.inlineHelpText)}',
            labelSelectCategories = '{!JSENCODE($ObjectType.Category__c.LabelPlural)}',
            labelBusinessServicePopupTitle = '{!JSENCODE($ObjectType.BMC_BusinessService__c.LabelPlural)}',
            labelDocumentsPopupTitle = '{!JSENCODE($ObjectType.Document.LabelPlural)}',
			newTitle;
            var createNewTemplateLabel= '{!JSENCODE($Label.Create_New)}'+' '+'{!JSENCODE($Label.Template)}';
            var Description = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.description__c.label)}';
            var infixCondition ='';
            var postfixCondition =''
            var isFlattenedCmdb = {!isFlattenedCmdb}; 
            var AddImage= '{!JSENCODE($Label.AddImage)}';
        
            var isRequestDefCreatable = '{!reqDefBean.isRequestDefCreatable}';
            var isrequestDefUpdateble = '{!reqDefBean.isrequestDefUpdateble}';
            var isRequestDefDeletable = '{!reqDefBean.isRequestDefDeletable}';  
			
			var ALL = '{!reqDefBean.ALL}';
            var PROFILE_PREFIX = '{!reqDefBean.PROFILE_PREFIX}';
            var PERMISSIONSET_PREFIX = '{!reqDefBean.PERMISSIONSET_PREFIX}';
            var labelYes = '{!JSENCODE($Label.ExtjsMessageYes)}';
            var labelNo = '{!JSENCODE($Label.ExtjsMessageNo)}';
            var dateValue = '{!JSENCODE(reqDefBean.filterClauseDate)}';
            var dateClause = escape('(serviceType__c != \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ')');
            if(!isFlattenedCmdb){
            	dateClause = escape('(serviceType__c != \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
            }else{
            	dateClause = escape('(serviceType__c != \'Offering\') And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
            }
            
            var isInActive = {!reqDefBean.isInActive};

            function getPreFirstBtn(){
                return !{!IF(paginator.hasPrevious,'true','false')};
            }
            function getNextLastBtn(){
                return !{!IF(paginator.hasNext,'true','false')};
            }
            function getIsDirect(){
                return '{!JSENCODE($CurrentPage.parameters.isDirect)}';
            }
            function getReqDefID(){
                return '{!reqDefBean.reqDefObj.Id}';
            }
            function getWID(){
                return '{!JSENCODE($CurrentPage.parameters.wid)}';
            }           
            function getImageID(attachmentId){
             document.getElementById('{!$Component.ReqDefForm.Image_Id}').src='/servlet/servlet.FileDownload?file='+attachmentId;
                 setReqDefDoc(attachmentId);
                rfPopUpClose('rfModalVFPage');
            }
            function getSDFStylesResPath(){
            var resPath = '{!$Resource.SDEFStyles}';
            return resPath;  
            }
            function getDaysTargetHiddenEle(){            
            return document.getElementById('{!$Component.ReqDefForm.targetInDays}');
            }
            
            function enableRequiredAttachment(){
            var attachmentChecked = document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachment}').checked;
            if(attachmentChecked)
                 document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachmentRequired}').disabled = false;
            else{
                 document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachmentRequired}').disabled = true;
                 document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachmentRequired}').checked = false;
                }
            }
            function getHoursTargetHiddenEle(){            
            return document.getElementById('{!$Component.ReqDefForm.targetInHours}');
            }
            function getRefDefDescriptionEle(){
            return document.getElementById('{!$Component.ReqDefForm.ReqDef_Description}');
            }
            function setCatData(id, name, catUrgency) {
			document.getElementById('thePage:ReqDefForm:Category__c_id_name').setAttribute('value',name);
			document.getElementById('{!$Component.ReqDefForm.Category__c_id_name}').value = name;
            document.getElementById('{!$Component.ReqDefForm.Category__c_id_id}').value = id;
            document.getElementById('{!$Component.ReqDefForm.Category__c_id_fkurgency__c}').value = catUrgency;
            }
            function openImagePopup(){
                var folder = '{!folderId}';
                if(document.getElementById('radioCom').checked == true){
                    showLightningPopup('vfModalPage',AddImage,'DocPage?isSRD=true&folderId='+ folder,200,470);
                }else if(document.getElementById('radioSF').checked = true){
                    if(!inProgress){
                        showLightningPopup('vfModalPage',labelDocumentsPopupTitle,'ImageSelectorPage',500,832);
                    }
                }
            }
            function updateTitle(){
                if(errormsg == '{!JSENCODE($Label.SavedSuccessfully)}'){
                    var wid = getWID();
                    window.parent.changeTitle(wid,newTitle,newTitle);
              	    changeSRDTitle();
                    window.parent.refreshList();
                }
            }
            function assignApexErrorMessage(){
            
                var elem = document.getElementById('apexMessageErrorPanelDiv');
                if(elem != null && elem.firstChild != null){
                    var ulList = elem.firstChild;
                    var msgvalue = ulList.firstChild.innerText || ulList.firstChild.textContent;
					isApexError=true;
					 showErrorMessageToast(msgvalue);
                }
            }
            
            function resetEntitlementData(){
                accLeftStore.removeAll();
                leftStore.removeAll();
	            var  accountRadioEveryOne_SS = document.getElementById('accountRadioEveryOne_SS');
                var  accountRadioSelected_SS = document.getElementById('accountRadioSelected_SS');
                var  accountRadioEveryOne_Con = document.getElementById('accountRadioEveryOne_Con');
                var  accountRadioSelected_Con = document.getElementById('accountRadioSelected_Con');
				var allAccount_SelfService= accountRadioEveryOne_SS.checked;
                var allAccount_Console= accountRadioEveryOne_Con.checked;
				var ProfileOptionSelector_SelfService= document.getElementById('thePage:ReqDefForm:profileOptionSelect_SS');
				var ProfileOptionSelector_Console= document.getElementById('thePage:ReqDefForm:profileOptionSelect_Con');
				var restrictSRAccessCheckbox = document.getElementById('thePage:ReqDefForm:restrictSRAccess');
	     		var restrictSRAccessTable = document.getElementById('restrictSRAccessTable');
	
                if(currentConfig == 'RemedyforceConsole'){
                	 /*------------Accounts-------------*/
                
	                document.getElementById('accountRadioSelect_SS').style.display = 'none'; 
	                document.getElementById('accountRadioSelect_Con').style.display = 'inline'; 
	                
	              	if(console_allAccountInputOption && console_allAccountInputOption.toLowerCase() == 'true' || console_accRightStoreData.length < 1){
                        accountRadioEveryOne_Con.checked = true;
                        accountRadioSelected_Con.checked = false;
                    }                        
	              	else{
                        accountRadioSelected_Con.checked = true;
                        accountRadioEveryOne_Con.checked = false;
                    }
	              	accLeftStore.loadData(console_accLeftStoreData);
                   
                    Ext.getCmp('accountSelector').bindStore(accLeftStore);
					Ext.getCmp('accountSelector').setValue(console_accRightStoreData);
	               
	                /*------------Profile/PermissionSet-------------*/
	                
	                ProfileOptionSelector_SelfService.style.display = 'none'; 
                    ProfileOptionSelector_Console.style.display = 'inline'; 
                    
	                ProfileOptionSelector_Console.value   = console_entitlementOptionSelected;
	                storeCurrentContents = console_entitlementOptionSelected;
					if(console_entitlementOptionSelected == PERMISSIONSET_PREFIX) {     //changing profile-permission grid title
							if(entitlementOptionSelected == PROFILE_PREFIX || entitlementOptionSelected == ALL){
								var availableTitle =  document.getElementById('thePage:ReqDefForm:available');
			                    availableTitle.innerText = availableTitle.textContent = AvailablePermissionSets;
			                    var selectedTitle =  document.getElementById('thePage:ReqDefForm:selected');
			                    selectedTitle.innerText = selectedTitle.textContent = SelectedPermissionSets;
							}
	                    
	                    leftStore.loadData(console_permissionsetLeftStoreData);
                        
                        Ext.getCmp('profileSelector').bindStore(leftStore);
					    Ext.getCmp('profileSelector').setValue(console_permissionsetRightStoreData);
	                } else{
	                
		                	if(entitlementOptionSelected == PERMISSIONSET_PREFIX){     //changing profile-permission grid title
		                		var availableTitle =  document.getElementById('thePage:ReqDefForm:available');
			                   	availableTitle.innerText = availableTitle.textContent = AvailableProfile;
			                   	var selectedTitle =  document.getElementById('thePage:ReqDefForm:selected');
			                    selectedTitle.innerText = selectedTitle.textContent = SelectedProfile;
							}
	                	leftStore.loadData(console_profileLeftStoreData);
                        Ext.getCmp('profileSelector').bindStore(leftStore);
					    Ext.getCmp('profileSelector').setValue(console_profileRightStoreData);
	         		}
	         		
	         		/*---------Restrict checkbox-------------------*/
	         		restrictSRAccessTable.style.visibility =  'visible';
	         		restrictSRAccessCheckbox.checked = restrictCheckboxValue;
	         		secondRun = true;
	         	}else{
	         		/*-----------Account---------------*/
	         	 
                    document.getElementById('accountRadioSelect_SS').style.display = 'inline'; 
	                document.getElementById('accountRadioSelect_Con').style.display = 'none'; 
	                
	                ProfileOptionSelector_SelfService.value   = entitlementOptionSelected;
	                storeCurrentContents = entitlementOptionSelected;
	                if(allAccountInputOption && allAccountInputOption.toLowerCase() == 'true'){
                        accountRadioEveryOne_SS.checked = true;
                        accountRadioSelected_SS.checked = false;
                    }
	              	else{
                        accountRadioSelected_SS.checked = true;
                        accountRadioEveryOne_SS.checked = false;
                    }
                    accLeftStore.loadData(accLeftStoreData);
                  
                    Ext.getCmp('accountSelector').bindStore(accLeftStore);
					Ext.getCmp('accountSelector').setValue(accRightStoreData);
               		/*------------Profile/PermissionSet-------------*/
					ProfileOptionSelector_SelfService.style.display = 'inline'; 
	                ProfileOptionSelector_Console.style.display = 'none'; 
	                
                if (entitlementOptionSelected == PERMISSIONSET_PREFIX) {
                			if(console_entitlementOptionSelected == PROFILE_PREFIX || entitlementOptionSelected == ALL){ //changing profile-permission grid title
				                var availableTitle =  document.getElementById('thePage:ReqDefForm:available');
			                    availableTitle.innerText = availableTitle.textContent = AvailablePermissionSets;
			                    var selectedTitle =  document.getElementById('thePage:ReqDefForm:selected');
			                    selectedTitle.innerText = selectedTitle.textContent = SelectedPermissionSets;
			                }
                    leftStore.loadData(permissionsetLeftStoreData);
                    
                    Ext.getCmp('profileSelector').bindStore(leftStore);
                    Ext.getCmp('profileSelector').setValue(permissionsetRightStoreData);
                } else {
		                	if(console_entitlementOptionSelected == PERMISSIONSET_PREFIX){ //changing profile-permission grid title
				                var availableTitle =  document.getElementById('thePage:ReqDefForm:available');
			                   	availableTitle.innerText = availableTitle.textContent = AvailableProfile;
			                   	var selectedTitle =  document.getElementById('thePage:ReqDefForm:selected');
			                    selectedTitle.innerText = selectedTitle.textContent = SelectedProfile;
			                }
                	leftStore.loadData(profileLeftStoreData);
                 
                    Ext.getCmp('profileSelector').bindStore(leftStore);
                    Ext.getCmp('profileSelector').setValue(profileRightStoreData);
                	
         		}
         			/*---------Restrict checkbox-------------------*/
                	restrictSRAccessTable.style.visibility =  'hidden';
	         }
	         	callToggleAccountSelector();
				callEntitlementSelector();
	         	
        }
        var URlDown = "{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#down')}";
      
        //Data for request fulfillment
        //Process labels
         var labelProcessNameHeader = '{!JSENCODE($Label.FulfillmentProcessName)}',
             labelProcessDescHeader = '{!JSENCODE($ObjectType.SYSTemplate__c.fields.description__c.label)}',
             labelAdd='{!JSENCODE($Label.Add)}',
             labelCreate = '{!JSENCODE($Label.Create)}',
             labelProcessTab = '{!JSENCODE($Label.Template)}',
             labelProcessTemplatePopupTitle = '{!JSENCODE($ObjectType.SYSTemplate__c.LabelPlural)}';
             
         
         //Input labels
         var labelInputPromptHeader = '{!JSENCODE($Label.PromptQuestionHeader)}',
             labelResponseTypeHeader = '{!JSENCODE($ObjectType.SRM_FulfillmentInputs__c.fields.ResponseType__c.label)}', 
             labelRequiredHeader = '{!JSENCODE($ObjectType.SRM_FulfillmentInputs__c.fields.Required__c.label)}',
             labelHiddenHeader = '{!JSENCODE($ObjectType.SRM_FulfillmentInputs__c.fields.Hidden__c.label)}',
             labelColumnHeader = '{!JSENCODE($Label.Column)}',
             labelEdit = '{!JSENCODE($Label.CMDBEdit)}',
             labelInputDeleteConfirmMsg = '{!JSENCODE($Label.InputDeleteConfirmMessage)}',
             labelProcessDeleteConfirmMsg = '{!JSENCODE($Label.ProcessDeleteConfirmMessage)}',
             labelInputTab = '{!JSENCODE($Label.InputNameLabel)}';
             labelHideRDInputList = '{!JSENCODE($Label.Supporting_Hide)}'+' '+'{!JSENCODE($Label.the_Request_Input_List)}';
             labelShowRDInputList =  '{!JSENCODE($Label.Show)}'+' '+'{!JSENCODE($Label.the_Request_Input_List)}';
         
         //Mapping labels
         var labelRequestInputCaption = '{!JSENCODE($Label.RequestInputSource)}',
             labelProcessVariableCaption = '{!JSENCODE($Label.ProcessVariableTarget)}',
             labelRequestInputHeader = '{!JSENCODE($Label.RequestInputPromptQuestionHeader)}',
             labelProcessVariableHeader = '{!JSENCODE($Label.CIExpField)}',
             labelConcatenateSelection = '{!JSENCODE($Label.ConcatenateInputSelections)}',
             labelMappingTab = '{!JSENCODE($Label.MappingTabTitle)}';
        
        
        //Error message labels
        var labelNone='{!JSENCODE($Label.None)}',
            labelSelectInputError='{!JSENCODE($Label.PleaseSelectRequestInput)}',
            labelSelectProcessVarError='{!JSENCODE($Label.PleaseSelectProcessVariable)}';
        var labelNewBusinessService ='{!JSENCODE($Label.Create_New)}'+' '+'{!JSENCODE($Label.BusinessService)}';
        var labelNewServiceOffering ='{!JSENCODE($Label.Create_New)}'+' '+'{!JSENCODE($Label.ServiceOffering)}';
        
         var  reDefId = '{!reqDefBean.reqDefObj.id}';
         var LKfilterId = '{!reqDefBean.reqDefObj.FKLookupFilter__c}';
         var wid2 = '{!JSENCODE($CurrentPage.parameters.wid)}';
         var requestDefId = '{!JSENCODE($CurrentPage.parameters.Id)}';
         var processFilterClause_TS = escape('(templateFor__c=\'Task\')');
         var processFilterClause_CR = escape('(templateFor__c=\'Change Request\')');
         
         var isInputOrderChanged = false;
         var reqInputOrderCompId = '{!$Component.ReqDefForm.reqInputOrder}';
         var linkProcessTemplate="/apex/SearchPage?popupId=ProcessTemplate&view=list&pgheight=656";
         function getSDFStylesResPath(){
             var resPath = '{!$Resource.SDEFStyles}';
             return resPath;
         }
          
        /*
        Check user premissions           
        */
        var isProcessCreateable = '{!reqDefBean.isProcessCreateable}';
        var isProcessDeleteable = '{!reqDefBean.isProcessDeleteable}';
        var isInputCreateable = '{!reqDefBean.isInputCreateable}';
        var isInputUpdateable = '{!reqDefBean.isInputUpdateable}';
        var isInputDeleteable = '{!reqDefBean.isInputDeleteable}';
        var isMappingCreateable = '{!reqDefBean.isMappingCreateable}';
        var isMappingDeleteable = '{!reqDefBean.isMappingDeleteable}';
        var dispTypeTxt = '{!reqDefBean.dispTypeTxt}', dispTypeTxtArea='{!reqDefBean.dispTypeTxtArea}', dispTypeBoolean='{!reqDefBean.dispTypeBoolean}',
            dispTypeInt='{!reqDefBean.dispTypeInt}', dispTypeDouble='{!reqDefBean.dispTypeDouble}', dispTypeCurr='{!reqDefBean.dispTypeCurr}', 
            dispTypeDate='{!reqDefBean.dispTypeDate}',dispTypeDateTime='{!reqDefBean.dispTypeDateTime}', dispTypePicklist='{!reqDefBean.dispTypePicklist}', dispTypeMultiPicklist='{!reqDefBean.dispTypeMultiPicklist}',
            dispTypeReference='{!reqDefBean.dispTypeReference}', refTypeImpact='{!reqDefBean.refTypeImpact}', refTypeCategory='{!reqDefBean.refTypeCategory}', refTypeUrgency='{!reqDefBean.refTypeUrgency}';
 
        
        function setBusiOffering(){
            var fkBusinessOffering;
            if(!isFlattenedCmdb){
                fkBusinessOffering = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1}').value;
            }else{
                fkBusinessOffering = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id__x_1}').value;
            }
            if(fkBusinessOffering != null && fkBusinessOffering != ''){
                setServiceOffering(fkBusinessOffering);
            }
        }
        var setofferingClausePanelData = function()
        {
            isReqDefDeleted = {!isReqDefDeleted};
            errormsg = '{!JSENCODE(reqDefBean.messageString)}'; 
            OfferingClause = null;
            //var fkService = '{!JSENCODE(reqDefBean.reqDefObj.FKBusinessService__c)}';
            var fkService ='';
            var bsEle;
            if(!isFlattenedCmdb){
                bsEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c}');
                if(bsEle!=null){
                    fkService = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c}').value;
                } 
            }else{
                bsEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id}');
                if(bsEle!=null){
                    fkService = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id}').value;
                }
            } 
            
            var fkServiceField = '';
            var offeringEle;
             if(!isFlattenedCmdb){
                offeringEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_instance_name__c}');
             }else{
                offeringEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
             } 
            
            if(offeringEle!=null){
                    fkServiceField = offeringEle.value; 
            }
            
            if(!isFlattenedCmdb){
                if(fkService != null && fkService != '' && fkServiceField != null && fkServiceField != ''){
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
                }else{
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
                }
            }else{
                if(fkService != null && fkService != '' && fkServiceField != null && fkServiceField != ''){
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
                }else{
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
                }
                onServiceChange();
            }
        }
		function ServiceOfferingLink(popupfor)
		{
			var link = '';
			if(popupfor == 'serviceOffering')
			{
           
			var dateValue = '{!JSENCODE(reqDefBean.filterClauseDate)}';
			var dateClause = escape(' (end_date__c = null or end_date__c >=' + dateValue + ')AND MarkAsDeleted__c = false');
            var fkService ='';            
            var bsEle;
            var bsEleN;
            if(!isFlattenedCmdb)
            {
                
                bsEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c}');
                if(bsEle!=null)
                {
                    bsEleN =  document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_instance_name__c}').value;
                    if(bsEleN!=null && bsEleN!=undefined && bsEleN!="")
                    {
                     fkService = bsEle.value;
                    }
                }     
                if(fkService)     
                    link = 'SearchAndLink?txt=changelookupValues&parentName=SRM_RequestDefinition&childName=BMC_BusinessService__c&isLookUp=BMC_BusinessService__c&NewLookUpType=&filterId=offering_bsid&addlFilterId=flat_offering&searchLookUpStr=&isCustomLookup=false&isSRD=true&isServiceOffering=true&isFlattenedCmdb=false&param1='+fkService+'&filterClause'+dateClause;                
			    else
				    link =  'SearchAndLink?txt=changelookupValues&parentName=SRM_RequestDefinition&childName=BMC_BusinessService__c&isLookUp=BMC_BusinessService__c&NewLookUpType=&filterId=active_be&addlFilterId=flat_offering&searchLookUpStr=&isCustomLookup=false&isSRD=true&isServiceOffering=true&isFlattenedCmdb=false&filterClause'+dateClause;                ;                
            }           
            else
            {
                bsEle = document.getElementById('{!$Component.ReqDefForm.BMC_BaseElement__c_id_id}');
                if(bsEle!=null)
                {
                    bsEleN =  document.getElementById('{!$Component.ReqDefForm.BMC_BaseElement__c_id_name__c}').value;
                    if(bsEleN!=null && bsEleN!=undefined && bsEleN!="")
                    {
                     fkService = bsEle.value;
                    }
                } 
                onServiceChange();    
                if(fkService)          
				    link = 'SearchAndLink?txt=changelookupValues&parentName=SRM_RequestDefinition&childName=BMC_BusinessService__c&isLookUp=BMC_BusinessService__c&NewLookUpType=&filterId=flat_offering_bsid&addlFilterId=be_enddate&searchLookUpStr=&isCustomLookup=false&isSRD=true&isServiceOffering=true&param1='+fkService+'&filterClause'+dateClause;                
			    else
				    link =  'SearchAndLink?txt=changelookupValues&parentName=SRM_RequestDefinition&childName=BMC_BusinessService__c&isLookUp=BMC_BusinessService__c&NewLookUpType=&filterId=be_enddate&addlFilterId=flat_offering&searchLookUpStr=&isCustomLookup=false&isSRD=true&isServiceOffering=true&filterClause'+dateClause;
            }	
        }     
        link += '&modalType=rfModalVFPage+&lightningUI=true';
        return link;
}
        
     </script>
    <link rel="stylesheet" type="text/css"
        href="{!$Resource.SDEFStyles}/CustomViews.css" />
    <link rel="stylesheet" type="text/css"
        href="{!$Resource.SDEFStyles}/ReqDefPage.css" />
    
    <apex:outputPanel id="mappingDataPanel">
        <script>
            //Array store for process comboBox on Mappings tab
            var processOptionData = [{!ProcessOptions}];

            //Array store for request input grid
            var questionData = [{!RequestPrompts}];
        </script>
    </apex:outputPanel>
    <!-- Data for Request Fulfillment Tab and List Views-->
    <apex:outputPanel id="processTemplateStore">
        <script>
           /*
             Request Process/template data setup, populate data store for process grid         
           */
        
            var processData;            
            var disableReorderBTN;
            function setProcessData() {
                disableReorderBTN ='{!disableReorderBTN}';
                processData = [{!ProcessTemplates}];
                setProcessDataStore(processData);
            } 
        </script>
     </apex:outputPanel>
     <apex:outputPanel id="requestInputStore">
        <script>
            /*
                Request input data setup,  populate data store for request input grid         
            */
            var inputData;
            var isrichTextAreapresent;
            function setInputData() {
                inputData = [{!processInputs}];
                isrichTextAreapresent={!isrichTextAreapresent};
                setInputDataStore(inputData);
                setQuestionDataStore(questionData);
                selectClickedRow();
            }
        </script>
     </apex:outputPanel>
    
     <apex:outputPanel id="processVarStore">
        <script>
            var processVarData = [];
           
           
           function setProcessVarData() {
                processVarData = [{!reqDefBean.processVarData}]; 
                setProcessVarDataStore(processVarData);
            } 
        </script>
        
     </apex:outputPanel>

      <apex:outputPanel id="inputMappingStore">
        <script> 
            var PE_NEW = String.fromCharCode(182) + String.fromCharCode(2365) + String.fromCharCode(1240) + String.fromCharCode(1055);
            var mappingData = [];
            function setInputMappingData() {
                mappingData = '{!JSENCODE(inputMappings)}';
                if(mappingData!=''){
                    mappingData = JSON.parse(mappingData);
                }
                setInputMappingDataStore(mappingData);
            }
            
        </script>
        
     </apex:outputPanel>
     
     <apex:outputPanel id="offeringClausePanel">
        <script>
            isReqDefDeleted = {!isReqDefDeleted};
            errormsg = '{!JSENCODE(reqDefBean.messageString)}'; 
            var OfferingClause = null;
            var fkService = '{!JSENCODE(reqDefBean.reqDefObj.FKBusinessService__c)}';
            var fkServiceField ='';
            var fkServiceEle;
            
            if(!isFlattenedCmdb){
                fkServiceEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_instance_name__c}');
            }else{
                fkServiceEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
            } 
            if(fkServiceEle!=null){
                fkServiceField = fkServiceEle.value; 
            }
            
            if(!isFlattenedCmdb){
                if((fkService != null && fkService != '') || (fkServiceField != null && fkServiceField != '') ){
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
                }else{
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
                }
            }else{
                if((fkService != null && fkService != '') || (fkServiceField != null && fkServiceField != '') ){
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
                }else{
                    OfferingClause = escape('(serviceType__c = \'Offering\') And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
                }               
            }
            
            if(isFlattenedCmdb){
                var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}'); 
                if(tempEl!=null&&serviceName!=tempEl.value){ 
                   clearOffering(); 
                   serviceName=tempEl.value; 
                } 
             }
        </script>
        
     </apex:outputPanel>
     <apex:outputPanel id="watsonJsonPanel">
        <script>
            var jsonStr = '{!JSENCODE(watsonJsonStr)}';
            var requestDefinitionName = '{!JSENCODE(requestDefinitionName)}';
            var isChatbotConfigured = '{!isChatbotConfigured}';
        </script>
     </apex:outputPanel>
     
		<div id="errorMessageDiv" class="demo-only" style="height:4rem; display: none;">
			<div class="slds-notify_container slds-is-relative">
				<div class="slds-notify slds-notify_toast slds-theme_error" role="status">
					<span class="slds-assistive-text">error</span>
					<span class="slds-icon_container slds-icon-utility-error slds-m-right_small slds-no-flex slds-align-top" title="{!$Label.Error}">
						<svg class="slds-icon slds-icon_small" >
							<use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#error')}"></use>
						</svg>
					</span>
					<div class="slds-notify__content">
						<h2 class="slds-text-heading_small">{!$Label.MsgSaveError}</h2>
						<p id="errorsList"></p>
					</div>
					<div class="slds-notify__close">
						<button class="slds-button slds-button_icon slds-button_icon-inverse" title="{!$Label.Close}"  onclick="closeMsgDiv('errorMessageDiv')">
							<svg class="slds-button__icon slds-button__icon_large" >
								<use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
							</svg>
							<span class="slds-assistive-text">{!$Label.Close}</span>
						</button>
					</div>
				</div>
			</div>
        </div>

    <!-- .End of Data for Request Fulfillment Tab and List Views-->
    <apex:form id="ReqDefForm">
        <div id="capsule" class="CapsuleDiv1">
        <c:TabOutComponent ></c:TabOutComponent>
            <c:ValidationComponent errorMsgList="{!reqDefBean.messageString}" id="validationComponent"></c:ValidationComponent>
        <apex:actionFunction action="{!getSearchAccounts}"
            name="getSearchAccounts"
            rerender="accountEntitlementPanel" oncomplete="loadLeftData();hideLoadingMask();">
            <apex:param assignTo="{!searchString}" name="searchstring" value="" />
            <apex:param assignTo="{!accRightStoreData}" name="rightData" value="" />
        </apex:actionFunction>        
        <apex:actionFunction action="{!nextAccounts}" 
            name="nextAccounts"
            rerender="accountEntitlementPanel" oncomplete="loadLeftData();hideLoadingMask();">  
            <apex:param assignTo="{!accRightStoreData}" name="rightData" value="" />          
        </apex:actionFunction>
        <apex:actionFunction action="{!prevAccounts}"
            name="prevAccounts"
            rerender="accountEntitlementPanel" oncomplete="loadLeftData();hideLoadingMask();">            
            <apex:param assignTo="{!accRightStoreData}" name="rightData" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!setSelectedBusinessService}"
            name="setBusinessService"
            rerender="BMC_BusinessService__c_id_instance_name__c,BMC_BusinessService__c_id_fkbmc_baseelement__c,BMC_BaseElement__c_id_name__c,BMC_BaseElement__c_id_id,offeringClausePanel,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!setSelectedServiceOffering}"
            name="setServiceOffering"
            rerender="BMC_BusinessService__c_id_instance_name__c__x_1, BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c__x_1,BMC_BaseElement__c_id_id__x_1,CustomerPrice__c, DeliveryCost__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c, CostOption1__c, CostOption2__c, PriceOption1__c, PriceOption2__c, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!setSelectedDoc}" name="setReqDefDoc"
            rerender="Image_Id">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>

        <apex:actionFunction name="save" action="{!save}"
            reRender="afterSavePanel,titlePanel,validationComponent,apexMessageErrorPanel, processTemplateStore, ReqDef_DirectLink, requestInputStore, inputMappingStore, mappingDataPanel, customerPriceCurrency,deliveryCostCurrency,ReqDef_Description_RichText, entitlementDataPanel, ReqDef_UserInstructions_RichText"
            onComplete="enablebtn(false);assignApexErrorMessage();showError();setProcessData();updateProcessOptions();setInputData();setInputMappingData();setBtnState();updateTitle();handleSave();  ">
            <apex:param assignTo="{!reqDefBean.fkLookupId}" name="LKfilterId" value="" />   
            <apex:param assignTo="{!updatedMappingList}" name="updatedMappingList" value="" /> 
        </apex:actionFunction>
		<apex:actionFunction name="saveandnext" action="{!save}" reRender="afterSavePanel,titlePanel,validationComponent,apexMessageErrorPanel, processTemplateStore, ReqDef_DirectLink, requestInputStore, inputMappingStore, mappingDataPanel, customerPriceCurrency,deliveryCostCurrency,ReqDef_Description_RichText, entitlementDataPanel, ReqDef_UserInstructions_RichText"
            onComplete="enablebtn(true);assignApexErrorMessage();showError();setProcessData();updateProcessOptions();setInputData();setBtnState();updateTitle();handleSave();  ">
            <apex:param assignTo="{!reqDefBean.fkLookupId}" name="LKfilterId" value="" />
            <apex:param assignTo="{!updatedMappingList}" name="updatedMappingList" value="" /> 
        </apex:actionFunction>
         <apex:actionFunction name="changeConfiguration" action="{!loadConsoleEntitledData}"
            rerender="entitlementDataPanel"
            onComplete="resetEntitlementData();">
         </apex:actionFunction>
        
        
        
        <apex:actionFunction name="deleteReqDefObj" action="{!deleteReqDef}" rerender="offeringClausePanel" oncomplete="closeWindow();"/>
        <apex:actionFunction name="getWatsonJson" action="{!getWatsonJson}" reRender="watsonJsonPanel" oncomplete="downloadWatsonTemplate();"/>
        <apex:actionFunction name="resetReqDefObj" action="{!reset}" rerender="SYSTemplate__c_id__inc_name,SYSTemplate__c_id__inc_id,targetInDays, targetInHours, ReqDef_Title, ReqDef_Description, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c, BMC_BusinessService__c_id_instance_name__c__x_1, 
                    BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id, BMC_BaseElement__c_id_name__c__x_1, 
                    BMC_BaseElement__c_id_id__x_1, Category__c_id_name, Category__c_id_id, Category__c_id_fkurgency__c, CustomerPrice__c, PriceOption1__c, PriceOption2__c, DeliveryCost__c, 
                    CostOption1__c, CostOption2__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c,RequestDefinition__c_id_SRDUrl__c, 
                    Image_Id, RequestDefinition_Status, RequestDefinition_Online, restrictSRAccess, ReqDef_DirectLink,  OptionsTab, entitlementDataPanel, accountRadioSelect_SS, accountRadioSelect_Con, profileOptionSelect_Con, selectedConsoleProfiles, allProfile,isApprovalReqd,isMobile,
                    processTemplateStore, requestInputStore, processVarStore, inputMappingStore,mappingDataPanel, SRM_RequestDefinition_userInstructions__c, afterSavePanel, titlePanel,SYSTemplate__c_id_name, SYSTemplate__c_id_id,customerPriceCurrency,deliveryCostCurrency" 
                    oncomplete="setTurnaroundTime();resetEntitlementData();callToggleAccountSelector();callEntitlementSelector();setProcessData();setInputData();setProcessVarData();setInputMappingData();resetProcessOption();setInactiveAndAttachmentChkBox();setRequestDefIconImageDisplay('{!reqDefBean.reqDefObj.BMCServiceDesk__Image__c}');">
        </apex:actionFunction>
        
        <apex:actionRegion >
        <apex:actionFunction name="previousReqDef" action="{!previous}" rerender="ReqDef_Description_RichText,ReqDef_UserInstructions_RichText,NextPreviousButtonPanel, entitlementConfigOption ,targetInDays, targetInHours, ReqDef_Title, ReqDef_Description, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c, BMC_BusinessService__c_id_instance_name__c__x_1, 
                    BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id, BMC_BaseElement__c_id_name__c__x_1, 
                    BMC_BaseElement__c_id_id__x_1, Category__c_id_name, Category__c_id_id, Category__c_id_fkurgency__c, CustomerPrice__c, PriceOption1__c, PriceOption2__c, DeliveryCost__c, 
                    CostOption1__c, CostOption2__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c,SYSTemplate__c_id__inc_name,RequestDefinition__c_id_SRDUrl__c,isMobile,  
                    Image_Id, RequestDefinition_Status, RequestDefinition_Online, ReqDef_DirectLink, OptionsTab, entitlementDataPanel, accountRadioSelect_SS, accountRadioSelect_Con, profileOptionSelect_Con, selectedConsoleProfiles, allProfile,isApprovalReqd,
                    restrictSRAccess, processTemplateStore, requestInputStore, processVarStore, inputMappingStore,mappingDataPanel, SRM_RequestDefinition_userInstructions__c, afterSavePanel, titlePanel,SYSTemplate__c_id_name, SYSTemplate__c_id_id,customerPriceCurrency,deliveryCostCurrency" 
                    oncomplete="setTurnaroundTime();resetEntitlementData();callToggleAccountSelector();callEntitlementSelector();setProcessData();setInputData();setProcessVarData();setInputMappingData();resetProcessOption();window.parent.changeTitle(getWID(),newTitle,newTitle);handleSave();addInputBtnHandler();setInactiveAndAttachmentChkBox();setActivateDeactivateButton();closeMsgDiv('errorMessageDiv');">
            <apex:param assignTo="{!reqDefBean.tempString}" name="idSetString" value=""/> 
        </apex:actionFunction>
        
        <apex:actionFunction name="nextReqDef" action="{!next}" rerender="ReqDef_Description_RichText,ReqDef_UserInstructions_RichText,NextPreviousButtonPanel, entitlementConfigOption, targetInDays, targetInHours, ReqDef_Title, ReqDef_Description, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c, BMC_BusinessService__c_id_instance_name__c__x_1, 
                    BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id, BMC_BaseElement__c_id_name__c__x_1, 
                    BMC_BaseElement__c_id_id__x_1, Category__c_id_name, Category__c_id_id, Category__c_id_fkurgency__c, CustomerPrice__c, PriceOption1__c, PriceOption2__c, DeliveryCost__c, 
                    CostOption1__c, CostOption2__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c,SYSTemplate__c_id__inc_name,RequestDefinition__c_id_SRDUrl__c,isMobile,  
                    Image_Id, RequestDefinition_Status, RequestDefinition_Online, ReqDef_DirectLink, OptionsTab, entitlementDataPanel, accountRadioSelect_SS, allProfile,isApprovalReqd,
                    restrictSRAccess, processTemplateStore, requestInputStore, processVarStore, inputMappingStore,mappingDataPanel, SRM_RequestDefinition_userInstructions__c, accountRadioSelect_Con, profileOptionSelect_Con, selectedConsoleProfiles, afterSavePanel, titlePanel,SYSTemplate__c_id_name, SYSTemplate__c_id_id,customerPriceCurrency,deliveryCostCurrency" 
                    oncomplete="setTurnaroundTime();resetEntitlementData();callToggleAccountSelector();callEntitlementSelector();setProcessData();setInputData();setProcessVarData();setInputMappingData();resetProcessOption();window.parent.changeTitle(getWID(),newTitle,newTitle);handleSave();addInputBtnHandler();setInactiveAndAttachmentChkBox();setActivateDeactivateButton();closeMsgDiv('errorMessageDiv');">
            <apex:param assignTo="{!reqDefBean.tempString}" name="idSetString" value=""/> 
        </apex:actionFunction>
        </apex:actionRegion>
        <apex:actionFunction action="{!setServiceRequestTemplate}"
            name="setServiceRequestTemplate"
            rerender="SYSTemplate__c_id_name, SYSTemplate__c_id_id,SYSTemplate__c_id__inc_id,SYSTemplate__c_id__inc_name,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
         <apex:actionFunction action="{!setIncidentTemplate}"
            name="setIncidentTemplate"
            rerender="SYSTemplate__c_id__inc_id,SYSTemplate__c_id__inc_name,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();var INCValue = getIncValue();onCompleteSetIncident(INCValue);"> 
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
        <apex:inputHidden id="targetInDays" value="{!reqDefBean.targetInDays}" />
        <apex:inputHidden id="targetInHours" value="{!reqDefBean.targetInHours}" />
        <!-- <apex:inputHidden id="cPriceInUSD" value="{!reqDefBean.cPriceInUSD}" />
        <apex:inputHidden id="dPriceInUSD" value="{!reqDefBean.dPriceInUSD}" />  -->

        <div id="rfDPLReferenceDiv" class="clsCapsule rf-console-main mainDiv">
            <table cellpadding="0" cellspacing="0" class="clsMainTable">

                <!-- Button toolbar row -->
                <tr class="clsRowGreyBg">
                    <td colspan="2">
                            <div id="btnToolbar1">
                                <div class="slds-page-header__row slds-p-horizontal_x-large slds-p-vertical_small">
                                    <div class="slds-page-header__col-title">
                                        <div class="slds-media">
                                            <div class="slds-media__body">
                                                <div class="slds-page-header__name">
                                                    <div class="slds-page-header__name-title">
                                                        <h1>
                                                            <apex:outputPanel id="titlePanel">
                                                                <span class="slds-page-header__title slds-m-top_x-small slds-align-middle slds-truncate slds-hide" 
                                                                    title="{!$Label.New}" id="newSRDName">
                                                                    {!$Label.New} {!$ObjectType.SRM_RequestDefinition__c.label}
                                                                </span>
                                                                <span class="slds-page-header__title slds-m-top_x-small slds-align-middle slds-truncate slds-show" 
                                                                title="{!reqDefBean.reqDefObj.ServiceRequestTitle__c}" id="existingSRDName">
                                                                     {!reqDefBean.reqDefObj.ServiceRequestTitle__c}
                                                                </span>
                                                            </apex:outputPanel>
                                                        </h1>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
									<div class="slds-p-horizontal_small">
										<button  title="{!$Label.TooltipHelp}" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" onclick="showHelp()">
											<lightning-primitive-icon lightning-primitiveicon_primitiveicon-host="">
												<svg lightning-primitiveIcon_primitiveIcon="" focusable="false"  aria-hidden="true" class="slds-button__icon">
													<use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#question')}"></use>
												</svg>
											</lightning-primitive-icon>
										</button>
									</div>
									<div class="separator" style="height: 30px;"></div>
									<div class="slds-col  slds-size_0-of-5 slds-p-horizontal_small">
										<button  id="prevBtnId" title="{!$Label.PreviousRecord}"  type="button" class="prevNextButton slds-button slds-button_icon slds-button_icon-border-filled" style="border: none;background:none;" onclick="PreviousBtnHandler()">
											<lightning-primitive-icon lightning-primitiveicon_primitiveicon-host="">
												<svg lightning-primitiveIcon_primitiveIcon="" focusable="false"  aria-hidden="true" class="slds-button__icon">
													<use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#left')}"></use>
												</svg>
											</lightning-primitive-icon>
										</button>
										<button id="nextBtnId" title="{!$Label.NextRecord}" type="button" class="prevNextButton slds-button slds-button_icon slds-button_icon-border-filled" style="border: none;background:none;" onclick="NextBtnHandler()">
											<lightning-primitive-icon lightning-primitiveicon_primitiveicon-host="">
												<svg lightning-primitiveIcon_primitiveIcon="" focusable="false"  aria-hidden="true" class="slds-button__icon">  
													<use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#right')}"></use>
												</svg>
											</lightning-primitive-icon>
										</button>
									</div>
									<div class="separator" style="height: 30px;"></div>
                                    <div class="slds-page-header__col-actions" style="padding-left: .6em;">
                                        <div class="slds-page-header__controls">
                                            <div class="slds-page-header__control">
                                                <div class="slds-button-group" style="cursor:pointer" role="group">
                                                   
                                                    <span class="slds-button slds-button_neutral" title="{!$Label.New}" id="newBtnId" onclick="NewBtnHandler();">
                                                        {!$Label.New}
                                                    </span>
                                                    <span class="slds-button slds-button_neutral" title="{!$Label.Close}" id="closeBtnId" onclick="showWarningOnClose();">
                                                        {!$Label.Close}
                                                    </span>
                                                   
                                                    <span class="slds-button slds-button_neutral" title="{!$Label.Save}" id="saveBtnId" onclick="SaveBtnHandler();">
                                                        {!$Label.Save}
                                                    </span>
                                                    <div class="rf-toolbar-menubtn slds-dropdown-trigger slds-dropdown-trigger_click slds-button_last" id="toolbarMenu"
                                                    onclick="toggleToolbarMenu('toggle',this);">
                                                        <button type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" aria-haspopup="true" title="{!$Label.moreAction}">
                                                            <svg class="slds-button__icon" aria-hidden="true">
                                                                <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#down')}"></use>
                                                            </svg>
                                                            <span class="slds-assistive-text">{!$Label.moreAction}</span>
                                                        </button>
                                                         <div class="rf-toolbar-menu slds-dropdown slds-dropdown_right slds-dropdown_actions">
                                                            <ul class="slds-dropdown__list" role="menu" >
                                                                <li class="slds-dropdown__item" role="presentation" onclick="CopyBtnHandler()">
                                                                    <a id="copyBtnId" href="javascript:void(0);" role="menuitem" tabindex="0">
                                                                        <span class="slds-truncate" title="{!$Label.Copy}">{!$Label.Copy}</span>
                                                                    </a>
                                                                </li>
                                                                <li class="slds-dropdown__item" role="presentation" onclick="DeleteBtnHandler()">
                                                                    <a id="deleteBtnId" href="javascript:void(0);" role="menuitem" tabindex="1">
                                                                        <span class="slds-truncate" title="{!$Label.Delete}">{!$Label.Delete}</span>
                                                                    </a>
                                                                </li>
                                                                <li class="slds-dropdown__item" role="presentation" onclick="ResetBtnHandler()">
                                                                    <a id="resetBtnId" href="javascript:void(0);" role="menuitem" tabindex="2">
                                                                        <span class="slds-truncate" title="{!$Label.Refresh}">{!$Label.Refresh}</span>
                                                                    </a>
                                                                </li>
                                                                <li id="downloadJsonBtn" class="slds-dropdown__item" role="presentation">
                                                                    <a href="javascript:void(0);" role="menuitem" tabindex="3" onclick="downloadBtnHandler()">
                                                                        <span class="slds-truncate" title="{!$label.DownloadChatBotJson}">{!$label.DownloadChatBotJson}</span>
                                                                    </a>
                                                                </li>
																<li  class="slds-dropdown__item" role="presentation" onclick="showLoadingMask();toggleReqDefObjActivation()">
                                                                    <a id="activateBtn" href="javascript:void(0);" role="menuitem" tabindex="4">
                                                                        <span class="slds-truncate">{!$label.Deactivate}</span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>                               
                                </div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                       <table cellpadding="0" cellspacing="0">
                            <tr id="TabButtons">
                                <td class="bottomGrayLine" colspan="3">
                                    <ul class="slds-tabs_default__nav slds-p-left_large">
                                        <li class="slds-tabs_default__item slds-is-active">
                                            <a id="ReqDef_GeneralInfo" title="{!$Label.bmcservicedesk__slm_general_information}" value="{!$Label.bmcservicedesk__slm_general_information}" class="clasActiveTab slds-tabs_default__link slds-is-active anchorCls"
                                                onclick="displayActiveTab(this,0);">
                                                {!$Label.bmcservicedesk__slm_general_information}
                                            </a>
                                        </li>
                                        <li class="slds-tabs_default__item">
                                            <a id="ReqDef_Input" class="slds-tabs_default__link anchorCls" title="{!$Label.InputNameLabel}" value="{!$Label.InputNameLabel}"
                                                onclick="displayActiveTab(this,0);">
                                                {!$Label.InputNameLabel}
                                            </a>
                                        </li>
                                        <li class="slds-tabs_default__item">
                                            <a id="ReqDef_Fulfillment" class="slds-tabs_default__link anchorCls" title="{!$Label.Fulfillment}" value="{!$Label.Fulfillment}"
                                                onclick="displayActiveTab(this,0);">
                                                {!$Label.Fulfillment}
                                            </a>
                                        </li>
                                        <li class="slds-tabs_default__item">
                                            <a id="ReqDef_Options" title="{!$Label.DisplayOptions}" value="{!$Label.DisplayOptions}" class="slds-tabs_default__link anchorCls"
                                                onclick="displayActiveTab(this,0);">
                                                {!$Label.DisplayOptions}
                                            </a>
                                        </li>
                                        <li class="slds-tabs_default__item">
                                            <a id="ReqDef_Entitlement" title="{!$Label.Entitlement}" value="{!$Label.Entitlement}" class="slds-tabs_default__link anchorCls"
                                                onclick="displayActiveTab(this,0);">
                                                {!$Label.Entitlement}
                                            </a>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr id="Progressbar">
                                <td colspan="3">
                                    <div class="rf_form_medium slds-p-vertical_xx-small">
                                        <div class="inlineFlex bottomGrayLine" style="padding-top:3px;">
                                            <div class="slds-form-element__control">
                                        <div class="slds-progress-ring slds-progress-ring_large">
                                            <div class="slds-progress-ring__progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                                                <svg viewBox="-1 -1 2 2">
                                                    <path class="slds-progress-ring__path" id="rf-progressring" d="M 1 0 A 1 1 0 0 0 0 0 L 0 0"></path>
                                                </svg>
                                            </div>
                                            <div class="slds-progress-ring__content" id="progressRingContent">1</div>
                                        </div>
                                    </div>
                                        </div> 
                                        <div class="inlineFlex bottomGrayLine clsVAlignTop">
                                            <div id="currentStep" class="headerCls slds-p-top_x-small slds-p-left_x-small slds-setup-assistant__step-summary-title slds-text-heading_x-small">
                                        <apex:outputLabel value="{!$Label.bmcservicedesk__slm_general_information}" />
                                    </div>
                                        </div>
                                        <div class="inlineFlex" style="float:right;">
                                            <div id="mainSteps" class="slds-button-group-row slds-p-vertical_xxx-small">
                                                <div class="slds-m-horizontal_xxx-small slds-p-right_medium">
                                                    <button type="button" class="slds-button slds-p-horizontal_x-small rf-btn-outline prevbtn slds-hidden" title="{!$Label.PreviousStep}" 
                                                    id="previousStep" onclick="goToSRDStep(-1);">
                                                        <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#back')}"></use>
                                                        </svg>
                                                        <span id="previousStepBtn">{!$Label.PreviousStep}</span>
                                                    </button>
                                        </div>
                                        <div class="slds-m-horizontal_xxx-small">                                                       
                                                    <button type="button" class="slds-button slds-p-horizontal_x-small rf-btn-outline nextbtn slds-hidden" title="{!$Label.NextStep}" 
                                                    id="nextStep" onclick="goToSRDStep(1);">
                                                        <span id="nextStepBtn">{!$Label.NextStep}</span>
                                                        <svg id="nextStepSvg" class="slds-button__icon slds-button__icon_right" aria-hidden="true">
                                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#forward')}"></use>
                                                        </svg>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                        <div id='ReqDef_GeneralInfoTab' class="clsGeneralInfoTab slds-p-horizontal_xx-large slds-p-vertical_small">
                            <div class="slds-form clsInlineTable rf_form_medium" style="margin-left:25px;">
                                <ul class="slds-accordion">
                                    <li class="slds-accordion__list-item">
                                        <section id="section-accordion-01" class="slds-accordion__section slds-p-horizontal_none slds-is-open">
                                            <div class="slds-accordion__summary">
                                                <h3 class="slds-accordion__summary-heading">
                                                    <button type="button" aria-controls="accordion-01" aria-expanded="true" 
                                                    class="slds-button slds-button_reset slds-accordion__summary-action" onclick="toggleSection('01');">
                                                        <svg class="slds-accordion__summary-action-icon slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                                        </svg>
                                                        <span class="slds-accordion__summary-content headerCls" title="{!$Label.SRDRequestDetails}">
                                                            {!$Label.SRDRequestDetails}
                                                        </span>
                                                    </button>
                                                </h3>
                                            </div>
                                            <div class="slds-accordion__content slds-p-horizontal_xx-small" id="accordion-01">

                                        <table cellpadding="0" cellspacing="0" class="slds-form clsInlineTable">
                                <tr>
                                    <td class="clsInputTextBoxTD">
                                        <div class="slds-form__row">
                                            <!--Title-->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label" for="ReqDef_Title">
                                                            <abbr class="slds-required" title="{!$Label.Required}">* </abbr>
                                                            <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__serviceRequestTitle__c.label}" />
                                                        </label>
                                                        <div class="slds-form-element__control">
                                                            <apex:inputText value="{!reqDefBean.reqDefObj.BMCServiceDesk__serviceRequestTitle__c}" id="ReqDef_Title" StyleClass="slds-input" html-autoComplete="off"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="rf-form-hspacer">
                                    </td>
                                    <td class="clsInputTextBoxTD">
                                        <div class="slds-form__row">
                                            <!--Category-->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="Category__c_id_name">
                                                        <abbr class="slds-required" title="{!$Label.Required}">* </abbr>
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKCategory__c.label}" />
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <div class="slds-combobox_container">
                                                            <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" aria-expanded="false" aria-haspopup="listbox"
                                                                role="combobox" id="triggerDiv_category">
                                                                <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                    <apex:inputText id="Category__c_id_name"
                                                                        value="{!reqDefBean.categoryName}" styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                        onBlur="rfToggleTypebox('category',false,this);showalldata(event,null,escape('inactive__c = false and AvailableForServiceCatalog__c=true'));"
                                                                        html-placeholder="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKCategory__c.label}" 
                                                                        html-aria-controls="rf-typebox-id_category" html-autoComplete="off" html-rf-fieldapiname="category"
                                                                        onfocus="rfToggleTypebox('category',true,this)"/>
                                                                    <apex:inputhidden id="Category__c_id_id" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKCategory__c}" />
                                                                    <apex:inputhidden id="Category__c_id_fkurgency__c" />
                                                                    <span id="RequestDefinitionLookup" class="rf-icon slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right" 
                                                                        onclick="openSRDLookup('Category');">
                                                                        <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                        </svg>
                                                                    </span>
                                                                </div>
                                                                    <!--typeahead -->
																<div id="rf-typebox-id_category" class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox">
																	<ul class="slds-listbox slds-listbox_vertical" role="presentation">
																		<li role="presentation" class="slds-listbox__item" onclick="openSRDLookup('Category');">
																			<div aria-selected="true" id="rf-typebox-search_category" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
																				role="option">
																				<span class="slds-media__figure slds-listbox__option-icon">
																					<span class="slds-icon_container slds-icon-utility-search" title="{!$label.Search} ">
																						<svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
																						</svg>
																						<span class="slds-assistive-text">{!$label.Search} </span>
																					</span>
																				</span>
																				<span class="slds-media__body">
                                                                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-search_category">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdsearchoption}">
                                                                                            <apex:param value="" />
                                                                                            <apex:param value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKCategory__c.label}" />
                                                                                        </apex:outputText>
																					</span>
																				</span>
																			</div>
                                                                            </li>
                                                                            <li role="presentation" class="slds-listbox__item" id="AddNew-category" onclick="openCreateNewPopup('Category');">
                                                                                <div id="rf-typebox-add_category" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                    role="option">
                                                                                    <span class="slds-media__figure slds-listbox__option-icon">
                                                                                        <span class="slds-icon_container slds-icon-utility-add">
                                                                                            <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                                                            </svg>
                                                                                        </span>
                                                                                    </span>
                                                                                    <span class="slds-media__body">
                                                                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-addnewoption_category">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdnewrecordoption}">
                                                                                            <apex:param value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKCategory__c.label}"/>
                                                                                        </apex:outputText>
                                                                                        </span>
                                                                                    </span>
																				</div>
                                                                            </li>
                                                                        </ul>
																</div>
															</div>
														</div>
													</div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="slds-form__row">
                                            <!--Description-->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label" for="ReqDef_Description">
                                                            <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Description__c.label}" />
                                                        </label>
                                                        <div class="slds-form-element__control">
                                                            <apex:inputTextArea value="{!reqDefBean.reqDefObj.BMCServiceDesk__Description__c}" disabled="false" id="ReqDef_Description" StyleClass="slds-input clsInputTextAreaTD1"
                                                                rows="1" tabindex="2" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="rf-form-hspacer" style="vertical-align:top;">
                                        <div class="slds-form-element textEditorIcon">
                                            <label class="slds-form-element__label">&nbsp; </label>
                                            <div class="slds-form-element__control">
                                                <span id="RequestDefinitionDesc" class="rf-icon slds-icon_container slds-icon-utility-description slds-p-around_xx-small" onclick="showTextEditorRD('{!$Component.ReqDefForm.ReqDef_Description}', '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.Description__c.label)}',32000,labelOK , labelCancel);">
                                                    <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                    <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#description')}"></use>
                                                    </svg>
                                                </span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="clsVAlignTop">
                                        <div class="slds-form__row">
                                            <!--RTF Description-->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label" for="ReqDef_Description_RichText">&nbsp; </label>
                                                        <div class="slds-form-element__control">
                                                            <apex:inputHidden id="ReqDef_Description_RichText" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Description_Rich_Text__c}" />
                                                            <button type="button" class="slds-button slds-button_neutral slds-m-horizontal_none" style="cursor:pointer;" 
                                                            title="{!$ObjectType.SRM_RequestDefinition__c.fields.Description_Rich_Text__c.label}"
                                                                onclick="openRTFPopupWindow(inProgress,false);"
                                                            >
                                                                <svg id="rtfIcon" class="slds-icon slds-icon_x-small slds-icon-text-default slds-m-right_x-small" aria-hidden="true">
                                                                                <use 
                                                                    xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#display_rich_text')}"></use>
                                                                </svg>
                                                            {!$ObjectType.SRM_RequestDefinition__c.fields.Description_Rich_Text__c.label}
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>    
                                <tr>
                                    <td>
                                        <div class="slds-form__row">
                                            <!--Service-->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="BMC_BaseElement__c_id_name__c">
                                                        <abbr class="slds-required" title="{!$Label.Required}">* </abbr>
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}"/>
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <div class="slds-combobox_container">
                                                            <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" aria-expanded="false" aria-haspopup="listbox"
                                                                role="combobox" id="triggerDiv_service">
                                                                <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                <apex:outputpanel rendered="{!NOT(isFlattenedCmdb)}" layout="none">
                                                                    <apex:inputText id="BMC_BusinessService__c_id_instance_name__c" value="{!reqDefBean.businessServiceName}"
                                                                            styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                            onblur="rfToggleTypebox('service',false,this);showalldata(event,setofferingClausePanelData,dateClause);"
                                                                            html-aria-controls="rf-typebox-id_service" html-autoComplete="off"
                                                                            html-placeholder="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}"
                                                                            onfocus="rfToggleTypebox('service',true,this);" html-rf-fieldapiname="service"
                                                                         />
                                                                    <apex:inputHidden id="BMC_BusinessService__c_id_fkbmc_baseelement__c" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKBusinessService__c}"
                                                                    />
                                                                </apex:outputpanel>
                                                                <apex:outputpanel rendered="{!isFlattenedCmdb}" layout="none">
                                                                    <apex:inputText id="BMC_BaseElement__c_id_name__c" value="{!reqDefBean.businessServiceName}"
                                                                            styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                            onblur="rfToggleTypebox('service',false,this);showalldata(event,setofferingClausePanelData,dateClause);if(this.value=='')clearOffering();"
                                                                            html-aria-controls="rf-typebox-id_service" html-autoComplete="off"
                                                                            html-placeholder="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}"
                                                                            onfocus="rfToggleTypebox('service',true,this);" html-rf-fieldapiname="service"
                                                                            />
                                                                    <apex:inputHidden id="BMC_BaseElement__c_id_id" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKBusinessService__c}" />
                                                                </apex:outputpanel>
                                                                    <span id="businessserviceLookup" class="rf-icon slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right"
                                                                        onclick="openSRDLookup('Service');">
                                                                        <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                        </svg>
                                                                    </span>
                                                                </div>

                                                            <!--typeahead -->
                                                                <div id="rf-typebox-id_service" class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox">
                                                                <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                    <li role="presentation" class="slds-listbox__item" onclick="openSRDLookup('Service');">
                                                                        <div aria-selected="true" id="rf-typebox-search_service" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                            role="option">
                                                                            <span class="slds-media__figure slds-listbox__option-icon">
                                                                                <span class="slds-icon_container slds-icon-utility-search" title="{!$label.Search} ">
                                                                                    <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                    <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                                    </svg>
                                                                                    <span class="slds-assistive-text">{!$label.Search} </span>
                                                                                </span>
                                                                            </span>
                                                                            <span class="slds-media__body">
                                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-search_service">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdsearchoption}">
                                                                                            <apex:param value="" />
                                                                                            <apex:param value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}" />
                                                                                        </apex:outputText>
                                                                                </span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                    <li role="presentation" class="slds-listbox__item" id="AddNew-service" onclick="setServiceName();createnewserviceoffering('BusinessService',setBusinessService);">
                                                                        <div id="rf-typebox-add_service" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                            role="option">
                                                                            <span class="slds-media__figure slds-listbox__option-icon">
                                                                                <span class="slds-icon_container slds-icon-utility-add">
                                                                                    <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                    <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                                                    </svg>
                                                                                </span>
                                                                            </span>
                                                                            <span class="slds-media__body">
                                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-addnewoption_service">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdnewrecordoption}">
                                                                                            <apex:param value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}" />
                                                                                        </apex:outputText>
                                                                                </span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="rf-form-hspacer">
                                    </td>
                                    <td class="clsInputLabelTD">
                                        <div class="slds-form__row">
                                            <!--Offering-->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="BMC_BaseElement__c_id_name__c__x_1">
                                                        <abbr class="slds-required" title="{!$Label.Required}">* </abbr>
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}"/>
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <div class="slds-combobox_container">
                                                            <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" aria-expanded="false" aria-haspopup="listbox"
                                                                role="combobox" id="triggerDiv_offering">
                                                                <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                    <apex:outputpanel rendered="{!NOT(isFlattenedCmdb)}" layout="none">
                                                                        <apex:inputText id="BMC_BusinessService__c_id_instance_name__c__x_1"
                                                                            value="{!reqDefBean.ServiceOfferingName}" styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                            onblur="rfToggleTypebox('offering',false,this);showalldata(event,setBusiOffering,OfferingClause);"
                                                                            html-aria-controls="rf-typebox-id_offering" html-autoComplete="off"
                                                                            html-placeholder="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}"
                                                                            onfocus="rfToggleTypebox('offering',true,this);" html-rf-fieldapiname="offering"
                                                                            />
                                                                        <apex:inputHidden id="BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKServiceOffering__c}"
                                                                        />
                                                                    </apex:outputpanel>
                                                                    <apex:outputpanel rendered="{!isFlattenedCmdb}" layout="none">
                                                                        <apex:inputText id="BMC_BaseElement__c_id_name__c__x_1" value="{!reqDefBean.ServiceOfferingName}"
                                                                            styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                            onblur="rfToggleTypebox('offering',false,this);showalldata(event,setBusiOffering,OfferingClause);"
                                                                            html-aria-controls="rf-typebox-id_offering" html-autoComplete="off"
                                                                            html-placeholder="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}"
                                                                            onfocus="rfToggleTypebox('offering',true,this);" html-rf-fieldapiname="offering"
                                                                        />
                                                                        <apex:inputHidden id="BMC_BaseElement__c_id_id__x_1" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKServiceOffering__c}" />
                                                                    </apex:outputpanel>
                                                                    <span id="businessserviceOfferingLookup" class="rf-icon slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right"
                                                                        onclick="openSRDLookup('Offering');">
                                                                        <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                        </svg>
                                                                    </span>
                                                                </div>
                                                                <!--typeahead -->
                                                                <div id="rf-typebox-id_offering" class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox">
                                                                    <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                        <li role="presentation" class="slds-listbox__item" onclick="openSRDLookup('Offering');">
                                                                            <div aria-selected="true" id="rf-typebox-search_offering" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                role="option">
                                                                                <span class="slds-media__figure slds-listbox__option-icon">
                                                                                    <span class="slds-icon_container slds-icon-utility-search" title="{!$label.Search} ">
                                                                                        <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                                        </svg>
                                                                                        <span class="slds-assistive-text">{!$label.Search} </span>
                                                                                    </span>
                                                                                </span>
                                                                                <span class="slds-media__body">
                                                                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-search_offering">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdsearchoption}">
                                                                                            <apex:param value="" />
                                                                                            <apex:param value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}" />
                                                                                        </apex:outputText>
                                                                                    </span>
                                                                                </span>
                                                                            </div>
                                                                        </li>
                                                                        <li role="presentation" class="slds-listbox__item" id="AddNew-offering" onclick="setSubServiceId();createnewserviceoffering('ServiceOffering',setServiceOffering);">
                                                                            <div id="rf-typebox-add_service" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                role="option">
                                                                                <span class="slds-media__figure slds-listbox__option-icon">
                                                                                    <span class="slds-icon_container slds-icon-utility-add">
                                                                                        <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                                                        </svg>
                                                                                    </span>
                                                                                </span>
                                                                                <span class="slds-media__body">
                                                                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-addnewoption_offering">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdnewrecordoption}">
                                                                                            <apex:param value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}" />
                                                                                        </apex:outputText>
                                                                                    </span>
                                                                                </span>
                                                                            </div>
                                                                        </li>
                                                                    </ul>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                                <tr>
                                                <td class="clsInputLabelTD rf_form_col">
                                        <div class="slds-form__row">
                                            <!--Service Request Template -->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="SYSTemplate__c_id_name">
                                                        <abbr class="slds-required" title="{!$Label.Required}">* </abbr>
                                                        <apex:outputLabel value="{!$Label.bmcservicedesk__servicerequesttemplatelookuplabel}" />
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <div class="slds-combobox_container">
                                                            <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" aria-expanded="false" aria-haspopup="listbox"
                                                                role="combobox" id="triggerDiv_srtemplate">
                                                                <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                    <apex:inputText id="SYSTemplate__c_id_name" value="{!reqDefBean.serviceReqTemplateName}"
                                                                        styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                        html-aria-controls="rf-typebox-id_srtemplate" html-autoComplete="off"
                                                                        html-placeholder="{!$Label.bmcservicedesk__servicerequesttemplatelookuphelptext}"
                                                                        onblur="rfToggleTypebox('srtemplate',false,this);fetchDataForSR(event);" onchange="clearAssociatedIdsSR();"
                                                                        onfocus="rfToggleTypebox('srtemplate',true,this);" html-rf-fieldapiname="srtemplate"
                                                                    />
                                                                    <apex:inputhidden id="SYSTemplate__c_id_id" value="{!reqDefBean.serviceReqTemplateObj.BMCServiceDesk__FKTemplate__c}" />
                                                                    <span id="ServiceReqTemplateLookup" class="rf-icon slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right"
                                                                        onclick="openSRDLookup('SRTemplate')">
                                                                         <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                        </svg>
                                                                    </span>
                                                                </div>
                                                                <!--typeahead -->
                                                                <div id="rf-typebox-id_srtemplate" class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox">
                                                                    <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                        <li role="presentation" class="slds-listbox__item" onclick="openSRDLookup('SRTemplate');">
                                                                            <div aria-selected="true" id="rf-typebox-search_intemplate" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                role="option">
                                                                                <span class="slds-media__figure slds-listbox__option-icon">
                                                                                    <span class="slds-icon_container slds-icon-utility-search" title="{!$label.Search} ">
                                                                                        <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                                        </svg>
                                                                                        <span class="slds-assistive-text">{!$label.Search} </span>
                                                                                    </span>
                                                                                </span>
                                                                                <span class="slds-media__body">
                                                                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-search_srtemplate">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdsearchoption}">
                                                                                            <apex:param value="" />
                                                                                            <apex:param value="{!$Label.bmcservicedesk__servicerequesttemplatelookuplabel}" />
                                                                                        </apex:outputText>
                                                                                    </span>
                                                                                </span>
                                                                            </div>
                                                                        </li>
                                                                        <li role="presentation" class="slds-listbox__item" id="AddNew-srtemplate" onclick="openCreateNewPopup('SR Template');">
                                                                            <div id="rf-typebox-add_srtemplate" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                role="option">
                                                                                <span class="slds-media__figure slds-listbox__option-icon">
                                                                                    <span class="slds-icon_container slds-icon-utility-add">
                                                                                        <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                                                        </svg>
                                                                                    </span>
                                                                                </span>
                                                                                <span class="slds-media__body">
                                                                                    <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-addnewoption_srtemplate">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdnewrecordoption}">
                                                                                            <apex:param value="{!$Label.bmcservicedesk__servicerequesttemplatelookuplabel}" />
                                                                                        </apex:outputText>
                                                                                    </span>
                                                                                </span>
                                                                            </div>
                                                                        </li>
                                                                    </ul>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="rf-form-hspacer"></td>
                                    
                                                <td class="clsInputLabelTD rf_form_col">
                                        <div class="slds-form__row">
                                            <!-- Incident Template Lookup -->
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="SYSTemplate__c_id__inc_name">
                                                        <abbr class="slds-required" title="{!$Label.Required}">* </abbr>
                                                        <apex:outputLabel value="{!$Label.bmcservicedesk__incidenttemplate}" />
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <div class="slds-combobox_container">
                                                            <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" aria-expanded="false" aria-haspopup="listbox"
                                                                role="combobox" id="triggerDiv_intemplate">
                                                                <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                                    <apex:inputText value="{!reqDefBean.IncidentTemplateName}" id="SYSTemplate__c_id__inc_name" styleClass="RFlookupClass slds-input slds-combobox__input slds-combobox__input-value"
                                                                        html-aria-controls="rf-typebox-id_intemplate" html-autoComplete="off"
                                                                        html-placeholder="{!JSENCODE($Label.bmcservicedesk__select)} {!JSENCODE($Label.bmcservicedesk__incidenttemplate)}"
                                                                        onblur="rfToggleTypebox('intemplate',false,this);fetchDataForInc(event);" onchange="clearAssociatedIdsInc();"
                                                                        onfocus="rfToggleTypebox('intemplate',true,this);" html-rf-fieldapiname="intemplate"
                                                                    />
                                                                    <apex:inputhidden id="SYSTemplate__c_id__inc_id" value="{!reqDefBean.IncidentTemplateId}" />
                                                                    <span id="IncidentTemplateLookup" class="rf-icon slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_right"
                                                                        onclick="openSRDLookup('INTemplate')">
                                                                        <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                        </svg>
                                                                    </span>
                                                                </div>    
                                                                    <!--typeahead -->
                                                                    <div id="rf-typebox-id_intemplate" class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox">
                                                                        <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                            <li role="presentation" class="slds-listbox__item" onclick="openSRDLookup('INTemplate');">
                                                                                <div aria-selected="true" id="rf-typebox-search_intemplate" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                    role="option">
                                                                                    <span class="slds-media__figure slds-listbox__option-icon">
                                                                                        <span class="slds-icon_container slds-icon-utility-search" title="{!$label.Search} ">
                                                                                            <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                                                                            </svg>
                                                                                            <span class="slds-assistive-text">{!$label.Search} </span>
                                                                                        </span>
                                                                                    </span>
                                                                                    <span class="slds-media__body">
                                                                                        <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-search_intemplate">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdsearchoption}">
                                                                                            <apex:param value="" />
                                                                                            <apex:param value="{!$Label.bmcservicedesk__incidenttemplate}" />
                                                                                        </apex:outputText>
                                                                                        </span>
                                                                                    </span>
                                                                                </div>
                                                                            </li>
                                                                            <li role="presentation" class="slds-listbox__item" id="AddNew-intemplate" onclick="openCreateNewPopup('INC Template');">
                                                                                <div id="rf-typebox-add_template" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term"
                                                                                    role="option">
                                                                                    <span class="slds-media__figure slds-listbox__option-icon">
                                                                                        <span class="slds-icon_container slds-icon-utility-add">
                                                                                            <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                                                            </svg>
                                                                                        </span>
                                                                                    </span>
                                                                                    <span class="slds-media__body">
                                                                                        <span class="slds-listbox__option-text slds-listbox__option-text_entity" id="rf-addnewoption_intemplate">
                                                                                        <apex:outputText value="{!$Label.bmcservicedesk__srdnewrecordoption}">
                                                                                            <apex:param value="{!$Label.bmcservicedesk__incidenttemplate}" />
                                                                                        </apex:outputText>
                                                                                        </span>
                                                                                    </span>
                                                                                </div>
                                                                            </li>
                                                                        </ul>
                                                            </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                        </table>    
                                    </div>
                                </section>
                            </li>
                            <li class="slds-accordion__list-item">
                                <section id="section-accordion-02" class="slds-accordion__section slds-p-top_large slds-p-horizontal_none slds-is-open">
                                    <div class="slds-accordion__summary">
                                        <h3 class="slds-accordion__summary-heading">
                                            <button type="button" aria-controls="accordion-02" aria-expanded="true" 
                                            class="slds-button slds-button_reset slds-accordion__summary-action" onclick="toggleSection('02');">
                                                <svg class="slds-accordion__summary-action-icon slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                                </svg>
                                                <span class="slds-accordion__summary-content headerCls" title="{!$Label.SRDPriceAvailability}">
                                                    {!$Label.SRDPriceAvailability}
                                                </span>
                                            </button>
                                        </h3>
                                    </div>
                                    <div class="slds-accordion__content slds-p-horizontal_xx-small" id="accordion-02">
                                        <table>
                                <tr>
                                    <td>
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="CustomerPrice__c">
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__CustomerPrice__c.label}"/>
                                                    </label>
                                                    <div class="slds-form-element__control" title="{!$ObjectType.SRM_RequestDefinition__c.fields.CustomerPrice__c.inlineHelpText}">
                                                        <apex:inputfield styleClass="slds-input priceCls" value="{!reqDefBean.reqDefObj.BMCServiceDesk__CustomerPrice__c}" id="CustomerPrice__c"
                                                        />
                                                        <apex:outputLabel id="customerPriceCurrency" styleClass="slds-form-element__label reqDefclsInputLabelTD" value="{!currencyUsed} /" />
                                                                <apex:inputfield styleClass="slds-input slds-select slds-m-left_xx-small slds-p-horizontal_xxx-small" style="width:180px;" value="{!reqDefBean.reqDefObj.BMCServiceDesk__PriceOption1__c}" id="PriceOption1__c"
                                                        />
                                                        <apex:outputLabel styleClass="reqDefclsInputLabelTD" value="/" />
                                                                <apex:inputfield styleClass="slds-input slds-select slds-m-left_xx-small slds-p-horizontal_xxx-small unitCls" value="{!reqDefBean.reqDefObj.BMCServiceDesk__PriceOption2__c}" id="PriceOption2__c"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="rf-form-hspacer"></td>
                                    <td>
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="DeliveryCost__c">
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__DeliveryCost__c.label}"/>
                                                    </label>
                                                    <div class="slds-form-element__control" title="{!$ObjectType.SRM_RequestDefinition__c.fields.DeliveryCost__c.inlineHelpText}">
                                                        <apex:inputfield styleClass="slds-input priceCls" value="{!reqDefBean.reqDefObj.BMCServiceDesk__DeliveryCost__c}" id="DeliveryCost__c"
                                                        />
                                                        <apex:outputLabel id="deliveryCostCurrency" styleClass="slds-form-element__label reqDefclsInputLabelTD" value="{!currencyUsed} /" />
                                                                <apex:inputfield styleClass="slds-input slds-select slds-m-left_xx-small slds-p-horizontal_xxx-small" style="width:180px;" value="{!reqDefBean.reqDefObj.BMCServiceDesk__CostOption1__c}" id="CostOption1__c"
                                                        />
                                                        <apex:outputLabel styleClass="reqDefclsInputLabelTD" value="/" />
                                                                <apex:inputfield styleClass="slds-input slds-select slds-m-left_xx-small slds-p-horizontal_xxx-small unitCls" value="{!reqDefBean.reqDefObj.BMCServiceDesk__CostOption2__c}" id="CostOption2__c"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_compound slds-form-element_stacked slds-is-editing">
                                                                    <label class="slds-form-element__label" for="RequestDefinition__c_id_StartDate__c">
                                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__StartDate__c.label}" />
                                                                    </label>
                                                                    <div class="slds-form-element__control" title="{!$ObjectType.SRM_RequestDefinition__c.fields.StartDate__c.inlineHelpText}">
                                                                        <apex:inputField onclick="adjustDatePicker($(this))" value="{!reqDefBean.reqDefObj.BMCServiceDesk__StartDate__c}" id="RequestDefinition__c_id_StartDate__c" StyleClass="slds-input"
                                                                 style="width: 318px"/>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                </div>
                                            </td>
                                            <td class="rf-form-hspacer"></td>
                                            <td>
                                                <div class="slds-form__row">
                                                    <div class="slds-form__item" role="listitem">
                                                        <div class="slds-form-element slds-form-element_compound slds-form-element_stacked slds-is-editing">
                                                                    <label class="slds-form-element__label" for="stacked-location-latitude-01">
                                                                         <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__EndDate__c.label}" />
                                                                    </label>
                                                                    <div class="slds-form-element__control" title="{!$ObjectType.SRM_RequestDefinition__c.fields.EndDate__c.inlineHelpText}">
                                                                        <apex:inputField onclick="adjustDatePicker($(this))" value="{!reqDefBean.reqDefObj.BMCServiceDesk__EndDate__c}" id="RequestDefinition__c_id_EndDate__c" StyleClass="slds-input"
                                                                		style="width: 318px"/>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                    		</td>
                                        </tr>
                                        <tr>        
                                    <td>
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="RequestDefinition_Turnaroundtime">
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__TurnaroundTime__c.label}"/>
                                                    </label>
                                                    <div class="slds-form-element__control" id="RequestDefinition_Turnaroundtime">
                                                        <table style="width:auto;">
                                                            <tr>
                                                                <td class="days-label-td">
                                                                    <div id="days-ct"/>
                                                                    <apex:outputLabel StyleClass="slds-form-element__label clsLabelHistoryDays" value="{!$Label.bmcservicedesk__incidenthistorydays}" />
                                                                </td>
                                                                <td class="hours-label-td">
                                                                    <div id="hours-ct" />
                                                                    <apex:outputLabel StyleClass="slds-form-element__label clsLabelHistoryDays" value="{!$Label.bmcservicedesk__hourslabel}" />
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                            <td class="rf-form-hspacer"></td>
                                            <td title="{!$ObjectType.SRM_RequestDefinition__c.fields.Status__c.inlineHelpText}">
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="RequestDefinition_Status">
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Status__c.label}" />
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputfield value="{!reqDefBean.reqDefObj.BMCServiceDesk__Status__c}" id="RequestDefinition_Status" 
                                                        styleClass="slds-input slds-select slds-combobox__input"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>                
                                    </td>
                                        </tr>
                                        <tr>
                                            <td class="rf_form_col">
                                                <div class="slds-form__row slds-p-top_x-small">
                                                    <div class="slds-form__item" role="listitem">
                                                        <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                            <span class="slds-checkbox">
                                                                <apex:inputCheckbox title="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Online__c.inlineHelpText}" id="RequestDefinition_Online"
                                                                    value="{!reqDefBean.reqDefObj.BMCServiceDesk__Online__c}" />
                                                                <apex:outputLabel for="RequestDefinition_Online" styleClass="slds-checkbox__label slds-m-right_none">
                                                                    <span class="slds-checkbox--faux"></span>
                                                                    <span class="slds-form-element__label slds-p-right_none slds-p-top_xxx-small">{!$Label.ReqDefOnline}</span>
                                                                </apex:outputLabel>
                                                                <span class="d-icon-info_circle slds-button slds-button_icon slds-p-top_xxx-small" tooltip-placement="bottom" uib-tooltip-html="tooltipContent"
                                                                    id="OnlineInfo">
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                            <span class="slds-checkbox">
                                                                <apex:inputcheckbox value="{!reqDefBean.reqDefObj.BMCServiceDesk__Mobile__c}" id="isMobile" title="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Mobile__c.inlineHelpText}"
                                                                />
                                                                <apex:outputLabel for="isMobile" styleClass="slds-checkbox__label slds-m-right_none">
                                                                    <span class="slds-checkbox--faux"></span>
                                                                    <span class="slds-form-element__label">{!$ObjectType.SRM_RequestDefinition__c.fields.Mobile__c.label}</span>
                                                                </apex:outputLabel>
                                                            </span>
                                                    </div>
                                                </div>
                                            </div>
                                            </td>
                                            <td class="rf-form-hspacer"></td>
                                            <td class="clsVAlignTop rf_form_col">    
                                                <div class="slds-form__row slds-p-top_x-small">
                                                    <div class="slds-form__item" role="listitem">
                                                        <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                            <span class="slds-checkbox">
                                                                <apex:inputcheckbox value="{!reqDefBean.reqDefObj.BMCServiceDesk__ApprovalRequired__c}" id="isApprovalReqd" />
                                                                <apex:outputLabel for="isApprovalReqd" styleClass="slds-checkbox__label slds-m-right_none">
                                                                    <span class="slds-checkbox--faux"></span>
                                                                    <span class="slds-form-element__label slds-p-right_none slds-p-top_xxx-small">{!$Label.approvalrequired}</span>
                                                                </apex:outputLabel>
                                                                <span class="d-icon-info_circle slds-button slds-button_icon slds-p-top_xxx-small" tooltip-placement="bottom" uib-tooltip-html="tooltipContent"
                                                                    id="ApprvalRequiredInfo">
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                        </div>
                                    </td>
                                </tr>
                                    </table>
                                    </div>
                                </section>
                            </li>
                            <li class="slds-accordion__list-item">
                                <section id="section-accordion-03" class="slds-accordion__section slds-p-top_large slds-p-horizontal_none slds-is-open">
                                    <div class="slds-accordion__summary">
                                        <h3 class="slds-accordion__summary-heading">
                                            <button type="button" aria-controls="accordion-03" aria-expanded="true" 
                                            class="slds-button slds-button_reset slds-accordion__summary-action" onclick="toggleSection('03');">
                                                <svg class="slds-accordion__summary-action-icon slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                    <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                                </svg>
                                                <span class="slds-accordion__summary-content headerCls" title="{!$Label.SRDOtherDetails}">
                                                    {!$Label.SRDOtherDetails}
                                                </span>
                                            </button>
                                        </h3>
                                    </div>
                                    <div class="slds-accordion__content slds-p-horizontal_xx-small" id="accordion-03">
                                <table>
                                <tr>
                                    <td class="rf_form_col">
                                        <!--Image-->
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label slds-p-right_none slds-m-right_none" for="Image">
                                                        <apex:outputLabel styleClass="slds-p-right_none slds-m-right_none" value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Image__c.label}" />
                                                    </label>
                                                    <span class="d-icon-info_circle slds-button slds-button_icon slds-p-top_xxx-small" tooltip-placement="bottom" uib-tooltip-html="tooltipContent"
                                                        id="ImageInfo">
                                                    </span>
                                                    <div class="slds-form-element__control">
                                                        <table cellpadding="0" cellspacing="0" width="100%">
                                                            <tr>
                                                                <td width="25%" class="clsBottomPadTD">
                                                                    <table cellpadding="0" cellspacing="0" style="width:fit-content;">
                                                                        <tr>
                                                                            <td class="clsImageTD">
                                                                                <div id="enclosingDiv">
                                                                                    <apex:image value="{!IF(reqDefBean.reqDefObj.BMCServiceDesk__Image__c != null,URLFOR($Action.Document.Download,reqDefBean.reqDefObj.BMCServiceDesk__Image__c,[retURL='']),'')}"
                                                                                        id="Image_Id" width="100%" height="100%"/>

                                                                                    <image id="someImage" src="" class="clsImage" onError="ImgError(this)" />
                                                                                </div>

                                                                                <script>
                                                                                    document.getElementById('someImage').src = '/';
                                                                                    var imgId = '{!JSENCODE(reqDefBean.reqDefObj.Image__c)}';
                                                                                    setRequestDefIconImageDisplay(imgId);
                                                                                </script>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                <td class="clsBottomPadTD1 slds-var-p-left_medium">
                                                                    <div class="slds-form-element__control slds-var-p-vertical_xx-small">
                                                                        <span class="slds-radio slds-var-p-bottom_x-small">
                                                                            <input type="radio" class="radioInput" name="selectRadio" id="radioCom" 
                                                                            onclick="document.getElementById('radioSF').checked = false;"
                                                                            />
                                                                            <label class="slds-radio__label" for="radioCom">
                                                                                <span class="slds-radio_faux"></span>
                                                                                <span class="slds-form-element__label">{!$Label.selectfromcomputer}</span>
                                                                            </label>
                                                                        </span>
                                                                        <span class="slds-radio slds-var-p-bottom_small">
                                                                            <input type="radio" class="radioInput" checked="true" name="selectRadio" id="radioSF" 
                                                                            onclick="document.getElementById('radioCom').checked = false;"
                                                                            />
                                                                            <label class="slds-radio__label" for="radioSF">
                                                                                <span class="slds-radio_faux"></span>
                                                                                <span class="slds-form-element__label">{!$Label.selectfromsalesforce}</span>
                                                                            </label>
                                                                        </span>
                                                                    </div>
                                                                    <div>
                                                                        <button type="button" class="slds-button slds-button_neutral" onclick="openImagePopup();">
                                                                            <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                                                <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#download')}"></use>
                                                                            </svg>{!$Label.ReqDefImageSelect}
                                                                        </button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>  
                                        </div>
                                    </td>
                                    <td class="rf-form-hspacer"></td>
                                    <td style="vertical-align: top;" class="slds-var-p-top_medium rf_form_col">
                                        <div class="slds-form__row">
                                            <div class="slds-form__item" role="listitem">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="RequestDefinition__c_id_SRDUrl__c">
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__SRDUrl__c.label}" />
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputText value="{!reqDefBean.reqDefObj.BMCServiceDesk__SRDUrl__c}" id="RequestDefinition__c_id_SRDUrl__c" StyleClass="slds-input"
                                                            html-placeholder="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__SRDUrl__c.inlineHelpText}" />
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                        <div class="slds-form__row" id="ReqDef_DirectLinkTR"  style="display:none;">
                                            <div class="slds-form__item" role="listitem" id="ssLinkTD">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <label class="slds-form-element__label" for="ReqDef_DirectLink">
                                                        <apex:outputLabel value="{!$Label.bmcservicedesk__selfservicelink}" />
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <apex:outputPanel id="ReqDef_DirectLink" layout="none">
                                                            <apex:inputText value="{!reqDefBean.directLink}" id="ReqDef_DirectSSLink" styleClass="slds-input ssLink" 
                                                            html-readonly="true" title="{!$Label.bmcservicedesk__directlinksrinfo}" onkeypress="return false;" onclick="this.select();" />
                                                        </apex:outputPanel>
                                                    </div>    
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                            		</section>
                                </li>
                                </ul> 
                            </div>      
                        </div>
                        
                        <div id='ReqDef_EntitlementTab' class="clsEntitlemenetTab slds-m-horizontal_large slds-p-horizontal_xx-large slds-p-top_small">
                            <div class="rf_form_medium">
                        <table style="width:100%">
                            <tr>
                                <td class="configureEntitlementDiv">
                                    <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                        <label class="slds-form-element__legend">{!$Label.configureentitlementfor}</label>
                                        <div class="slds-form-element__control">
                                            <div>
                                                <apex:selectList value="{!reqDefBean.entiltementConfigurationFor}" multiselect="false" size="1" id="entitlementConfigOption"
                                                onchange="switchEntitlementConfiguration(this.value)" styleClass="slds-input slds-select">
                                                <apex:selectOption itemValue="SelfService" itemLabel="{!$Label.bmcservicedesk__navigator_selfservice}" />
                                                <apex:selectOption itemValue="RemedyforceConsole" itemLabel="{!$Label.bmcservicedesk__remedyforce_console}" />
                                                </apex:selectList>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td></td>
                            </tr>

                            <table class="clsclsAvailableTableAccounts1">
                                <tr colspan="2">
                                    <td class="clsBoldInputLabelTD paddingTopForNextField" >
                                        <apex:outputLabel styleClass="slds-form-element__legend slds-form-element__label" value="{!$Label.bmcservicedesk__accountentitlement}" />
                                        <div style="margin-top:5px">
                                                 <span class="d-icon-info_circle slds-button slds-button_icon slds-p-top_xxx-small" tooltip-placement="bottom" uib-tooltip-html="tooltipContent"
                                                    id="AccountInfo">
                                                </span>
                                         </div>
                                    </td>

                                </tr>
                                <tr>
                   
                                    <td>
                                        <div class="slds-form-element__control slds-var-p-vertical_xx-small" id="accountRadioSelect_SS">
                                            <span class="slds-radio slds-var-p-bottom_x-small">
                                                <input type="radio" class="radioInput" id="accountRadioEveryOne_SS" 
                                                onclick="document.getElementById('accountRadioSelected_SS').checked = false;toggleAccountSelector('true');" 
                                                />
                                                <label class="slds-radio__label" for="accountRadioEveryOne_SS">
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">{!$Label.Allprofiles}</span>
                                                </label>
                                            </span>
                                            <span class="slds-radio slds-var-p-bottom_small">
                                                <input type="radio" class="radioInput" id="accountRadioSelected_SS" 
                                                onclick="document.getElementById('accountRadioEveryOne_SS').checked = false;toggleAccountSelector('false');"
                                                />
                                                <label class="slds-radio__label" for="accountRadioSelected_SS">
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label" style="margin-bottom: -22px;">{!$Label.SelectedAccounts}</span>
                                                </label>
                                            </span>
                                        </div>


                                        <div class="slds-form-element__control slds-var-p-vertical_xx-small" style="display:none" id="accountRadioSelect_Con">
                                            <span class="slds-radio slds-var-p-bottom_x-small">
                                                <input type="radio" class="radioInput" id="accountRadioEveryOne_Con" 
                                                onclick="document.getElementById('accountRadioSelected_Con').checked = false;toggleAccountSelector('true');"
                                                />
                                                <label class="slds-radio__label" for="accountRadioEveryOne_Con">
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">{!$Label.Allprofiles}</span>
                                                </label>
                                            </span>
                                            <span class="slds-radio slds-var-p-bottom_small">
                                                <input type="radio" class="radioInput" id="accountRadioSelected_Con" 
                                                onclick="document.getElementById('accountRadioEveryOne_Con').checked = false;toggleAccountSelector('false');"
                                                />
                                                <label class="slds-radio__label" for="accountRadioSelected_Con">
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">{!$Label.SelectedAccounts}</span>
                                                </label>
                                            </span>
                                            <apex:inputHidden id="AllAccountsSS" value="{!reqDefBean.reqDefObj.BMCServiceDesk__AllAccounts__c}" />
                                            <apex:inputHidden id="AllAccountCon" value="{!reqDefBean.reqDefObj.BMCServiceDesk__AllAccount_ConsoleConfiguration__c}" />
                                        </div>
                                        <script> 
                                            if({!reqDefBean.reqDefObj.AllAccounts__c }){
                                                document.getElementById('accountRadioEveryOne_SS').checked = true;
                                            }else{
                                                document.getElementById('accountRadioSelected_SS').checked = true;
                                            }
                                            if({!reqDefBean.reqDefObj.AllAccount_ConsoleConfiguration__c }){
                                                document.getElementById('accountRadioEveryOne_Con').checked = true;
                                            }else{
                                                document.getElementById('accountRadioSelected_Con').checked = true;
                                            }

                                        </script>
                                    </td>
                                </tr>
                               
                                <tr>
                                    <td>
                                        <div >
                                        <table class="clsAvailableTableAccounts" style="margin-top:-10px">
                                            <tr>
                                                <td width="300px">
                                                    <apex:outputLabel styleClass="slds-form-element__label" value="{!$Label.bmcservicedesk__availableaccounts}" />
                                                    <div id="accountDiv" class="slds-form-element__control">
                                                        <input id="txtSrch" type="text" placeholder="{!JSENCODE($Label.Search)}" onkeypress="if(event.keyCode == 13){txtSearch();}" class="accountSearchTextbox slds-input"/>
                                                        <a id="lookupIcon" class="d-icon-search lookupIcon" onclick="txtSearch()" title="{!JSENCODE($Label.Search)}"/>
                                                        <a id="crossIcon" class="d-icon-cross crossIconCSS" onclick="resetSearch()" style="display:none" title="{!$Label.Refresh}"/>
                                                    </div>
                                                </td>
                                                <td class="paddingLeft15">
                                                    <apex:outputLabel styleClass="slds-form-element__label marginTopSelectedAccount" value="{!$Label.bmcservicedesk__selectedaccounts}" />
                                                </td>
                                            </tr>
                                        </table>
                                        </div>
                                    </td>
                                </tr>

                                <tr>
                                    <td>
                                        <div id='accountSelectorDiv'></div>
                                        <div width="520px">
                                            <table class="accountToolbar">
                                                <tr>
                                                    <td style="padding-left:190.5px"><div id ="accBtnPrevId" class="entilementPaginatorDiv d-icon-angle_left pagination-keys accountToolbarMargin3px " onclick="PrevBtnHandler()" title="{!$Label.Previous}"></div></td>
                                                    <td ><div id="accBtnNextId" class="entilementPaginatorDiv d-icon-angle_right pagination-keys accountToolbarMargin215px " onclick="nextAccountBtn()" title="{!$Label.Next}"></div></td>
                                                </tr>
                                            </table>
                                        </div>
                                        <apex:inputHidden id="selectedAccounts" value="{!reqDefBean.selectedAccounts}" />
                                    </td>   
                                </tr>
                            </table>
                            <table class="clsTable2 configureEntitlementDiv">
                                <tr></tr>
                                <tr>
                                    <td >
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__legend">{!$Label.profileentitlementtitle}</label>
                                            <div class="slds-form-element__control">
                                                <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                    <apex:selectList style="display:inline;" value="{!reqDefBean.entiltementOption}" multiselect="false" size="1" id="profileOptionSelect_SS"
                                                        onChange="entitlementSelector(this.value);" styleClass="slds-input slds-select">
                                                        <apex:selectOptions value="{!EntitlementOptions}" />
                                                    </apex:selectList>
                                                    <apex:selectList style="display:none" value="{!reqDefBean.console_entiltementOption}" multiselect="false" size="1" id="profileOptionSelect_Con"
                                                        onChange="entitlementSelector(this.value);" styleClass="slds-input slds-select">
                                                        <apex:selectOptions value="{!EntitlementOptions}" />
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                   
                                </tr>
                                <tr>
                                    <table class="clsAvailableTableAccounts">
                                        <tr>
                                            <td width="300px" class="paddingTopForNextField">
                                                <apex:outputLabel styleClass="slds-form-element__label" id="available" value="{!$Label.bmcservicedesk__availableprofile}" />
                                            </td>
                                            <td class="paddingLeft15 paddingTopForNextField">
                                                <apex:outputLabel styleClass="slds-form-element__label" id="selected" value="{!$Label.bmcservicedesk__selectedprofile}" />
                                            </td>
                                        </tr>
                                    </table>
                                </tr>
                                <tr>
                                    <div id='profileSelectorDiv' style="margin-bottom:5px;"></div>
                                    <apex:inputHidden id="selectedProfiles" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Profiles__c}" />
                                    <apex:inputHidden id="selectedConsoleProfiles" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Profile_ConsoleConfiguration__c}" />
                                </tr>

                            </table>
                            <table id="restrictSRAccessTable" class="paddingBottom10 clsTable2" style="visibility:hidden">

                                <tr>
                                    <td>
                                        <div class="slds-form__item" role="listitem" style="padding-left:0px !important">
                                            <div class="slds-form-element slds-form-element_stacked slds-is-editing">
                                                <span class="slds-checkbox">
                                                    <apex:inputcheckbox id="restrictSRAccess" value="{!reqDefBean.restrictSRFromStaff}" />
                                                    <apex:outputLabel for="restrictSRAccess" styleClass="slds-checkbox__label">
                                                        <span class="slds-checkbox--faux"></span>
                                                        <span class="slds-form-element__label">{!$Label.restrictsraccess}</span>
                                                    </apex:outputLabel>
                                                </span>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>


                        </table>
                    </div>
                    </div>
                        <div id='ReqDef_FulfillmentTab' class="clsFulfillmentTab slds-p-horizontal_xx-large slds-p-top_small">
                            <table cellspacing="0" cellpadding="0" border="0" id="inputMappingDiv" class="clsInlineTable rf_form_medium">
                            <tr>
                                <td valign="top" colspan="3" class="clsBoldInputLabelTD">
                                        <apex:outputLabel styleClass="slds-form-element__legend headerCls" value="{!$Label.bmcservicedesk__add_fulfillment_templates}" />
                                </td>
                            </tr>
                            <tr>
                                <td valign="top" colspan="3">
                                    <div id="processGrid" style="width:100%"></div>
                                </td>
                            </tr>
                            <tr>
                                 <td valign="top" colspan="3" height="10">&nbsp;</td>
                            </tr>
                            <tr>
                                <td valign="top" colspan="3" class="clsBoldInputLabelTD">
                                        <apex:outputLabel styleClass="slds-form-element__legend processNameCls headerCls slds-m-right_xx-small" value="{!$Label.bmcservicedesk__map_user_inputs_to_template_fields} "/>
                                        <label id="processTemplateName" class="slds-form-element__legend processNameCls headerCls"></label>
                                </td>
                            </tr>
                            <tr>
                                <td valign="top" colspan="3" height="5"></td>
                            </tr>
                            <tr>
                                <td valign="top" colspan="2" class="slds-p-top_xx-small">
                                    <label class="mapInstrucntionCls slds-m-right_xxx-small" id="mappingInfo">{!$Label.SRDMappingInfo}</label>
                                    				<span class="rf-info-custom d-icon-info_circle slds-button slds-button_icon slds-p-top_none" tooltip-placement="top" uib-tooltip-html="tooltipContent"
                                        id="mappingNote"></span>
                                </td>
                                    <td valign="bottom" rowspan="2" class="slds-p-bottom_xx-small">
                                    <button id="addMappingBtn" type="button" class="slds-button slds-button_neutral" title="{!$Label.Add}" onclick="addNewFulfillmentMapping();"
                                        style="float:right;">
                                        <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                            <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                        </svg>
                                        {!$Label.Add}
                                    </button>
									 <button  id="cancelButton" type="button" class="slds-button slds-button_neutral" title="{!$Label.Cancel}" onclick="cancelFulfillmentMapping();"
                                    style="float:right;display:none">
                                    {!$Label.Cancel}
                                    </button>
                                </td>
                             </tr>
                             <tr>
                                    <td valign="top" colspan="2" class="clsBoldInputLabelTD slds-p-bottom_xx-small">
                                    <div class="slds-form__row slds-p-vertical_xx-small">
                                        <div class="slds-form__item" role="listitem">
                                            <div class="slds-form-element slds-form-element_stacked slds-is-editing slds-m-around_none">
                                                <span class="slds-checkbox">
                                                    <apex:inputCheckbox id="chkPrefixPrompt" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Prefix_Prompt_to_user_input__c}" />
                                                    <apex:outputLabel for="chkPrefixPrompt" styleClass="mapInstrucntionCls slds-checkbox__label slds-m-right_none">
                                                        <span class="slds-checkbox--faux"></span>
                                                        <span class="slds-form-element__label slds-p-right_xxx-small">{!$Label.prefixprompttouserinput}</span>
                                                    </apex:outputLabel>
                                                        <span class="rf-info-custom d-icon-info_circle slds-button slds-button_icon slds-p-top_none" tooltip-placement="top" uib-tooltip-html="tooltipContent"
                                                        id="prefixNote">
                                                    </span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr height="15px">
                                <td colspan="3">
                                    <div>
                                        <table class="mappingGridDiv">
                                            <tr>
                                                <td width="408px">
                                                    <div class="slds-form-element__legend mappingDivHeader">{!JSENCODE($Label.Fields)} 
                                                        <span class="rf-info-custom d-icon-info_circle slds-button slds-button_icon slds-p-top_none" tooltip-placement="top" uib-tooltip-html="tooltipContent"
                                                            id="mappingFieldNote"></span>
                                                    </div>
                                                        <div id="templateField" style="display:none;" class="slds-form-element__control"></div>
                                                </td>
                                                    <td>
                                                        <div class="slds-form-element__legend mappingDivHeader">{!JSENCODE($Label.mapped_fields_for_selected_template)}</div>
                                                        <div id="inputField" style="display:none;" class="slds-form-element__control"></div>
                                                </td>
                                                <td width="22px">
                                                    <div id="divBorder" class="divBorder" style="display:none"></div>
                                                        <button title="{!$Label.Add}" type="button" class="slds-button slds-button_neutral slds-button_icon-x-small checkButton disableDiv"
                                                            onclick="addFulfillmentMapping();" id="AddBtn" style="display:none;">
                                                        <svg class="slds-button__icon" aria-hidden="true">
															<use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
														</svg>
													</button>
                                                </td>
                                            </tr>
                                            
                                            <tr>
                                                <td colspan="3">
                                                    <div id="mappingGrid"></div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <div style="height:15px;"></div>
                                </td>
                            </tr>
                            <tr>
                                <td class="clsBoldInputLabelTD" colspan="3" valign="top">
                                        <apex:outputLabel styleClass="slds-form-element__legend headerCls slds-m-right_xxx-small" value="{!$Label.bmcservicedesk__fulfillment_criteria_ci_asset}" />
                                        <span class="rf-info-custom d-icon-info_circle slds-button slds-button_icon slds-p-around_xx-small" 
                                         tooltip-placement="top" uib-tooltip-html="tooltipContent" id="cmdbNote"></span>
                                    
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" valign="top" style="padding-bottom: 20px;" class="mapInstrucntionCls slds-p-top_xx-small">
                                    <div>
                                        <apex:outputLabel value="{!$Label.bmcservicedesk__rule_criteria}" styleClass="mapInstrucntionCls" />
                                    </div>
                                    <apex:outputPanel id="criteriaTextDiv">
                                            <textarea id="CriteriaText" cols="100" class="CriteriaTextClass slds-input" disabled="true" style="height:32px;">{!QueryCondition}</textarea>
                                    </apex:outputPanel>
                                        <a id="PopupLink" value="#" onclick="FulfillmentCriteriaHandler();" class="slds-button slds-button_neutral slds-m-left_small clsVAlignTop"></a>
                                        <a id="DeleteLink" value="#" onclick="showLoadingMask();deleteFulfillmentCriteria(LKfilterId);" class="slds-button slds-button_neutral clsVAlignTop" style="display:none;">{!$Label.Delete}</a>
                                </td>
                            </tr>
                        </table>
                    </div>
                        <div id='ReqDef_InputTab' class="clsInputTab slds-p-horizontal_xx-large slds-p-top_small">
                        <table cellspacing="0" cellpadding="0" width="100%" border="0" id="inputListDiv" class="clsInlineTable rf_form_medium">
                            <tr id="userInstructionsTR">
                                <td>
                                    <table>
                                        <tr>
                                            <td width="73%">
                                                <div class="slds-form-element">
                                                        <apex:outputLabel styleClass="slds-form-element__legend" value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__UserInstructions__c.label}"
                                                    />
                                                    </div>
                                                <div class="slds-form-element__control">
                                                    <apex:inputTextarea title="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__UserInstructions__c.inlineHelpText}" id="SRM_RequestDefinition_userInstructions__c"
                                                        value="{!reqDefBean.userInstructions}" styleClass="clsInputTextAreaTD1 slds-textarea" rows="1"
                                                        tabindex="509" />      
                                                </div>
                                            </td>
                                            <td class="clsVAlignTop">
                                                <div class="slds-form-element textEditorIcon">
                                                    <label class="slds-form-element__label">&nbsp; </label>
                                                    <div class="slds-form-element__control">
                                                        <span id="UserInstructionIcon" class="rf-icon slds-icon_container slds-icon-utility-description slds-p-around_xx-small"
                                                            onclick="showTextEditorRD('{!$Component.ReqDefForm.SRM_RequestDefinition_userInstructions__c}', '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.userInstructions__c.label)}',
                                                            '32000', '{!JSENCODE($Label.OK)}', '{!JSENCODE($Label.Cancel)}');" style="margin-top:5px;">
                                                    <svg class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                                                                <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#description')}"></use>
                                                    </svg>
                                                </span>  
                                                    </div>
                                                </div>
                                            </td>                                           
                                                <td class="clsVAlignTop clsPadding5TD clsPaddingRight5TD RTFInstructionsTDWidth" style="width:25.7%">
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label">&nbsp; </label>
                                                    <div class="slds-form-element__control">
                                                <apex:inputHidden id="ReqDef_UserInstructions_RichText" value="{!reqDefBean.reqDefObj.BMCServiceDesk__User_Instructions_Rich_Text__c}" />
                                                        <span type="button" class="slds-button slds-button_neutral slds-m-horizontal_none" style="cursor:pointer;max-width:260px;" title="{!$Label.Rich_Text_Instructions}"
                                                            onclick="openRTFPopupWindow(inProgress,true);">
                                                    <svg id="rtfIcon" class="slds-icon slds-icon slds-icon_x-small slds-icon-text-default slds-m-right_x-small" aria-hidden="true">
                                                        <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#display_rich_text')}"></use>
                                                    </svg>
                                                    <span class="slds-truncate">{!$Label.Rich_Text_Instructions}</span>
                                                </span>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            
                            <tr>
                                <td class="slds-p-top_none">
                                    <apex:outputpanel layout="block" id="createfulfillmentInputPanel">
                                        <table cellspacing="0" cellpadding="0" border="0" width="100%">
                                        <!--Fulfillment Input Steps-->
                            
                                        <tr>
                                            <td id="inputHeader" class="inputHeader">
                                                <h3 class="srdInputHeader" id="srdInputHeaderId">
                                                    <span class="srdInputHeaderSpan" id="fulfillmentInputHeader"></span>
                                                </h3>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                               
                                                <div id="fulfillmentInputHeaderStep1" class="fulfillment-input-step-header" style="display:block;">
                                                    <!-- STEP 1 header -->
                                                     <div class="fulfillmentInputOptionParentClass">
                                                            <div id="requestInput" class="fulfillmentInputOptionClass width50Class srdInputSubHeaderFontSize slds-form-element__legend">{!$Label.RequestInput}</div>
                                                            <div class="textAlignRightClass width50Class ">
                                                                <div style="display:inline-block">
                                                                    <button id="addInputBtn" type="button" class="slds-button slds-button_neutral" onclick="nextPrevInputStep(1);" title="{!$Label.Add}">
                                                                        <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                                                            <use 
                                                                            xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#add')}"></use>
                                                                        </svg>
                                                                        {!$Label.Add}
                                                                    </button>
                                                                </div>

                                                                <div class="slds-button-group" role="group" style="padding-left:8px;vertical-align: middle;">
                                                                                                                                     
                                                                        <span  id="downKey" onclick="moveSelectedRow('down')" class="disableDiv slds-button slds-button_icon slds-button_icon-border-filled" aria-haspopup="true" title="{!JSENCODE($Label.IconDown)}">
                                                                            <svg class="slds-button__icon" aria-hidden="true">
                                                                                <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#chevrondown')}"></use>
                                                                            </svg>
                                                                        </span>
                                                                        <span onclick="moveSelectedRow('up');" id="upKey" class="disableDiv slds-button slds-button_icon slds-button_icon-border-filled" aria-haspopup="true" title="{!JSENCODE($Label.IconUp)}">
                                                                            <svg class="slds-button__icon" aria-hidden="true">
                                                                                <use xlink:href="{!URLFOR($Asset.SLDS, '/assets/icons/utility-sprite/svg/symbols.svg#chevronup')}"></use>
                                                                            </svg>
                                                                        </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                <div id="fulfillmentInputHeaderStep2" class="fulfillment-input-step-header">
                                                    <!-- STEP 2 header -->
                                                    <div class="slds-p-top_small fulfillmentInputOptionParentClass">
                                                        <div class="fulfillmentInputOptionClass widthInputSelectionClass srdInputSubHeaderFontSize slds-p-left_medium">
                                                            <div class="">
                                                                <div id="dataTypeSelectionError" class="dataTypeSelectionErrorClass">{!$Label.DataTypeSelectionError}</div>                                                                
                                                                <apex:repeat value="{!inputFieldTypesMap}" var="fieldType">
                                                                            <div id="div{!inputFieldTypesMap[fieldType]}" class="slds-form-element__control slds-var-p-vertical_xx-small">
                                                                                <span class="slds-radio slds-var-p-bottom_x-small">
                                                                                    <input type="radio" value="{!inputFieldTypesMap[fieldType]}" name="dataTypeInput" id="{!fieldType}" tabindex="0" class="radioInput" onclick="dataTypeSelection();"></input>            
                                                                                    <label class="slds-radio__label" for="{!fieldType}">
                                                                                        <span class="slds-radio_faux"></span>
                                                                                        <span class="slds-form-element__label">{!inputFieldTypesMap[fieldType]}</span>
                                                                                    </label>
                                                                                </span>                                                                            
                                                                            </div>
                                                                </apex:repeat>
															</div>
														</div>
														<div class="fulfillmentInputOptionClass width6Class textAlignRightClass nextPrevLinkClass">
															<span class="slds-button slds-button_neutral" style="cursor:pointer" onclick="nextPrevInputStep(-1);">  
																{!$Label.ssBack}
                                                            </span>
														</div>
														<div class="slds-m-left_x-small fulfillmentInputOptionClass width6Class textAlignRightClass nextPrevLinkClass">
															<span class="slds-button slds-button_neutral" style="cursor:pointer" onclick="nextPrevInputStep(1);">
																{!$Label.Next}
                                                            </span>
														</div>
													</div>
												</div>
												<div id="fulfillmentInputHeaderStep3" class="fulfillment-input-step-header">
													<!-- STEP 3 header -->
													<div class="">
													</div>
												</div>
											</td>
										</tr>
										<tr>
											<!--fulfillmentInputStep1-->
											<td class="fulfillment-input-step" style="display:block;" width="100%" id="tdRDInput">
												<div id="grid"></div>
											</td>

											<!--fulfillmentInputStep2-->
											<td class="fulfillment-input-step">
												
											</td>
											<!--fulfillmentInputStep3-->
											<td class="fulfillment-input-step" id="tdInputs" width="100%;">
												<iframe id="frameFulfillmentInput" src="" height="490px" width="100%" scrolling="yes" frameborder="0" onload="hideLoadingMask()"/> 
												<table style="display:none;">
													<tr>
													<td>
														<input id="btnUpId" type="button" class="btnArrowUpDisable" onclick="moveSelectedRow(-1)" disabled="disabled"/>
													</td>
													</tr>
													<tr>
													<td>
														<input id="btnDownId" type="button" class="btnArrowDownDisable" onclick="moveSelectedRow(1)" disabled="disabled"/>
													</td>
													</tr>
												</table>
											</td>
										</tr>
										</table>
									</apex:outputpanel>      
								</td>
						    </tr>
                        </table>
                        <apex:inputhidden value="{!reqDefBean.reqDefObj.BMCServiceDesk__Set_Execution_Order__c}" id="RequestDefinition__c_id_Set_Execution_Order__c"
                        />
                    </div>
                        <div id='ReqDef_OptionsTab' class="clsOptionsTab slds-m-horizontal_large slds-p-horizontal_xx-large slds-p-top_small">
                        <apex:outputPanel id="OptionsTab">
                            <table width="646" cellpadding="0" cellspacing="0" class="rf_form_medium">

                                <!--  ############ Save & Edit functionality for this commented section is already implemented ################ -->

                                <tr>
                                    <td class="clsBoldInputLabelTD">
                                            <apex:outputLabel styleClass="slds-form-element__legend" value="{!$Label.bmcservicedesk__reqdefreviewservice}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <apex:outputLabel styleClass="labelstyler displayOptionInfo" value="{!$Label.bmcservicedesk__reviewinstruction}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td height="6"></td>
                                </tr>
                                <tr>
                                    <td>
                                            <table style="width:50%;">
                                            <tr>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                        
                                                                    <span class="slds-checkbox">
                                                    				<apex:inputCheckbox title="" id="reqDefTurnTime" value="{!reqDefBean.turnAround}" />
	                                                                <apex:outputLabel for="reqDefTurnTime" styleClass="slds-checkbox__label ">
	                                                                    <span class="slds-checkbox--faux"></span>
	                                                                    <span class="slds-form-element__label">{!$Label.reqdefturnaroundtime}</span>
	                                                                </apex:outputLabel>
	                                                            </span>
	                                                        </div>
	                                                    </div>
	                                                </div>
                                                </td>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                    <apex:inputCheckbox title="" id="reqDefEmail" value="{!reqDefBean.email}" />
                                                                        <apex:outputLabel for="reqDefEmail" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.email}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td height="6" colspan="2"></td>
                                            </tr>
                                            <tr>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                    <apex:inputCheckbox title="" id="reqDefPrice" value="{!reqDefBean.price}" />
                                                                        <apex:outputLabel for="reqDefPrice" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.reqdefprice}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                                        <apex:inputCheckbox title="" id="reqDefInstructions" value="{!reqDefBean.instructions}" />
                                                                        <apex:outputLabel for="reqDefInstructions" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.instructions}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td height="6" colspan="2"></td>
                                            </tr>
                                            <tr>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                    <apex:inputCheckbox title="" id="reqDefExptCom" value="{!reqDefBean.dateExpected}" />
                                                                        <apex:outputLabel for="reqDefExptCom" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.reqdefexpectedcompletion}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                    <apex:inputCheckbox title="" id="reqDefServiceCoordinator" value="{!reqDefBean.serviceCoordinator}" />
                                                                        <apex:outputLabel for="reqDefServiceCoordinator" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.assignedto}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                        
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td height="6" colspan="2"></td>
                                            </tr>
                                            <tr>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                    <apex:inputCheckbox title="" id="reqDefPhone" value="{!reqDefBean.phone}" />
                                                                        <apex:outputLabel for="reqDefPhone" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.phone}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                                <td class="clsPanelInputCheckboxTDSA">
                                                        <div class="slds-form__row">
                                                            <div class="slds-form__item" role="listitem">
                                                                <div class="slds-form-element">
                                                                    <span class="slds-checkbox">
                                                    <apex:inputCheckbox title="" id="Approvals" value="{!reqDefBean.approvals}" />
                                                                        <apex:outputLabel for="Approvals" styleClass="slds-checkbox__label">
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label">{!$Label.approvals}</span>
                                                                        </apex:outputLabel>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </td>
                                            </tr>

                                        </table>
                                    </td>
                                </tr>
                                <tr><td height="10"></td></tr>
                                <tr><td height="10"><div class="clsSeparatorTD"></div></td></tr>
                                <tr><td height="10"></td></tr>

                                <tr>
                                    <td class="clsBoldInputLabelTD">
                                            <apex:outputLabel styleClass="slds-form-element__legend" value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__ProvideInformation__c.label}"
                                        />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <apex:outputLabel styleClass="labelstyler displayOptionInfo" value="{!$Label.bmcservicedesk__provideinstruction}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td height="6"></td>
                                </tr>
                                <tr>
                                    <td class="clsPanelInputCheckboxTDSA">
                                            <div class="slds-form__row">
                                                <div class="slds-form__item" role="listitem">
                                                    <div class="slds-form-element">
                                                        <span class="slds-checkbox">
                                        <apex:inputCheckbox title="" id="reqDefDateReq" value="{!reqDefBean.dateRequired}" />
                                                            <apex:outputLabel for="reqDefDateReq" styleClass="slds-checkbox__label">
                                                                <span class="slds-checkbox--faux"></span>
                                                                <span class="slds-form-element__label">{!$Label.reqdefdatereq}</span>
                                                            </apex:outputLabel>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td height="6"></td>
                                </tr>
                                <tr>
                                    <td class="clsPanelInputCheckboxTDSA">
                                            <div class="slds-form__row">
                                                <div class="slds-form__item" role="listitem">
                                                    <div class="slds-form-element">
                                                        <span class="slds-checkbox">
                                        <apex:inputCheckbox title="" id="reqDefQuantity" value="{!reqDefBean.quantity}" />
                                                            <apex:outputLabel for="reqDefQuantity" styleClass="slds-checkbox__label">
                                                                <span class="slds-checkbox--faux"></span>
                                                                <span class="slds-form-element__label">{!$Label.reqdefquantity}</span>
                                                            </apex:outputLabel>
                                                        </span>
                                            
                                                    </div>
                                                </div>
                                            </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td height="6"></td>
                                </tr>
                                <tr>
                                    <td class="clsPanelInputCheckboxTDSA">
                                            <div class="slds-form__row">
                                                <div class="slds-form__item" role="listitem">
                                                    <div class="slds-form-element">
                                                        <span class="slds-checkbox">
                                            <apex:inputCheckbox title="" id="reqDefAttachment" value="{!reqDefBean.attachment}" 
                                                            onclick="enableRequiredAttachment();"
                                                            />
                                                            <apex:outputLabel for="reqDefAttachment" styleClass="slds-checkbox__label">
                                                                <span class="slds-checkbox--faux"></span>
                                                                <span class="slds-form-element__label">{!$Label.attachments}</span>
                                                            </apex:outputLabel>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td height="6"></td>
                                </tr>
                                <tr>
                                    <td class="clsPanelInputCheckboxTDSA">
                                            <div class="slds-form__row">
                                                <div class="slds-form__item" role="listitem">
                                                    <div class="slds-form-element">
                                            
                                                        <span class="slds-checkbox" style="margin-left: 27px;">
                                            <apex:inputCheckbox title="" id="reqDefAttachmentRequired" value="{!reqDefBean.attachmentRequired}"/>
                                                            <apex:outputLabel for="reqDefAttachmentRequired" styleClass="slds-checkbox__label">
                                                                <span class="slds-checkbox--faux"></span>
                                                                <span class="slds-form-element__label">{!$Label.requiredattachmentchkbox}</span>
   															</apex:outputLabel>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                    </td>
                                </tr>
                                <tr><td height="10"></td></tr>
                                <tr><td height="10"><div class="clsSeparatorTD"></div></td></tr>
                                <tr><td height="10"></td></tr>

                                <tr>
                                    <td class="clsBoldInputLabelTD">
                                            <apex:outputLabel styleClass="slds-form-element__legend" value="{!$Label.bmcservicedesk__reqdefpricequantityforstafflabel}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td height="6"></td>
                                </tr>
                                <tr>
                                    <td class="clsPanelInputCheckboxTDSA">
                                            <div class="slds-form__row">
                                                <div class="slds-form__item" role="listitem">
                                                    <div class="slds-form-element ">
                                                        <span class="slds-checkbox">
                                        <apex:inputCheckbox title="" id="reqDefpriceQuantityForStaff" value="{!reqDefBean.priceQuantityForStaff}" />
                                                            <apex:outputLabel for="reqDefpriceQuantityForStaff" styleClass="slds-checkbox__label">
                                                                <span class="slds-checkbox--faux"></span>
                                                                <span class="slds-form-element__label">{!$Label.reqdefpricequantityforstaff}</span>
                                                            </apex:outputLabel>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td height="11"></td>
                                </tr>
                            </table>
                            <script>
                                var inactiveValue = '{!reqDefBean.isInActive}';
                                var prefixPromptValue = {!reqDefBean.reqDefObj.BMCServiceDesk__Prefix_Prompt_to_user_input__c};
                            </script>
                        </apex:outputPanel>
                    </div>
                </tr>
            </table>

        </div>
        
        <apex:outputPanel id="apexMessageErrorPanel" >
         <div id="apexMessageErrorPanelDiv" style="display:none;">
            <apex:messages />
        </div>
     </apex:outputPanel>
     
     <!--  
         Input hidden, contains changed/rearranged ordered string for request inputs
     -->
    <apex:inputHidden value="{!reqDefBean.reqInputOrderStr}" id="reqInputOrder"/>
    
	<apex:actionFunction name="toggleReqDefObjActivation" action="{!activateReqDefObj}" rerender="activateBtn" oncomplete="toggleReqDefActivation()"/>
    <apex:actionRegion >
        <apex:actionFunction name="addProcessTemplateAction" action="{!addTemplate}" rerender="processTemplateStore, mappingDataPanel,validationComponent" oncomplete="setProcessData();showError();">
            <apex:param name="templateId" value="" assignTo="{!reqDefBean.newTemplateId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="removeProcessAction" action="{!removeProcess}" rerender="processTemplateStore, mappingDataPanel, inputMappingStore, validationComponent" oncomplete="setProcessData();setInputMappingData();showError();hideLoadingMask();">
            <apex:param name="templateId" value="" assignTo="{!reqDefBean.delTemplateId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="removeRequestInputAction" action="{!removeRequestInput}" rerender="requestInputStore, mappingDataPanel, inputMappingStore, validationComponent" oncomplete="setInputData();setInputMappingData();showError();addInputBtnHandler();hideLoadingMask();">
            <apex:param name="reqInputId" value="" assignTo="{!reqDefBean.requestInputId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="updateInputDataAction" action="{!resetInputData}" rerender="requestInputStore, mappingDataPanel, validationComponent" oncomplete="setInputData();showError();"/>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="addMappingAction" action="{!addInputMapping}" rerender="inputMappingStore, processVarStore, validationComponent" oncomplete="setInputMappingData();setProcessVarData();showError();hideLoadingMask();">
            <apex:param name="mapProcessId" value="" assignTo="{!reqDefBean.mapProcessId}"/>
            <apex:param name="mapReqInputIds" value="" assignTo="{!reqDefBean.mapReqInputIds}"/>
            <apex:param name="mapProcessVar" value="" assignTo="{!reqDefBean.mapProcessVarId}"/>
            <apex:param name="delProcessId" value="" assignTo="{!reqDefBean.mappingIds}" />
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="removeInputMappingAction" action="{!removeInputMapping}"  rerender="inputMappingStore, processVarStore, validationComponent" oncomplete="setInputMappingData();setProcessVarData();showError();hideLoadingMask();">
            <apex:param name="processVariable" value="" assignTo="{!reqDefBean.processVariable}"/>
            <apex:param name="processTemplate" value="" assignTo="{!reqDefBean.processTemplate}"/>
            <apex:param name="mapProcessId" value="" assignTo="{!reqDefBean.mappingIds}" />
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="updateProcessVarAction" action="{!resetProcessVarData}" rerender="processVarStore" oncomplete="setProcessVarData();setInputMappingData();hideLoadingMask();">
            <apex:param name="processVarTemplateId" value="" assignTo="{!reqDefBean.processVarTemplateId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
	<apex:actionFunction name="deleteFulfillmentCriteria" action="{!deleteFulfillmentCriteria}" rerender="afterSavePanel,criteriaTextDiv" oncomplete="hideLoadingMask();">
		<apex:param assignTo="{!reqDefBean.reqDefObj.FKLookupFilter__c}" name="LKfilterId" value="" />
    </apex:actionFunction>
    </div>
    </apex:form>
    <apex:outputPanel id="afterSavePanel">
        <script>
			var recordID='{!reqDefBean.reqDefObj.Id}';
      errormsg = '{!JSENCODE(reqDefBean.messageString)}';       
      targetInDays= '{!reqDefbean.targetInDays}';
      targetInHours= '{!reqDefbean.targetInHours}';
  	  var directLink = '{!JSENCODE(reqDefBean.directLink)}';
  	  
	  newTitle = '{!JSENCODE(reqDefBean.reqDefObj.serviceRequestTitle__c)}';      
      reDefId= '{!reqDefBean.reqDefObj.id}';
	  LKfilterId= '{!reqDefBean.reqDefObj.FKLookupFilter__c}';
	  var TextLink = document.getElementById('PopupLink');
	  if(LKfilterId == null || LKfilterId == ''){
		if(typeof(TextLink) != 'undefined' && typeof(TextLink.innerText) != 'undefined')
			TextLink.innerText = labelNew;
		else
			TextLink.textContent = labelNew;
		document.getElementById('DeleteLink').style.display = 'none';
		document.getElementById('CriteriaText').style.width = '87.5%';		
	  }
	  else{
		if(typeof(TextLink) != 'undefined' && typeof(TextLink.innerText) != 'undefined')
			TextLink.innerText = labelEdit;
		else
			TextLink.textContent = labelEdit;
		document.getElementById('DeleteLink').style.display = 'inline-block';
		document.getElementById('CriteriaText').style.width = '83.5%';
	  }	
		
        function callCopyPage(){
            window.parent.addTab("RequestDefPage?copyId=" + reDefId,reqDefWindowHeader,reqDefWindowHeader);
        }
      prevProcessTemplateId = '{!reqDefBean.prevProcessTemplateId}';
      deletedProcessId = '{!deletedId}';
      
      function handleSave(){
            window.parent.handleSave(getWID(), reDefId);
            
      }
      if(directLink!=null && directLink!=undefined && directLink!=''){
                document.getElementById('ReqDef_DirectLinkTR').style.display = 'block';
      }
      else{
      	document.getElementById('ReqDef_DirectLinkTR').style.display='none';
      }

        var description_RichText = document.getElementById('{!$Component.ReqDefForm.ReqDef_Description_RichText}').value;
        var userInstructions_RichText = document.getElementById('{!$Component.ReqDefForm.ReqDef_UserInstructions_RichText}').value;  
        function setDescriptionFields(isUsrInstruction){               
            if(isUsrInstruction){
                document.getElementById('{!$Component.ReqDefForm.ReqDef_UserInstructions_RichText}').value = userInstructions_RichText;
            }else{
                document.getElementById('{!$Component.ReqDefForm.ReqDef_Description_RichText}').value = description_RichText ;
            }
        }
      </script>

     </apex:outputPanel>
	 <apex:outputPanel id="NextPreviousButtonPanel">
      <script>
      	secondRun = false;
      	currentConfig = 'SelfService';
     </script>
      </apex:outputPanel>
     <apex:outputPanel id="accountEntitlementPanel">
        <script>
          var accSearchData = '';
          preFirstBtn = !{!IF(paginator.hasPrevious,'true','false')};
          nextLastBtn = !{!IF(paginator.hasNext,'true','false')}; 
        if(currentConfig == 'RemedyforceConsole'){
     		accSearchData = [{!reqDefBean.console_unSelectedAccounts}];
	    }else{
	        accSearchData = [{!reqDefBean.unSelectedAccounts}];            
	    }
        </script>
     </apex:outputPanel>
    
     <apex:outputPanel id="entitlementDataPanel">
        <script>
        var errorMsg  = '{!reqDefBean.messageString}';
        if(errorMsg == '' || errorMsg == labelSavedSuccessfully){
            console_allAccountInputOption = '{!reqDefBean.reqDefObj.BMCServiceDesk__AllAccount_ConsoleConfiguration__c}';
            var AllAccountCon = document.getElementById('thePage:ReqDefForm:AllAccountCon');
            //AllAccountCon is hidden field to set the value to controller
            if(console_allAccountInputOption.toLowerCase() == 'true'){
                AllAccountCon.value = true;
            }else{
                AllAccountCon.value = false;
            }
        	if(currentConfig == 'RemedyforceConsole'){
        		
	       		console_entitlementOptionSelected = '{!JSENCODE(reqDefBean.console_entiltementOption)}';
		        console_allAccountInputOption = '{!reqDefBean.reqDefObj.BMCServiceDesk__AllAccount_ConsoleConfiguration__c}';
		        
	            console_permissionsetRightStoreData = [{!reqDefBean.console_selectedPermissionsets}];
	            console_permissionsetLeftStoreData = [{!reqDefBean.console_unSelectedPermissionsets}];
	            
	            console_profileRightStoreData = [{!reqDefBean.console_selectedProfiles}];
	            console_profileLeftStoreData = [{!reqDefBean.console_unselectedProfiles}];
	            
	            console_accRightStoreData = [{!reqDefBean.console_selectedAccEnt}];
	            console_accLeftStoreData = [{!reqDefBean.console_unSelectedAccounts}];
	            restrictCheckboxValue = {!reqDefBean.restrictSRFromStaff};
	               
	     	}else{
	         	entitlementOptionSelected = '{!JSENCODE(reqDefBean.entiltementOption)}';
		        allAccountInputOption =  '{!reqDefBean.reqDefObj.BMCServiceDesk__AllAccounts__c}';  
	         
	            permissionsetRightStoreData = [{!reqDefBean.selectedPermissionsets}];
	            permissionsetLeftStoreData = [{!reqDefBean.unSelectedPermissionsets}];
	            
	            profileRightStoreData = [{!reqDefBean.selectedProfiles}];
	            profileLeftStoreData = [{!reqDefBean.unselectedProfiles}];
	            
	            accRightStoreData = [{!reqDefBean.selectedAccEnt}];
	            accLeftStoreData = [{!reqDefBean.unSelectedAccounts}];            
	            
	         }
        }
        function callToggleAccountSelector() {
        	if(currentConfig == 'RemedyforceConsole')
            	toggleAccountSelector(console_allAccountInputOption);   
            else
            	toggleAccountSelector(allAccountInputOption);  
        }
        function callEntitlementSelector() {
        	if(currentConfig == 'RemedyforceConsole')
           		 entitlementSelector(console_entitlementOptionSelected);
           	else
           		entitlementSelector(entitlementOptionSelected);
           	
        }
        function getPreFirstBtn(){
            var preFirstBtn = !{!IF(paginator.hasPrevious,'true','false')};                    
            return preFirstBtn;
        }
        function getNextLastBtn(){
            var nextLastBtn = !{!IF(paginator.hasNext,'true','false')};          
            return nextLastBtn;
        }
        </script>
     </apex:outputPanel>
    <script>
        var endtime1 = '{!endtime}';
        var etestdate = new Date();
        var etesttime = etestdate.getTime();
        
        servertime1 = (endtime1 - stime);
        
        data +=servertime1;
        data += '<br>';
        
            //time to calculate page rendertime 
            var pageloaddate = new Date();
            var renderingstartitme = pageloaddate.getTime();
            
        
     </script>
     
     <script>
            var dirtyFlag;
            var disabled = false; 
			var fulfillmentBtn = document.getElementById('ReqDef_Fulfillment');
			var inputbtn = document.getElementById('ReqDef_Input');
           if(reDefId == ''){
                 disabled = true ;
                 fulfillmentBtn.style.color='#808080';
                 fulfillmentBtn.style.cursor='default';
                 inputbtn.style.color='#808080';
                 inputbtn.style.cursor='default';
                 document.getElementById('{!$Component.ReqDefForm.ReqDef_Title}').focus();
           }
        function enablebtn(isWizard) {
			var errorMsgDiv = document.getElementById('errorMessageDiv');
            if(errorMsgDiv)
                errorMsgDiv.setAttribute('style','display:none;');
        	if(errormsg == labelSavedSuccessfully && disabled == true){
				fulfillmentBtn.disabled = false ;
				fulfillmentBtn.style.color = '#004376';
				fulfillmentBtn.style.cursor='pointer';
				inputbtn.disabled = false ;
				inputbtn.style.color = '#004376';
				inputbtn.style.cursor='pointer';
				buttonHandler('/apex/FulfillmentInputDetailPage?requestId='+reDefId+'&isInputCreateable='+isInputCreateable,'490');
				if(isWizard){
					goToSRDStep(1);
				}
            }
			hideLoadingMask();
		}
           checkPermissions();
           function getExecOrderEle(){
           	return document.getElementById('{!$Component.ReqDefForm.RequestDefinition__c_id_Set_Execution_Order__c}');
           }		   

          var businessServiceName;
          if({!isFlattenedCmdb}){
            businessServiceName = '{!$Component.ReqDefForm.BMC_BaseElement__c_id_name__c}'; 
          }else{
            businessServiceName = '{!$Component.ReqDefForm.BMC_BusinessService__c_id_instance_name__c}';
        }
          var SRTemplateId = '{!$Component.ReqDefForm.SYSTemplate__c_id_id}';
          var SRTemplatename = '{!$Component.ReqDefForm.SYSTemplate__c_id_name}';
          var INTemplateId = '{!$Component.ReqDefForm.SYSTemplate__c_id__inc_id}';
          var INTemplatename = '{!$Component.ReqDefForm.SYSTemplate__c_id__inc_name}';
          var categoryId = '{!$Component.ReqDefForm.Category__c_id_name}';
          var Templatepage = '{!$Page.Templatepage}';
		  var serviceName='{!JSENCODE(reqDefBean.businessServiceName)}';
          var refVal='{!JSENCODE(reqDefBean.reqDefObj.FKBusinessService__c)}';
          var CloseWindowLabel = '{!JSENCODE($Label.CloseWindow)}';
          var closeWindowLabelMsg = '{!JSENCODE($Label.CloseWindowLabel)}';
          var serviceValue= document.getElementById('{!$Component.ReqDefForm.BMC_BaseElement__c_id_name__c}').value;
          var serviceOfferingValue = document.getElementById('{!$Component.ReqDefForm.BMC_BaseElement__c_id_name__c__x_1}').value;
          var serviceOfferingName = '{!JSENCODE(reqDefBean.ServiceOfferingName)}';
		  
		  function onServiceChange(){ 
                 
              var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}'); 
              if(tempEl!=null&&serviceName!=tempEl.value){ 
                   clearOffering(); 
                   serviceName=tempEl.value; 
              }                   
          } 

		  function clearOffering(){
              document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c__x_1}').value='';
          }
		  
		  function setServiceName(){
				var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
				if(tempEl!=null&&serviceName!=tempEl.value)
					serviceName=tempEl.value;                          
          }    
		  
		  function setSubServiceId(){
			var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
			if(tempEl!=null&&serviceName!=tempEl.value)
				serviceName=tempEl.value;
			tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id}');
			if(tempEl!=null&& refVal!=tempEl.value)
				refVal=tempEl.value;
			tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c__x_1}');
			if(tempEl!=null&&serviceOfferingName!=tempEl.value)
                serviceOfferingName=tempEl.value; 
		  }	       
        function setDirtyFlag(value)
        {
            dirtyFlag=value;
        }
        function showWarningOnClose()
        {
			var wid = getWID();
				if (window.parent.changeArray[getWID()] != null && typeof(window.parent.changeArray[getWID()]) != 'undefined' && window.parent.changeArray[getWID()] != -1 ){
						showLightningPopup('modal',CloseWindowLabel,closeWindowLabelMsg,labelNo,labelYes,'SRDForm','closeHandler');
					}
				else{
						window.parent.closeTab(wid);
				}
        }         
        function openCreateNewPopup(popupFor)
        {
            var link;
            var height;
            var width;
            var title;
            if(popupFor=='INC Template')
            {
                height=450;
                width=800;
                title = '{!JSENCODE($Label.Create_New)} {!JSENCODE($Label.IncidentTemplate)}';
                link='TemplatePage?standardLayout=true&id=&columnField=Name&direction=ASC&wid=2&isFromSRD=true&TemplateFor=Incident';
                var INCTemplateName =  document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_name}').value;
                if(INCTemplateName =='' || INCTemplateName ==null)
                    onCompleteFunction=updatetIncidenttemplatevalues; 
                else
                    onCompleteFunction=null;    
            }
            if(popupFor=='SR Template')
            {
                var incidenttemplId= document.getElementById(INTemplateId).value;
                var incidenttemplName= document.getElementById(INTemplatename).value;
				link='TemplatePage?standardLayout=true&id=&columnField=Name&direction=ASC&wid=2&isFromSRD=true';
				link+='&TemplateFor=rd&incid='+incidenttemplId+'&incname='+encodeURIComponent(incidenttemplName);
				height=450;
				width=800;
				title='{!JSENCODE($Label.Create_New_Request_Defination_Template)}';
				var SRTemplateValue=  document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value;
				if(SRTemplateValue==null || SRTemplateValue=='')
					onCompleteFunction=updatetSRtemplatevalues;
				else
					onCompleteFunction = null;
			}
            if(popupFor == 'Category')
			{
                link = 'CategoryPage?isFromSRD=true';
                height = 450;
                width = 800;
                title = '{!JSENCODE($Label.Create_New)} {!JSENCODE($Label.AdminCategory)}';
                var categoryName = document.getElementById('{!$Component.ReqDefForm.Category__c_id_name}').value;
                if(categoryName=='' || categoryName==null)
                    onCompleteFunction = openCategoryPage;
                else    
                    onCompleteFunction = null;
            }
            showLightningPopup('vfModalPage', title, link, height, width);
        }
        var INCValue;
        function getIncValue()
        {
            return document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_name}').value;
        }
        
        function clearSRTemplate()
        {
            document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value='';
            document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_id}').value='';
        }
        function clearAssociatedIdsInc()
        {
            var incTemplateValue= getIncValue();
            if(incTemplateValue=='' || incTemplateValue==null)
            {
                clearSRTemplate();
                document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_id}').value='';
            }
        }
        function fetchDataForSR(event)
        {
            var SRTemplateValue = document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value;
            if(SRTemplateValue!= null && SRTemplateValue!='')
                showalldata(event,OncompleteUpdateIncTemplate,escape('(templateFor__c=\'Request Detail\')'));
        }
        function clearAssociatedIdsSR()
        {
            var SRTemplateValue = document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value;
            if(SRTemplateValue =='' || SRTemplateValue ==null)
            {
                document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_id}').value='';
            }
        }
                       
        var setLookupCriteriaID;
        function assignLookupCriteriaID(LookupCriteriaID){ 
             setLookupCriteriaID=LookupCriteriaID;
         }
         function onCompleteSetIncident(returnValue)
         {
             var incId=document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_id}').value;
             var originalValueIncTemplate='{!JSENCODE(reqDefBean.IncidentTemplateName)}'; //value stored at server
             if(originalValueIncTemplate!=returnValue) //New Value for Inc Template
                 clearSRTemplate();
             if(returnValue=='' || returnValue==null) 
              {          
             
                  clearAssociatedIdsInc();
              }
         }
     </script>
</html>
</apex:page>