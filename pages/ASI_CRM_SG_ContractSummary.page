<!--
/*********************************************************************************
 * Name: ASI_CRM_SG_ContractSummary
 * Description: Display Contract Summary in PDF
 *
 * Version History
 * Date             Developer               Comments
 * ---------------  --------------------    --------------------------------------------------------------------------------
 * 2017-01-10		Laputa: Vincent			Create
 * 2017-11-07       Jeffrey Cheung          Update view, use apex:dataTable to dry up code
 * 2018-03-27       Laputa: Vincent         [VL 1.0] ICM117657570 : use new field to store RTM wholesaler margin
 */
-->
<apex:page renderAs="Pdf"
           standardController="ASI_TH_CRM_Contract__c"
           extensions="ASI_CRM_SG_ContractSummary"
           action="{!init}"
           Title="SG Contract Summary"
           showHeader="false" applyHtmlTag="false" applyBodyTag="false" docType="html-5.0">
	<html>
    <head>
        <style>
            @page {
                @top-center {
                    content: element(header);
                }
                @bottom-right {
                    content: element(footer);
                } 
                size: A4 landscape;
                margin: 1cm;
                //margin to be set here on later stages.
            }
            div.header {
                padding: 10px;
                position: running(header);
            }
            div.footer {
                display: block;
                padding: 15px;
                position: running(footer);
            }
            .pagenumber:before {
                content: counter(page);
                font-weight: bold;
                background-color: #C0C0C0;
            }
            .pagecount:before {
                content: counter(pages);
                font-weight: bold;
                background-color: #C0C0C0;
            }
            body {
                font-family: Arial, Helvetica,sans-serif;
                font-size: 12px;
                line-height: 130%;
            }
            sup {
                font-weight: normal;
                font-size: 91%;
            }
            span {
            	font-family: Arial Unicode MS;
            }
            .heading {
                text-align : center !important;
                font-weight: bold;
                text-decoration: underline;
            }
            .wholesaler {
                border-collapse: collapse;
                border-width: 1px;
                border-color: #111;
                width: 75%;
            }
            .internalHeading {
                font-weight: bold;
                text-decoration: underline;
            }
            .bodyText {
                text-align : justify !important;
            }
            .boldText {
                vertical-align: text-top;
                font-weight: bold;
            }
            tr.border-bottom-header td{
            	border-bottom:2pt solid black;
            }
            tr.border-bottom-field td{
            	border-bottom:1px solid #EDEAE9;
            }
            tr.border-field td{
            	border:1px solid #EDEAE9;
            }
            tr.border-field th{
            	border:1px solid #EDEAE9;
            }
            .text-right{
                text-align: right;
            }
        </style>
    </head>
    <body>
		<h1>For {!IF(external, 'External', 'Internal')} Discussion Only</h1>
        <table style="width:100%; padding:15px; " cellpadding="5">
            <colgroup>
                <col span="1" style="width: 15%;padding-left:5px;"/>
                <col span="1" style="width: 35%;padding-left:5px;"/>
                <col span="1" style="width: 15%;padding-left:5px;"/>
                <col span="1" style="width: 35%;padding-right:5px;"/>
            </colgroup>
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">{!CorP} Detail</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Outlet</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.name}</td>
                	<td class="boldText">Contract No.</td>
                    <td>{!Contract.name}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Owner</td>
                    <td>{!Contract.owner.firstname} {!Contract.owner.lastname}</td>
                	<td class="boldText">Converted From</td>
                    <td>{!Contract.ASI_CRM_Converted_From__r.name}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Remarks</td>
                    <td>{!Contract.ASI_CRM_Remarks__c}</td>
                	<td class="boldText">Original Version</td>
                    <td>{!Contract.ASI_CRM_Original_Version__r.name}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">{!IF(existBeforeRTM,'','Type')}</td>
                    <td>{!IF(existBeforeRTM,'',Contract.ASI_CRM_Type__c)}</td>
                	<td class="boldText">Version</td>
                    <td>{!Contract.ASI_CRM_Version__c}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">Contract Status</td>
                    <td>{!Contract.ASI_TH_CRM_Contract_Status__c}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">Start Date</td>
                    <td>
                        <apex:outputtext value="{0,date,dd/MM/YYYY}"> 
                        <apex:param value="{!Contract.ASI_TH_CRM_Start_Date__c}" />
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">End Date</td>
                    <td>
                        <apex:outputtext value="{0,date,dd/MM/YYYY}"> 
                            <apex:param value="{!Contract.ASI_TH_CRM_End_Date__c}" />
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">Early Contract Completed</td>
                    <td>{!if(Contract.ASI_CRM_Early_Contract_Completed__c,"Yes","No")}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">Contract Period Extended</td>
                    <td>{!if(Contract.ASI_CRM_Contract_Period_Extended__c,"Yes","No")}</td>
                </tr>
                <tr>
                    <td></td>
                </tr>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Outlet Detail</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Legal Outlet Name</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_Legal_Outlet_Name__c}</td>
                	<td class="boldText">Owner</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.owner.firstname} {!Contract.ASI_CRM_CN_Outlet_WS__r.owner.lastname}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Business Registration Number</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_Business_Registration_Number__c}</td>
                	<td class="boldText">Customer Code</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_MY_CustomerCode__c}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Is Parent Account</td>
                    <td>{!if(Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_IsParentAccount__c,'Yes','No')}</td>
                	<td class="boldText">Active</td>
                    <td>{!if(Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Inactive_Flag__c,'No','Yes')}</td>
                </tr><!--
                <tr class="border-bottom-field">
                	<td class="boldText">Parent Outlet</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Parent_Outlet__r.name}</td>
                	<td class="boldText"></td>
                    <td></td>
                </tr>-->
                <tr class="border-bottom-field">
                	<td class="boldText">Main Sector</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_SG_Main_Sector__c}</td>
                	<td class="boldText">{!IF(existBeforeRTM,'','Type')}</td>
                    <td>{!IF(existBeforeRTM,'',Contract.ASI_CRM_Type__c)}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Outlet Capacity</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_SG_Outlet_Capacity__c}</td>
                	<td class="boldText"></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                </tr>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Outlet Basic Information</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Address Line 1</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_JP_City_Ward__c}</td>
                	<td class="boldText">Phone Number</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Phone_Number__c}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Address Line 2</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_JP_Town__c}</td>
                	<td class="boldText">Fax Number</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Fax_Number__c}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Address Line 3</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_Street_Number__c}</td>
                	<td class="boldText">Sector Code</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_SG_Category_Code_13__c}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Postal Code</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_PostalCode__c}</td>
                	<td class="boldText"></td>
                    <td></td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Area</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_SG_Area__c}</td>
                	<td class="boldText"></td>
                    <td></td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Location</td>
                    <td>{!Contract.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_SG_Location__c}</td>
                	<td class="boldText"></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(external,'display:none;','')}" cellpadding="5">
            <colgroup>
                <col span="1" style="width: 15%;padding-left:5px;"/>
                <col span="1" style="width: 35%;padding-left:5px;"/>
                <col span="1" style="width: 15%;padding-left:5px;"/>
                <col span="1" style="width: 35%;padding-right:5px;"/>
            </colgroup>
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Marketing A&amp;P Support</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Anniversary</td>
                    <td>{!if(Contract.ASI_CRM_SG_Anniversary__c,'Yes','No')}</td>
                	<td class="boldText">Anniversary Amount</td>
                    <td>{!ROUND(Contract.ASI_CRM_SG_Anniversary_Amount__c,2)}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Training</td>
                    <td>{!if(Contract.ASI_CRM_SG_Training__c,'Yes','No')}</td>
                	<td class="boldText">Training Amount</td>
                    <td>{!ROUND(Contract.ASI_CRM_SG_Training_Amount__c,2)}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">POSM</td>
                    <td>{!if(Contract.ASI_CRM_SG_POSM__c,'Yes','No')}</td>
                	<td class="boldText">POSM Amount</td>
                    <td>{!ROUND(Contract.ASI_CRM_SG_POSM_Amount__c,2)}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Events</td>
                    <td>{!if(Contract.ASI_CRM_SG_Events__c,'Yes','No')}</td>
                	<td class="boldText">Events Amount</td>
                    <td>{!ROUND(Contract.ASI_CRM_SG_Events_Amount__c,2)}</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">Total Marketing A&amp;P Support</td>
                    <td>{!ROUND(Contract.ASI_CRM_SG_Total_Marketing_A_P_Support__c,2)}</td>
                </tr>
                <tr>
                    <td></td>
                </tr>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Summary</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Inflation Rate</td>
                    <td>{!Contract.ASI_CRM_Inflation_Rate__c}%</td>
                	<td class="boldText">Distribution Rate</td>
                    <td>{!Contract.ASI_CRM_Distribution_Rate__c}%</td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Total Sales Target Case</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_TotalSalesTargetCase__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Total Free Goods (Cases)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Free_Goods_Cases__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Total Contract Margin</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Contract_Margin__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Total Cash/Goods-in-kind Sponsorship</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_TotalCashGoodsinkindSponsor__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Total Cash Sponsorship</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Cash_Sponsorship__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Net Sales</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Net_Sales__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Total Cash Sponsorship (Cash)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_Total_Cash_Sponsorship_Cash__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Return on Investment</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Return_on_Investment__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Total Trade A&amp;P - (FOC: WS-Ontrade SP)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_TotalTradeAPFOCWSOntradeSP__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Total Volume (Cases)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Volume_Cases__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Trade A&amp;P - Total -PRS</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Trade_A_P_PRS__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Sales Revenue Target</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_Sales_Revenue_Target__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td class="boldText">Total Investment Value for PRS</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_TotalInvestment_Value_for_PRS__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Total Free Goods (Value)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_Total_Free_Goods_Value__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field" style="{!if(external,'display:none;','')}">
                	<td class="boldText">Total Target Sales (9L Cases)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Target_Sales_9L_Cases__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText">Total Free Goods (9L Cases)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Free_Goods_9L_Cases__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field" style="{!if(external,'display:none;','')}">
                	<td class="boldText"></td>
                    <td></td>
                	<td class="boldText">Total Volume (9L Cases)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_SG_Total_Volume_9L_Cases__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <table style="width:100%; padding:15px; {!if(CorP='Proposal','display:none;','')}" cellpadding="5">
            <colgroup>
                <col span="1" style="width: 15%;padding-left:5px;"/>
                <col span="1" style="width: 35%;padding-left:5px;"/>
                <col span="1" style="width: 15%;padding-left:5px;"/>
                <col span="1" style="width: 35%;padding-right:5px;"/>
            </colgroup>
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Performance</td>
                </tr>
                <tr class="border-bottom-field">
                	<td style="{!if(external,'display:none;','')}" class="boldText">Return On Investment (Actual)</td>
                    <td style="{!if(external,'display:none;','')}">
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_Return_On_Investment_Actual__c}"/>
                        </apex:outputText>
                    </td>
                	<td style="{!if(external,'display:none;','')}" class="boldText">Sales Revenue</td>
                    <td style="{!if(external,'display:none;','')}">
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_Sales_Revenue__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr class="border-bottom-field">
                	<td style="{!if(external,'display:none;','')}" class="boldText">ROI % (Actual)</td>
                    <td style="{!if(external,'display:none;','')}">{!Contract.ASI_CRM_ROI_Percent_Actual__c}%</td>
                	<td class="boldText">Till Date Sales Revenue % Achieved</td>
                    <td>{!Contract.ASI_CRM_Till_Date_Sales_Percent_Achieved__c}%</td>
                </tr>
                <tr class="border-bottom-field" style="{!if(external,'display:none;','')}">
                	<td class="boldText">Till Date Sales Volume (9L)</td>
                    <td>
                        <apex:outputText value="{0,number, ###,##0.00}">
                        	<apex:param value="{!Contract.ASI_CRM_Till_Date_Sales_Volume_9L__c}"/>
                        </apex:outputText>
                    </td>
                	<td class="boldText"></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        
        <!-- SKU tab -->
        <table style="width:100%; padding:15px;" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - SKU</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px;" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
					<!--
                    <th style="">SKU</th>
                    <th style="{!if(external,'display:none;','')}">Product</th>
					-->
                    <th style="">Product</th>
                    <th style="">Package Size</th>
                    <th style="" align="right">Sales (Cases)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Sales (9L)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Duty (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">FOB (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Handling Cost (S$)</th>
                    <th style="{!if(external || existBeforeRTM,'display:none;','')}" align="right">Total COGS (S$)</th>
                    <th style="{!if(existBeforeRTM,'display:none;','')}" align="right">WS-OT (S$/Bottle)</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractTarget}" var="data">
                    <tr class="border-field">                        
						<!--
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</td>
                        <td style="{!if(external,'display:none;','')}">{!data.ASI_CRM_Subbrand__r.ASI_MFM_Sub_brand_Description__c}</td>
						-->
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}</td>
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_HK_CRM_Pack_Factor__c}</td>
                        <td style="" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_TargetCase__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Target_Sales_9L_Cases__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Total_Duty__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Total_FOB__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Total_Handling_Cost__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external || existBeforeRTM,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Total_COGS__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(existBeforeRTM,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Selling_Price_Btl_WS_On_Trade__c}"/>
                            </apex:outputText>
                        </td>

                    </tr>
                </apex:repeat>
            </tbody>
            <tfoot>
                <tr class="border-field">
                    <th style="">Total Value:</th>
					<!--
                    <th style="{!if(external,'display:none;','')}"></th>
					-->
                    <th style="" align="right">
                        <!--
						<apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalPackageSize}"/>
                        </apex:outputText>
						-->
                    </th>
                    <th style="" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalSalesCases}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalSales9L}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalDuty}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalFOB}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalHandling}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external || existBeforeRTM,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalTotalCOGS}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(existBeforeRTM,'display:none;','')}" align="right">
                        <!--
						<apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalWSOTPerBottle}"/>
                        </apex:outputText>
						-->
                    </th>

                </tr>
            </tfoot>
        </table>

        <!-- Incentive tab -->
        <!-- Use apex:dataTable to dry up code -->
        <table style="width:100%; padding:15px;{!if(existBeforeRTM,'display:none;','')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - Incentive</td>
                </tr>
            </tbody>
        </table>
        <apex:dataTable value="{!ContractTarget}" var="data" style="width:100%; padding:15px;" cellpadding="5" headerClass="border-bottom-field" footerClass="border-field boldText" rowClasses="border-field" rendered="{!NOT(existBeforeRTM)}">
            <apex:column headerValue="Product" footerValue="Total Value:">
                <apex:outputText >{!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}</apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Wholesaler Margin (S$/Bottle)">
                <apex:outputText value="{0,number, ###,##0.00}">
					<!-- [VL 1.0] BEGIN -->
					<!--
                    <apex:param value="{!data.ASI_CRM_SG_Wholesaler_Margin__c}"/>
					-->
                    <apex:param value="{!data.ASI_CRM_Wholesaler_Margin_RTM__c}"/>
					<!-- [VL 1.0] END -->
                </apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Entitle Back Rebates" rendered="{!NOT(external)}">
                <span style="{!if(!data.ASI_CRM_Entitle_Back_Rebates__c,'display:none;','')}">&#x2714;</span>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Back Rebates (S$/Bottle)" rendered="{!NOT(external) || totalBottleIncentive>0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_Bottle_Incentive__c}"/>
                </apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Back Rebates Total (S$)" rendered="{!NOT(external) || totalBottleIncentive>0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_Bottle_Incentive_Total__c}"/>
                </apex:outputText>
				<apex:facet name="footer">
                    <apex:outputText value="{0,number, ###,##0.00}">
						<apex:param value="{!totalBottleIncentiveTotal}"/>
					</apex:outputText>
                </apex:facet>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Net Price (S$/Bottle)" rendered="{!NOT(external)}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Net_Price__c}"/>
                </apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Cash (S$)" rendered="{!NOT(external) || totalCash>0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Cash__c}"/>
                </apex:outputText>
				<apex:facet name="footer">
                    <apex:outputText value="{0,number, ###,##0.00}">
						<apex:param value="{!totalCash}"/>
					</apex:outputText>
                </apex:facet>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Net Net Price (S$/Bottle)" rendered="{!NOT(external)}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Net_Net_Price__c}"/>
                </apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="A&P Fund (S$)" rendered="{!NOT(external) || totalAdhocMoney > 0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Ad_hoc_Promotions__c}"/>
                </apex:outputText>
				<apex:facet name="footer">
                    <apex:outputText value="{0,number, ###,##0.00}">
						<apex:param value="{!totalAdhocMoney}"/>
					</apex:outputText>
                </apex:facet>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="A&P Fund (Cases)" rendered="{!NOT(external) || totalAdhoc > 0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Anniversary_Free_Bottles__c}"/>
                </apex:outputText>
				<apex:facet name="footer">
                    <apex:outputText value="{0,number, ###,##0.00}">
						<apex:param value="{!totalAdhoc}"/>
					</apex:outputText>
                </apex:facet>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" footerClass="text-right" headerValue="Net Net Price after A&P (S$/Bottle)" rendered="{!NOT(external)}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_Net_Net_Price_After_A_P__c}"/>
                </apex:outputText>
            </apex:column>
        </apex:dataTable>

        <!-- Free Goods tab -->
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - Free Goods</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
                    <th style="">Product</th>
                    <th style="{!if(AND(external,totalSalesIncentive<=0),'display:none;','')}" align="right">Sales Incentive (Given Bottles per Case)</th>
                    <th style="{!if(AND(external,totalManagementIncentive<=0),'display:none;','')}" align="right">Management Incentives (Cases per month)</th>
                    <th style="{!if(AND(external,totalCSTargetIncentive<=0),'display:none;','')}" align="right">Contract Sponsorship / Target Incentive (Total Cases)</th>
                    <th style="{!if(AND(external,totalOthers<=0),'display:none;','')}" align="right">Others (Total Cases)</th>
                    <th style="" align="right">Total Free Goods (Cases)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Total Free Goods (9L)</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractTarget}" var="data">
                    <tr class="border-field">                        
						<!--
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</td>
						-->
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}</td>
                        <td style="{!if(AND(external,totalSalesIncentive<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Sales_Incentive__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalManagementIncentive<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Management_Incentives__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalCSTargetIncentive<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Cont_Sponsor_Target_Incentive__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalOthers<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Others__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Total_Free_Goods_Cases__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Total_Free_Goods_9L_Cases__c}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
        
        <!-- Contract Margin tab -->
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - Contract Margin</td>
                </tr>
            </tbody>
        </table>

        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5" cellspacing="0">
            <thead>
				<!--
                <tr class="border-bottom-field">
                    <th style="">SKU</th>
                    <th style="{!if(AND(external,totalConsumerOffer<=0),'display:none;','')}">Consumer Price Offer (S$ per bottle)</th>
                    <th style="{!if(external,'display:none;','')}">WS - OT Price</th>
                    <th style="{!if(AND(external,totalConsumerOffer<=0),'display:none;','')}">Compensation for WS - Price Difference (S$)</th>
                    <th style="{!if(AND(external,totalWSMargin<=0),'display:none;','')}">Wholesaler Margin (S$ per bottle)</th>
                    <th style="{!if(AND(external,totalWSMargin<=0),'display:none;','')}">Wholesaler Margin Total (S$)</th>
                    <th style="{!if(AND(external,AND(totalConsumerOffer<=0,totalWSMargin<=0)),'display:none;','')}">Wholesaler Margin/ - per 9Lc (S$)</th>
                    <th style="{!if(AND(external,AND(totalConsumerOffer<=0,totalWSMargin<=0)),'display:none;','')}">Contract Margin - Total (S$)</th>
                    <th style="{!if(AND(external,totalBottleIncentive<=0),'display:none;','')}">Bottle Incentive (S$)</th>
                    <th style="{!if(AND(external,totalBottleIncentive<=0),'display:none;','')}">Bottle Incentive - Total (S$)</th>
                </tr>
				-->
                <tr class="border-bottom-field">
                    <th style="">Product</th>
                    <th style="{!if(AND(external,totalConsumerOffer<=0),'display:none;','')}" align="right">Consumer Price Offer (S$ per bottle)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">WS - OT Price</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Compensation for WS - Price Difference (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Wholesaler Margin (S$ per bottle)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Wholesaler Margin Total (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Wholesaler Margin/ - per 9Lc (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Contract Margin - Total (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Bottle Incentive (S$)</th>
                    <th style="{!if(AND(external,totalBottleIncentive<=0),'display:none;','')}" align="right">Bottle Incentive - Total (S$)</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractTarget}" var="data">
					<!--
                    <tr class="border-bottom-field">                        
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</td>
                        <td style="{!if(AND(external,totalConsumerOffer<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Consumer_Price_Offer__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Selling_Price_Btl_WS_On_Trade__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalConsumerOffer<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Compensation_for_WS_Price_Dif__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalWSMargin<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Wholesaler_Margin__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalWSMargin<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Wholesaler_Margin_Total__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,AND(totalConsumerOffer<=0,totalWSMargin<=0)),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Contract_Margin_per_9Lc__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,AND(totalConsumerOffer<=0,totalWSMargin<=0)),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Contract_Margin_Total__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalBottleIncentive<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Bottle_Incentive__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalBottleIncentive<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Bottle_Incentive_Total__c}"/>
                            </apex:outputText>
                        </td>
                    </tr>
					-->
                    <tr class="border-field">         
						<!--
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</td>
						-->
                        <td style="">{!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}</td>
                        <td style="{!if(AND(external,totalConsumerOffer<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Consumer_Price_Offer__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Selling_Price_Btl_WS_On_Trade__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Compensation_for_WS_Price_Dif__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Wholesaler_Margin__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Wholesaler_Margin_Total__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Contract_Margin_per_9Lc__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Contract_Margin_Total__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Bottle_Incentive__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalBottleIncentive<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Bottle_Incentive_Total__c}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
        
        <!-- Cash Sponsorship tab -->
		<!--
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - Cash Sponsorship</td>
                </tr>
            </tbody>
        </table>
        <apex:dataTable value="{!ContractTarget}" var="data" style="width:100%; padding:15px;" cellpadding="5" headerClass="border-bottom-field" rowClasses="border-field" rendered="{!existBeforeRTM && (totalGoodsInKind+totalCash)>0}">
            <apex:column headerValue="SKU" footerValue="Total Value:" rendered="{!NOT(external)}">
                <apex:outputText >{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" headerValue="Good-in-Kinds (S$)" footerValue="{!totalGoodsInKind}" rendered="{!totalGoodsInKind>0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Good_in_Kinds__c}"/>
                </apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" headerValue="Cash (S$)" footerValue="{!totalCash}" rendered="{!totalCash>0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Cash__c}"/>
                </apex:outputText>
            </apex:column>
            <apex:column headerClass="text-right" styleClass="text-right" headerValue="Cash Sponsorship - Total (S$)" footerValue="{!(totalGoodsInKind+totalCash)}" rendered="{!(totalGoodsInKind+totalCash)>0}">
                <apex:outputText value="{0,number, ###,##0.00}">
                    <apex:param value="{!data.ASI_CRM_SG_Cash_Sponsorship_Total__c}"/>
                </apex:outputText>
            </apex:column>
        </apex:dataTable>
		-->
		<table style="width:100%; padding:15px; {!if(!existBeforeRTM || AND(existBeforeRTM, external,notDisplayCSTab),'display:none;','')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - Cash Sponsorship</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(!existBeforeRTM || AND(existBeforeRTM, external,notDisplayCSTab),'display:none;','')}" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
                    <th style="{!if(external,'display:none;','')}">Product</th>
                    <th style="{!if(AND(external,totalGoodsInKind<=0),'display:none;','')}" align="right">Good-in-Kinds (S$)</th>
                    <th style="{!if(AND(external,totalCash<=0),'display:none;','')}" align="right">Cash (S$)</th>
                    <th style="{!if(AND(external,(totalGoodsInKind+totalCash)<=0),'display:none;','')}" align="right">Cash Sponsorship - Total (S$)</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractTarget}" var="data">
                    <tr class="border-field" style="{!if(external,'display:none;','')}">                        
						<!--
                        <td style="{!if(external,'display:none;','')}">{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</td>
						-->
                        <td style="{!if(external,'display:none;','')}">{!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}</td>
                        <td style="{!if(AND(external,totalGoodsInKind<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Good_in_Kinds__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,totalCash<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Cash__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,(totalGoodsInKind+totalCash)<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Cash_Sponsorship_Total__c}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
            </tbody>
            <tfoot>
                <tr class="border-field">
                    <th style="{!if(external,'display:none;','')}">Total Value:</th>
                    <th style="{!if(AND(external,totalGoodsInKind<=0),'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalGoodsInKind}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(AND(external,totalCash<=0),'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalCash}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(AND(external,(totalGoodsInKind+totalCash)<=0),'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!(totalGoodsInKind+totalCash)}"/>
                        </apex:outputText>
                    </th>
                </tr>
            </tfoot>
        </table>


        <!-- AnP tab -->
        <table style="width:100%; padding:15px; {!if(!existBeforeRTM || AND(existBeforeRTM, external,notDisplayAPTab),'display:none;','')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Target - A&amp;P</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(!existBeforeRTM || AND(existBeforeRTM, external,notDisplayAPTab),'display:none;','')}" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
                    <th style="{!if(external,'display:none;','')}">Product</th>
                    <th style="{!if(AND(external,(totalEventCase)<=0),'display:none;','')}" align="right">Events (Total Cases)</th>
                    <th style="{!if(AND(external,(totalEventValue)<=0),'display:none;','')}" align="right">Events (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Signages (Total Cases)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Signages (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Advertising Spot (Total Cases)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Advertising Spot (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Anniversary (Total Cases)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Total Incentive Trips (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Product Branding Display (S$)</th>
                    <th style="{!if(AND(external,(totalAdhoc)<=0),'display:none;','')}" align="right">Ad-hoc Promotions (S$)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Trade Advertising / Promotional - Total (FOC: WS-OT SP)</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Trade Advertising / Promotional - PRS (S$)</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractTarget}" var="data">
                    <tr class="border-field" style="{!if(external,'display:none;','')}">                        
                        <!--
						<td style="{!if(external,'display:none;','')}">{!data.ASI_CRM_SKU__r.ASI_CRM_Short_Description__c}</td>
						-->
                        <td style="{!if(external,'display:none;','')}">{!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}</td>
                        <td style="{!if(AND(external,(totalEventCase)<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Events_Free_Bottles__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,(totalEventValue)<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Events__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Signages_Ad_Spot_Free_Btl__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Signages_Advertising_Spot__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Advertising_Spot_Free_Bottles__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Advertising_Spot__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Anniversary_Free_Bottles__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Trade_Incentive_Trips__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Product_Branding_Display__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(AND(external,(totalAdhoc)<=0),'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Ad_hoc_Promotions__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Trd_Adv_Promo_Total__c}"/>
                            </apex:outputText>
                        </td>
                        <td style="{!if(external,'display:none;','')}" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_SG_Trd_Adv_Promo_TotalPRS__c}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
            </tbody>
            <tfoot>
                <tr class="border-field">
                    <th style="{!if(external,'display:none;','')}">Total Value:</th>
                    <th style="{!if(AND(external,(totalEventCase)<=0),'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalEventCase}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(AND(external,(totalEventValue)<=0),'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalEventValue}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalSignageCase}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalSignageValue}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalASCase}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalASValue}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalAnniversary}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalTradeIncentive}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalProductBranding}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(AND(external,(totalAdhoc)<=0),'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalAdhoc}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalAPWSOT}"/>
                        </apex:outputText>
                    </th>
                    <th style="{!if(external,'display:none;','')}" align="right">
                        <apex:outputText value="{0,number, ###,##0.00}">
                            <apex:param value="{!totalAPPRSWS}"/>
                        </apex:outputText>
                    </th>
                </tr>
            </tfoot>
        </table>
        
        <!-- Payment Schedule tab - Cash -->
        <table style="width:100%; padding:15px; {!if(notDisplayCSTab,'display:none;','')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Payment Schedule - Cash Sponsorship</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(notDisplayCSTab,'display:none;','')}" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
                    <th style="" align="right">Cash Sponsorship (S$)</th>
                    <th style="" align="right">% of Achieved Sales Target</th>
                    <th style="" align="right">Schedule Date</th>
                    <th style="" align="left">Remarks</th>
                    <th style="" align="right">Payment Issued</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!CashSponsorshipSchedule}" var="data">
                    <tr class="border-field">                        
                        <td style="" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Sponsorship__c}"/>
                            </apex:outputText>
                        </td>                       
                        <td style="" align="right">
                            {!data.ASI_CRM_Percentof_achieved_Sales_Target__c}
                        </td>                       
                        <td style="" align="right">
                            <apex:outputText value="{0,date,dd/MM/YYYY}">
                                <apex:param value="{!data.ASI_CRM_Schedule_Date__c}"/>
                            </apex:outputText>
                        </td>                  
                        <td style="" align="left">
                            {!data.ASI_CRM_Remarks__c}
                        </td>    
						<td align="right">
							{!if(data.ASI_CRM_Payment_Issued__c,"Yes","No")}
						</td>
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
        
        <!-- Payment Schedule tab - Contract -->
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Payment Schedule - Contract Sponsorship</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'','display:none;')}" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
                    <th style="" align="right">Free Goods (Act Case)</th>
                    <th style="" align="right">% of Achieved Sales Target</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractSponsorshipSchedule}" var="data">
                    <tr class="border-field">                        
                        <td style="" align="right">
                            <apex:outputText value="{0,number, ###,##0.00}">
                                <apex:param value="{!data.ASI_CRM_Sponsorship__c}"/>
                            </apex:outputText>
                        </td>                       
                        <td style="" align="right">
                            {!data.ASI_CRM_Percentof_achieved_Sales_Target__c}
                        </td>     
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
        
        <!-- Payment Schedule tab - SKU Achievement -->
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'display:none;','')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Payment Schedule - SKU Achievement</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(existBeforeRTM,'display:none;','')}" cellpadding="5" cellspacing="0">
            <thead>
                <tr class="border-bottom-field">
                    <th style="">Product</th>
                    <th style="" align="right">25%</th>
                    <th style="" align="right">50%</th>
                    <th style="" align="right">75%</th>
                    <th style="" align="right">100%</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Achieved</th>
                    <th style="{!if(external,'display:none;','')}" align="right">Issued</th>
                    <th style="" align="right">System Remarks</th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!ContractTarget}" var="data">
                    <tr class="border-field">                        
                        <td style="">
                            {!data.ASI_CRM_SKU__r.ASI_MFM_Sub_brand__r.ASI_MFM_Sub_brand_Description__c}
                        </td>                       
                        <td style="" align="right">
							<span style="{!if(!data.ASI_CRM_Entitle_Back_Rebates__c,'display:none;','')}">&#x2714;</span>
                        </td>
                        <td style="" align="right">
                            <span style="{!if(!data.ASI_CRM_Entitle_Back_Rebates__c,'display:none;','')}">&#x2714;</span>
                        </td>     
                        <td style="" align="right">
                            <span style="{!if(!data.ASI_CRM_Entitle_Back_Rebates__c,'display:none;','')}">&#x2714;</span>
                        </td>     
                        <td style="" align="right">
                            <span style="{!if(!data.ASI_CRM_Entitle_Back_Rebates__c,'display:none;','')}">&#x2714;</span>
                        </td>     
                        <td style="{!if(external,'display:none;','')}" align="right">
                            {!data.ASI_CRM_Till_Date_Sales_Percent_Bottle__c}
                        </td>     
                        <td style="{!if(external,'display:none;','')}" align="right">
                            {!data.ASI_CRM_Back_Rebates_Issued_Percent__c}
                        </td>     
                        <td style="" align="right">
                            {!data.ASI_CRM_System_Remarks__c}
                        </td>     
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
        
        <!-- Contract Outlet tab -->
        <table style="width:100%; padding:15px; {!if(notDisplayCOTab,'display:none;','')}" cellpadding="5">
            <tbody>
                <tr class="border-bottom-header">
                    <td class="boldText" style="font-size:18px" colspan="4">Contract Outlet</td>
                </tr>
            </tbody>
        </table>
        <table style="width:100%; padding:15px; {!if(notDisplayCOTab,'display:none;','')}" cellpadding="5">
            <tbody>
                <apex:repeat value="{!ContractOutlet}" var="data">
                    <tr class="border-bottom-field">  
                        <td style="">
                            {!data.ASI_CRM_SG_Customer__r.name}
                        </td>     
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
    </body>
</html>
</apex:page>