<apex:page showHeader="true" sidebar="true" standardController="Account" extensions="LAT_MX_Account_OnTrade_Controller">
 <Style>
    ul.slds-list--vertical li {
            padding-bottom: 5px;
        }
    .fakeBtn {
        width: 25%;
        text-align:center ;
        padding:6px !important;
        text-decoration: none !important;
        font: 100%/1.5 'Salesforce Sans', Arial, sans-serif !important;
        color: #000 !important;
    }

 </Style>

    <apex:includeScript value="{!$Resource.LAT_Resources}/js/jquery-1.7.1.min.js" />
    <apex:form id="accountOnTrade">
        <apex:sectionHeader title="{!IF(ISBLANK(Account.Name), 'Nuevo', 'Editar')}" subtitle="{!IF(ISBLANK(Account.Name), 'Cliente', Account.Name)}" id="headerTitle"/>
        <apex:pageBlock title="" mode="edit">
            <apex:actionStatus id="status" >
                <apex:facet name="start">
                    <c:LAT_MX_LoadingLayer ImageUrl="{!URLFOR($Resource.LAT_MX_LoadingGif)}" Message="{!$Label.LAT_BR_VFP05_00023}"/>
                    <!-- Label.LAT_BR_VFP05_00023 = Espere... -->
                </apex:facet>
            </apex:actionStatus>
            <apex:pageMessages id="mesages"/>
            <apex:pageBlockButtons location="top">
                <apex:commandButton id="bGuardar" value="Guardar" action="{!Save}" onClick="if(doSaveAcc() === false) { return false; }" status="status" reRender="headerTitle,mesages" />
                <apex:commandButton value="Cancelar" action="{!Cancel}" status="status" reRender="headerTitle,mesages"/>
            </apex:pageBlockButtons>
            <br></br>
            <br></br>
             <apex:pageBlockSection id="pgBlockDatosBasicos" title="Datos Basicos" collapsible="false" columns="2">
                <apex:facet name="header">
                    <h3>Información General<span class="titleSeparatingColon">:</span></h3>
                </apex:facet>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Nombre de Cliente</apex:outputLabel>
                    <apex:inputField id="clientName" value="{!Account.name}" required="true" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Cliente Padre</apex:outputLabel>
                    <apex:inputField id="parent" value="{!Account.parentID}" />
                </apex:pageBlockSectionItem>
                 <apex:pageBlockSectionItem >
                    <apex:outputLabel >Nombre Comercial</apex:outputLabel>
                    <apex:inputField id="nombreComercial" value="{!accFields.LAT_Nombre_Comercial__c}" required="true"/>
                </apex:pageBlockSectionItem>
                 <apex:pageBlockSectionItem />                 
                 <apex:pageBlockSectionItem rendered="{!if(disabled == false, true, false)}">
                    <apex:outputLabel >Ejecutivo responsable</apex:outputLabel>
                    <apex:inputField id="propietario" value="{!Account.ownerID}" required="true" />
                </apex:pageBlockSectionItem>              

                <apex:pageBlockSectionItem rendered="{!if(disabled == true, true, false)}">
                    <apex:outputLabel >Ejecutivo responsable</apex:outputLabel>
                        <apex:outputField value="{!Account.ownerID}" />
                </apex:pageBlockSectionItem>
                <!--
                 <apex:pageBlockSectionItem >
                    <apex:outputLabel >Descripción</apex:outputLabel>
                    <apex:inputField id="descripcion" value="{!Account.Description}"/>
                </apex:pageBlockSectionItem>
                -->
                <apex:pageBlockSectionItem rendered="{!if(disabled == false, true, false)}">
                    <apex:outputLabel >Ejecutivo que lo Atiende</apex:outputLabel>
                    <apex:inputField id="ejecutivoAtiende" value="{!accFields.LAT_MX_AttendingKAM__c}" required="true" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!if(disabled == true, true, false)}">
                   <apex:outputLabel >Ejecutivo que lo Atiende</apex:outputLabel>
                   <apex:outputField id="ejecutivoAtiende" value="{!accFields.LAT_MX_AttendingKAM__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!if(disabled == false, true, false)}">
                    <apex:outputLabel >Grupo</apex:outputLabel>
                    <apex:inputField id="grupo" value="{!Account.LAT_MX_Group__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!if(disabled == true, true, false)}">
                <apex:outputLabel >Grupo</apex:outputLabel>
                    <apex:outputField id="grupo" value="{!Account.LAT_MX_Group__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Status</apex:outputLabel>
                    <apex:inputField id="status" value="{!Account.Status__c}" required="true"/>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="pgBlockSectionDatosComerciales" title="Datos Comerciales" collapsible="false" columns="2">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel id="lMarca1" >Marca de prioridad </apex:outputLabel>
                    <apex:inputField id="fMarca1" value="{!Account.LAT_MX_PriorityBrand_1__c}" required="true"/>
                </apex:pageBlockSectionItem>
                  <apex:pageBlockSectionItem >
                    <apex:outputLabel >Horario Apertura</apex:outputLabel>
                    <apex:inputField id="horarioApertura" value="{!Account.Begin_Time__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel id="lMarca2" >Marca de prioridad 2</apex:outputLabel>
                    <apex:inputField id="fMarca2" value="{!Account.LAT_MX_PriorityBrand_2__c}" />
                </apex:pageBlockSectionItem>
                <!--
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Fecha Apertura</apex:outputLabel>
                    <apex:inputField id="fechaApertura" value="{!accFields.LAT_Fecha_Apertura__c}" />
                </apex:pageBlockSectionItem>
                -->
                <apex:pageBlockSectionItem >
                    <apex:outputLabel id="lMarca3" >Marca de prioridad 3</apex:outputLabel>
                    <apex:inputField id="fMarca3" value="{!Account.LAT_MX_PriorityBrand_3__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Día Relevante</apex:outputLabel>
                    <apex:inputField id="diaRelevante" value="{!accFields.LAT_MX_MejorDia__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Periodicidad de visitas</apex:outputLabel>
                    <apex:inputField id="visita" value="{!accFields.LAT_MX_Periodicity__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Ticket Promedio</apex:outputLabel>
                    <apex:inputField id="ticketPromedio" value="{!Account.LAT_MX_AverageTicket__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Capacidad</apex:outputLabel>
                    <apex:inputField id="capacidad" value="{!accFields.LAT_Capacidad__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Bonifica</apex:outputLabel>
                    <apex:inputField id="bonifica" value="{!Account.LAT_MX_GiveBonus__c}" />
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

            <apex:pageBlockSection id="pgMayoristas" columns="2">
                <apex:pageBlockSectionItem rendered="{!if(disabled == false, true, false)}">
                    <apex:outputLabel >Mayorista 1</apex:outputLabel>
                    <apex:inputField id="mayorista1" value="{!accFields.LAT_MX_FirstSupplyOption__c}" required="true"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!if(disabled == true, true, false)}">
                    <apex:outputLabel >Mayorista 1</apex:outputLabel>
                    <apex:outputField id="mayorista1" value="{!accFields.LAT_MX_FirstSupplyOption__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!if(disabled == false, true, false)}">
                    <apex:outputLabel >Mayorista 2</apex:outputLabel>
                    <apex:inputField id="mayorista2" value="{!accFields.LAT_MX_SecondSupplyOption__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!if(disabled == true, true, false)}">
                    <apex:outputLabel >Mayorista 2</apex:outputLabel>
                    <apex:outputField id="mayorista2" value="{!accFields.LAT_MX_SecondSupplyOption__c}" />
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

            <apex:pageBlockSection id="pgBlockSectionSegmentacion" title="Segmentación - PROS" collapsible="false" columns="2">
                <apex:facet name="headez">
                    <h3>Segmentación - PROS<span class="titleSeparatingColon">:</span></h3>
                </apex:facet>
                <apex:pageBlockSectionItem id="idStatus" rendered="{!accFields.LAT_ID_Status__c == 'Inactivo'}">
                    <apex:outputLabel id="lidStatus">Status sistema bonificaciones</apex:outputLabel>
                    <apex:inputField id="fidStatus" value="{!accFields.LAT_ID_Status__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="idStatus2" rendered="{!accFields.LAT_ID_Status__c != 'Inactivo'}">
                    <apex:outputLabel id="lidStatus">Status sistema bonificaciones</apex:outputLabel>
                    <apex:outputField id="fidStatus" value="{!accFields.LAT_ID_Status__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="idStatusEmpty">
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="TcentroConsumo">
                    <apex:outputLabel id="lTcentroConsumo">Tipo Centro Consumo</apex:outputLabel>
                    <apex:inputField id="fTcentroConsumo" value="{!accFields.LAT_TipoCentro__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="channelType">
                    <apex:outputLabel id="lchannelType">Tipo Lugar</apex:outputLabel>
                    <apex:inputField id="fchannelType" value="{!Account.Channel_Type__c}" />
                </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="tipoLugar">
                    <apex:outputLabel id="ltype">Tipo Cliente</apex:outputLabel>
                    <apex:inputField id="ftype" value="{!Account.type}" />
                </apex:pageBlockSectionItem>

                <!--  hacerlo por outputfield -->
                <apex:pageBlockSectionItem id="subTipoLugar" rendered="{!if(disabled == false, true, false)}">
                    <apex:outputLabel id="lsubTipoLugar">Sub Tipo Lugar</apex:outputLabel>
                    <apex:inputField id="fsubTipoLugar" value="{!Account.Sub_Channel__c}" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="subTipoLugarDisabled" rendered="{!if(disabled == true, true, false)}">
                    <apex:outputLabel id="lsubTipoLugarDisabled">Sub Tipo Lugar</apex:outputLabel>
                    <apex:outputField id="fsubTipoLugarDisabled" value="{!Account.Sub_Channel__c}" />
                </apex:pageBlockSectionItem>
                <!--  hacerlo por outputfield -->

                <apex:pageBlockSectionItem id="idStsEmpty">
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="aceptanBranding">
                    <apex:outputLabel id="lAceptanBranding">Aceptan Branding</apex:outputLabel>
                    <apex:inputField id="fAceptanBranding" value="{!accFields.LAT_Branding__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="calidadBateo">
                    <apex:outputLabel id="lCalidadBateo">Calidades de Bateo</apex:outputLabel>
                    <apex:inputField id="fCalidadBateo" value="{!accFields.LAT_CalidadBateo__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="cubaLibre">
                    <apex:outputLabel id="lCubaLibre">Precio Cuba Libre</apex:outputLabel>
                    <apex:inputField id="fCubaLibre" value="{!accFields.LAT_CubaLibre__c}" onblur="checkIsNumeric('{!$Component.fCubaLibre}');"            />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="DJInternacional">
                    <apex:outputLabel id="lDJInternacional">Presencia de DJ Internacional</apex:outputLabel>
                    <apex:inputField id="fDJInternacional" value="{!accFields.LAT_DJInternacional__c}" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="precioBacardi">
                    <apex:outputLabel id="lPrecioBacardi">Precio Botella de Bacardí</apex:outputLabel>
                    <apex:inputField id="fPrecioBacardi" value="{!accFields.LAT_PrecioBacardi__c}" onblur="checkIsNumeric('{!$Component.fPrecioBacardi}');" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="precioPlatoFuerte">
                    <apex:outputLabel id="lPrecioPlatoFuerte">Precio Mínimo de Plato Fuerte</apex:outputLabel>
                    <apex:inputField id="fPrecioPlatoFuerte" value="{!accFields.LAT_PrecioMinPlatoFuerte__c}" onblur="checkIsNumeric('{!$Component.fPrecioPlatoFuerte}');" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="promocionPrecioPaquete">
                    <apex:outputLabel id="lPromocionesPrecioPaquete">Promociones de Precios o Paquetes</apex:outputLabel>
                    <apex:inputField id="fPromocionesPrecioPaquete" value="{!accFields.LAT_PromocionesPrecioPaquete__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="restriccionesAcceso">
                    <apex:outputLabel id="lRestriccionesAcceso">Restricciones de Acceso</apex:outputLabel>
                    <apex:inputField id="fRestriccionesAcceso" value="{!accFields.LAT_RestriccionesAcceso__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="skuChampagne">
                    <apex:outputLabel id="lSkuChampagne">Números de SKUs de Champagne</apex:outputLabel>
                    <apex:inputField id="fSkuChampagne" value="{!accFields.LAT_SKUChampagne__c}" onblur="checkIsNumeric('{!$Component.fSkuChampagne}');"    />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="skuWhisky">
                    <apex:outputLabel id="lSkuWhisky">Número de SKUs de Whiskies de 18 Años en Adelante</apex:outputLabel>
                    <apex:inputField id="fSkuWhisky" value="{!accFields.LAT_SKUWhiskies__c}" onblur="checkIsNumeric('{!$Component.fSkuWhisky}');"        />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="somelier">
                    <apex:outputLabel id="lSomelier">Presencia de Somelier</apex:outputLabel>
                    <apex:inputField id="fSomelier" value="{!accFields.LAT_Somelier__c}" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="visibilidadTailorMade">
                    <apex:outputLabel id="lVisibilidadTailorMade">Acepta Visibilidad Tailor Made</apex:outputLabel>
                    <apex:inputField id="fVisibilidadTailorMade" value="{!accFields.LAT_VisibilidadTailorMade__c}" />
                </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                    <apex:outputLabel id="lTipoComida" >Tipo Comida</apex:outputLabel>
                    <apex:inputField id="fTipoComida" value="{!accFields.LAT_TipoComida__c}" />
                </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                    <apex:outputLabel id="lTipoComida" >Cuenta con Chef Reconocido</apex:outputLabel>
                    <apex:inputField id="fTipoComida" value="{!accFields.LAT_MX_HasRecognizedChef__c}"/>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

            <apex:pageBlockSection id="pgBlockSectionConvenio" title="Convenio" collapsible="false" columns="2">
                <apex:facet name="headez">
                    <h3>Convenio<span class="titleSeparatingColon">:</span></h3>
                </apex:facet>
                <apex:pageBlockSectionItem id="Conveniosection">
                    <apex:outputLabel id="lConvenioCheck">Tiene convenio PRM?</apex:outputLabel>
                    <apex:inputField id="fConvenioCheck" value="{!accFields.LAT_Convenio_prm__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="Capacitacion">
                    <apex:outputLabel id="lCapacitacion">Acepta  Capacitacion</apex:outputLabel>
                    <apex:inputField styleclass="notRequired" id="fCapacitacion" value="{!accFields.LAT_Capacitacion__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="fechaInicioConvenio">
                    <apex:outputLabel id="lConvenio">Fecha de Inicio Convenio</apex:outputLabel>
                    <apex:inputField id="fInicio" value="{!accFields.LAT_MX_InicioConvenio__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="Activaciones">
                    <apex:outputLabel id="lActivaciones">Acepta Activaciones</apex:outputLabel>
                    <apex:inputField id="fActivaciones" styleclass="notRequired" value="{!accFields.LAT_Activaciones__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="fechaFinConvenio">
                    <apex:outputLabel id="lConvenio">Fecha de Fin Convenio</apex:outputLabel>
                    <apex:inputField id="fFin" value="{!accFields.LAT_MX_FinConvenio__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="Incentivos">
                    <apex:outputLabel id="lIncentivos">Acepta Incentivos</apex:outputLabel>
                    <apex:inputField id="fIncentivos" styleclass="notRequired" value="{!accFields.LAT_Incentivos__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="contractoAnual">
                        <apex:outputLabel id="lcontractoAnual">Inversión contrato anual</apex:outputLabel>
                        <apex:inputField id="fcontractoAnual" value="{!accFields.LAT_MX_AnualContract__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="Convenio1">
                    <apex:outputLabel id="lConvenio1">Convenio de Competencia</apex:outputLabel>
                    <apex:inputField id="fConvenio1" styleclass="notRequired" value="{!accFields.LAT_Convenio1__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="Convenio2">
                    <apex:outputLabel id="lConvenio2">Convenio de Competencia 2</apex:outputLabel>
                    <apex:inputField id="fConvenio2" styleclass="notRequired" value="{!accFields.LAT_Convenio2__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem id="Convenio3">
                    <apex:outputLabel id="lConvenio3">Convenio de Competencia 3</apex:outputLabel>
                    <apex:inputField id="fConvenio3" styleclass="notRequired" value="{!accFields.LAT_Convenio3__c}"/>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

            <apex:pageBlockSection id="pgBlockSectionDireccion" title="Dirección" collapsible="false" columns="2" >
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Calle</apex:outputLabel>
                    <apex:inputField id="direccion" value="{!accFields.LAT_MX_Direccion__c}" required="true"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Teléfono</apex:outputLabel>
                    <apex:inputField id="telefono" value="{!Account.Phone}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!Account.name != null}">
                    <apex:outputLabel >Colonia/Fraccionamiento </apex:outputLabel>
                    <apex:outputField id="colonia" value="{!accFields.LAT_MX_Neighbourhood__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Sitio Web</apex:outputLabel>
                    <apex:inputField id="web" value="{!Account.Website}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Ciudad </apex:outputLabel>
                    <apex:outputField id="ciudad" value="{!accFields.LAT_MX_City__c}" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Email</apex:outputLabel>
                    <apex:inputField id="email" value="{!Account.Email_NFE__c}" />
                </apex:pageBlockSectionItem>
                 <apex:pageBlockSectionItem >
                    <apex:outputLabel rendered="{!Account.name != null}">Contacto</apex:outputLabel>
                    <apex:inputField id="contacto" value="{!Account.Contact_Schedule__c}" rendered="{!Account.name != null}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Código Postal</apex:outputLabel>
                    <apex:inputField id="codigoPostal" value="{!Account.LAT_MX_PostalCode__c}" required="true"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel >Delegación/Municipio </apex:outputLabel>
                    <apex:outputField id="delegacion" value="{!accFields.LAT_MX_County__c}" />
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

            <!--
            <apex:pageBlockSection id="pgBlockSectionRecomendacion" title="Recomendación" collapsible="false" columns="2">
                <apex:facet name="headez">
                    <h3>Recomendacion<span class="titleSeparatingColon">:</span></h3>
                </apex:facet>
                    <apex:pageBlockSectionItem id="Entrada">
                        <apex:outputLabel id="lEntrada">Entrada</apex:outputLabel>
                        <apex:inputField id="fEntrada" value="{!accFields.LAT_Entrada__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="Coctel">
                        <apex:outputLabel id="lCoctel">Coctel</apex:outputLabel>
                        <apex:inputField id="fCoctel" value="{!accFields.LAT_Coctel__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="PlatoFuerte">
                        <apex:outputLabel id="lPlatoFuerte">Plato Fuerte</apex:outputLabel>
                        <apex:inputField id="fPlatoFuerte" value="{!accFields.LAT_PlatoFuerte__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="Postre">
                        <apex:outputLabel id="lPostre">Postre</apex:outputLabel>
                        <apex:inputField id="fPostre" value="{!accFields.LAT_Postre__c}" />
                    </apex:pageBlockSectionItem>

            </apex:pageBlockSection>
            -->

            <apex:pageBlockSection id="pgBlockSectionBut" title="RFC" collapsible="false" columns="1">
                <apex:facet name="headez">
                    <h3>RFC<span class="titleSeparatingColon">:</span></h3>
                </apex:facet>
                     <apex:outputPanel layout="block" Style="text-align: center;">
                        <input id='buscarRFCBut' type="button" class="slds-pill btn" style="width: 25%;" onclick="getValueAndSearch()" value="Agregar RFC" status="status" rendered="tableSection"/>
                    </apex:outputPanel>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="pgBlockSectionRFC" columns="8">
                    <apex:pageBlockSectionItem id="rfc">
                            <apex:outputLabel id="lrfc">RFC</apex:outputLabel>
                            <apex:inputText id="frfc" value="{!rfcSelec}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="razonSocial" >
                            <apex:outputLabel id="lrazonSocial">Razon Social</apex:outputLabel>
                            <apex:inputText id="frazonSocial" value="{!rsSelec}" />
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                        <apex:outputPanel >
                            <input id="crearRFCPage" value="Insertar RFC"  type="button" class="slds-pill btn" style="width: 100%;" onclick="getValueAndCreate()" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1" id="tableSection" >
                    <apex:outputPanel layout="block" styleClass="sldc" rendered="{!listaRFCActuales.size == 0}" style="text-align: center; background-color: #FFF; padding: 10px;">
                        No hay registros de RFC
                    </apex:outputPanel>
                    <apex:pageBlockTable value="{!listaRFCActuales}" var="h" id="headerListTable" styleClass="slds-table" rendered="{!listaRFCActuales.size != 0}">
                        <apex:column >
                            <a href="#" class="actionLink" onclick="confirmDelete('{!h.rfc}')">Eliminar</a>
                        </apex:column>
                        <apex:column headerValue="Seleccionar">
                            <apex:inputCheckbox value="{!h.selected}" id="checkedone">
                            </apex:inputCheckbox>
                        </apex:column>
                        <apex:column value="{!h.rfc}" headerValue="RFC" />
                        <apex:column value="{!h.razonSocial}" headerValue="Razón Social" />
                    </apex:pageBlockTable>
            </apex:pageBlockSection>

        </apex:pageBlock>
        <inputHidden value="{!Account.parentID}" />
        <inputHidden value="{!Account.Client_code_AN8__c}" />

        <apex:actionFunction action="{!doDelete}" reRender="tableSection" name="doDeleteAction" immediate="true" status="status">
            <apex:param name="nickName" value="" assignTo="{!toDeleteId}"/>
        </apex:actionFunction>

        <apex:actionFunction action="{!addRFCList}" reRender="tableSection" name="doCreateAction" immediate="true" status="status">
            <apex:param name="nickName" value="" assignTo="{!rsSelec}"/>
            <apex:param name="nickName2" value="" assignTo="{!rfcSelec}"/>
        </apex:actionFunction>
        <apex:actionFunction action="{!loadRFC}" status="status" reRender="tableSection" name="doSearchAction" immediate="true">
            <apex:param name="nickName" value="" assignTo="{!parentID}"/>
        </apex:actionFunction>

    </apex:form>
    <script>
        var positions = {};
        var labels = {};
        var fields = {};
        var RFC = '';
        var RS = '';
        var fieldsToDisable = ["clientName","parent","nombreComercial","propietario","descripcion","ejecutivoAtiende","grupo","status","fMarca1","horarioApertura","fMarca2","fechaApertura","fMarca3","diaRelevante","visita","ticketPromedio","capacidad","bonifica","mayorista1","mayorista2","fTcentroConsumo","fchannelType","ftype","fsubTipoLugar","fAceptanBranding","fCalidadBateo","fCubaLibre","fDJInternacional","fPrecioBacardi","fPrecioPlatoFuerte","fPromocionesPrecioPaquete","fRestriccionesAcceso","fSkuChampagne","fSkuWhisky","fSomelier","fVisibilidadTailorMade","fTipoComida","fConvenioCheck","fCapacitacion","fInicio","fActivaciones","fFin","fIncentivos","fcontractoAnual","fConvenio1","fConvenio2","fConvenio3","direccion","telefono","colonia","web","ciudad","email","contacto","codigoPostal","delegacion","fEntrada","fCoctel","fPlatoFuerte","fPostre"];

        $(document).ready(init);

        $('[id$="channelType"]').on('change', function() {
            cleanPositions();
            if ($(this).val() == "HEB") {
                positions['fCalidadBateo'].append(fields['fPromocionesPrecioPaquete']);
                positions['lCalidadBateo'].append(labels['lPromocionesPrecioPaquete']);
                positions['fCubaLibre'].append(fields['fAceptanBranding']);
                positions['lCubaLibre'].append(labels['lAceptanBranding']);
                positions['fDJInternacional'].append(fields['fSkuChampagne']);
                positions['lDJInternacional'].append(labels['lSkuChampagne']);
                positions['fPrecioBacardi'].append(fields['fCubaLibre']);
                positions['lPrecioBacardi'].append(labels['lCubaLibre']);
            }
            else if($(this).val() == "LEB"){
                positions['fCalidadBateo'].append(fields['fPromocionesPrecioPaquete']);
                positions['lCalidadBateo'].append(labels['lPromocionesPrecioPaquete']);
                positions['fCubaLibre'].append(fields['fAceptanBranding']);
                positions['lCubaLibre'].append(labels['lAceptanBranding']);
                positions['fDJInternacional'].append(fields['fCalidadBateo']);
                positions['lDJInternacional'].append(labels['lCalidadBateo']);
                positions['fPrecioBacardi'].append(fields['fCubaLibre']);
                positions['lPrecioBacardi'].append(labels['lCubaLibre']);
            }
            else if($(this).val() == "NIGHT CLUB"){
                positions['fCalidadBateo'].append(fields['fDJInternacional']);
                positions['lCalidadBateo'].append(labels['lDJInternacional']);
                positions['fCubaLibre'].append(fields['fPrecioBacardi']);
                positions['lCubaLibre'].append(labels['lPrecioBacardi']);
                positions['fDJInternacional'].append(fields['fRestriccionesAcceso']);
                positions['lDJInternacional'].append(labels['lRestriccionesAcceso']);
                positions['fPrecioBacardi'].append(fields['fVisibilidadTailorMade']);
                positions['lPrecioBacardi'].append(labels['lVisibilidadTailorMade']);

            }
            else if($(this).val() == "RESTAURANTE"){
                positions['fCalidadBateo'].append(fields['fSomelier']);
                positions['lCalidadBateo'].append(labels['lSomelier']);
                positions['fDJInternacional'].append(fields['fAceptanBranding']);
                positions['lDJInternacional'].append(labels['lAceptanBranding']);
                positions['fCubaLibre'].append(fields['fPrecioPlatoFuerte']);
                positions['lCubaLibre'].append(labels['lPrecioPlatoFuerte']);
                positions['fPrecioBacardi'].append(fields['fSkuWhisky']);
                positions['lPrecioBacardi'].append(labels['lSkuWhisky']);
                positions['fPrecioPlatoFuerte'].append(fields['fTipoComida']);
                positions['lPrecioPlatoFuerte'].append(labels['lTipoComida']);
            }           
        });

        function init() {
            loadFields();
            cleanPositions();
            completePage();
            addYearToDatePicker();
            doRequiredConv();
            conveniosMultiUI();
            marcasMultiUI();           
            conveniosMultiUIShow();
            marcasMultiUIShow();

            $('[id$="fchannelType"]').change(doRequiredSeg);
            $('[id$="parent"]').change(hideConvenio);
            $('[id$="buscarRFCBut"]').click(insertarRFC);
            $('[id$="fConvenioCheck"]').change(doRequiredConv);

            $('[id$="fTcentroConsumo"]').change(changeTipoCentro);

            hideConvenio();
            doRequiredSeg();
            //doRequiredConv();

            $('[id$="razonSocial"]').hide();
            $('[id$="rfc"]').hide();
            $('[id$="crearRFCPage"]').hide();

            disableFieldsWhenInactiveAccount();
        }

        function conveniosMultiUIShow() {
           $('[id$="fConvenio1"]').val([$('[id$="fConvenio1"]').val(), $('[id$="fConvenio2"]').val(), $('[id$="fConvenio3"]').val()]);
        }

        function marcasMultiUIShow() {
           $('[id$="fMarca1"]').val([$('[id$="fMarca1"]').val(), $('[id$="fMarca2"]').val(), $('[id$="fMarca3"]').val()]);
        }

        function marcasMultiUI() {
            $('[id$="fConvenioCheck"]').hide();
            $('[id$="lConvenioCheck"]').hide();
            $('[id$="fMarca1"]').attr('multiple', true);
            $('[id$="fMarca2"]').hide();
            $('[id$="fMarca3"]').hide();
            $('[id$="lMarca2"]').hide();
            $('[id$="lMarca3"]').hide();
        }

        function marcasMultiUISave() {
            var none = "--None--";
            var values = $('[id$="fMarca1"]').val();

            if (values.length > 0) $('[id$="fMarca1"]').val(values[0]);
            if (values.length > 1) $('[id$="fMarca2"]').val(values[1]);
            if (values.length > 2) $('[id$="fMarca3"]').val(values[2]);

            if (values.length <= 2) $('[id$="fMarca3"]').val(none);
            if (values.length <= 1) {
                $('[id$="fMarca2"]').val(none);
                $('[id$="fMarca3"]').val(none);
            }
            if (values.length <= 0) {
                $('[id$="fMarca1"]').val(none);
                $('[id$="fMarca2"]').val(none);
                $('[id$="fMarca3"]').val(none);
            }
        }

        function conveniosMultiUI() {
            $('[id$="fConvenio1"]').attr('multiple', true);
            $('[id$="fConvenio2"]').hide();
            $('[id$="fConvenio3"]').hide();
            $('[id$="lConvenio2"]').hide();
            $('[id$="lConvenio3"]').hide();
        }

        function conveniosMultiUISave() {
            var none = "--None--";
            var values = $('[id$="fConvenio1"]').val();

            if (values.length > 0) $('[id$="fConvenio1"]').val(values[0]);
            if (values.length > 1) $('[id$="fConvenio2"]').val(values[1]);
            if (values.length > 2) $('[id$="fConvenio3"]').val(values[2]);

            if (values.length <= 0) {
                $('[id$="fConvenio1"]').val(none);
                $('[id$="fConvenio2"]').val(none);
                $('[id$="fConvenio3"]').val(none);
            }
            if (values.length <= 1) {
                $('[id$="fConvenio2"]').val(none);
                $('[id$="fConvenio3"]').val(none);
            }
            if (values.length <= 2) $('[id$="fConvenio3"]').val(none);
        }

        function hideConvenio(){
            if($('[id$="parent"]').val() == "" || $('[id$="parent"]').val() == "undefined"){
                $('[id$="pgBlockSectionConvenio"]').show();
                //doRequiredConv();
            }else{
                $('[id$="pgBlockSectionConvenio"]').hide();
                //doRequiredConv();
            }
        }
        function addYearToDatePicker(){
            var actualYear = $('#calYearPicker option:first-child').val();
            while(actualYear > 2000){
                actualYear = actualYear - 1;
                $('#calYearPicker').prepend('<option value="' + actualYear + '">' + actualYear + '</option>');
            }
        }
        function insertarRFC () {
            if($('[id$="parent"]').val() == "" || $('[id$="parent"]').val() == "undefined"){
                $('[id$="razonSocial"]').show();
                $('[id$="rfc"]').show();
                $('[id$="crearRFCPage"]').show();
            }
            return false;
        }

        function loadFields() {
            $('[id$="pgBlockSectionSegmentacion"] div.pbSubsection table th label').each(function () {
                if(!$(this).is('span')){
                labels[getId($(this).attr('id'))] = $(this);
                positions[getId($(this).attr('id'))] = $(this).parent();
                }
            });

            $('[id$="pgBlockSectionSegmentacion"] div.pbSubsection table td').children(0).each(function () {
                if(!$(this).is('span')){
                fields[getId($(this).attr('id'))] = $(this);
                positions[getId($(this).attr('id'))] = $(this).parent();
                }
            });
        }

        function cleanPositions() {
            $.each(positions, function(key, value) {
                 if ('fidStatus' != key && 'lidStatus' != key && 'fTcentroConsumo' != key &&'lTcentroConsumo' != key && 'ltype' != key && 'ftype' != key &&  'fsubTipoLugar' != key && 'lsubTipoLugar' != key && 'fchannelType' != key && 'lchannelType' != key) {
                    value.empty();
                }
            });
         }

        function getId(str) {
            var position = str.lastIndexOf(':');
            return str.substring(position + 1);
        }

        function completePage() {
            if ('{!Account.Channel_Type__c}'.toUpperCase() == "HEB") {
                positions['fAceptanBranding'].append(fields['fPromocionesPrecioPaquete']);
                positions['lAceptanBranding'].append(labels['lPromocionesPrecioPaquete']);
                positions['fCalidadBateo'].append(fields['fAceptanBranding']);
                positions['lCalidadBateo'].append(labels['lAceptanBranding']);
                positions['fCubaLibre'].append(fields['fSkuChampagne']);
                positions['lCubaLibre'].append(labels['lSkuChampagne']);
                positions['fDJInternacional'].append(fields['fCubaLibre']);
                positions['lDJInternacional'].append(labels['lCubaLibre']);
                doRequiredSeg();
            }
            else if('{!Account.Channel_Type__c}'.toUpperCase() == "LEB"){
                positions['fAceptanBranding'].append(fields['fPromocionesPrecioPaquete']);
                positions['lAceptanBranding'].append(labels['lPromocionesPrecioPaquete']);
                positions['fCalidadBateo'].append(fields['fAceptanBranding']);
                positions['lCalidadBateo'].append(labels['lAceptanBranding']);
                positions['fCubaLibre'].append(fields['fCalidadBateo']);
                positions['lCubaLibre'].append(labels['lCalidadBateo']);
                positions['fDJInternacional'].append(fields['fCubaLibre']);
                positions['lDJInternacional'].append(labels['lCubaLibre']);
                doRequiredSeg();
            }
            else if('{!Account.Channel_Type__c}'.toUpperCase() == "NIGHT CLUB"){
                positions['fAceptanBranding'].append(fields['fDJInternacional']);
                positions['lAceptanBranding'].append(labels['lDJInternacional']);
                positions['fCalidadBateo'].append(fields['fPrecioBacardi']);
                positions['lCalidadBateo'].append(labels['lPrecioBacardi']);
                positions['fCubaLibre'].append(fields['fRestriccionesAcceso']);
                positions['lCubaLibre'].append(labels['lRestriccionesAcceso']);
                positions['fDJInternacional'].append(fields['fVisibilidadTailorMade']);
                positions['lDJInternacional'].append(labels['lVisibilidadTailorMade']);
                doRequiredSeg();
            }

            else if('{!Account.Channel_Type__c}'.toUpperCase() == "RESTAURANTE"){
                positions['fAceptanBranding'].append(fields['fSomelier']);
                positions['lAceptanBranding'].append(labels['lSomelier']);
                positions['fCalidadBateo'].append(fields['fAceptanBranding']);
                positions['lCalidadBateo'].append(labels['lAceptanBranding']);
                positions['fCubaLibre'].append(fields['fPrecioPlatoFuerte']);
                positions['lCubaLibre'].append(labels['lPrecioPlatoFuerte']);
                positions['fDJInternacional'].append(fields['fSkuWhisky']);
                positions['lDJInternacional'].append(labels['lSkuWhisky']);
                positions['fPrecioBacardi'].append(fields['fTipoComida']);
                positions['lPrecioBacardi'].append(labels['lTipoComida']);
                doRequiredSeg();
            }
        }
        function checkIsNumeric(textId) {
            var textIdText =  (document.getElementById(textId).value);
            var ValidChars = "0123456789";
            var IsNumber=true;
            var Char;
            for (i = 0; i < textIdText.length && IsNumber == true; i++){
                Char = textIdText.charAt(i);
                if (ValidChars.indexOf(Char) == -1){
                IsNumber = false;
                }
            }
            if (IsNumber == false) {
                alert("El Campo tiene que ser un numero");
                document.getElementById(textId).value = '';
                return false;
            }
       }

       function changeTipoCentro(){
            if($('[id$="fTcentroConsumo"]').val() == 'CC Convenio' || $('[id$="fTcentroConsumo"]').val() == 'Hotel Convenio'){
                $('[id$="fConvenioCheck"]').prop('checked', true);
            } else {
                $('[id$="fConvenioCheck"]').prop('checked', false);
            }
            doRequiredConv();
        }


       function doRequiredConv(evt) {
            if($('[id$="parent"]').val() == "" || $('[id$="parent"]').val() == "undefined") {
                 if($('[id$="fConvenioCheck"]').is(":checked")) {
                    $('[id$="pgBlockSectionConvenio"] div.pbSubsection table td').each(function () {

                        var inp = $($(this)).find('.notRequired');

                        if(!inp.length > 0 && !$(this).hasClass("empty")){
                            if(!$(this).hasClass('requiredInput')) $(this).wrapInner('<div class="requiredInput" />');
                            if(!$(this).hasClass('.requiredBlock')) $(this).find('.requiredInput').append('<div class="requiredBlock" />') ;
                        }
                    });
                }else {
                    $('[id$="pgBlockSectionConvenio"] div.pbSubsection table td').each(function () {
                         $(this).find('.requiredInput').find('.requiredBlock').remove();
                    });
                }
            }            
       }

       function doRequiredSeg(evt) {
            $('[id$="pgBlockSectionSegmentacion"] div.pbSubsection table td').each(function () {
                if(!$(this).hasClass('empty')){
                    if(!$(this).hasClass('requiredInput')) $(this).wrapInner('<div class="requiredInput" />');
                    if(!$(this).hasClass('.requiredBlock')) $(this).find('.requiredInput').append('<div class="requiredBlock" />') ;
                }
            });
       }

       function doSaveAcc() {
            var estado = true;
            var estadoRFC = true;
            marcasMultiUISave();
            conveniosMultiUISave();

            if($('[id$="headerListTable"]').size()<= 0){
                estadoRFC = false;
            }
            if($('[id$="parent"]').val() == "" || $('[id$="parent"]').val() == "undefined") {
               if($('[id$="fConvenioCheck"]').is(":checked")) {
                    if($('[id$="fInicio"]').val() == '' || $('[id$="fFin"]').val() == '' || $('[id$="fcontractoAnual"]').val() == '' ) estado = false
                    //if($('[id$="fConvenio1"]').val() == "" )estado = false;
                }
            }

            if($('[id$="fchannelType"]').val() == "HEB" && ($('[id$="fSkuChampagne"]').val() == "" || $('[id$="fCubaLibre"]').val() == "")) estado = false;
            if($('[id$="fchannelType"]').val() == "NIGHT CLUB"  && $('[id$="fPrecioBacardi"]').val() == "") estado = false;
            if($('[id$="fchannelType"]').val() == "LEB" &&  ($('[id$="fCubaLibre"]').val() == "") || $('[id$="fCalidadBateo"]').val() == "") estado = false;
            if($('[id$="fchannelType"]').val() == "RESTAURANTE" && ($('[id$="fPrecioPlatoFuerte"]').val() == "" || $('[id$="fSkuWhisky"]').val() == "" || $('[id$="fTipoComida"]').val() == "")) estado = false;
            if($('[id$="fTcentroConsumo"]').val() == "" || $('[id$="fchannelType"]').val() == "" || $('[id$="ftype"]').val() == "" || $('[id$="fsubTipoLugar"]').val() == "")estado = false;

            if(!estado){
                var errorMsg = '<div class="message errorM3" role="alert">';
                    errorMsg += '  <table border="0" cellpadding="0" cellspacing="0" class="messageTable" style="padding:0px;margin:0px;">';
                    errorMsg += '      <tbody>';
                    errorMsg += '        <tr valign="top">';
                    errorMsg += '          <td><img alt="ERROR" class="msgIcon" src="/s.gif" title="ERROR"></td>';
                    errorMsg += '          <td class="messageCell">';
                    errorMsg += '            <div class="messageText">';
                    errorMsg += '              <span style="color:#cc0000">';
                    errorMsg += '                <h4>Errors</h4>';
                    errorMsg += '              </span>';
                    errorMsg += '              <br>';
                    errorMsg += '            </div>';
                    errorMsg += '          </td>';
                    errorMsg += '        </tr>';
                    errorMsg += '        <tr>';
                    errorMsg += '          <td></td>';
                    errorMsg += '          <td>';
                    errorMsg += '            <span>';
                    errorMsg += '            <ul style="padding-left:10px;padding-top:0px;margin:0px">';
                    errorMsg += '              <li style="padding-top:5px">Por favor revise las áreas Segmentación y Convenio</li>';
                    errorMsg += '            </ul>';
                    errorMsg += '            </span>';
                    errorMsg += '          </td>';
                    errorMsg += '        </tr>';
                    errorMsg += '      </tbody>';
                    errorMsg += '    </table>';
                    errorMsg += '  </div>';
                    if($('.pbBody').find('.errorM3').length != 0){
                        $('.pbBody').find('.errorM3').remove();
                        $('.pbBody').prepend(errorMsg);
                    }else{
                        $('.pbBody').prepend(errorMsg);
                    }

                return false;
            }
            else if(!estadoRFC){
                var errorMsg = '<div class="message errorM3" role="alert">';
                    errorMsg += '  <table border="0" cellpadding="0" cellspacing="0" class="messageTable" style="padding:0px;margin:0px;">';
                    errorMsg += '      <tbody>';
                    errorMsg += '        <tr valign="top">';
                    errorMsg += '          <td><img alt="ERROR" class="msgIcon" src="/s.gif" title="ERROR"></td>';
                    errorMsg += '          <td class="messageCell">';
                    errorMsg += '            <div class="messageText">';
                    errorMsg += '              <span style="color:#cc0000">';
                    errorMsg += '                <h4>Errors</h4>';
                    errorMsg += '              </span>';
                    errorMsg += '              <br>';
                    errorMsg += '            </div>';
                    errorMsg += '          </td>';
                    errorMsg += '        </tr>';
                    errorMsg += '        <tr>';
                    errorMsg += '          <td></td>';
                    errorMsg += '          <td>';
                    errorMsg += '            <span>';
                    errorMsg += '            <ul style="padding-left:10px;padding-top:0px;margin:0px">';
                    errorMsg += '              <li style="padding-top:5px">Debe seleccionar un RFC</li>';
                    errorMsg += '            </ul>';
                    errorMsg += '            </span>';
                    errorMsg += '          </td>';
                    errorMsg += '        </tr>';
                    errorMsg += '      </tbody>';
                    errorMsg += '    </table>';
                    errorMsg += '  </div>';
                    if($('.pbBody').find('.errorM3').length != 0){
                        $('.pbBody').find('.errorM3').remove();
                        $('.pbBody').prepend(errorMsg);
                    }else{
                        $('.pbBody').prepend(errorMsg);
                    }

                return false;
            }
        }

        function getValueAndSearch() {
            var parentId = $('[id$="parent_lkid"]').val();
                doSearchAction(parentId);
        }

        function getValueAndCreate() {
            var razonSocialVar = $('[id$="frazonSocial"]').val();
            var rfcVar = $('[id$="frfc"]').val();

            if (razonSocialVar != null && razonSocialVar != '' && rfcVar != null && rfcVar != '') {
                doCreateAction(razonSocialVar,rfcVar);
            }
        }
        function confirmDelete(toDeleteId) {
            var conf = confirm('Seguro que quiere eliminar este registro?');

            if (conf) {
                doDeleteAction(toDeleteId);
            }
        }

        function disableFieldsWhenInactiveAccount() {

            setTimeout(function(){
                var disabled = {!disabled};

                for (i = 0; i < fieldsToDisable.length; i++) {

                    if(disabled == true){
                        $('[id$='+fieldsToDisable[i]+']').attr('disabled','disabled');
                                        
                    }else{
                        $('[id$='+fieldsToDisable[i]+']').removeAttr('disabled','disabled');
                    }
                }
            }, 2000);                       
        }

    </script>
</apex:page>