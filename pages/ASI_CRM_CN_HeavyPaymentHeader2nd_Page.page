<!-- ---------------------------------------------------------------------------
* Filename: ASI_CRM_CN_HeavyPaymentHeader_Page
* Author:   Laputa
* Purpose:  
*
* Copyright 2017 Laputa Limited. All rights reserved.
* Customer confidential. Do not distribute.

* History
* -----------------------------------------------------------------------------
* 2017-05-25     Laputa          Create
-->
<apex:page standardController="ASI_TH_CRM_PaymentRequest__c" extensions="ASI_CRM_CN_HeavyPaymentHeader_Controller" action="{!Calculation}" sidebar="false" >
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <apex:stylesheet value="{!URLFOR($Resource.ASI_CRM_CN_Jquery, 'jquery-ui1.10.4.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ASI_Library, 'dist/css/bootstrap.min.css')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ASI_CRM_CN_Jquery, 'jquery1.10.2.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ASI_CRM_CN_Jquery, 'jquery-ui1.10.4.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ASI_Library, 'dist/js/bootstrap.min.js')}" />
    
    <style>
        .AlignRight{
        text-align: right  !important;
        font-weight: bold !important;
        }
        
        .BSCommandButton{
        color: #333 !important;
        background-color: #fff !important;
        border-color: #ccc !important;
        margin-left: 0.5em !important; 
        margin-right: 0.5em !important; 
        margin-bottom: 0.5em !important;
        padding: 3px 6px !important; 
        }
        
        
        
        .HeaderCss{
        color: #fff;
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;
        background-color: #337ab7;
        border: 1px solid transparent;
        border-color: #337ab7;
        padding: 10px 15px;
        text-align: center;
        }
        
        .WeightLeft{
        font-weight: bold !important; 
        text-align: left !important;
        padding-left: 2em !important; 
        }
        
        
        .PanelBody{
        padding: 0.3em; 
        background-color: #fff; 
        border: 1px solid transparent;
        border-color: #337ab7;
        border-bottom-left-radius: 3px;
        border-bottom-right-radius: 3px;
        border-top-right-radius: 3px;
        }        
        
        
        .BorderBottom{
        border-bottom: 1px solid #ddd;
        }
        
        
        .GridColumn1{
        grid-column-start: 1 !important; 
        grid-column-end: 1 !important;
        }
        
        .GridColumn2{
        grid-column-start: 2 !important; 
        grid-column-end: 2 !important;
        }
        
        .GridColumn3{
        grid-column-start: 3 !important; 
        grid-column-end: 3 !important;
        }
        
        .GridColumn4{
        grid-column-start: 4 !important; 
        grid-column-end: 4 !important;
        }
        
        .GridColumn5{
        grid-column-start: 5 !important; 
        grid-column-end: 5 !important;
        }
        
        
        .GridColumn6{
        grid-column-start: 6 !important; 
        grid-column-end: 6 !important;
        }
        
        .GridColumn7{
        grid-column-start: 7 !important; 
        grid-column-end: 7 !important;
        }
        
        .MethodologyLabel{
        font-weight: bold !important; 
        text-align: right !important;
        }
        
        .FontWeightCSS{
        font-weight: bold;
        }
    </style>
    <apex:outputPanel ><chatter:feedWithFollowers entityid="{!ASI_TH_CRM_PaymentRequest__c.id}" /></apex:outputPanel>
    <script type="text/javascript"> 
    function addLoadEvent(func) {   
        var oldonload = window.onload;
        if (typeof window.onload != 'function') {   
            window.onload = func;   }   
        else {  window.onload = function() {    
            if (oldonload) {    oldonload();    }   
            func(); }   
             }   
    }   
    
    
    function checkPage() {  
        if (document.getElementsByName("piSubmit")[0] != null) 
            document.getElementsByName("piSubmit")[0].style.display = 'none'; 
        if (document.getElementsByName("piSubmit")[0] != null) 
            document.getElementsByName("piSubmit")[0].style.display = 'none'; 
        if (document.getElementsByName("piRemove")[0] != null) {
            var orgFunc = document.getElementsByName("piRemove")[0].onclick;
            document.getElementsByName("piRemove")[0].onclick = function(){ recallApprovalRequest(orgFunc);};
        }
        var anchors = document.getElementsByTagName("a");
        var reassignBackToRelatedList = "apex%2FASI_MFM_TW_Approval_Related_List%3Finline%3D1%26id%3D"; // the pattern of URL returning to related list iframe
        for (var i = 0; i < anchors.length; i++) {
            if (anchors[i].href.indexOf(reassignBackToRelatedList) > 0) {
                anchors[i].href = anchors[i].href.replace(reassignBackToRelatedList,""); // remove the url portion of returning to related list iframe
            }
            if (anchors[i].href.indexOf("salesforce.com") > 0) { 
                anchors[i].setAttribute('target', '_top'); // open the link in parent window when user press any links containing "salesforce.com" in URL
            }
        }
        
        
    }
    
    function recallApprovalRequest(func) {  
        var recallApprovalRequestBackToRelatedList = "apex%2FASI_MFM_TW_Approval_Related_List%3Finline%3D1%26id%3D";  // the pattern of URL returning to related list iframe
        var funcStr = func.toString();
        var urlIndexStart = funcStr.indexOf("https"); 
        var funcStr2 = funcStr.substring(urlIndexStart,funcStr.length);            
        var urlIndexEnd = funcStr2.indexOf(",")-1;           
        var urlStr = funcStr2.substring(0,urlIndexEnd); // extract the url of cancel button from the original onClick function
        urlStr = urlStr.replace(recallApprovalRequestBackToRelatedList,""); // remove the url portion of returning to related list iframe
        var newWin = window.open(urlStr, "_top");  // open the window "Recall Approval Request" in parent window when the user press the button "Recall Approval Request"
    }
    
    addLoadEvent(function() {    checkPage();    }); 
    
    </script>
    <apex:form style="padding-bottom: 1em;" id="PaymentPageDIV" >
        
        <div class="bs ">
            
            <div class="container-fluid" >
                
                <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;" >
                    <div style="grid-column-start: 1; grid-column-end: 1;" >
                        <div style="font-weight: bold; font-family: Arial,Helvetica,sans-serif; color: #000; font-size: 1.3em; margin: 0.5em;">
                            Payment Request
                        </div> 
                    </div>
                    
                    <div style="grid-column-start: 2; grid-column-end: 2;  margin-top: 0.5em;" >
                        <div>
                            <apex:commandButton value="{!$Label.ASI_HK_CRM_VF_COMMON_BTN_Edit}" styleClass="BSCommandButton" action="{!GoEditHeader}" rendered="{!PH.ASI_TH_CRM_Status__c == 'Draft'}"  />
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_Form_Preview}" styleClass="BSCommandButton" onClick="window.open('/apex/ASI_CRM_CN_HeavyPaymentRequestForm2nd?id={!PH.id}&pdf=1');"    />
                            
                            <!----
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_Submit_Approval}" styleClass="BSCommandButton" 
                                                onclick="window.location.href='/apex/ASI_CRM_CN_HeavyPaymentCheckPage?id={!PH.Id}&Type=SubmitApproval'" 
                                                oncomplete="return false;"
                                                rendered="{!PH.ASI_TH_CRM_Status__c == 'Draft'}"  />
                            ------>
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_Submit_Approval}" styleClass="BSCommandButton" 
                                                action="{!GoToCheckPoint}" reRender="PaymentPageDIV" status="ActionStatus" 
                                                oncomplete="return false;"
                                                rendered="{!PH.ASI_TH_CRM_Status__c == 'Draft'}"  />
                            
                            <apex:commandButton styleClass="BSCommandButton"  value="{!$Label.ASI_CRM_CN_View} {!$Label.ASI_CRM_CN_Check_Point}"  
                                                onclick="window.location.href='/apex/ASI_CRM_CN_HeavyPaymentCheckPage2nd?id={!PH.Id}&Type=ViewCheckPoint'" 
                                                oncomplete="return false;"
                                                rendered="{!PH.ASI_TH_CRM_Status__c != 'Draft'  }"  />
                            
                            
                            
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_Volume_Report}" styleClass="BSCommandButton" 
                                                 onclick="window.open('/apex/ASI_CRM_CN_HeavyContractVolumeReportPage?id={!PH.ASI_TH_CRM_Contract__c}')" />
                          
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_Payment_Instruction}" styleClass="BSCommandButton"  
                                                rendered="{!PH.ASI_TH_CRM_Status__c=='Paid'}" 
                                                onClick="window.open('/apex/ASI_CRM_CN_HeavyPaymentSlipPage?id={!PH.id}&PTSelected=Instruction');"   />
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_Payment_Receipt}"  styleClass="BSCommandButton"  
                                                onClick="window.open('/apex/ASI_CRM_CN_HeavyPaymentSlipPage?id={!PH.id}&PTSelected=Receipt');"  
                                                rendered="{!PH.ASI_TH_CRM_Status__c=='Paid'}"  />
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_Auto_PO_Modification}"  styleClass="BSCommandButton"  
                                                 action="{!AutoPOModification}" status="ActionStatus"  reRender="PaymentPageDIV"
                                                rendered="{!PH.ASI_TH_CRM_Status__c=='Paid' && PH.ASI_CRM_CN_Last_Payment__c && !PH.ASI_CRM_Auto_PO_Modification__c}"  />
                            
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_BRSF_Report}" 
                                                styleClass="BSCommandButton"
                                                onclick="window.open('/apex/ASI_CRM_CN_HeavyBRSFFormPDFPage?id={!PH.Id}')"   />
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_VF_BTN_PSF_Report}" 
                                                styleClass="BSCommandButton"
                                                onclick="window.open('/apex/ASI_CRM_CN_HeavyPSFFormPage?id={!PH.Id}')"   />
                            <apex:commandButton value="{!$Label.ASI_CRM_CN_Contract_Return}" 
                                                styleClass="BSCommandButton"
                                                action="{!GoReturn}"  rendered="{!showReturn}" reRender="PaymentPageDIV"   />

                            <!--20200317:AM@Introv START-->
                            <apex:commandButton value="Tax Calculation" action="{!reDirectToTaxSavingPage}" rendered="{!PH.ASI_TH_CRM_Status__c == 'Paid' || PH.ASI_TH_CRM_Status__c == 'Approved'}" reRender="PaymentPageDIV" styleClass="BSCommandButton"/>
                            <!--20200317:AM@Introv END-->
                            
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-danger fade in" style="{!IF(UpsertPermission,'display:none;','')}"  id="SaveFailPart">
                    <strong>Error!!</strong><br/>
                    <apex:outputText escape="false" value="{!Msg}"/>
                </div>
                
                
                <div class="row  ">
                    <div class="col">
                        
                        
                        <div class="panel panel-primary">
                            <div class="panel-heading">
                                {!$Label.ASI_CRM_CN_VF_LABEL_Header_Info}
                            </div>
                            <div class="panel-body" style="padding: 0.5em" >
                                <div class="bs table-responsive" > 
                                    <table class="bs table table-condensed" style="margin-bottom: 0;" >
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.Name.Label}"  />
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.name}" />
                                            </td>
                                            <td class="AlignRight"  style="width: 15% " >
                                                <apex:outputText value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_Payment_Raised_Date__c.Label}" />
                                            </td>
                                            <td style="width: 40% " >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_Payment_Raised_Date__c}"   />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_PO_No__c.Label}"  />
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputLink value="ASI_CRM_CN_ViewHeavyContractPage2nd?id={!PH.ASI_TH_CRM_Contract__c}" >{!PH.ASI_CRM_CN_PO_No__c}</apex:outputLink>
                                            </td>
                                            <td class="AlignRight"  style="width: 15% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_PO_Start_Date__c.Label}"  />
                                            </td>
                                            <td style="width: 40% " >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_PO_Start_Date__c}" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_OutletWS__c.Label}" />
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_OutletWS__c}" id="outlet_ws"/>
                                            </td>
                                            <td class="AlignRight"  style="width: 15% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_PO_End_Date__c.Label}"  />
                                            </td>
                                            <td style="width: 40% " >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_PO_End_Date__c}" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_Contract__c.Fields.ASI_TH_CRM_Promotion_Type__c.Label}" />
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_Promotion_Type__c}" />
                                            </td>
                                            <td class="AlignRight"  style="width: 15% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_Bottle_Collection_Rate__c.Label}" />
                                            </td>
                                            <td style="width: 40% " >
                                                <apex:outputText value="{0,number,0}%"><apex:param value="{!PH.ASI_CRM_CN_Bottle_Collection_Rate__c}"/></apex:outputText>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_Last_Payment__c.Label}"/>
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_Last_Payment__c}"/>
                                            </td>
                                            <td class="AlignRight"  style="width: 15% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_TH_CRM_Status__c.Label}" /></td>
                                            <td style="width: 40% " >
                                                <apex:outputField value="{!PH.ASI_TH_CRM_Status__c}" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_Last_Year_Payment__c.Label}</td>
                                            <td style="width: 25% "  ><apex:outputField value="{!PH.ASI_CRM_CN_Last_Year_Payment__c}"/></td>
                                            <td class="AlignRight"  style="width: 15% " >{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_Payment_Type__c.Label}</td>
                                            <td style="width: 40% " ><apex:outputField value="{!PH.ASI_CRM_CN_Payment_Type__c}"  /> </td>
                                        </tr>
                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                {!$Label.ASI_CRM_CN_Payment_Description}
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_Description__c}"/>
                                            </td>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputText value="{!$ObjectType.ASI_TH_CRM_Contract__c.Fields.ASI_CRM_Investment_Type__c.Label}" />
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!ContractSelected.ASI_CRM_Investment_Type__c}" id="investmenttype"/>
                                            </td>
                                        </tr>
                                        
                                        <tr  style=" {!IF(PH.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.RecordType.DeveloperName == 'ASI_CRM_CN_WS','','display:none;')}  " >
                                            <td class="AlignRight" style="width: 20% " >
                                                {!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_Volume_Option__c.Label}
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.ASI_CRM_Volume_Option__c}" id="paymenttype" />
                                            </td>
                                            <td></td>
                                            <td></td>
                                        </tr>

                                        <tr>
                                            <td class="AlignRight" style="width: 20% " >
                                                <apex:outputLabel value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_TH_CRM_GL_Date__c.Label}"  />
                                            </td>
                                            <td style="width: 25% "  >
                                                <apex:outputField value="{!PH.ASI_TH_CRM_GL_Date__c}" />
                                            </td>
                                            <td class="AlignRight"  style="width: 20% " >
                                                <apex:outputText value="{!$ObjectType.ASI_TH_CRM_PaymentRequest__c.Fields.ASI_CRM_CN_Invoice_Date__c.Label}" />
                                            </td>
                                            <td style="width: 25% " >
                                                <apex:outputField value="{!PH.ASI_CRM_CN_Invoice_Date__c}"   />
                                            </td>
                                        </tr>
                                        
                                    </table>
                                </div>
                            </div> 
                        </div>
                        
                    </div>
                </div>
                
                
                
                
                
                <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;margin-top: -1em;" >
                    <div style="grid-column-start: 1; grid-column-end: 1;" >
                        <div></div> 
                    </div>                    
                    <div style="grid-column-start: 2; grid-column-end: 2; " >
                        <div>                            
                            <apex:commandButton styleClass="BSCommandButton" 
                                                rendered="{!PH.ASI_TH_CRM_Status__c == 'Draft'}" 
                                                value="{!$Label.ASI_CRM_CN_VF_BTN_Payee_Detail}"
                                                action="{!GoEditDetailPage}"   />
                            <apex:commandButton styleClass="BSCommandButton" 
                                                rendered="{!PH.ASI_TH_CRM_Status__c == 'Draft'}" 
                                                value="{!$Label.ASI_CRM_CN_VF_BTN_Payee_Info}" action="{!GoEditPayee}"  />
                        </div>
                    </div>
                </div>
                <div class="row  ">
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_Payment_Summary}</div>                            
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        <div class="PanelBody" >
                            <apex:outputPanel id="PaymentSummaryPanel"   >
                                <table class="bs table table-condensed" style=" margin-bottom: 0;" id="PaymentSummaryDataTable"  >
                                    <thead>
                                        <tr>
                                            <th >{!$Label.ASI_CRM_CN_Payment_Summary}</th>
                                            <th >{!$Label.ASI_CRM_CN_PO_Estimated_Amount}</th>
                                            <th >{!$Label.ASI_CRM_CN_PO_Remaining_Amount}</th>
                                            <th >{!$Label.ASI_CRM_CN_Payment_Request_Amount}</th>
                                        </tr>
                                    </thead>
                                    <apex:variable value="{!0}" var="POEstimatedAmountTotal"/>
                                    <apex:variable value="{!0}" var="PORemainingAmountTotal"/>
                                    <apex:variable value="{!0}" var="PaymentRequestAmountTotal"/>
                                    <tbody>
                                        <apex:repeat value="{!PaymentSummaryList}"  var="PaymentSummary" id="PaymentSummaryListItem" >
                                            <apex:variable var="POEstimatedAmountTotal" value="{!POEstimatedAmountTotal+PaymentSummary.POEstimatedAmount}"/>
                                            <apex:variable var="PORemainingAmountTotal" value="{!PORemainingAmountTotal+PaymentSummary.POEstimatedAmount - PaymentSummary.PaidAmount}"/>
                                            <apex:variable var="PaymentRequestAmountTotal" value="{!PaymentRequestAmountTotal+PaymentSummary.PaymentRequestAmount}"/>
                                            <tr>
                                                <td class="BorderBottom" >
                                                    {!PaymentSummary.Name}
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PaymentSummary.POEstimatedAmount}"/></apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PaymentSummary.POEstimatedAmount - PaymentSummary.PaidAmount}"/></apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PaymentSummary.PaymentRequestAmount}"/></apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                        <tr class="FontWeightCSS" style="background-color: #e3e3d7;" >
                                            <td> {!$Label.ASI_CRM_CN_Total_Amount} 
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!POEstimatedAmountTotal}"/></apex:outputText>
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PORemainingAmountTotal}"/></apex:outputText>
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PaymentRequestAmountTotal}"/></apex:outputText>
                                            </td>
                                            
                                        </tr>
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
                
                
                
                
                <!-------------------------BRSF ----------------------->
                <div class="row  " style="padding-top: 1em;"  >
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_VF_LABEL_BRSF}</div>                            
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        
                        
                        <div class="PanelBody" >
                            <div class="bs table-responsive" style="padding-bottom: 1em;" > 
                                <table class="bs table table-condensed" style="margin-bottom: 0; width:60%" >
                                    <tr>
                                        <td style="border-left: 1px solid #ddd;width:8%"   class="MethodologyLabel" title="Start Date " >
                                            {!$Label.ASI_CRM_CN_Start_Date}
                                        </td>
                                        <td style="width:10% ; border-left: 1px solid #ddd;" ><apex:outputField value="{!PH.ASI_CRM_CN_PO_Start_Date__c}" />     </td>
                                        <td  style="border-left: 1px solid #ddd;  border-right: 1px solid #ddd; width:10% "  class="MethodologyLabel" title=" End Date" >
                                            {!$Label.ASI_CRM_CN_End_Date}
                                        </td>
                                        <td style="border-right: 1px solid #ddd;width:10% "  ><apex:outputField value="{!BRSFItemMap.Module.ASI_CRM_End_Date__c}"/></td>
                                    </tr>                                    
                                    <tr>
                                        <td style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;width:8%"   class="MethodologyLabel" >
                                            {!$Label.ASI_CRM_CN_Key_Principle}
                                        </td>
                                        <td style="width:10% ; border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                            <apex:outputField value="{!BRSFItemMap.Module.ASI_CRM_Methodology__r.Name} "  rendered="{!!showCN}" />
                                            <apex:outputField value="{!BRSFItemMap.Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                                        </td>
                                        <td  style="border-left: 1px solid #ddd;  border-right: 1px solid #ddd; border-bottom: 1px solid #ddd;width:10% "  class="MethodologyLabel"  >
                                            </td>
                                        <td style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;width:10% "   > </td>
                                    </tr>
                                    
                                    <tr>
                                        <td style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;width:8%"   class="MethodologyLabel" >
                                             {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Remark__c.Label}
                                        </td>
                                        <td style=" border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;border-right: 1px solid #ddd;" colspan="3">
                                           {!BRSFItemMap.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Remark__c}
                                        </td>
                                       
                                    </tr>
                                    <tr>
                                        <td style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;width:8%"   class="MethodologyLabel" >
                                             {!$Label.ASI_CRM_CN_Contract_Terms_Ref}
                                        </td>
                                        <td style=" border-left: 1px solid #ddd;border-bottom: 1px solid #ddd;border-right: 1px solid #ddd;" colspan="3">
                                            <apex:outputText escape="false" value="{!BRSFItemMap.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Payment_Reference__c}"/>
                                        </td>
                                    </tr>

                                </table>
                            </div>
                            
                            <apex:outputPanel id="BRSFPanel"   >
                                <table class="bs table table-condensed" style=" margin-bottom: 0;" id="BRSFDataTable"  >
                                    <thead>
                                        <tr>
                                            <th ><apex:outputText value="{!$ObjectType.ASI_MFM_Sub_brand__c.Label}" /></th>
                                            <th ><apex:outputText value="{!$Label.ASI_CRM_CN_Grade}" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_Incentive_Per_Bottle}" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Intake_Std_Btl}<br/>({!$Label.ASI_CRM_CN_Std_Btl})" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Cap_Collection_Vol_Std_Btl}<br/>({!$Label.ASI_CRM_CN_Std_Btl})" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_BC}" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Vol_Std_Btl}" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Amount}" /></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <apex:variable value="{!0}" var="Incentive_BT"/>
                                        <apex:variable value="{!0}" var="Actual_Vol"/>
                                        <apex:variable value="{!0}" var="Cap_Collection_Vol"/>
                                        <apex:variable value="{!0}" var="Payable_Vol"/>
                                        <apex:variable value="{!0}" var="Total_Payable"/>
                                        
                                        <apex:repeat value="{!BRSFItemMap.DetailLineMap}"  var="itm" id="item" >
                                            <apex:variable var="Incentive_BT" value="{!Incentive_BT+BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Incentive_BT__c}"/>
                                            <apex:variable var="Actual_Vol" value="{!Actual_Vol+BRSFItemMap.DetailLineMap[itm].ASI_CRM_CTD_Actual_Vol__c}"/>  
                                            <apex:variable var="Cap_Collection_Vol" value="{!Cap_Collection_Vol+BRSFItemMap.DetailLineMap[itm].ASI_CRM_CTD_Cap_Collection_Vol__c}"/>  
                                            <apex:variable var="Payable_Vol" value="{!Payable_Vol+BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Payable_Vol__c}"/>  
                                            <apex:variable var="Total_Payable" value="{!Total_Payable+BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Total_Payable__c}"/>
                                            
                                            
                                            <tr>
                                                <td class="BorderBottom" >
                                                    <apex:outputField value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Sub_Brand__c}"/>
                                                </td> 
                                                
                                                <td class="BorderBottom" >
                                                    <!----<apex:outputField value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Standard__c}"/>--------------->
                                                     <apex:outputLink value="/{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__c}">{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__r.ASI_CRM_Chinese_Name__c}</apex:outputLink>

                                                </td> 
                                                <td class="BorderBottom" style="{!IF(BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Allow_Changing_Incentive__c,'background-color: lightblue;','')}" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}" 
                                                                     style="{!IF(BRSFItemMap.DetailLineMap[itm].ASI_CRM_Over_Incentive__c,'color: red; font-weight: bold;','')}  " > 
                                                        <apex:param value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Incentive_BT__c}"/>
                                                    </apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CTD_Actual_Vol__c}"/></apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CTD_Cap_Collection_Vol__c}"/></apex:outputText>
                                                </td>
                                                
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0,number,0.0}%"><apex:param value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Collection_Rate__c}"/></apex:outputText>
                                                </td>
                                                
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"
                                                                     style="{!IF(BRSFItemMap.DetailLineMap[itm].ASI_CRM_Suggested_Value__c < BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Payable_Vol__c,'color: red; font-weight: bold;','')}" >
                                                        <apex:param value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Payable_Vol__c}"/>
                                                    </apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!BRSFItemMap.DetailLineMap[itm].ASI_CRM_CN_Total_Payable__c}"/></apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                        <tr class="FontWeightCSS" style="background-color: #e3e3d7;" >
                                            <td>{!$Label.ASI_CRM_CN_Total_Amount} 
                                            </td>
                                            <td></td>
                                            <td id="BRSFTotalIncentiveBTId" >
                                                <!-- <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!Incentive_BT}"/></apex:outputText> -->
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!Actual_Vol}"/></apex:outputText>
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!Cap_Collection_Vol}"/></apex:outputText>
                                            </td>
                                            <td>
                                                <apex:outputText value="{0,number,0.0}%" rendered="{!Actual_Vol!=null && Actual_Vol!=0 && Cap_Collection_Vol!=0 && Cap_Collection_Vol!=null}">
                                                    <apex:param value="{!(Cap_Collection_Vol/Actual_Vol)*100}" />
                                                </apex:outputText>
                                                <apex:outputText value=" - " rendered="{!Actual_Vol==null||Cap_Collection_Vol==0||Actual_Vol==0||Cap_Collection_Vol==null}" />
                                            </td>
                                            <td id="BRSFTotalPayableVolId">
                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!Payable_Vol}"/></apex:outputText>
                                            </td>
                                            <td id="BRSFTotalPayableAmountId" >
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!Total_Payable}"/></apex:outputText>
                                            </td>
                                        </tr>
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>
                            
                            
                            <div class="bs table-responsive" style="padding-top: 1em; padding-left: 2em; padding-bottom: 1em;" > 
                                <table class="bs table table-condensed" style="margin-bottom: 0; width:50%;" >
                                    <tr>
                                        <td style="border-left: 1px solid #ddd;width:10% "   class="MethodologyLabel">
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Historical_Paid_Amount__c.Label}
                                        </td>
                                        <td style="border-left: 1px solid #ddd;width:15% " ><apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!BRSFItemMap.Module.ASI_CRM_Historical_Paid_Amount__c}"/></apex:outputText></td>
                                        <td  style="border-left: 1px solid #ddd;width:10% "  class="MethodologyLabel" >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Application_Payment_Amount__c.Label}
                                        </td>
                                        <td style=" border-left: 1px solid #ddd; border-right: 1px solid #ddd;width:15% "  >
                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!BRSFItemMap.Module.ASI_CRM_Application_Payment_Amount__c}"/></apex:outputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Adjustment__c.Label}
                                        </td>
                                        <td style="border-left: 1px solid #ddd; " >
                                            <apex:outputText value="{0,number,#,###,##0.00}%"><apex:param value="{!BRSFItemMap.Module.ASI_CRM_Adjustment__c}"/></apex:outputText>
                                        </td>
                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Actual_Payment__c.Label}
                                        </td>
                                        <td style="  border-left: 1px solid #ddd; border-right: 1px solid #ddd; "  >
                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!BRSFItemMap.Module.ASI_CRM_Actual_Payment__c}"/></apex:outputText></td>
                                    </tr>
                                    <tr>
                                        <td style=" border-left: 1px solid #ddd;  border-bottom: 1px solid #ddd;"  class="MethodologyLabel" >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Overpayment_Reason__c.Label}
                                        </td>
                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >{!BRSFItemMap.Module.ASI_CRM_Overpayment_Reason__c}</td>
                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;" class="MethodologyLabel"  >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Other_Comments__c.Label}
                                        </td>
                                        <td style="  border-left: 1px solid #ddd;border-right: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >{!BRSFItemMap.Module.ASI_CRM_Other_Comments__c}</td>
                                    </tr>
                                </table>
                            </div>
                            
                        </div>
                        
                    </div>
                </div>
                
                
                
                
                <!--------------------------------------------------------------PSF-------------------------------------------------------------->
                <div class="row  " style="padding-top: 1em;">
                    <div class="col">
                        <apex:outputPanel id="PSFPanel">
                            <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                                <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >PSF</div>
                                <div style="grid-column-start: 2; grid-column-end: 2;  " >
                                    
                                </div>
                            </div>
                            <div class="PanelBody" >
                                <apex:variable value="{!0}" var="i"/>
                                <apex:repeat value="{!PSF_Item_Map}"  var="itm" id="PSFitem" >
                                    <apex:variable var="i" value="{!i+1}"/>
                                    
                                    <div class="panel panel-primary">
                                        <div class="panel-heading">{!$Label.ASI_CRM_CN_Module}-{!i}</div>
                                        
                                        <div class="panel-body">
                                            
                                            <div class="bs table-responsive" style="padding-bottom: 1em;" > 
                                                
                                                <table class="bs table table-condensed" style="margin-bottom: 0; width:80%" >
                                                    <tr>
                                                        <td style="border-left: 1px solid #ddd;width:10%" class="MethodologyLabel" >{!$Label.ASI_CRM_CN_Start_Date}:</td>
                                                        <td style="width:10%" ><apex:outputField value="{!PH.ASI_CRM_CN_PO_Start_Date__c}" /></td>
                                                        <td style="border-left: 1px solid #ddd;width:10%"  class="MethodologyLabel"  >{!$Label.ASI_CRM_CN_End_Date}:</td>
                                                        <td style="border-right: 1px solid #ddd;"  >
                                                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_End_Date__c}"/>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <table class="bs table table-condensed" style="margin-bottom: 0; width:80%"  >
                                                    <tr>
                                                        <td style="border-left: 1px solid #ddd; width:10%" class="MethodologyLabel" >{!$Label.ASI_CRM_CN_Key_Principle}</td>
                                                        <td style="width:25%" >
                                                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Methodology__r.Name}"  rendered="{!!showCN}" />
                                                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                                                        </td>
                                                        <td style="width:15%; border-left: 1px solid #ddd;" class="WeightLeft" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}</td>
                                                        <td style="width:10%" >
                                                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c}"/>
                                                        </td>
                                                        <td  style="border-left: 1px solid #ddd;width:15%" class="WeightLeft" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Unit__c.Label}</td>
                                                        <td style="border-right: 1px solid #ddd;  "  >
                                                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="1" style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd; width:20%" class="MethodologyLabel"> 
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Remark__c.Label}
                                                        </td>
                                                        <td colspan="5" style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                                            {!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Remark__c}
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="1" style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd; width:20%" class="MethodologyLabel"> 
                                                            {!$Label.ASI_CRM_CN_Contract_Terms_Ref}
                                                        </td>
                                                        <td colspan="5" style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                                            <apex:outputText escape="false" value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Payment_Reference__c}"/>
                                                        </td>
                                                        
                                                    </tr>
                                                </table>
                                                
                                            </div>                                            
                                            <apex:outputPanel >
                                                
                                                <table class="bs table table-condensed" style="margin-bottom: 0;"  >
                                                    <thead>
                                                        <tr>
                                                            <th style=" {!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;width:20%;')}  " >
                                                                {!$ObjectType.ASI_MFM_Sub_brand__c.Label}</th>
                                                            <th style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                                {!$Label.ASI_CRM_CN_Grade}
                                                            </th>
                                                            <th style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c!='By Sub-Brand','','display:none;')}"  >
                                                                {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}
                                                            </th>
                                                            <th>
                                                                <div style=" {!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                                                    <apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_Incentive_Per_Bottle}" />
                                                                </div>
                                                                <div style=" {!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  " >
                                                                    {!$Label.ASI_CRM_CN_CTD_Incentive_Target}
                                                                </div>
                                                            </th>
                                                            <th> 
                                                                {!$Label.ASI_CRM_CN_CTD_Volume_Target} <br/> (<apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)
                                                            </th>
                                                            
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Intake_Std_Btl}" /><br/> (<apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th>
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Cap_Collection_Vol_Std_Btl}" /><br/>  (<apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th>
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_BC}" /></th>
                                                            <th style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Vol_Std_Btl}" /></th>
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Amount}" /></th>
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Completion_Ratio}" /></th>
                                                            <th style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                                <apex:outputText escape="false" value="{!$ObjectType.ASI_CRM_CN_Contract_BRSF_Line_Item__c.Fields.ASI_CRM_Key_Sub_brand__c.Label}"/>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <apex:variable value="{!0}" var="PSFIncentive_BT"/>
                                                        <apex:variable value="{!0}" var="PSFV0_0_Full_Contract_Target"/>
                                                        <apex:variable value="{!0}" var="PSFActual_Vol"/>
                                                        <apex:variable value="{!0}" var="PSFCap_Collection_Vol"/>
                                                        <apex:variable value="{!0}" var="PSFPayable_Vol"/>
                                                        <apex:variable value="{!0}" var="PSFTotal_Payable"/>
                                                        <apex:variable value="{!0}" var="PSFCompletionRatio"/>
                                                        
                                                        <apex:variable value="{!0}" var="PSFIntake"/>
                                                        <apex:variable value="{!0}" var="PSFBC"/>
                                                        
                                                        <apex:repeat value="{!PSF_Item_Map[itm].DetailLineMap}"  var="line" id="lineItem" >
                                                            <apex:variable var="PSFIncentive_BT" value="{!PSFIncentive_BT+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Incentive_BT__c}"/>
                                                            <apex:variable var="PSFV0_0_Full_Contract_Target" value="{!PSFV0_0_Full_Contract_Target+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                                            <apex:variable var="PSFActual_Vol" value="{!PSFActual_Vol+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Actual_Vol__c}"/>  
                                                            <apex:variable var="PSFCap_Collection_Vol" value="{!PSFCap_Collection_Vol+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Cap_Collection_Vol__c}"/>  
                                                            <apex:variable var="PSFPayable_Vol" value="{!PSFPayable_Vol+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Payable_Vol__c}"/>  
                                                            <apex:variable var="PSFTotal_Payable" value="{!PSFTotal_Payable+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c}"/>
                                                            
                                                            <apex:variable var="PSFIntake" value="{!PSFIntake+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Actual_Vol__c}"/>  
                                                            <apex:variable var="PSFBC" value="{!PSFBC+PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Bottle_Collected__c}"/>  
                                                            
                                                            <tr>
                                                                <td class="BorderBottom" >
                                                                    <div style=" {!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                                                        <apex:outputField value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Sub_Brand__c}"    />
                                                                    </div>
                                                                    <div  style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Grade','','display:none;')}  " >
                                                                        <apex:outputLink value="/{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Sub_Brand_Grade__c}">
                                                                            {!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_Chinese_Name__c}
                                                                        </apex:outputLink>
                                                                    </div>
                                                                    <div style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Category','','display:none;')}  " >
                                                                        <apex:outputLink value="/{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Product_Category__c}" >{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Product_Category__r.ASI_CRM_CN_Chinese_Name__c}</apex:outputLink>
                                                                    </div>
                                                                    <div style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Total','','display:none;')}  " >
                                                                         {!$Label.ASI_CRM_CN_By_Total}
                                                                    </div>
                                                                </td> 
                                                                
                                                                <td class="BorderBottom" style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                                     <apex:outputLink value="/{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__c}">{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__r.ASI_CRM_Chinese_Name__c}</apex:outputLink>
                                                               
                                                                </td> 
                                                                <td class="BorderBottom" style="{!IF(PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Allow_Changing_Incentive__c,'background-color: lightblue;','')} " >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}" 
                                                                                     style="{!IF(PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Over_Incentive__c,'color: red; font-weight: bold;','')}  " > 
                                                                        <apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Incentive_BT__c}"/>
                                                                    </apex:outputText>
                                                                </td>
                                                                
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_V0_0_Full_Contract_Target__c}"/></apex:outputText>
                                                                </td>
                                                                
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Actual_Vol__c}"/></apex:outputText>
                                                                </td>
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Cap_Collection_Vol__c}"/></apex:outputText>
                                                                </td>
                                                                
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0,number,0.0}%"><apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Collection_Rate__c}"/></apex:outputText>
                                                                </td>
                                                                
                                                                <td class="BorderBottom" style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}" 
                                                                                     rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}"
                                                                                     style="{!IF(PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Suggested_Volume__c <PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Payable_Vol__c,'color: red; font-weight: bold;','')}"
                                                                                     >
                                                                        <apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Payable_Vol__c}"/>
                                                                    </apex:outputText>
                                                                    
                                                                </td>
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"
                                                                                     rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}" >
                                                                        <apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c}"/>
                                                                    </apex:outputText>
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"
                                                                                     rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c!='By Sub-Brand'}" 
                                                                                     style="{!IF(PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Suggested_Amount__c <PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c,'color: red; font-weight: bold;','')}"
                                                                                     >
                                                                        <apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c}"/>
                                                                    </apex:outputText>
                                                                    
                                                                    
                                                                </td>
                                                                
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0,number,0.0}%"><apex:param value="{!PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_CN_Completion_Rate__c}"/></apex:outputText>
                                                               </td>
                                                                <td class="BorderBottom" style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" >
                                                                    <div style="{!IF(PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Key_Sub_Brand__c,'','display:none;')}"   >
                                                                        <input name="chkBox_1" type="checkbox"  value="1" disabled="true" checked="true" />
                                                                    </div>
                                                                    <div style="{!IF(PSF_Item_Map[itm].DetailLineMap[line].ASI_CRM_Key_Sub_Brand__c,'display:none;','')}"   >
                                                                        <input name="chkBox_1" type="checkbox"  value="1" disabled="true"   />
                                                                    </div>
                                                                    
                                                                </td>
                                                            </tr>
                                                        </apex:repeat>
                                                        <tr class="FontWeightCSS" style="background-color: #e3e3d7;" >
                                                            <apex:variable var="PSFCompletionRatio" value="{!if(PSFV0_0_Full_Contract_Target!=0,(PSFActual_Vol/PSFV0_0_Full_Contract_Target)*100,0.0)}"/>
                                                            
                                                            <td>{!$Label.ASI_CRM_CN_Total_Amount}</td>
                                                            <td  style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ></td>
                                                            <td id="{!'PSFTotalIncentiveBT_'+itm}" >
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}" rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c!='By Sub-Brand'}"><apex:param value="{!PSFIncentive_BT}"/></apex:outputText>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSFV0_0_Full_Contract_Target}"/></apex:outputText>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFActual_Vol}"/></apex:outputText>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFCap_Collection_Vol}"/></apex:outputText>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{0,number,0.0}%" rendered="{!PSFIntake!=null && PSFIntake!=0 && PSFBC!=0 && PSFBC!=null}">
                                                                    <apex:param value="{!(PSFBC/PSFIntake)*100}" />
                                                                </apex:outputText>
                                                                <apex:outputText value=" - " rendered="{!PSFIntake==0 || PSFIntake==null||PSFBC==0||PSFBC==null}" />
                                                                
                                                            </td>
                                                            
                                                            <td id="{!'PSFTotalPayableVolId_'+itm}" style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"   >
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFPayable_Vol}"/></apex:outputText>
                                                            </td>
                                                            <td id="{!'PSFTotalPayableAmountId_'+itm}"  >
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSFTotal_Payable}"/></apex:outputText>
                                                            </td>
                                                            
                                                            <td>
                                                                <apex:outputText value="{0,number,0.0}%"><apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Completion_Ratio__c}"/></apex:outputText>
                                                            </td>
                                                            <td  style="{!IF(PSF_Item_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ></td>
                                                        </tr>
                                                        
                                                        
                                                    </tbody>
                                                    
                                                </table>
                                            </apex:outputPanel>
                                            
                                            <div class="bs table-responsive" style="padding-top: 1em; padding-left: 2em; padding-bottom: 1em;" > 
                                                
                                                
                                                <table class="bs table table-condensed" style="margin-bottom: 0; width:50%;" >
                                                    <tr>
                                                        <td style="border-left: 1px solid #ddd;width:10% "   class="MethodologyLabel">
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Historical_Paid_Amount__c.Label}
                                                        </td>
                                                        <td style="border-left: 1px solid #ddd;width:15% " ><apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Historical_Paid_Amount__c}"/></apex:outputText></td>
                                                        <td  style="border-left: 1px solid #ddd;width:10% "  class="MethodologyLabel" >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Application_Payment_Amount__c.Label}
                                                        </td>
                                                        <td style=" border-left: 1px solid #ddd; border-right: 1px solid #ddd;width:15% "  > 
                                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Application_Payment_Amount__c}"/></apex:outputText></td>
                                                    </tr>
                                                    <tr>
                                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Adjustment__c.Label}
                                                        </td>
                                                        <td style="border-left: 1px solid #ddd; " >
                                                            <apex:outputText value="{0,number,#,###,##0.00}%"><apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Adjustment__c}"/></apex:outputText>
                                                        
                                                        </td>
                                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Actual_Payment__c.Label}
                                                        </td>
                                                        <td style="  border-left: 1px solid #ddd; border-right: 1px solid #ddd; "  >
                                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c}"/></apex:outputText>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style=" border-left: 1px solid #ddd;  border-bottom: 1px solid #ddd;"  class="MethodologyLabel" >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_PSF_Overpayment_Reason__c.Label}
                                                        </td>
                                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >{!PSF_Item_Map[itm].Module.ASI_CRM_PSF_Overpayment_Reason__c}</td>
                                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;" class="MethodologyLabel"  >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Other_Comments__c.Label}
                                                        </td>
                                                        <td style="  border-left: 1px solid #ddd;border-right: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >
                                                            {!PSF_Item_Map[itm].Module.ASI_CRM_Other_Comments__c}</td>
                                                    </tr>
                                                </table>                       
                                                
                                                
                                                
                                            </div>
                                            
                                            
                                        </div>
                                    </div>
                                </apex:repeat>
                            </div>
                            
                        </apex:outputPanel>
                    </div>
                    
                </div>
                
                
                
                
                
                
                
                <!--------------------------------Variable Event Cost -------------------------------------------------------------->
                 <apex:outputPanel rendered="{!DisplayVEC}">
                <div class="row  " style="padding-top: 1em;" >
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_Variable_Event_Cost}</div>
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        
                        
                        <div class="PanelBody" >
                            <table class="bs table table-condensed" style="margin-bottom: 0; width:80%" >
                                <tr>
                                    <td style="border-left: 1px solid #ddd;width:10%" class="MethodologyLabel" >{!$Label.ASI_CRM_CN_Start_Date}:</td>
                                    <td style="width:10%" ><apex:outputField value="{!PH.ASI_CRM_CN_PO_Start_Date__c}" /></td>
                                    <td style="border-left: 1px solid #ddd;width:10%"  class="MethodologyLabel"  >{!$Label.ASI_CRM_CN_End_Date}:</td>
                                    <td style="border-right: 1px solid #ddd;"  >
                                        <apex:outputField value="{!VariableEventCost.Module.ASI_CRM_End_Date__c}" />
                                    </td>
                                </tr>
                            </table>
                            
                            <table class="bs table table-condensed" style="margin-bottom: 0; width:80%"  >
                                <tr>
                                    <td style="border-left: 1px solid #ddd; width:10%" class="MethodologyLabel" >{!$Label.ASI_CRM_CN_Key_Principle}</td>
                                    <td style="width:25%" ><!---{!VariableEventCost.MethodologyValue}--->
                                        <apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Methodology__r.Name}"  rendered="{!!showCN}" />
                                        <apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                                    </td>
                                    <td style="width:15%; border-left: 1px solid #ddd;" class="WeightLeft" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}</td>
                                    <td style="width:10%" >
                                        <apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c}"/>
                                    </td>
                                    <td  style="border-left: 1px solid #ddd;width:15%" class="WeightLeft" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Unit__c.Label}</td>
                                    <td style="border-right: 1px solid #ddd;  "  >
                                        <apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td colspan="1" style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd; width:20%" class="MethodologyLabel"> 
                                        {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Remark__c.Label}
                                    </td>
                                    <td colspan="5" style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                        {!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Remark__c}
                                    </td>
                                </tr>
                                
                                  <tr>
                                    <td colspan="1" style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd; width:20%" class="MethodologyLabel"> 
                                       {!$Label.ASI_CRM_CN_Contract_Terms_Ref}
                                    </td>
                                    <td colspan="5" style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                         <apex:outputText escape="false" value="{!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Payment_Reference__c}"/>
                                    </td>
                                </tr>
                            </table>
                            
                            <apex:outputPanel id="VECPanel">
                                <table class="bs table table-condensed" style="margin-bottom: 0;" id="VECDataTable"  >
                                    <thead>
                                        <tr>
                                            <th style=" {!IF(VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;width:20%;')}  " >
                                                {!$ObjectType.ASI_MFM_Sub_brand__c.Label}
                                            </th>
                                            <th style="{!IF(VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                {!$Label.ASI_CRM_CN_Grade}
                                            </th>
                                            <th style="{!IF(VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c!='By Sub-Brand','','display:none;')}"  >
                                                {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}
                                            </th>
                                            <th style="{!IF(VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_Incentive_Per_Bottle}" /></th>
                                            <th style="{!IF(VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}">{!$Label.ASI_CRM_CN_CTD_Incentive_Target}</th>
                                            <th>{!$Label.ASI_CRM_CN_CTD_Volume_Target} <br/> (<apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Intake_Std_Btl}" /> <br/> (<apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Cap_Collection_Vol_Std_Btl}" /><br/>(<apex:outputField value="{!VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_BC}" /></th>
                                            <th style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " ><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Vol_Std_Btl}" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Amount}" /></th>
                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Completion_Ratio}" /></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                        <apex:variable value="{!0}" var="Incentive_BT"/>
                                        <apex:variable value="{!0}" var="V0_0_Full_Contract_Target"/>
                                        <apex:variable value="{!0}" var="Actual_Vol"/>
                                        <apex:variable value="{!0}" var="Cap_Collection_Vol"/>
                                        <apex:variable value="{!0}" var="Payable_Vol"/>
                                        <apex:variable value="{!0}" var="Total_Payable"/>
                                        <apex:variable value="{!0}" var="CompletionRatio"/>
                                        <apex:variable value="{!0}" var="VECCTDIntake"/>
                                        <apex:variable value="{!0}" var="VECCTDBC"/>
                                        
                                        
                                        <apex:repeat value="{!VariableEventCost.DetailLineMap}"  var="itm" id="VECitem" >
                                            
                                            <apex:variable var="Incentive_BT" value="{!Incentive_BT+VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Incentive_BT__c}"/>
                                            <apex:variable var="V0_0_Full_Contract_Target" value="{!V0_0_Full_Contract_Target+VariableEventCost.DetailLineMap[itm].ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                            <apex:variable var="Actual_Vol" value="{!Actual_Vol+VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Actual_Vol__c}"/>  
                                            <apex:variable var="Cap_Collection_Vol" value="{!Cap_Collection_Vol+VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Bottle_Collected__c}"/>  
                                            
                                            <apex:variable var="Payable_Vol" value="{!Payable_Vol+VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Payable_Vol__c}"/>  
                                            <apex:variable var="Total_Payable" value="{!Total_Payable+VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Total_Payable__c}"/>
                                            
                                            <apex:variable var="VECCTDIntake" value="{!VECCTDIntake+VariableEventCost.DetailLineMap[itm].ASI_CRM_CTD_Actual_Vol__c}"/>  
                                            <apex:variable var="VECCTDBC" value="{!VECCTDBC+VariableEventCost.DetailLineMap[itm].ASI_CRM_CTD_Cap_Collection_Vol__c}"/>  
                                            
                                            <tr>
                                                
                                                <td class="BorderBottom" >
                                                    <div   style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  ">
                                                        <apex:outputField value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Sub_Brand__c}" />
                                                    </div>
                                                    <div  style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Grade','','display:none;')}  " >
                                                        <apex:outputLink value="/{!VariableEventCost.DetailLineMap[itm].ASI_CRM_Sub_Brand_Grade__c}">
                                                            {!VariableEventCost.DetailLineMap[itm].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_Chinese_Name__c}
                                                        </apex:outputLink>
                                                    </div>
                                                    <div style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Category','','display:none;')}  " >
                                                        <apex:outputLink value="/{!VariableEventCost.DetailLineMap[itm].ASI_CRM_Product_Category__c}" >
                                                            {!VariableEventCost.DetailLineMap[itm].ASI_CRM_Product_Category__r.ASI_CRM_CN_Chinese_Name__c}</apex:outputLink>
                                                    </div>
                                                    <div style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Total','','display:none;')}  " >
                                                      {!$Label.ASI_CRM_CN_By_Total}
                                                    </div>
                                                </td>
                                                <td class="BorderBottom"  style="{!IF(VariableEventCost.Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"   >
                                                    <apex:outputLink value="/{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__c}">{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__r.ASI_CRM_Chinese_Name__c}</apex:outputLink>
                                                </td> 
                                                <td class="BorderBottom" style="{!IF(VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Allow_Changing_Incentive__c,'background-color: lightblue;','')}"   >
                                                    <apex:outputField value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Incentive_BT__c}" style="{!IF(VariableEventCost.DetailLineMap[itm].ASI_CRM_Over_Incentive__c,'color: red; font-weight: bold;','')}"/>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputField value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_V0_0_Full_Contract_Target__c}" />
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CTD_Actual_Vol__c}"/></apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CTD_Cap_Collection_Vol__c}"/></apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0,number,0.0}%"><apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Collection_Rate__c}"/></apex:outputText>
                                                </td>
                                                <td class="BorderBottom" style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"
                                                                     rendered="{!VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}"
                                                                     style="{!IF(VariableEventCost.DetailLineMap[itm].ASI_CRM_Suggested_Value__c < VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Payable_Vol__c,'color: red; font-weight: bold;','')}"
                                                                     >
                                                        <apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Payable_Vol__c}"/>
                                                    </apex:outputText>
                                                </td>
                                                <td class="BorderBottom" >
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}" rendered="{!VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}" >
                                                        <apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Total_Payable__c}"/>
                                                    </apex:outputText>
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}" 
                                                                     rendered="{!VariableEventCost.Module.ASI_CRM_Volume_Base__c!='By Sub-Brand'}" 
                                                                     style="{!IF(VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Suggested_Amount__c < VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Total_Payable__c,'color: red; font-weight: bold;','')}"
                                                                     >
                                                        <apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Total_Payable__c}"/>
                                                    </apex:outputText>
                                                    
                                                </td>
                                                <td class="BorderBottom" >
                                                    <!---<apex:outputField value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Completion_Rate__c}" />------------>
                                                       <apex:outputText value="{0,number,0.0}%"><apex:param value="{!VariableEventCost.DetailLineMap[itm].ASI_CRM_CN_Completion_Rate__c}"/></apex:outputText>
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                        <tr class="FontWeightCSS" style="background-color: #e3e3d7;" >
                                            
                                            <td>{!$Label.ASI_CRM_CN_Total_Amount}</td>
                                            <td  style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ></td>
                                            <td id="VECTotalIncentiveBTId"  >
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}" rendered="{!VariableEventCost.Module.ASI_CRM_Volume_Base__c!='By Sub-Brand'}"><apex:param value="{!Incentive_BT}"/></apex:outputText>
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!V0_0_Full_Contract_Target}"/></apex:outputText>
                                            </td>
                                             <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!VECCTDIntake}"/></apex:outputText>
                                            </td>
                                            <td>
                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!VECCTDBC}"/></apex:outputText>
                                            </td>
                                            
                                            <td>
                                                <apex:outputText value="{0,number,0.0}%" rendered="{!Actual_Vol!=null && Actual_Vol!=0 && Cap_Collection_Vol!=0&&Cap_Collection_Vol!=null}">
                                                    <apex:param value="{!(Cap_Collection_Vol/Actual_Vol)*100}" />
                                                </apex:outputText>
                                                <apex:outputText value=" - " rendered="{!Actual_Vol==null||Actual_Vol==0||Cap_Collection_Vol==0||Cap_Collection_Vol==null}" />
                                               
                                            </td>
                                            
                                            <td id="VECTotalPayableVolId"  style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!Payable_Vol}"/></apex:outputText>
                                            </td>
                                            <td id="VECTotalPayableAmountId" >
                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!Total_Payable}"/></apex:outputText>
                                            </td>
                                            <td  >
                                                 <apex:outputText value="{0,number,#,###,##0.0}%" 
                                                                 rendered="{!VariableEventCost.VolumeTarget!=null && VariableEventCost.VolumeTarget!=0 && VariableEventCost.RealVolume!=0}">
                                                    <apex:param value="{!(VariableEventCost.RealVolume/VariableEventCost.VolumeTarget)*100}"/>
                                                </apex:outputText>
                                                <apex:outputText value=" - " rendered="{!VariableEventCost.RealVolume==null || VariableEventCost.VolumeTarget==null || VariableEventCost.VolumeTarget==0}" />     
                                            </td>
                                            <td  style="{!IF(VariableEventCost.Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ></td>
                                        </tr>
                                        
                                        
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>
                            
                            
                            <div class="bs table-responsive" style="padding-top: 1em; padding-left: 2em; padding-bottom: 1em;" > 
                                
                                
                                
                                <table class="bs table table-condensed" style="margin-bottom: 0; width:50%;" >
                                    <tr>
                                        <td style="border-left: 1px solid #ddd;width:10% "   class="MethodologyLabel">
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Historical_Paid_Amount__c.Label}
                                        </td>
                                        <td style="border-left: 1px solid #ddd;width:15% " ><apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!VariableEventCost.Module.ASI_CRM_Historical_Paid_Amount__c}"/></apex:outputText></td>
                                        <td  style="border-left: 1px solid #ddd;width:10% "  class="MethodologyLabel" > {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Application_Payment_Amount__c.Label}</td>
                                        <td style=" border-left: 1px solid #ddd; border-right: 1px solid #ddd;width:15% "  >
                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!VariableEventCost.Module.ASI_CRM_Application_Payment_Amount__c}"/></apex:outputText></td>
                                    </tr>
                                    <tr>
                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Adjustment__c.Label}</td>
                                        <td style="border-left: 1px solid #ddd; " >
                                            <apex:outputText value="{0,number,#,###,##0.00}%"><apex:param value="{!VariableEventCost.Module.ASI_CRM_Adjustment__c}"/></apex:outputText>
                                        </td>
                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  > {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Actual_Payment__c.Label}</td>
                                        <td style="  border-left: 1px solid #ddd; border-right: 1px solid #ddd; "  ><apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!VariableEventCost.Module.ASI_CRM_Actual_Payment__c}"/></apex:outputText></td>
                                    </tr>
                                    <tr>
                                        <td style=" border-left: 1px solid #ddd;  border-bottom: 1px solid #ddd;"  class="MethodologyLabel" >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Overpayment_Reason__c.Label}
                                        </td>
                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >{!VariableEventCost.Module.ASI_CRM_Overpayment_Reason__c}</td>
                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;" class="MethodologyLabel"  >
                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Other_Comments__c.Label}
                                        </td>
                                        <td style="  border-left: 1px solid #ddd;border-right: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >  {!VariableEventCost.Module.ASI_CRM_Other_Comments__c}</td>
                                    </tr>
                                </table>                       
                                
                                
                            </div>
                        </div>
                        
                    </div>
                </div>
                </apex:outputPanel>
                
                <!-------------------------------- Other Payment Detail -------------------------------------------------------------->
                
                <div class="row  " style="padding-top: 1em;" >
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_Contract_Fix_Cost}</div>
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        <div class="PanelBody" >
                            
                            <!-- <apex:outputPanel id="OtherPaymentDetailPanel"  >
                                <table class="bs table table-condensed" style="margin-bottom: 0;" id="OtherPaymentDetailDataTable"  >
                                    <thead>
                                        <tr>
                                            <th >{!$ObjectType.ASI_TH_CRM_PaymentRequestLineItem__c.Fields.ASI_CRM_CN_Expense_Type__c.Label}</th>
                                            <th> {!$Label.ASI_CRM_CN_Contract_Terms_Ref}</th>
                                            <th><apex:outputText value="{!$ObjectType.ASI_CRM_Contract_Cost__c.Fields.ASI_CRM_CN_Contract_Amount__c.Label}" /></th>
                                            
                                            <th >{!$ObjectType.ASI_TH_CRM_PaymentRequestLineItem__c.Fields.ASI_TH_CRM_Amount__c.Label}</th>
                                            <th >{!$ObjectType.ASI_TH_CRM_PaymentRequestLineItem__c.Fields.ASI_CRM_CN_Comment__c.Label}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                        <apex:repeat value="{!OtherPaymentLineList}"  var="OtherPaymentLine" id="OtherPaymentLineTable" >
                                            <tr>
                                                 <td>
                                                   {!OtherPaymentLine.ASI_CRM_CN_Expense_Type__c}
                                                </td> 
                                                <td>
                                                    <apex:outputField value="{!OtherPaymentLine.ASI_CRM_CN_Contract_Cost__r.ASI_CRM_Contract_Terms__c}"/>
                                                </td> 
                                               
                                                <td>
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!OtherPaymentLine.ASI_CRM_CN_Contract_Cost__r.ASI_CRM_CN_Contract_Amount__c}"/></apex:outputText>
                                                </td>
                                                <td>
                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!OtherPaymentLine.ASI_TH_CRM_Amount__c}"/></apex:outputText>
                                                </td>
                                                <td>{!OtherPaymentLine.ASI_CRM_CN_Comment__c}</td>
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>     -->                        

                            <apex:outputPanel id="OtherPaymentDetailPanel">
                            	<apex:variable value="{!0}" var="i"/>
                                <apex:repeat value="{!PSF_Fixed_Map}"  var="itm" id="PSFFixed" >
                                    <apex:variable var="i" value="{!i+1}"/>
                                    
                                    <div class="panel panel-primary">
                                        <div class="panel-heading" style=" {!IF(showCN,'','display:none;width:20%;')}  ">{!PSF_Fixed_Map[itm].Module.ASI_CRM_CN_AC_Code__r.ASI_MFM_A_C_CN_Description__c}</div>
                                        <div class="panel-heading" style=" {!IF(showCN,'display:none;width:20%;','')}  ">{!PSF_Fixed_Map[itm].Module.ASI_CRM_CN_AC_Code__r.ASI_MFM_A_C_Description__c}</div>
                                        
                                        <div class="panel-body">
                                            
                                            <div class="bs table-responsive" style="padding-bottom: 1em;" > 
                                                
                                                <table class="bs table table-condensed" style="margin-bottom: 0; width:80%" >
                                                    <tr>
                                                        <td style="border-left: 1px solid #ddd;width:10%" class="MethodologyLabel" >{!$Label.ASI_CRM_CN_Start_Date}:</td>
                                                        <td style="width:10%" ><apex:outputField value="{!PH.ASI_CRM_CN_PO_Start_Date__c}" /></td>
                                                        <td style="border-left: 1px solid #ddd;width:10%"  class="MethodologyLabel"  >{!$Label.ASI_CRM_CN_End_Date}:</td>
                                                        <td style="border-right: 1px solid #ddd;"  >
                                                            <apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_End_Date__c}"/>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <table class="bs table table-condensed" style="margin-bottom: 0; width:80%"  >
                                                    <tr>
                                                        <!-- <td style="border-left: 1px solid #ddd; width:10%" class="MethodologyLabel" >{!$Label.ASI_CRM_CN_Key_Principle}</td>
                                                        <td style="width:25%" >
                                                            <apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Methodology__r.Name}"  rendered="{!!showCN}" />
                                                            <apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                                                        </td> -->
                                                        <td style="width:10%; border-left: 1px solid #ddd;" class="WeightLeft" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}</td>
                                                        <td style="width:10%" >
                                                            <apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c}"/>
                                                        </td>
                                                        <td  style="border-left: 1px solid #ddd;width:10%" class="WeightLeft" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Unit__c.Label}</td>
                                                        <td style="border-right: 1px solid #ddd;  "  >
                                                            <apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="1" style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd; width:20%" class="MethodologyLabel"> 
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Remark__c.Label}
                                                        </td>
                                                        <td colspan="5" style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                                            {!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Remark__c}
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="1" style="border-left: 1px solid #ddd;border-bottom: 1px solid #ddd; width:20%" class="MethodologyLabel"> 
                                                            {!$Label.ASI_CRM_CN_Contract_Terms_Ref}
                                                        </td>
                                                        <td colspan="5" style="border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;" >
                                                            <apex:outputText escape="false" value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Payment_Reference__c}"/>
                                                        </td>
                                                        
                                                    </tr>
                                                </table>
                                                
                                            </div>                                            
                                            <apex:outputPanel >
                                                
                                                <table class="bs table table-condensed" style="margin-bottom: 0;"  >
                                                    <thead>
                                                        <tr>
                                                            <th style=" {!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;width:20%;')}  " >
                                                                {!$ObjectType.ASI_MFM_Sub_brand__c.Label}</th>
                                                            <th style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                                {!$Label.ASI_CRM_CN_Grade}
                                                            </th>
                                                            <th style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c!='By Sub-Brand','','display:none;')}"  >
                                                                {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}
                                                            </th>
                                                            <th>
                                                                <div style=" {!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                                                    <apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_Incentive_Per_Bottle}" />
                                                                </div>
                                                                <div style=" {!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  " >
                                                                    {!$Label.ASI_CRM_CN_CTD_Incentive_Target}
                                                                </div>
                                                            </th>
                                                            <th> 
                                                                {!$Label.ASI_CRM_CN_CTD_Volume_Target} <br/> (<apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)
                                                            </th>
                                                            
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Intake_Std_Btl}" /><br/> (<apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th>
                                                            <!-- <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Cap_Collection_Vol_Std_Btl}" /><br/>  (<apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}"/>)</th> -->
                                                            <!-- <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_BC}" /></th> -->
                                                            <th style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Vol_Std_Btl}" /></th>
                                                            <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Payable_Amount}" /></th>
                                                            <!-- <th><apex:outputText escape="false" value="{!$Label.ASI_CRM_CN_CTD_Completion_Ratio}" /></th> -->
                                                            <!-- <th style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                                <apex:outputText escape="false" value="{!$ObjectType.ASI_CRM_CN_Contract_BRSF_Line_Item__c.Fields.ASI_CRM_Key_Sub_brand__c.Label}"/>
                                                            </th> -->
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <apex:variable value="{!0}" var="PSFIncentive_BT"/>
                                                        <apex:variable value="{!0}" var="PSFV0_0_Full_Contract_Target"/>
                                                        <apex:variable value="{!0}" var="PSFActual_Vol"/>
                                                        <apex:variable value="{!0}" var="PSFCap_Collection_Vol"/>
                                                        <apex:variable value="{!0}" var="PSFPayable_Vol"/>
                                                        <apex:variable value="{!0}" var="PSFTotal_Payable"/>
                                                        <apex:variable value="{!0}" var="PSFCompletionRatio"/>
                                                        
                                                        <apex:variable value="{!0}" var="PSFIntake"/>
                                                        <apex:variable value="{!0}" var="PSFBC"/>
                                                        
                                                        <apex:repeat value="{!PSF_Fixed_Map[itm].DetailLineMap}"  var="line" id="lineItem" >
                                                            <apex:variable var="PSFIncentive_BT" value="{!PSFIncentive_BT+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Incentive_BT__c}"/>
                                                            <apex:variable var="PSFV0_0_Full_Contract_Target" value="{!PSFV0_0_Full_Contract_Target+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                                            <apex:variable var="PSFActual_Vol" value="{!PSFActual_Vol+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Actual_Vol__c}"/>  
                                                            <apex:variable var="PSFCap_Collection_Vol" value="{!PSFCap_Collection_Vol+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Cap_Collection_Vol__c}"/>  
                                                            <apex:variable var="PSFPayable_Vol" value="{!PSFPayable_Vol+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Payable_Vol__c}"/>  
                                                            <apex:variable var="PSFTotal_Payable" value="{!PSFTotal_Payable+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c}"/>
                                                            
                                                            <apex:variable var="PSFIntake" value="{!PSFIntake+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Actual_Vol__c}"/>  
                                                            <apex:variable var="PSFBC" value="{!PSFBC+PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Bottle_Collected__c}"/>  
                                                            
                                                            <tr>
                                                                <td class="BorderBottom" >
                                                                    <div style=" {!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                                                        <apex:outputField value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Sub_Brand__c}"    />
                                                                    </div>
                                                                    <div  style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Grade','','display:none;')}  " >
                                                                        <apex:outputLink value="/{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Sub_Brand_Grade__c}">
                                                                            {!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_Chinese_Name__c}
                                                                        </apex:outputLink>
                                                                    </div>
                                                                    <div style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Category','','display:none;')}  " >
                                                                        <apex:outputLink value="/{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Product_Category__c}" >{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Product_Category__r.ASI_CRM_CN_Chinese_Name__c}</apex:outputLink>
                                                                    </div>
                                                                    <div style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Total','','display:none;')}  " >
                                                                         {!$Label.ASI_CRM_CN_By_Total}
                                                                    </div>
                                                                </td> 
                                                                
                                                                <td class="BorderBottom" style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >
                                                                     <apex:outputLink value="/{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__c}">{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Sub_Brand__r.ASI_CRM_CN_Sub_brand_Grade__r.ASI_CRM_Chinese_Name__c}</apex:outputLink>
                                                               
                                                                </td> 
                                                                <td class="BorderBottom" style="{!IF(PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Allow_Changing_Incentive__c,'background-color: lightblue;','')} " >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}" 
                                                                                     style="{!IF(PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Over_Incentive__c,'color: red; font-weight: bold;','')}  " > 
                                                                        <apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Incentive_BT__c}"/>
                                                                    </apex:outputText>
                                                                </td>
                                                                
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_V0_0_Full_Contract_Target__c}"/></apex:outputText>
                                                                </td>
                                                                
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Actual_Vol__c}"/></apex:outputText>
                                                                </td>
                                                                <!-- <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CTD_Cap_Collection_Vol__c}"/></apex:outputText>
                                                                </td> -->
                                                                
                                                                <!-- <td class="BorderBottom" >
                                                                    <apex:outputText value="{0,number,0}%"><apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Collection_Rate__c}"/></apex:outputText>
                                                                </td> -->
                                                                
                                                                <td class="BorderBottom" style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0}" 
                                                                                     rendered="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}"
                                                                                     style="{!IF(PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Suggested_Volume__c <PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Payable_Vol__c,'color: red; font-weight: bold;','')}"
                                                                                     >
                                                                        <apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Payable_Vol__c}"/>
                                                                    </apex:outputText>
                                                                    
                                                                </td>
                                                                <td class="BorderBottom" >
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"
                                                                                     rendered="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}" >
                                                                        <apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c}"/>
                                                                    </apex:outputText>
                                                                    <apex:outputText value="{0, number, ###,###,###,###,##0.00}"
                                                                                     rendered="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c!='By Sub-Brand'}" 
                                                                                     style="{!IF(PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Suggested_Amount__c <PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c,'color: red; font-weight: bold;','')}"
                                                                                     >
                                                                        <apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Total_Payable__c}"/>
                                                                    </apex:outputText>
                                                                    
                                                                    
                                                                </td>
                                                                
                                                               <!--  <td class="BorderBottom" >
                                                                    <apex:outputText value="{0,number,0.0}%"><apex:param value="{!PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_CN_Completion_Rate__c}"/></apex:outputText>
                                                               </td> -->
                                                                <!-- <td class="BorderBottom" style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" >
                                                                    <div style="{!IF(PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Key_Sub_Brand__c,'','display:none;')}"   >
                                                                        <input name="chkBox_1" type="checkbox"  value="1" disabled="true" checked="true" />
                                                                    </div>
                                                                    <div style="{!IF(PSF_Fixed_Map[itm].DetailLineMap[line].ASI_CRM_Key_Sub_Brand__c,'display:none;','')}"   >
                                                                        <input name="chkBox_1" type="checkbox"  value="1" disabled="true"   />
                                                                    </div>
                                                                    
                                                                </td> -->
                                                            </tr>
                                                        </apex:repeat>
                                                        <tr class="FontWeightCSS" style="background-color: #e3e3d7;" >
                                                            <apex:variable var="PSFCompletionRatio" value="{!if(PSFV0_0_Full_Contract_Target!=0,(PSFActual_Vol/PSFV0_0_Full_Contract_Target)*100,0.0)}"/>
                                                            
                                                            <td>{!$Label.ASI_CRM_CN_Total_Amount}</td>
                                                            <td  style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ></td>
                                                            <td id="{!'PSFTotalIncentiveBT_'+itm}" >
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}" rendered="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c!='By Sub-Brand'}"><apex:param value="{!PSFIncentive_BT}"/></apex:outputText>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSFV0_0_Full_Contract_Target}"/></apex:outputText>
                                                            </td>
                                                            <td>
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFActual_Vol}"/></apex:outputText>
                                                            </td>
                                                            <!-- <td>
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFCap_Collection_Vol}"/></apex:outputText>
                                                            </td> -->
                                                            <!-- <td>
                                                                <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFIntake!=null && PSFIntake!=0 && PSFBC!=0 && PSFBC!=null}">
                                                                    <apex:param value="{!(PSFBC/PSFIntake)*100}" />
                                                                </apex:outputText>
                                                                <apex:outputText value=" - " rendered="{!PSFIntake==0 || PSFIntake==null||PSFBC==0||PSFBC==null}" />
                                                                
                                                            </td> -->
                                                            
                                                            <td id="{!'PSFTotalPayableVolId_'+itm}" style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"   >
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFPayable_Vol}"/></apex:outputText>
                                                            </td>
                                                            <td id="{!'PSFTotalPayableAmountId_'+itm}"  >
                                                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSFTotal_Payable}"/></apex:outputText>
                                                            </td>
                                                            
                                                            <!-- <td>
                                                                <apex:outputText value="{0,number,0.0}%"><apex:param value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Completion_Ratio__c}"/></apex:outputText>
                                                            </td> -->
                                                            <!-- <td  style="{!IF(PSF_Fixed_Map[itm].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" ></td> -->
                                                        </tr>
                                                        
                                                        
                                                    </tbody>
                                                    
                                                </table>
                                            </apex:outputPanel>
                                            
                                            <div class="bs table-responsive" style="padding-top: 1em; padding-left: 2em; padding-bottom: 1em;" > 
                                                
                                                
                                                <table class="bs table table-condensed" style="margin-bottom: 0; width:50%;" >
                                                    <tr>
                                                        <td style="border-left: 1px solid #ddd;width:10% "   class="MethodologyLabel">
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Historical_Paid_Amount__c.Label}
                                                        </td>
                                                        <td style="border-left: 1px solid #ddd;width:15% " ><apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Historical_Paid_Amount__c}"/></apex:outputText></td>
                                                        <td  style="border-left: 1px solid #ddd;width:10% "  class="MethodologyLabel" >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Application_Payment_Amount__c.Label}
                                                        </td>
                                                        <td style=" border-left: 1px solid #ddd; border-right: 1px solid #ddd;width:15% "  > 
                                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Application_Payment_Amount__c}"/></apex:outputText></td>
                                                    </tr>
                                                    <tr>
                                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Adjustment__c.Label}
                                                        </td>
                                                        <td style="border-left: 1px solid #ddd; " >
                                                            <apex:outputText value="{0,number,#,###,##0.00}%"><apex:param value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Adjustment__c}"/></apex:outputText>
                                                        
                                                        </td>
                                                        <td style=" border-left: 1px solid #ddd; " class="MethodologyLabel"  >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Actual_Payment__c.Label}
                                                        </td>
                                                        <td style="  border-left: 1px solid #ddd; border-right: 1px solid #ddd; "  >
                                                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Actual_Payment__c}"/></apex:outputText>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style=" border-left: 1px solid #ddd;  border-bottom: 1px solid #ddd;"  class="MethodologyLabel" >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Fixedcost_Overpayment_Reason__c.Label}
                                                        </td>
                                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;"  ><apex:outputField value="{!PSF_Fixed_Map[itm].Module.ASI_CRM_Fixedcost_Overpayment_Reason__c}" /></td>
                                                        <td style=" border-left: 1px solid #ddd; border-bottom: 1px solid #ddd;" class="MethodologyLabel"  >
                                                            {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Other_Comments__c.Label}
                                                        </td>
                                                        <td style="  border-left: 1px solid #ddd;border-right: 1px solid #ddd; border-bottom: 1px solid #ddd;"  >
                                                            {!PSF_Fixed_Map[itm].Module.ASI_CRM_Other_Comments__c}</td>
                                                    </tr>
                                                </table>                       
                                                
                                                
                                                
                                            </div>
                                            
                                            
                                        </div>
                                    </div>
                                </apex:repeat>
                        	</apex:outputPanel>
                        </div>
                    </div>
                </div>
                
                
                
                <div class="row  "   style="{!IF(cashtype,'padding-top: 1em;','display:none;')}  " >
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_VF_LABEL_Cash}</div>
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        <div class="PanelBody" >
                            
                            <apex:outputPanel id="PayeeCashDetailPanel">
                                <table class="bs table table-condensed" style="margin-bottom: 0;" id="PayeeCashDetailDataTable"  >
                                    <thead>
                                        <tr>
                                            
                                            <th >{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Cash_Payee_Name_T1__c.Label}</th>
                                            <th >{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Amount__c.Label}</th>
                                            <th >{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Reason__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Comfirm_Receipt__c.Label}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                        <apex:repeat value="{!Payee_Item_Map_CASH}" var="itm"   id="PayeeCashDetailLineTable" >
                                            <tr>
                                                <td>
                                                    <apex:outputField value="{!Payee_Item_Map_CASH[itm].ASI_CRM_CN_Cash_Payee_Name_T1__c}" />
                                                </td> 
                                                <td>
                                                    <apex:outputField value="{!Payee_Item_Map_CASH[itm].ASI_CRM_CN_Amount__c}" />
                                                </td>
                                                <td> <apex:outputField value="{!Payee_Item_Map_CASH[itm].ASI_CRM_CN_Reason__c}" /></td>
                                                <td><apex:outputField value="{!Payee_Item_Map_CASH[itm].ASI_CRM_CN_Comfirm_Receipt__c}" /> </td>
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>                            
                        </div>
                    </div>
                </div>
                
                
                
                
                
                
                <div class="row  "   style="{!IF(discounttype,'padding-top: 1em;','display:none;')}  " >
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_VF_LABEL_Discount}</div>
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        <div class="PanelBody" >
                            
                            <apex:outputPanel id="PayeeDiscountDetailPanel">
                                <table class="bs table table-condensed" style="margin-bottom: 0;" id="PayeeDiscountDetailDataTable"  >
                                    <thead>
                                        <tr>
                                            
                                            <th >{!$Label.ASI_CRM_CN_VF_LABEL_T2_WS}</th>
                                            <th >{!$Label.ASI_CRM_CN_VF_LABEL_T1_WS}</th>
                                            <th >{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Discount_Amount__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Reason__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Instruction_Sent_Time__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Comfirm_Receipt__c.Label}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                        <apex:repeat value="{!Payee_Item_Map_DISCOUNT}" var="itm"   id="PayeeDiscountDetailLineTable" >
                                            <tr>
                                                <td>
                                                    <apex:outputField value="{!Payee_Item_Map_DISCOUNT[itm].ASI_CRM_CN_Payee_T2__c}" />
                                                </td> 
                                                <td>
                                                    <apex:outputField value="{!Payee_Item_Map_DISCOUNT[itm].ASI_CRM_CN_Payee_T1__c}" />
                                                </td>
                                                <td>  <apex:outputField value="{!Payee_Item_Map_DISCOUNT[itm].ASI_CRM_CN_Amount__c}" /></td>
                                                <td><apex:outputField value="{!Payee_Item_Map_DISCOUNT[itm].ASI_CRM_CN_Reason__c}" /> </td>
                                                <td> <apex:outputField value="{!Payee_Item_Map_DISCOUNT[itm].ASI_CRM_CN_Instruction_Sent_Time__c}" /></td>
                                                <td> <apex:outputField value="{!Payee_Item_Map_DISCOUNT[itm].ASI_CRM_CN_Comfirm_Receipt__c}" /></td>
                                                
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>                            
                        </div>
                    </div>
                </div>
                
                
                
                
                
                
                
                
                
                
                <div class="row  "   style="{!IF(discounttype,'padding-top: 1em;','display:none;')}  " >
                    <div class="col">
                        <div style="display: grid; grid-template-columns: 20% 80% ; grid-template-rows: auto;"   >
                            <div class="HeaderCss"  style="grid-column-start: 1; grid-column-end: 1;"  >{!$Label.ASI_CRM_CN_VF_LABEL_Others}</div>
                            <div style="grid-column-start: 2; grid-column-end: 2;  " ></div> 
                        </div>
                        <div class="PanelBody" >
                            
                            <apex:outputPanel id="PayeeOtherWSDetailPanel">
                                <table class="bs table table-condensed" style="margin-bottom: 0;" id="PayeeOtherWSDetailDataTable"  >
                                    <thead>
                                        <tr>
                                            
                                            <th >{!$Label.ASI_CRM_CN_VF_LABEL_T2_WS}</th>
                                            <th >{!$Label.ASI_CRM_CN_VF_LABEL_T1_WS}</th>
                                            <th >{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Discount_Amount__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Reason__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Instruction_Sent_Time__c.Label}</th>
                                            <th>{!$ObjectType.ASI_CRM_CN_PH_Payee_Line_Item__c.Fields.ASI_CRM_CN_Comfirm_Receipt__c.Label}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                        <apex:repeat value="{!Payee_Item_Map_CD}" var="itm"   id="PayeeOtherWSDetailLineTable" >
                                            <tr>
                                                <td>
                                                    <apex:outputField value="{!Payee_Item_Map_CD[itm].ASI_CRM_CN_Payee_T2__c}" />
                                                </td> 
                                                <td>
                                                    <apex:outputField value="{!Payee_Item_Map_CD[itm].ASI_CRM_CN_Payee_T1__c}" />
                                                </td>
                                                <td>  <apex:outputField value="{!Payee_Item_Map_CD[itm].ASI_CRM_CN_Amount__c}" /></td>
                                                <td><apex:outputField value="{!Payee_Item_Map_CD[itm].ASI_CRM_CN_Reason__c}" /> </td>
                                                <td><apex:outputField value="{!Payee_Item_Map_CD[itm].ASI_CRM_CN_Instruction_Sent_Time__c}" /></td>
                                                <td> <apex:outputField value="{!Payee_Item_Map_CD[itm].ASI_CRM_CN_Comfirm_Receipt__c}" /></td>
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                    
                                </table>
                            </apex:outputPanel>                            
                        </div>
                    </div>
                </div>
                
                
                
                <apex:actionstatus id="ActionStatus">
                    <apex:facet name="start">
                        <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb;
                                                                             height: 100%; width:100%; opacity:0.65;"> 
                            <div class="waitingHolder" id="loadtext" style="position: absolute;" align="left" valign="top">
                                &nbsp;&nbsp;&nbsp;
                                <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
                                <span class="waitingDescription">Please Wait...</span>
                            </div>
                        </div>
                    </apex:facet>
                </apex:actionstatus>   
                
                
            </div>
            
        </div>
    </apex:form>
    
    <apex:relatedList id="Attachments" subject="{!pageid}" list="CombinedAttachments"/>
    <apex:relatedList id="Approval" subject="{!pageid}" list="ProcessSteps"/>
    
    <apex:relatedList id="ApprovalComment" subject="{!pageid}" list="Payment_Request_Approval_Comments__r" />
    
    
</apex:page>