<!--
*********************************************************************************
* Name: ASI_TnE_ManageClaimDetailPage
* Description: Controller class for managing all the related Claim Details. 
*
* Version History
* Date             Developer               Comments
* ---------------  --------------------    --------------------------------------------------------------------------------
* 09/03/2015       Laputa                  Created
* 09/05/2018       Linus@introv            Added KH logic 
* 28/12/2018       SH                      Modified layout for MY 
*********************************************************************************
-->
<apex:page standardController="ASI_TnE_ClaimHeader__c" extensions="ASI_TnE_ManageClaimDetailController" sidebar="false">
    <head>
        <!-- ******************* SCRIPTS BLOCK ******************* -->
        <!-- ******************* SCRIPTS BLOCK ******************* -->
        <apex:stylesheet value="/sCSS/21.0/sprites/1297816277000/Theme3/default/gc/versioning.css" />
        <apex:stylesheet value="{!URLFOR($Resource.ASI_CRM_jQuery_Lib, '/libs/jquery/css/redmond/jquery-ui-1.10.3.custom.min.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.ASI_CRM_jQuery_Lib, '/styles/common.css')}" />
        
        <link href="{!URLFOR($Resource.ASI_CRM_jQuery_DataTables, 'css/jquery.dataTables.css')}" media="screen" rel="stylesheet" type="text/css" />
        
        <apex:includeScript value="{!URLFOR($Resource.ASI_CRM_jQuery_Lib, '/libs/jquery/js/jquery-1.9.1.min.js')}" />
        <apex:includeScript value="{!URLFOR($Resource.ASI_CRM_jQuery_Lib, '/libs/jquery/js/jquery-ui-1.10.3.custom.min.js')}" /> 
        <apex:includeScript value="{!URLFOR($Resource.ASI_CRM_jQuery_DataTables, 'js/jquery.dataTables.js')}"/>
        
        <!-- this script first -->
        <script type="text/javascript">__sfdcSessionId = '{!$Api.Session_Id}';</script>
        <!-- this script second -->
            <script src="/soap/ajax/29.0/connection.js" type="text/javascript"></script>
        
        <script>
        //$ = jQuery.noConflict();
        
        var startTime = new Date().getTime();
        var addRowStartTime;
        
        var basicDataTableProperties = {
            "bDestroy":true,
            "bStateSave":true,
            "bSearch":false,
            "bFilter" : false,
            "iDisplayLength":1000,
            "bSort" : false,
            "bPaginate": false,
            "bScrollCollapse": true,
            "bJQueryUI": true
        };
        
        $(document).ready(
            function(){
                console.log("##INIT - Contract Builder Page");
                setTables();
                defaultDisabledFields();
                var endTime = new Date().getTime();
                console.log('Init time : ' + (endTime - startTime));
            }
        );
        
        function setFocusOnLoad(){ }
        
        function defaultDisabledFields(){
            
        }
        
        function setMainTabTable(){
            var claimDetail_dataTableProperties = basicDataTableProperties;
            //debugger;
            // Normal View
            if({!isFinanceType==false}){
                if('{!headerRecType}' != 'ID' && '{!headerRecType}' != 'PH'){

                    if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO"}
                        ];
                    } else {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO"}
                        ];
                    }

                    if('{!headerRecType}' == 'SG' || '{!headerRecType}' == 'KH') {   // Added by 2018-01-24 Linus@introv
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO"}
                        ];
                    }

                    if('{!headerRecType}' == 'HK' && '{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card'){
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO & CAP Plan"},                           
                            {"sTitle": "Cross Charge To"}
                        ];
                    } else if('{!headerRecType}' == 'HK') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO & CAP Plan"},                       
                            {"sTitle": "Cross Charge To"}
                        ];
                    }

                    if('{!headerRecType}' == 'MY' ) {
                        // [SH] 2018-12-28 Modified Layout
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            //{"sTitle": "Bill To"},
                            {"sTitle": "Client Type"},
                            //{"sTitle": "Tax"},
                            //{"sTitle": "GST Value"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    }

                    if('{!headerRecType}' == 'TH' && '{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card'){
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO/Payment"},
                            {"sTitle": "Market Charged To"}
                        ];
                    } else if('{!headerRecType}' == 'TH') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO/Payment"},
                            {"sTitle": "Market Charged To"}
                        ];
                    }

                    if('{!headerRecType}' == 'HK') {
                        $("#claimdetail_Table_HK").dataTable(claimDetail_dataTableProperties);
                    }
                    if('{!headerRecType}' == 'SG') {
                        $("#claimdetail_Table_SG").dataTable(claimDetail_dataTableProperties);
                    }
                    // Added by 2018-01-24 Linus@introv
                    if('{!headerRecType}' == 'KH') {
                        $("#claimdetail_Table_KH").dataTable(claimDetail_dataTableProperties);
                    }
                    if('{!headerRecType}' == 'TH') {
                        console.log(claimDetail_dataTableProperties['aoColumns']);
                        $("#claimdetail_Table_TH").dataTable(claimDetail_dataTableProperties);
                    }
                    if('{!headerRecType}' == 'MY') {
                        $("#claimdetail_Table_MY").dataTable(claimDetail_dataTableProperties);
                    }
                }
                
                if('{!headerRecType}' == 'ID' ){

                    if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    } else {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    }

                    $("#claimdetail_Table_ID").dataTable(claimDetail_dataTableProperties);
                }
                
                if('{!headerRecType}' == 'PH'){

                    if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    } else {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Action"},
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    }

                    $("#claimdetail_Table_PH").dataTable(claimDetail_dataTableProperties);
                }
            }
            
            // Finance View
            if({!isFinanceType==true}){ 
                if({!isFinanceView==true}){  
                    if({!isTaxApplicable==true}){ 
                        if('{!claimHeader.ASI_TnE_Type__c}' == 'Corp Card') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "Invoice Issuer/Outlet"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO"},
                            ];
                        } else {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "Invoice Issuer/Outlet"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO"},
                            ];
                        }

                        if('{!headerRecType}' == 'SG' || '{!headerRecType}' == 'KH') {       // Added by 2018-01-24 Linus@introv
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "Invoice Issuer/Outlet"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO"}
                            ];
                        }

                        if('{!headerRecType}' == 'TH' && '{!claimHeader.ASI_TnE_Type__c}' == 'Corp Card') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "WHT"},
                                {"sTitle": "WHT %"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Supplier"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO/Payment"},
                            ];
                        } else if ('{!headerRecType}' == 'TH') {  
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "WHT"},
                                {"sTitle": "WHT %"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Supplier"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO/Payment"},
                            ];
                        }
                        
                        if('{!headerRecType}' == 'ID' && '{!claimHeader.ASI_TnE_Type__c}' == 'Corp Card') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "Invoice Issuer/Outlet"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO"},
                            ];
                        } else if ('{!headerRecType}' == 'ID'){
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                {"sTitle": "Tax Amount"},
                                {"sTitle": "Invoice Issuer/Outlet"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO"},
                            ];
                        }

                        if('{!headerRecType}' == 'MY') {
                                // [SH] 2018-12-28 Modified Layout
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                //{"sTitle": "Bill To"},
                                {"sTitle": "Payment Amount"},
                                //{"sTitle": "Tax"},
                                {"sTitle": "Client Type"},
                                //{"sTitle": "Tax Rate"},
                                {"sTitle": "Taxable Amount"},
                                //{"sTitle": "GST Value"},
                                {"sTitle": "Invoice Issuer/Outlet"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"}
                            ];
                        }

                    } else {
                        if('{!claimHeader.ASI_TnE_Type__c}' == 'Corp Card') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "RC"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"}
                            ];
                        } else {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "RC"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"}
                            ];
                        }
                        
                        if('{!claimHeader.ASI_TnE_Type__c}' == 'Corp Card' && '{!headerRecType}' == 'ID') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "RC"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"}
                            ];
                        } else if ('{!headerRecType}' == 'ID'){
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "A/C Code"},
                                {"sTitle": "BU"},
                                {"sTitle": "RC"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Brand Charged To"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"}
                            ];
                        }

                        if('{!claimHeader.ASI_TnE_Type__c}' == 'Corp Card' && '{!headerRecType}' == 'HK') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "BU"}, 
                                {"sTitle": "A/C Code"},                            
                                {"sTitle": "Cross Charge To"},
                                {"sTitle": "Sub-Ledger"},
                                {"sTitle": "Excluded"},                   
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Claim Amount"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO & CAP Plan"}
                            ];
                        } else if ('{!headerRecType}' == 'HK'){
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Action"},
                                {"sTitle": "Account Number"},
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "BU"},
                                {"sTitle": "A/C Code"},                               
                                {"sTitle": "Cross Charge To"},
                                {"sTitle": "Sub-Ledger"},                                
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Claim Amount"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO & CAP Plan"}
                            ];
                        }
                    }

                    console.log(claimDetail_dataTableProperties["aoColumns"]);
                                        
                    $("#claimdetail_Finance_Table_SG").dataTable(claimDetail_dataTableProperties);
                                        
                }
            }
            
            //Employee View
            if({!isEmployeeView} == true){
                if('{!headerRecType}' != 'ID' && '{!headerRecType}' != 'PH'){

                    if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO"}
                        ];
                    } else {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO"}
                        ];
                    } 

                    if('{!headerRecType}' == 'SG' || '{!headerRecType}' == 'KH'){    // Added by 2018-01-24 Linus@introv
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                            {"sTitle": "PO"}
                        ];
                    }

                    if('{!headerRecType}' == 'MY'){
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
							{"sTitle": "Bill To"},
							{"sTitle": "Tax"},
                            {"sTitle": "Client Type"},
							{"sTitle": "GST Value"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer/Outlet"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"},
                        ];
                    }

                    if('{!headerRecType}' == 'TH'){
                        if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO/Payment"},
                            ];
                        } else {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "RC"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Tax"},
                                {"sTitle": "Market Charged To"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO/Payment"},
                            ];
                        }
                    }

                    if('{!headerRecType}' == 'HK'){
                        if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},                               
                                {"sTitle": "Cross Charge To"},
                                {"sTitle": "BU"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO & CAP Plan"}
                            ];
                        } else {
                            claimDetail_dataTableProperties["aoColumns"] = [
                                {"sTitle": "Expense Category"},
                                {"sTitle": "Expense Classification"},
                                {"sTitle": "Cross Charge To"},
                                {"sTitle": "BU"},
                                {"sTitle": "Excluded"},
                                {"sTitle": "Receipt Date"},
                                {"sTitle": "Receipt Amount"},
                                {"sTitle": "Currency"},
                                {"sTitle": "FX Rate"},
                                {"sTitle": "Payment Amount"},
                                {"sTitle": "Invoice Issuer"},
                                {"sTitle": "Destination"},
                                {"sTitle": "Pax"},
                                {"sTitle": "Name & Company"},
                                {"sTitle": "Details Expense"},
                                {"sTitle": "PO & CAP Plan"}
                            ];
                        } 
                     }

                    $("#claimdetail_Table_EMP_VIEW").dataTable(claimDetail_dataTableProperties);
                }
                if('{!headerRecType}' == 'ID'){
                    if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    } else {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    }
                    $("#claimdetail_Table_EMP_VIEW_ID").dataTable(claimDetail_dataTableProperties);
                }
                if('{!headerRecType}' == 'PH'){
                    if('{!claimHeader.ASI_TnE_Type__c}' != 'Corp Card') {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    } else {
                        claimDetail_dataTableProperties["aoColumns"] = [
                            {"sTitle": "Expense Category"},
                            {"sTitle": "Expense Classification"},
                            {"sTitle": "Excluded"},
                            {"sTitle": "RC"},
                            {"sTitle": "Receipt Date"},
                            {"sTitle": "Receipt Amount"},
                            {"sTitle": "Currency"},
                            {"sTitle": "FX Rate"},
                            {"sTitle": "Tax"},
                            {"sTitle": "Market Charged To"},
                            {"sTitle": "Brand Charged To"},
                            {"sTitle": "Invoice Issuer"},
                            {"sTitle": "Destination"},
                            {"sTitle": "Pax"},
                            {"sTitle": "Name & Company"},
                            {"sTitle": "Details Expense"}
                        ];
                    }
                    $("#claimdetail_Table_EMP_VIEW_PH").dataTable(claimDetail_dataTableProperties);
                }
            }
        }
        
        function setTables(){
            //Set line item
            setMainTabTable();
            if({!isFinanceType && isFinanceView}) {
                if('{!headerRecType}' == 'SG' || '{!headerRecType}' == 'KH'){  // Added by 2018-05-09 Linus@introv
                    $('#claimdetail_Finance_Table_SG > tbody  > tr').each(function() {
                        setCellReadOnly($(this).find("input.taxRate"));
                        setCellReadOnly($(this).find("span.taxableAmount"));
                        setCellReadOnly($(this).find("input.taxableAmount"));
                        var taxAmount = $(this).find("input.taxAmount").val();
                        taxAmount = normalizeFloat(taxAmount, [",",""]);
                        taxAmount = Math.round( taxAmount * 100) / 100
                        $(this).find("input.taxAmount").val(taxAmount);
                        //$(this).find("select.classification").trigger('change');
                    });
                }                
            }
        }
    
        function setCellReadOnly(cpiRowCell) {
    
            cpiRowCell.prop("disabled",true);
            //cpiRowCell.val("");
            cpiRowCell.css("background", "LightGray");
    
        }
        // set Classifications Map for Picklist and readonly
        var fClassificationMap = {};
        var rOnlyClassificationMap = {};
        // Set the WHT % default value for TH only
        var fClassificationWHTMap = {};

        // Set Cross Charging Value for HK only
        //var fClassificationCCMap = {};

        <apex:repeat value="{!fClassification}" var="catfKey">
            var temp_ClsList = [];
        <apex:repeat value="{!fClassification[catfKey]}" var="clsfKey">

            fClassificationWHTMap["{!clsfKey.id}"] = "{!clsfKey.ASI_TnE_WHT_Rate__c}";
            console.log(fClassificationWHTMap["{!clsfKey.id}"]);
            temp_ClsList.push("{!clsfKey.Id}~{!clsfKey.Name}");
        
            var temp_roList = [];
            if("{!clsfKey.ASI_TnE_Read_Only_Fields__c}" != '' && "{!clsfKey.ASI_TnE_Read_Only_Fields__c}" != null){
                var roFields = "{!clsfKey.ASI_TnE_Read_Only_Fields__c}";
                temp_roList = roFields.split(";").map(Function.prototype.call, String.prototype.trim);
            }
        
            rOnlyClassificationMap["{!clsfKey.Id}"] = temp_roList;

        </apex:repeat>
        
        fClassificationMap["{!catfKey}"] = temp_ClsList;
        </apex:repeat>
        
        // set Exchange Rate based on Country
        var exchangeRate = {};
        var exchangeRateHK = {};
        var dateRateMap = {};
        <apex:repeat value="{!exchangeRates}" var="exKey">
            <apex:repeat value="{!exchangeRates[exKey]}" var="exR">
                exchangeRate["{!exKey}"] = "{!exR.ASI_MFM_Exchange_Rate__c}";
            </apex:repeat>
        </apex:repeat>
        
        <apex:repeat value="{!exchangeRatesHK}" var="exKey">
            var dateRateMap = {};
            <apex:repeat value="{!exchangeRatesHK[exKey]}" var="exR">
                dateRateMap[new Date("{!exR.ASI_MFM_Effective_Date__c}")] = "{!exR.ASI_MFM_Exchange_Rate__c}"
            </apex:repeat>
            exchangeRateHK["{!exKey}"] = dateRateMap;
        </apex:repeat>

        var recentRowId;
        var selectedCat;
        var selectedClass;
        
        function updateDependentList(rowId, rowIndex, isOnChange){
            
            var catIdValue = $('#category_'+rowIndex).val();
            var classificationList = fClassificationMap[catIdValue];
            
            if(classificationList != undefined){
                $('#classification_'+rowIndex).find('option').remove();
                for(var i = 0; i < classificationList.length; i++){
                    var clsId = classificationList[i].split('~')[0];
                    var clsVal = classificationList[i].split('~')[1];
                    $('#classification_'+rowIndex).append('<option value=' + clsId + '>' + clsVal + '</option>');
                }
                if(isOnChange) {
                    readOnlyFields_Classification(rowId ,rowIndex, isOnChange);
                }
            }
        }
        
        function detectSameCurrency(rowId) {
            if(rowId != undefined){
                if(rowId.find("select.currCode").val() != '{!currencyStr}'){
                    rowId.find("input.fxRate").prop("readonly",false);
                    rowId.find("input.fxRate").css("background", "White");
                }else{
                    rowId.find("input.fxRate").prop("readonly",true);
                    //rowId.find("input.fxRate").val("");
                    rowId.find("input.fxRate").css("background", "LightGray");
                }
            }
        }

        function updateExchangeRate(rowId){
            if(rowId != undefined){
                var curr = rowId.find("select.currCode").val();
                var currNewVal = exchangeRate[curr];
                if('{!headerRecType}' == 'HK' && curr != 'HKD'){
                    var receiptDt = rowId.find("input.receiptDate").val();
                    var dtArray = receiptDt.split("/");
                    var dt = new Date(dtArray[2],dtArray[0]-1,dtArray[1]);
                    var selectedDt = new Date();
                    var isFirstRec = true;
                    var currMap = exchangeRateHK[curr];
                    for(var key in currMap){
                        var tempDt = new Date(key);
                        if(isFirstRec == true && (dt-tempDt) >= 0){
                            selectedDt = tempDt;
                            isFirstRec = false;
                        }else if((tempDt - selectedDt) >= 0 && (dt-tempDt) >= 0){
                            selectedDt = tempDt;
                        }
                    }
                    if(isFirstRec == true){
                        for(var key in currMap){
                            var tempDt = new Date(key);
                            if(isFirstRec == true){
                                selectedDt = tempDt;
                            }else if(selectedDt > tempDt){
                                selectedDt = tempDt;
                            }
                        }
                    }
                    if(currMap != null){
                        currNewVal = currMap[selectedDt];
                    }
                }
                
                
                /*if('{!headerRecType}' == 'PH' && curr == 'PHP') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }
                
                if('{!headerRecType}' == 'ID' && curr == 'IDR') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }

                if('{!headerRecType}' == 'SG' && curr == 'SGD') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }
                // Added by 2018-01-24 Linus@introv
                if('{!headerRecType}' == 'KH' && curr == 'KHR') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }
                if('{!headerRecType}' == 'MY' && curr == 'MYR') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }

                if('{!headerRecType}' == 'TH' && curr == 'THB') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }

                if('{!headerRecType}' == 'HK' && curr == 'HKD') {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }*/
                if('{!currencyStr}' == curr) {
                    currNewVal = 1.000000;
                    currNewVal = currNewVal.toFixed(6);
                }
                
                rowId.find("input.fxRate").val(currNewVal);

                //Special Case for Cash Advance
                if('{!claimHeader.ASI_TnE_Type__c}' == 'Cash Advance' && curr == '{!claimHeader.ASI_TnE_Currency__c}') {
                    currNewVal = '{!claimHeader.ASI_TnE_FX_Rate__c}';
                    currNewVal = currNewVal.toFixed(6);
                }

                
                if(rowId.find("select.currCode").val() != '{!currencyStr}'){
                    rowId.find("input.fxRate").prop("readonly",false);
                    rowId.find("input.fxRate").css("background", "White");
                }else{
                    rowId.find("input.fxRate").prop("readonly",true);
                    //rowId.find("input.fxRate").val("");
                    rowId.find("input.fxRate").css("background", "LightGray");
                }
            }
        }
        
        var prevVal;
        function getPreviousValue(rowId){
            if(rowId != undefined){
                prevVal = rowId.find("input.fxRate").val();
            }
        }
        
        function rateMessage(rowId){
            if(rowId != undefined && (prevVal != '' && prevVal != null)){
                var newVal = rowId.find("input.fxRate").val();
                var tenOfpVal = (parseFloat(prevVal) * 0.100000) + parseFloat(prevVal);
                var minusTenOfpVal = parseFloat(prevVal) - (parseFloat(prevVal) * 0.100000);
                
                if(parseFloat(newVal) > parseFloat(tenOfpVal.toFixed(6))){
                    if('{!headerRecType}' != 'HK') {
                        alert('FX Rate is in 10% difference with the PR rate');
                    } else {
                        alert('FX Rate is in 10% difference with the PR rate');
                    }
                }
                if(parseFloat(newVal) < parseFloat(minusTenOfpVal.toFixed(6))){
                    if('{!headerRecType}' != 'HK') {
                        alert('FX Rate is in 10% difference with the PR rate');
                    } else {
                        alert('FX Rate is in 10% difference with the PR rate');
                    }
                }
            }
        }

        function readOnlyFields_Classification(rowId, rowIndex, isOnChange){
            if(rowId != undefined){
                detectSameCurrency(rowId);
                var fieldsAPI = [];
                var clsfVal = $("#classification_"+rowIndex).val();
                fieldsAPI = rOnlyClassificationMap[clsfVal];
                var isTaxReadOnly = false;

                if('{!headerRecType}' == 'TH' && isOnChange) {
                    var whtRateDefault = fClassificationWHTMap[clsfVal];
                    //rowId.find("select.ASI_TnE_WHT_Rate").val(whtRateDefault);
                }

                if('{!headerRecType}' == 'HK' && isOnChange) {
                    //var crossChargingValue = fClassificationCCMap[clsfVal];
                    console.log(isOnChange);
                }

                if(fieldsAPI != undefined){
                    // remove the readonly and background first
                    rowId.find(":input").not("input.fxRate, input.taxAmt").prop("readonly",false);
                    rowId.find(":input").not("select.marketCharged").prop("disabled","");
                    rowId.find(":input").not("input.fxRate, input.taxAmt, select.marketCharged").css("background", "White");

                    rowId.find("a.ASI_TnE_A_C_Code").show();
                    rowId.find("a.ASI_TnE_SubBrand").show();
                    rowId.find("a.ASI_TnE_BU").show();
                    rowId.find("a.ASI_TnE_CAP_Plan").show();
                    rowId.find("a.ASI_TnE_Charge_To_Acc").show();
                    rowId.find("a.ASI_TnE_MFM_PO").show();
                    rowId.find("a.ASI_TnE_Outlet").show();
                    rowId.find("a.ASI_TnE_Payment_Request").show();
                    rowId.find("a.ASI_TnE_Supplier").show();
                    rowId.find("a.ASI_TnE_Tax_ID").show();

                    rowId.find("select.ASI_TnE_SubBrand").prop("disabled","");
                    rowId.find("select.ASI_TnE_SubBrand").css("background", "White");

                    for(var i=0; i < fieldsAPI.length; i++){
                        // Text Field
                        rowId.find("input."+fieldsAPI[i]).prop("readonly",true);
                        rowId.find("input."+fieldsAPI[i]).css("background", "LightGray");
                        rowId.find("a."+fieldsAPI[i]).hide();
                        if(fieldsAPI[i] != 'fxRate' && fieldsAPI[i] != 'taxAmt') {
                            rowId.find("input."+fieldsAPI[i]).not("input.fxRate, input.taxAmt").val("");                            
                        }

                        // TextArea Field
                        rowId.find("textarea."+fieldsAPI[i]).prop("readonly",true);
                        rowId.find("textarea."+fieldsAPI[i]).css("background", "LightGray");
                        rowId.find("textarea."+fieldsAPI[i]).val("");
                        // Select field
                        rowId.find("select."+fieldsAPI[i]).prop("disabled","disabled");
                        rowId.find("select."+fieldsAPI[i]).css("background", "LightGray");
                        rowId.find("select."+fieldsAPI[i]).val("");
                        // Checkbox
                        if(rowId.find("input."+fieldsAPI[i]).is(':checkbox')) {
                            rowId.find("input."+fieldsAPI[i]).prop('checked', false);
                            rowId.find("input."+fieldsAPI[i]).prop('disabled', true);
                            rowId.find("input."+fieldsAPI[i]).css("background", "LightGray");
                            isTaxReadOnly = true;
                        }
                    }
                }else{
                    // Inputs Field
                    rowId.find(":input").not("input.fxRate, input.taxAmt").prop("readonly",false);
                    rowId.find(":input").not("input.fxRate, input.taxAmt").css("background", "White");
                }
                
                if(!isTaxReadOnly && isOnChange) {
                    if('{!headerRecType}' != 'PH' && '{!headerRecType}' != 'ID' ) {
                        //rowId.find("input.ASI_TnE_Tax_Inclusive").prop('checked', true);
                    }
                    rowId.find("input.ASI_TnE_Tax_Inclusive").prop('disabled', false);
                    rowId.find("input.ASI_TnE_Tax_Inclusive").css("background", "White");
                    rowId.find("input.ASI_TnE_Tax_Inclusive").trigger("change");
                }
            }
            getDependentPicklistMapping();
        }

        function enableTaxAmt(rowId){
            if(rowId != undefined){
                if(rowId.find("input.taxInc").is(":checked")){
                    rowId.find("input.taxAmt").prop("readonly",false);
                    rowId.find("input.taxAmt").css("background", "White");
                }else{
                    rowId.find("input.taxAmt").prop("readonly",true);
                    rowId.find("input.taxAmt").val("");
                    rowId.find("input.taxAmt").css("background", "LightGray");
                }
            }
        }
        
        function marketChargedEnabled(rowId){
            if(rowId != undefined){
                if({!marketChargedEnabled} == false){
                    rowId.find("select.marketCharged").prop("disabled","disabled");
                    rowId.find("select.marketCharged").css("background", "LightGray");
                }
            }
        }
        
        var categoriesMap = '';
        var classificationsMap = '';
            
        function saveClaims(){
            getDependentPicklistMapping();
            console.log('***categoriesMap: ' + categoriesMap);
            console.log('***categoriesMap: ' + classificationsMap);
            saveClaim_Details(categoriesMap, classificationsMap);
            return false;
        }
        function quickSaveClaims(){
            getDependentPicklistMapping();          
            console.log('***categoriesMap: ' + categoriesMap);
            console.log('***categoriesMap: ' + classificationsMap);
            quickSaveClaim_Details(categoriesMap, classificationsMap);
        }
        function addNewClaims(){
            addRowStartTime = new Date().getTime();
            getDependentPicklistMapping();
            console.log('***categoriesMap: ' + categoriesMap);
            console.log('***categoriesMap: ' + classificationsMap);
            var addRowBeforeEndtime = new Date().getTime();
            console.log('Add Before Start Time : ' + addRowStartTime);
            console.log('Add Before End Time : ' + addRowBeforeEndtime);
            console.log('Add Before time : ' + (addRowBeforeEndtime - addRowStartTime));
            //addNewDetail(categoriesMap, classificationsMap);
            addNewDetail();
        }
        function onCompleteAddNew(){
            var addRowAfterStartTime = new Date().getTime();
            getDependentPicklistMapping();
            console.log('***categoriesMap: ' + categoriesMap);
            console.log('***categoriesMap: ' + classificationsMap);
            updateWrapperValues(categoriesMap, classificationsMap);
            var addRowAfterEndtime = new Date().getTime();
            console.log('Add After Start Time : ' + addRowAfterStartTime);
            console.log('Add After End Time : ' + addRowAfterEndtime);
            console.log('Add After time : ' + (addRowAfterEndtime - addRowAfterStartTime));
            console.log('Total Add time : ' + (addRowAfterEndtime - addRowStartTime));
        }
        
        function cloneClaims(rowId){
            getDependentPicklistMapping();
            console.log('***categoriesMap: ' + categoriesMap);
            console.log('***categoriesMap: ' + classificationsMap);
            cloneClaimDetail(rowId, categoriesMap, classificationsMap);
        }

        function deleteClaims(rowId) {
            getDependentPicklistMapping();
            console.log('***categoriesMap: ' + categoriesMap);
            console.log('***categoriesMap: ' + classificationsMap);
            deleteClaimDetail(rowId, categoriesMap, classificationsMap);
        }

        function validateClassification(rowId, rowIndex,obj) {
            getDependentPicklistMapping();
            var catIdValue = $('#category_'+rowIndex).val();
            var classification = rowId.find("select.classification").val();
            if(classification == '{!greetingId}'){
                alert('{!$Label.ASI_TnE_TW_NoClsfWarn}');
                rowId.find("select.classification").val(obj.oldValue);
            }else{
                console.log('rowIndex ' + rowIndex + ' catIdValue ' + catIdValue + ' classification ' + classification);
                console.log(categoriesMap);
                console.log(classificationsMap);
                assignClassificationAction(rowIndex, catIdValue, classification, categoriesMap, classificationsMap);
            }
        }
        
        function getDependentPicklistMapping(){
            var tableId;
            categoriesMap = '';
            classificationsMap = '';
            
            if({!isFinanceType} == false && {!isEmployeeView} == false){
                tableId = 'claimdetail_Table_' + '{!headerRecType}';
            }
            if({!isFinanceType} == true && {!isFinanceView} == true){   // Added by 2018-05-09 Linus@introv
                if('{!headerRecType}' == 'SG' || '{!headerRecType}' == 'KH')
                    tableId = 'claimdetail_Finance_Table_SG';                  
            }
            
            $('#'+tableId + ' tbody tr').each(function() {
                var tIndex = $(this).index() + 1;
                var catId = 'category_' + tIndex;
                var clsId = 'classification_' + tIndex;
                
                var SelCat_Val = $('#'+catId).val();
                var SelCls_Val = $('#'+clsId).val();
                
                categoriesMap += tIndex + '-' + SelCat_Val + '_';
                classificationsMap += tIndex + '-' + SelCls_Val + '_';
                
            });
            categoriesMap = categoriesMap.slice(0, - 1);
            classificationsMap = classificationsMap.slice(0, - 1);
        }
        
        function autoCalculatePaymentAmount(rowId) {
            var receiptAmount = rowId.find("input.receiptAmount").val();
            receiptAmount = normalizeFloat(receiptAmount, [",",""]);
            
            var fxRate = rowId.find("input.fxRate").val();
            fxRate = normalizeFloat(fxRate, [",",""]);
            
            var result = fxRate * receiptAmount;
            result = result.toFixed(2);
            rowId.find("span.paymentAmount").text(result);
            
        }
        
        function autoCalculateTaxableAmount(rowId) {
            var paymentAmount = rowId.find("span.paymentAmount").text();
            paymentAmount = normalizeFloat(paymentAmount, [",",""]);
            
            var taxRate = rowId.find("input.taxRate").val();
            taxRate = normalizeFloat(taxRate, [",",""]);
            taxRate = taxRate/100;
            
            //var taxableAmount = paymentAmount - paymentAmount * taxRate;
            var taxableAmount = (paymentAmount / (1 + taxRate));
            var taxAmount = paymentAmount - (paymentAmount/(1+(taxRate/100)));
            
            taxableAmount = taxableAmount.toFixed(2);
            taxAmount = taxAmount.toFixed(2);
            rowId.find("input.taxAmount").val(taxAmount);
            rowId.find("span.taxableAmount").val(taxableAmount);
            
        }
        
        function autoCalculateTaxAmountOnly(rowId) {
            var paymentAmount = rowId.find("span.paymentAmount").text();
            paymentAmount = normalizeFloat(paymentAmount, [",",""]);
            
            var taxableAmount = rowId.find("span.taxableAmount").val();
            taxableAmount = normalizeFloat(taxableAmount, [",",""]);
            
            var taxAmount = paymentAmount - taxableAmount;
            
            taxAmount = taxAmount.toFixed(2);
            rowId.find("input.taxAmount").val(taxAmount);
            
        }
        
        function autoCalculateTaxableAmountOnly(rowId) {
            var paymentAmount = rowId.find("span.paymentAmount").text();
            paymentAmount = normalizeFloat(paymentAmount, [",",""]);
            
            var taxAmount = rowId.find("input.taxAmount").val();
            taxAmount = normalizeFloat(taxAmount, [",",""]);
            
            var taxableAmount = paymentAmount - taxAmount;
            
            taxableAmount = taxableAmount.toFixed(2);
            
            rowId.find("span.taxableAmount").val(taxableAmount);
            
        }
        
        // Only for TH
        function autoCalculateWHT(rowId) {
            if('{!headerRecType}' == 'TH') {
                var taxAmount = rowId.find("input.taxAmount").val();
                taxAmount = normalizeFloat(taxAmount, [",",""]);
                var WHTRateTemp = rowId.find("select.ASI_TnE_WHT_Rate").val();
                var WHTRate = rowId.find("select.ASI_TnE_WHT_Rate").val();
                WHTRate = WHTRate.replace('%', '');
                WHTRate = normalizeFloat(WHTRate, [",",""]);
                var amount = rowId.find("span.paymentAmount").text();
                amount = normalizeFloat(amount, [",",""]);
                
                var result = (amount - taxAmount) * (WHTRate/100);
                
                result = result.toFixed(2);

                if(WHTRateTemp.indexOf("None") > -1) {
                    result = 0;
                }

                rowId.find("span.ASI_TnE_WHT_Amount").text(result);
            }
        }

        // Only apply to MY
        function taxInclusiveChanged(rowId) {
        
            if(!rowId.find("input.ASI_TnE_Tax_Inclusive").is(":checked")) {
                rowId.find("input.taxAmount").val('');
                rowId.find("input.taxAmount").trigger("change");
            } else {
                rowId.find("input.receiptAmount").trigger("change");
            }
                
            if('{!headerRecType}' == 'MY') {
                if(!rowId.find("input.ASI_TnE_Tax_Inclusive").is(":checked")) {
                    rowId.find("input.ASI_TnE_MY_GST_Value").val(0);
                    rowId.find("input.ASI_TnE_MY_GST_Value").trigger("change");
                    calculateGSTValue(rowId);
                } else {
                    calculateGSTValue(rowId);
                }
            }
        }

        // Only apply to MY
        function calculateGSTValue (rowId) {
            console.log("calculateGSTValue call");
            if('{!headerRecType}' == 'MY') {

                if(rowId.find("input.ASI_TnE_Tax_Inclusive").is(":checked")) {
                    var billedTo = rowId.find("select.ASI_TnE_Billed_To").val();
                    var clientType = rowId.find("select.ASI_TnE_Client_Type").val();
                    var paymentAmount = rowId.find("span.paymentAmount").text();
                    paymentAmount = normalizeFloat(paymentAmount, [",",""]);
                    var taxableAmount = rowId.find("span.taxableAmount").val();
                    taxableAmount = normalizeFloat(taxableAmount, [",",""]);
                    var taxRate = rowId.find("input.taxRate").val();
                    taxRate = normalizeFloat(taxRate, [",",""]);
                    taxRate = taxRate/100;
                    var GSTResult = 0;
                    console.log("calculateGSTValue inside billedTo " + billedTo + " clientType " + clientType);
                    console.log("*******paymentAmount " + paymentAmount);
                    if (billedTo == "Cash") {
                        console.log("cash");
                        if (clientType == "Existing Client" || clientType == "Staff") {
                            console.log("exist/staff clientType");
                            if(paymentAmount <= 530) {
                                console.log("paymentAmount <= 500 paymentAmount " + paymentAmount + " taxRate " + taxRate);
                                taxableAmount = paymentAmount / (1+taxRate);
                                console.log("paymentAmount <= 500 taxableAmount " + taxableAmount);
                                GSTResult = paymentAmount - taxableAmount;
                            } else {
                                taxableAmount = 500;
                                GSTResult = 30 /*paymentAmount - taxableAmount*/;
                            }
                        } else if(clientType == "" || clientType == null) {
                            if(paymentAmount <= 530) {
                                taxableAmount = paymentAmount / (1+taxRate);
                                GSTResult = paymentAmount - taxableAmount;
                            } else if (paymentAmount > 530) {
                                taxableAmount = 500;
                                GSTResult = 30 /*paymentAmount - taxableAmount*/;
                            }
                        }

                        if(clientType == "New Client" || clientType == "Potential Client" || clientType == "Supplier" || clientType.indexOf("Others") >= 0) {
                            taxableAmount = 0;
                            GSTResult = 0;
                        }
                        // [SH] 2018-12-28
                        taxableAmount = 0;
                        GSTResult = 0;
                    }

                    if(billedTo == "PRM") {
                        if (clientType == "Existing Client" || clientType == "Staff") {
                            taxableAmount = paymentAmount / (1+taxRate);
                            GSTResult = paymentAmount - taxableAmount;
                        }
                        if(clientType == "New Client" || clientType == "Potential Client" || clientType == "Supplier" || clientType.indexOf("Others") >= 0) {
                            taxableAmount = 0;
                            GSTResult = 0;                  
                        } else if(clientType == "" || clientType == null) {
                            taxableAmount = paymentAmount / (1+taxRate);
                            GSTResult = paymentAmount - taxableAmount;
                        }
                    }

                    taxableAmount = taxableAmount.toFixed(2);
                    GSTResult = GSTResult.toFixed(2);
                    rowId.find("input.taxableAmount").val(taxableAmount);
                    rowId.find("input.ASI_TnE_MY_GST_Value").val(GSTResult);
                } else {

                    var taxableAmount = 0;
                    var GSTResult = 0;
                    taxableAmount = taxableAmount.toFixed(2);
                    GSTResult = GSTResult.toFixed(2);
                    rowId.find("input.taxableAmount").val(taxableAmount);
                    rowId.find("input.ASI_TnE_MY_GST_Value").val(GSTResult);
                }

            }
        }

        function normalizeFloat(number, chars) {
            var lastIndex = -1;
            if(typeof number === 'undefined'){
                return number;
            }
            for(i=0; i < chars.length; i++) {
                t = number.lastIndexOf(chars[i]);

                if (t > lastIndex) {
                    lastIndex = t;
                }
            }

            if (lastIndex == -1) {
                lastIndex = number.length;
            }

            var whole = number.substring(0, lastIndex);   
            var precision = number.substring(lastIndex);
            for (i=0; i < chars.length; i++) {
                whole = whole.replace(chars[i], '');
                precision = precision.replace(chars[i],'.');           
            }
            number = whole + precision;
            f = parseFloat(number.replace(/,/g, '')) ;
            //f = parseFloat(number);
            f = (f!=null&&f!=undefined&&!isNaN(f))?f:0;
            return f;
        }
        </script>
        
        <!-- ******************* STYLE BLOCK ******************* -->
        <style>
            body {
            margin-top: 40px;
            font-size: 12px;
            font-family: Helvetica,Arial,Verdana,sans-serif;
            width:100%;
            }
            
            .loadingOverlay{
            opacity: 0.4;
            postion: absolute;
            top:0px;
            left:0px;
            background-color:#001100;
            width:100%;
            z-index: 5000
            }
            
            #container1{
            width:100%;
            }
            
            #tabLink{
            font-size: 10px;
            }
            
            .overlay {
            display: none;
            height: 100%;
            left: 0;
            position: fixed;
            top: 0;
            opacity: 0.3;
            -moz-opacity: 0.3;
            width: 100%;
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=30)";
            filter: alpha(opacity=30);
            background: #000;
            -khtml-opacity: 0.3;
            z-index: 1000;
            }
            
            .loader {
            width: 32px;
            height: 32px;
            position: absolute;
            left: 50%;
            }
            
            input.error-input {
            border-color: red;
            }
            
            .ASI_TnE_Outlet, .ASI_TnE_Invoice_Issuer {
                width: 115px
            }
            
            .ASI_TnE_MFM_PO, .ASI_TnE_Payment_Request {
                width: 115px
            }

            .ASI_TnE_CAP_Plan {
                width: 115px
            }
            
            .ASI_TnE_MFM_PO_Line_Item {
                width: 115px
            }
            
            .taxRate{
                width: 60px
            }

            .ASI_TnE_Client_Type {
                width:  130px
            }

            .marketCharged {
                width: 120px
            }

            .ASI_TnE_SubBrand {
                width: 120px
            }
        </style>
    </head>
    
    <body>
        <!-- ******************* PAGE LOADING BLOCK ******************* -->
        <apex:actionStatus id="loadingStatus" >
            <apex:facet name="start">
                <c:ASI_TnE_LoadingStatus BackColor="#ffffff"
                                     borderColor="#6B6B6B"
                                     borderSize="1"
                                     height="50px"
                                     width="160px"
                                     margintop="-25px"
                                     marginleft="-60px"
                                     ImageUrl="{!$Resource.loadingStatus}"
                                     Message="Loading..."/>
            </apex:facet>
        </apex:actionStatus>
        
        <apex:form >
            <apex:pageMessages id="pageMsg"></apex:pageMessages>
            
            <!-- ******************* ACTIONFUNCTIONS ******************* -->
            <apex:actionFunction name="updateWrapperValues" action="{!updateWrapperValues}" rerender="detail_pageBlock, pageMsg" status="loadingStatus" oncomplete="setTables();">
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
            </apex:actionFunction>
            
            <apex:actionFunction name="redirectClaimHeaderPage" action="{!redirectClaimHeaderPage}" rerender="pageMsg"/>
            
            <apex:actionFunction name="saveClaim_Details" action="{!saveClaimDetails}" status="loadingStatus" rerender="detail_pageBlock, pageMsg" oncomplete="setTables(); redirectClaimHeaderPage(); return false;">
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
            </apex:actionFunction>
            
            <apex:actionFunction name="quickSaveClaim_Details" action="{!saveClaimDetails}" status="loadingStatus" rerender="detail_pageBlock, pageMsg" oncomplete="setTables();">
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
                <apex:param name="IS_QUICK_SAVE" value="true" />
            </apex:actionFunction>
            
            <apex:actionFunction name="addNewDetail" action="{!addNewDetail}" rerender="detail_pageBlock, pageMsg" status="loadingStatus" onComplete="onCompleteAddNew();">
                <!--
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
                -->
            </apex:actionFunction>
            
            <apex:actionFunction name="cloneClaimDetail" action="{!cloneClaimDetail}" rerender="detail_pageBlock, pageMsg" onComplete="setTables();" status="loadingStatus">
                <apex:param name="PARAM_CLONE_CLAIM_DETAIL_ID" value=""/>
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
            </apex:actionFunction>

            <apex:actionFunction name="deleteClaimDetail" action="{!removeClaimDetail}" rerender="detail_pageBlock, pageMsg" onComplete="setTables();" status="loadingStatus">
                <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value=""/>
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
            </apex:actionFunction>
            
            <apex:actionFunction name="assignClassificationAction" action="{!assignClassification}" rerender="detail_pageBlock, pageMsg" onComplete="setTables();" status="loadingStatus">
                <apex:param name="ROWID" value="" />
                <apex:param name="CATEGORY" value="" />
                <apex:param name="CLASSIFICATION" value="" />
                <apex:param name="PARAM_CATEGORIES_IDS" value="" assignTo="{!PARAM_CATEGORIES_IDS}"/>
                <apex:param name="PARAM_CLASSIFICATIONS_IDS" value="" assignTo="{!PARAM_CLASSIFICATIONS_IDS}"/>
            </apex:actionFunction>

            <!-- ******************* HEADER BLOCK - T&E CLAIMS ******************* -->
            <apex:pageBlock id="header_pageBlock">
                <apex:panelGrid columns="1" width="1100px">
                    <apex:pageBlockSection title="Travel and Entertainment Claim">
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.Owner.Name}"/>
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.Name}"/>  
                        
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Payee_Employee__c}"/>
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Status__c}"/>
                        
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Company__c}"/>                        
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Start_Date__c}"/>
                        
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Department_Division__c}"/>
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_End_Date__c}"/>
                        
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Employee_Type__c}"/>
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Currency__c}"/>
                        
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_3rd_Party__c}"/>
                        <apex:outputField value="{!ASI_TnE_ClaimHeader__c.ASI_TnE_Total_Amount_LCY__c}"/>
                    </apex:pageBlockSection>
                </apex:panelGrid>  
            </apex:pageBlock>
            
            <!-- ******************* DETAIL BLOCK - T&E CLAIM DETAILS ******************* -->
            <apex:pageBlock id="detail_pageBlock">
                <!-- ******************* BUTTONS ******************* -->
                <apex:pageblockButtons >
                    <apex:commandButton value=" Save " rendered="{!IF(isEmployeeView == false || (isFinanceType && isFinanceView), true, false)}" onclick="setTables(); getDependentPicklistMapping();" action="{!saveClaimDetails}" status="loadingStatus" rerender="pageMsg">
                        <apex:param name="IS_QUICK_SAVE" value="false"/>
                    </apex:commandButton>
                    
                    <apex:commandButton value=" Quick Save " rendered="{!IF(isEmployeeView == false || (isFinanceType && isFinanceView), true, false)}" onclick="quickSaveClaims(); return false;"/>
                    
                    <apex:commandButton value=" Cancel " 
                                        action="{!cancel}" 
                                        immediate="true"/>
                </apex:pageblockButtons>
                
                <div id="detailTabs" class="tabLink" style="display:table;">
                    <ul>
                        <li><apex:outputPanel rendered="true"><a href="#tab_ClaimDetail">{!recTypeName}</a></apex:outputPanel></li>
                    </ul>
                    
                    <div id="tab_ClaimDetail">
                        <apex:pageBlock id="pageBlock_claimDetail">
                            <apex:outputPanel layout="block">
                                <apex:outputPanel rendered="{!IF(AND(isEmployeeView == false,!AND(headerRecType == 'HK', claimHeader.ASI_TnE_Type__c == 'Corp Card')), true, false)}">
                                    <apex:commandButton value="Add New" onclick="addNewClaims(); return false;" styleClass="addNewBtn"/>
                                    <br/>
                                    <br/>
                                </apex:outputPanel>
                                
<!-- ************************
T&E Hong Kong
************************* -->
                                <!-- ******************* NORMAL VIEW HK ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'HK' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_HK">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_HK_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                                    <!-- <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_HK_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_HK_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_HK_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true); validateClassification($('#row_HK_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <apex:outputtext rendered="{!claimHeader.ASI_TnE_Type__c == 'Corp Card'}">
                                                    <td style="text-align: center;"><apex:inputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>                                                
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_HK_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_HK_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_HK_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                        styleclass="ASI_TnE_Invoice_Issuer"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_MFM_PO__c}" styleClass="ASI_TnE_MFM_PO"/> <br/> 
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_CAP_Plan__c}" styleClass="ASI_TnE_CAP_Plan"/>
                                                </td>                                          
                                                <td><!--<apex:inputField value="{!eCls.detailRecord.ASI_TnE_BU__c}"/> <br/> 
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Employee__c}"
                                                                     styleClass="ASI_TnE_Employee"/> -->
                                                    <apex:inputField styleClass="ASI_TnE_Charge_To_Acc" value="{!eCls.detailRecord.ASI_TnE_Charge_To_Acc__c}"/>
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                
<!-- ************************
T&E Singapore
************************* -->
                                <!-- ******************* NORMAL VIEW SG ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'SG' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_SG">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_SG_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                                   <!--  <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_SG_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_SG_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_SG_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"
                                                                     styleclass="marketCharged"/>
                                                </td>
                                                <td>
                                                    <apex:selectList value="{!eCls.targetSubBrandSelected}" size="1" id="subBrandBlock" styleClass="ASI_TnE_SubBrand">
                                                        <apex:selectOptions value="{!eCls.subBrandSelectOption}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                    styleclass="ASI_TnE_Invoice_Issuer"/> <br/>
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Outlet__c}"
                                                        styleclass="ASI_TnE_Outlet"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_MFM_PO__c}" styleClass="ASI_TnE_MFM_PO"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
<!-- ************************
T&E Cambodge  Added by 2018-01-24 Linus@introv
************************* -->
                                <!-- ******************* NORMAL VIEW KH ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'KH' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_KH">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_KH_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                                   <!--  <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_KH_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_KH_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_KH_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_KH_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_KH_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_KH_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_KH_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"
                                                                     styleclass="marketCharged"/>
                                                </td>
                                                <td>
                                                    <apex:selectList value="{!eCls.targetSubBrandSelected}" size="1" id="subBrandBlock" styleClass="ASI_TnE_SubBrand">
                                                        <apex:selectOptions value="{!eCls.subBrandSelectOption}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                    styleclass="ASI_TnE_Invoice_Issuer"/> <br/>
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Outlet__c}"
                                                        styleclass="ASI_TnE_Outlet"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_MFM_PO__c}" styleClass="ASI_TnE_MFM_PO"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>                                
<!-- ************************
        T&E FINANCE VIEW General View
************************* -->
                         <apex:outputPanel rendered="{!IF(isFinanceType == true && isFinanceView == true, true, false)}">
                            <table id="claimdetail_Finance_Table_SG">
                                <apex:repeat value="{!detailWrapper}" var="eCls" >
                                    <tr Id="row_SG_{!eCls.rowIndex}" class="cldContent">
                                        <td>
                                            &nbsp;
                                            <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                            &nbsp;
                                            <!-- <apex:commandLink value="Delete"
                                                              immediate="true"
                                                              action="{!removeClaimDetail}"
                                                              rerender="detail_pageBlock, pageMsg"
                                                              onComplete="setTables();"
                                                              status="loadingStatus">
                                                <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                            </apex:commandLink> -->
                                            <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                        </td>
                                        <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Account_Number__c}"/></td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //pdateDependentList($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}', false);
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                         <apex:outputtext rendered="{!headerRecType == 'HK'}">
                                            <td>
                                              <apex:inputField value="{!eCls.detailRecord.ASI_TnE_BU__c}"/>  
                                            </td>
                                        </apex:outputtext>       
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_A_C_Code__c}"
                                                             styleClass="ASI_TnE_A_C_Code"/>
                                        </td>
                                        <td>
                                        <apex:outputtext rendered="{!headerRecType != 'HK'}"> 
                                            <apex:inputField value="{!eCls.detailRecord.ASI_TnE_BU__c}"/>  
                                         </apex:outputtext>
                                          <apex:outputtext rendered="{!headerRecType == 'HK'}">
                                              <apex:inputField styleClass="ASI_TnE_Charge_To_Acc" value="{!eCls.detailRecord.ASI_TnE_Charge_To_Acc__c}"/>
                                          </apex:outputtext>
                                        </td>
                                        <td><span> {!eCls.detailRecord.ASI_TnE_SG_Sub_Ledger__c} </span></td>
                                        <apex:outputtext rendered="{!headerRecType != 'HK'}">
                                            <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"
                                                    styleclass="marketCharged"/>
                                            </td>
                                        </apex:outputtext>
                                        <apex:outputtext rendered="{!AND(headerRecType != 'TH', headerRecType != 'HK')}">
                                            <td>
                                                <apex:selectList value="{!eCls.targetSubBrandSelected}" size="1" id="subBrandBlock" styleClass="ASI_TnE_SubBrand">
                                                    <apex:selectOptions value="{!eCls.subBrandSelectOption}"></apex:selectOptions>
                                                </apex:selectList>
                                            </td>
                                        </apex:outputtext>
                                        <apex:outputtext rendered="{!AND(claimHeader.ASI_TnE_Type__c == 'Corp Card', headerRecType != 'SG', headerRecType != 'MY')}">
                                            <td style="text-align: center;"><apex:inputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                        </apex:outputtext>
                                        <apex:outputtext rendered="{!headerRecType != 'HK'}">
                                            <td style="text-align: center;">
                                                <apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/>
                                            </td>
                                        </apex:outputtext>
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/>
                                        </td>
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"
                                                styleClass="receiptAmount"
                                                onChange="autoCalculatePaymentAmount($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculateTaxableAmount($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculateTaxAmountOnly($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculateWHT($('#row_SG_{!eCls.rowIndex}'));
                                                            calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/></td>
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                styleclass="currCode" 
                                                onchange="updateExchangeRate($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculatePaymentAmount($('#row_SG_{!eCls.rowIndex}'));
                                                                autoCalculateTaxableAmount($('#row_SG_{!eCls.rowIndex}'));
                                                                autoCalculateTaxAmountOnly($('#row_SG_{!eCls.rowIndex}'));
                                                                autoCalculateWHT($('#row_SG_{!eCls.rowIndex}'));
                                                                calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/>
                                        </td>
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                styleclass="fxRate" 
                                                onfocus="getPreviousValue($('#row_SG_{!eCls.rowIndex}'));" 
                                                onchange="rateMessage($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculatePaymentAmount($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculateTaxableAmount($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculateTaxAmountOnly($('#row_SG_{!eCls.rowIndex}'));
                                                            autoCalculateWHT($('#row_SG_{!eCls.rowIndex}'));
                                                            calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/>
                                        </td>
                                        <!-- [SH] 2018-12-28 -->
                                        <!--
                                        <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                            <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Billed_To__c}"
                                                    styleClass="ASI_TnE_Billed_To" 
                                                    onChange="calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/></td>
                                        </apex:outputtext>
										-->
                                        <apex:outputtext rendered="{!headerRecType == 'HK'}">
                                                <td><apex:outputfield value="{!eCls.detailRecord.ASI_TnE_Submitted_Payment_Amount__c}"
                                                                     styleClass="ASI_TnE_Submitted_Payment_Amount"/>
                                                </td>
                                        </apex:outputtext>
                                        <td><span class="paymentAmount"> {!eCls.detailRecord.ASI_TnE_HK_Payment_Amount__c}</span></td>
                                        <apex:outputtext rendered="{!isTaxApplicable}">
                                            <apex:outputText rendered="{!headerRecType != 'MY'}">
                                            <td style="text-align: center;">
                                                <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}" 
                                                                styleClass="ASI_TnE_Tax_Inclusive"
                                                                onChange="taxInclusiveChanged($('#row_SG_{!eCls.rowIndex}'));"/>
                                            </td>
                                            </apex:outputText>
                                            
                                            <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Client_Type__c}"
                                                        styleClass="ASI_TnE_Client_Type" 
                                                        onChange="calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/></td>
                                            </apex:outputtext>
                                            <apex:outputText rendered="{!headerRecType != 'MY'}">
                                            <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Rate__c}"
                                                    styleClass="taxRate" 
                                                    onChange="calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/></td>
                                            </apex:outputText>
                                            <td>
                                                <apex:outputtext rendered="{!headerRecType != 'MY'}">
                                                    <span class="taxableAmount">
                                                        {!eCls.detailRecord.ASI_TnE_Taxable_Amount_Display__c}
                                                    </span>
                                                </apex:outputText>
                                                
                                                <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                                    <apex:inputField styleClass="taxableAmount" value="{!eCls.detailRecord.ASI_TnE_Taxable_Amount_Display__c}" />
                                                </apex:outputText>
                                                <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                                    <div style="display:none;">
                                                        
                                                        <input value="{!eCls.detailRecord.ASI_TnE_Tax_Amount__c}"
                                                            styleClass="taxAmount"
                                                            onChange="autoCalculateTaxableAmountOnly($('#row_SG_{!eCls.rowIndex}'));
                                                                        calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/>
                                                        
                                                    </div> 
                                                </apex:outputText>
												
                                            </td>
                                            <apex:outputtext rendered="{!headerRecType != 'MY'}"> 
                                                <td>
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Amount__c}"
                                                        styleClass="taxAmount"
                                                        onChange="autoCalculateTaxableAmountOnly($('#row_SG_{!eCls.rowIndex}'));
                                                                    calculateGSTValue($('#row_SG_{!eCls.rowIndex}'));"/>
                                                </td>
                                            </apex:outputText>
                                            <!--
                                            <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_MY_GST_Value__c}"
                                                        styleClass="ASI_TnE_MY_GST_Value" /></td>
                                            </apex:outputText>
											-->
                                            <apex:outputtext rendered="{!headerRecType == 'TH'}">
                                                <td>
                                                    <span class="ASI_TnE_WHT_Amount">
                                                        {!eCls.detailRecord.ASI_TnE_WHT_Amount__c}
                                                    </span>
                                                </td><p></p>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_WHT_Rate__c}"
                                                        styleClass="ASI_TnE_WHT_Rate"
                                                        onChange="autoCalculateWHT($('#row_SG_{!eCls.rowIndex}'), '{!eCls.detailRecord.ASI_TnE_Amount__c}');"/>
                                                </td>
                                            </apex:outputtext>
                                        </apex:outputtext>
                                        <apex:outputtext rendered="{!OR(isTaxApplicable, headerRecType == 'HK')}">
                                            <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                    styleclass="ASI_TnE_Invoice_Issuer"/> 
                                                <apex:outputtext rendered="{!AND(headerRecType != 'TH', headerRecType != 'HK')}">
                                                    <br/>
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Outlet__c}"
                                                        styleclass="ASI_TnE_Outlet"/>
                                                </apex:outputtext>
                                            </td>
                                        </apex:outputtext>
                                        <apex:outputtext rendered="{!headerRecType == 'TH'}">
                                            <td>
                                                <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Supplier__c}"
                                                    styleclass="ASI_TnE_Supplier"/>
                                            </td>
                                        </apex:outputtext>
                                        <apex:outputtext rendered="{!headerRecType != 'MY'}">
                                            <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                        </apex:outputtext>
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                styleClass="ASI_TnE_Total_Number_Pax"/>
                                        </td>
                                        <apex:outputtext rendered="{!headerRecType == 'MY' || headerRecType == 'ID'}">
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                        </apex:outputtext>
                                        <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                        <apex:outputtext rendered="{!headerRecType != 'MY' && headerRecType != 'ID'}">
                                            <td>
                                                <apex:inputField value="{!eCls.detailRecord.ASI_TnE_MFM_PO__c}" styleClass="ASI_TnE_MFM_PO"/> 
                                                <apex:outputtext rendered="{!headerRecType == 'HK'}"> <br/> 
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_CAP_Plan__c}" styleClass="ASI_TnE_CAP_Plan"/>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType == 'TH'}">   <br/> 
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Payment_Request__c}" styleClass="ASI_TnE_Payment_Request"/>
                                                </apex:outputtext>
                                            </td>
                                        </apex:outputtext>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </apex:outputPanel>
                                
<!-- ************************
T&E Philippines
************************* -->
                                <!-- ******************* NORMAL VIEW PH ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'PH' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_PH">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_PH_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                                  <!--  <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_PH_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_PH_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_PH_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_PH_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <apex:outputtext rendered="{!claimHeader.ASI_TnE_Type__c == 'Corp Card'}">
                                                    <td style="text-align: center;"><apex:inputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_PH_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_PH_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_PH_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"
                                                                     styleclass="marketCharged"/>
                                                </td>
                                                <td>
                                                    <apex:selectList value="{!eCls.targetSubBrandSelected}" size="1" id="subBrandBlock" styleClass="ASI_TnE_SubBrand">
                                                        <apex:selectOptions value="{!eCls.subBrandSelectOption}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                                     styleclass="ASI_TnE_Invoice_Issuer"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                
                                
<!-- ************************
T&E Thailand
************************* -->
                                <!-- ******************* NORMAL VIEW TH ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'TH' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_TH">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_TH_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                                  <!--   <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_TH_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_TH_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_TH_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_TH_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <apex:outputtext rendered="{!claimHeader.ASI_TnE_Type__c == 'Corp Card'}">
                                                    <td style="text-align: center;"><apex:inputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_TH_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_TH_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_TH_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                        styleclass="ASI_TnE_Invoice_Issuer"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                                <td>
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_MFM_PO__c}" styleClass="ASI_TnE_MFM_PO"/> <br/> 
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Payment_Request__c}" styleClass="ASI_TnE_Payment_Request"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"
                                                                     styleclass="marketCharged"/>
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                
                                
<!-- ************************
T&E Malaysia
************************* -->
                                <!-- ******************* NORMAL VIEW MY ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'MY' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_MY">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_MY_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                             <!--        <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_MY_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_MY_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_MY_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_MY_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_MY_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_MY_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_MY_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <!-- [SH] 2018-12-28 Modified layout -->
                                                <!--
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Billed_To__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Billed_To"/>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
												-->
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Client_Type__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Client_Type"/>
                                                </td>
                                                
                                                <!--Added by 2018-06-20 Linus@introv-->
                                                <!-- [SH] 2018-12-28 Modified layout -->
                                                <!--
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Rate__c}"
                                                    styleClass="taxRate" 
                                                    onChange="calculateGSTValue($('#row_MY_{!eCls.rowIndex}'));"/></td>
                                                <td><apex:outputfield value="{!eCls.detailRecord.ASI_TnE_MY_GST_Value__c}"
                                                        styleClass="ASI_TnE_MY_GST_Value" />
                                                </td>
                                                -->
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"
                                                                     styleclass="marketCharged"/>
                                                </td>
                                                <td>
                                                    <apex:selectList value="{!eCls.targetSubBrandSelected}" size="1" id="subBrandBlock" styleClass="ASI_TnE_SubBrand">
                                                        <apex:selectOptions value="{!eCls.subBrandSelectOption}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                        styleclass="ASI_TnE_Invoice_Issuer"/> <br/>
                                                    <apex:inputField value="{!eCls.detailRecord.ASI_TnE_Outlet__c}"
                                                        styleclass="ASI_TnE_Outlet"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                
<!-- ************************
T&E Indonesia
************************* -->
                                <!-- ******************* NORMAL VIEW ID ******************* -->
                                <apex:outputPanel rendered="{!IF(headerRecType == 'ID' && isFinanceType == false && isEmployeeView == false, true, false)}">
                                    <table id="claimdetail_Table_ID">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_ID_{!eCls.rowIndex}" class="cldContent">
                                                <td>
                                                    &nbsp;
                                                    <apex:commandLink value="Clone" onclick="cloneClaims('{!eCls.rowIndex}'); return false;"/>
                                                    &nbsp;
                                               <!--     <apex:commandLink value="Delete"
                                                                      immediate="true"
                                                                      action="{!removeClaimDetail}"
                                                                      rerender="detail_pageBlock, pageMsg"
                                                                      onComplete="setTables();"
                                                                      status="loadingStatus">
                                                        <apex:param name="PARAM_DELETE_CLAIM_DETAIL_ID" value="{!eCls.rowIndex}"/>
                                                    </apex:commandLink> -->
                                                    <apex:commandLink value="Delete" onclick="deleteClaims('{!eCls.rowIndex}'); return false;"/>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="category_{!eCls.rowIndex}" size="1" style="width: 140px;" onchange="updateDependentList($('#row_ID_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);" class="category">
                                                            <apex:repeat value="{!categories}" var="cat">
                                                                <option value="{!cat.Id}">{!cat.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                        <script>
                                                        $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                                        //updateDependentList($('#row_ID_{!eCls.rowIndex}'), '{!eCls.rowIndex}');
                                                        </script>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class='requiredInput'>                                                
                                                        <div class='requiredBlock'></div>
                                                        <select Id="classification_{!eCls.rowIndex}" size="1" style="width: 160px;" onclick="this.oldValue = this.value;"
                                                                onchange="readOnlyFields_Classification($('#row_ID_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);validateClassification($('#row_ID_{!eCls.rowIndex}'), '{!eCls.rowIndex}',this);" class="classification">
                                                            
                                                            <apex:repeat value="{!classifications}" var="cla">
                                                                <option value="{!cla.Id}">{!cla.Name}</option>
                                                            </apex:repeat>
                                                        </select>
                                                    </div>
                                                </td>
                                                <apex:outputtext rendered="{!claimHeader.ASI_TnE_Type__c == 'Corp Card'}">
                                                    <td style="text-align: center;"><apex:inputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" required="true"/></td>
                                                <td style="width: 120px;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}" required="true"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}" required="true"
                                                                     styleclass="currCode" 
                                                                     onchange="updateExchangeRate($('#row_ID_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                     styleclass="fxRate" 
                                                                     onfocus="getPreviousValue($('#row_ID_{!eCls.rowIndex}'));" 
                                                                     onchange="rateMessage($('#row_ID_{!eCls.rowIndex}'));"/>
                                                </td>
                                                <td style="text-align: center;"><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                 styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td>
                                                    <apex:selectList value="{!eCls.targetSubBrandSelected}" size="1" id="subBrandBlock" styleClass="ASI_TnE_SubBrand">
                                                        <apex:selectOptions value="{!eCls.subBrandSelectOption}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                                     styleclass="ASI_TnE_Invoice_Issuer"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                     styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                     styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:inputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                
<!-- ************************
T&E EMPLOYEE VIEW
************************* -->
                                <!-- ******************* Indonesia ******************* -->
                                <apex:outputPanel rendered="{!IF(isEmployeeView && headerRecType == 'ID' && !(isFinanceType && isFinanceView),true,false)}">
                                    <table id="claimdetail_Table_EMP_VIEW_ID">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_{!eCls.rowIndex}" class="cldContent">
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Expense_Category__r.Name}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Expense_Classification__r.Name}"/></td>
                                                <apex:outputtext rendered="{!claimHeader.ASI_TnE_Type__c == 'Corp Card'}">
                                                    <td style="text-align: center;"><apex:outputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>
                                                <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate" /></td>
                                                <td style="width: 120px;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}"
                                                                      styleclass="currCode"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                      styleclass="fxRate"/>
                                                </td>
                                                <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                  styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td>
                                                    <span> {!eCls.detailRecord.ASI_TnE_SubBrand__r.name}</span>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                                      styleclass="ASI_TnE_Invoice_Issuer"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                      styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                      styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                
                                <!-- ******************* Philippines ******************* -->            
                                <apex:outputPanel rendered="{!IF(isEmployeeView && headerRecType == 'PH' && !(isFinanceType && isFinanceView),true,false)}">
                                    <table id="claimdetail_Table_EMP_VIEW_PH">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_{!eCls.rowIndex}" class="cldContent">
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Expense_Category__r.Name}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Expense_Classification__r.Name}"/></td>
                                                <apex:outputtext rendered="{!claimHeader.ASI_TnE_Type__c == 'Corp Card'}">
                                                    <td style="text-align: center;"><apex:outputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>
                                                <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate"/></td>
                                                <td style="width: 120px;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}"
                                                                      styleclass="currCode"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                      styleclass="fxRate"/>
                                                </td>
                                                <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                  styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"/></td>
                                                <td>
                                                    <span> {!eCls.detailRecord.ASI_TnE_SubBrand__r.name}</span>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                                      styleclass="ASI_TnE_Invoice_Issuer"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                      styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                      styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>

                                <!-- ******************* Malaysia, Hong Kong, Singapore ******************* -->
                                <apex:outputPanel rendered="{!IF(isEmployeeView && headerRecType != 'ID' && headerRecType != 'PH' && !(isFinanceType && isFinanceView),true,false)}">
                                    <table id="claimdetail_Table_EMP_VIEW">
                                        <apex:repeat value="{!detailWrapper}" var="eCls" >
                                            <tr Id="row_{!eCls.rowIndex}" class="cldContent">
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Expense_Category__r.Name}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Expense_Classification__r.Name}"/></td>
                                                <apex:outputtext rendered="{!headerRecType == 'HK'}">
                                                    <td>
                                                      <apex:outputField styleClass="ASI_TnE_Charge_To_Acc" value="{!eCls.detailRecord.ASI_TnE_Charge_To_Acc__c}"/>
                                                    </td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType == 'HK'}">
                                                    <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_BU__c}"
                                                                         styleClass="ASI_TnE_BU"/>
                                                    </td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!AND(claimHeader.ASI_TnE_Type__c == 'Corp Card', headerRecType != 'SG', headerRecType != 'MY')}">
                                                    <td style="text-align: center;"><apex:outputField styleclass="ASI_TnE_Dispute"  value="{!eCls.detailRecord.ASI_TnE_Dispute__c}"/></td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType != 'HK'}">
                                                    <td style="text-align: center;">
                                                        <apex:outputField value="{!eCls.detailRecord.ASI_TnE_With_Receipt__c}"/>
                                                    </td>
                                                </apex:outputtext>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Date__c}" styleclass="receiptDate"/></td>
                                                <td style="width: 120px;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Receipt_Amount__c}"/></td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Currency__c}"
                                                                      styleclass="currCode"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_FX_Rate__c}" style="width: 80px;" 
                                                                      styleclass="fxRate"/>
                                                </td>
                                                <apex:outputtext rendered="{!headerRecType == 'HK'}">
                                                    <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_HK_Payment_Amount__c}"
                                                                          styleclass="ASI_TnE_HK_Payment_Amount"/>
                                                    </td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                                    <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Billed_To__c}"
                                                                                                      styleclass="ASI_TnE_Billed_To"/>
                                                    </td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType != 'HK'}">
                                                    <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Tax_Inclusive__c}"
                                                                                                      styleclass="taxInc ASI_TnE_Tax_Inclusive"/>
                                                    </td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType == 'MY'}">
                                                    <td style="text-align: center;"><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Client_Type__c}"
                                                                                                      styleclass="ASI_TnE_Client_Type"/>
                                                    </td>
                                                    <td><apex:outputfield value="{!eCls.detailRecord.ASI_TnE_MY_GST_Value__c}"
                                                            styleClass="ASI_TnE_MY_GST_Value" /></td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!headerRecType != 'HK'}">
                                                    <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Market_Charged_To__c}"/></td>
                                                </apex:outputtext>
                                                <apex:outputtext rendered="{!AND(headerRecType != 'TH', headerRecType != 'HK')}">
                                                    <td>
                                                        <span> {!eCls.detailRecord.ASI_TnE_SubBrand__r.name}</span>
                                                    </td>
                                                </apex:outputtext>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Invoice_Issuer__c}"
                                                        styleclass="ASI_TnE_Invoice_Issuer"/> 
                                                    <apex:outputtext rendered="{!AND(headerRecType != 'TH', headerRecType != 'HK')}">
                                                        <br/>
                                                        <apex:outputField value="{!eCls.detailRecord.ASI_TnE_Outlet__c}"
                                                            styleclass="ASI_TnE_Outlet"/>
                                                    </apex:outputtext>
                                                </td>
                                                <apex:outputtext rendered="{!headerRecType != 'MY'}">
                                                    <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Destination__c}" styleClass="ASI_TnE_Destination"/></td>
                                                </apex:outputtext>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Total_Number_Pax__c}" style="width: 35px;"
                                                                      styleClass="ASI_TnE_Total_Number_Pax"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Name_Company__c}"
                                                                      styleClass="ASI_TnE_Name_Company"/>
                                                </td>
                                                <td><apex:outputField value="{!eCls.detailRecord.ASI_TnE_Details_of_Expense__c}"/></td>
                                                <apex:outputtext rendered="{!headerRecType != 'MY'}">
                                                    <td>
                                                        <apex:outputField value="{!eCls.detailRecord.ASI_TnE_MFM_PO__c}" styleClass="ASI_TnE_MFM_PO__c"/>
                                                        <apex:outputtext rendered="{!headerRecType == 'TH'}">   <br/> 
                                                            <apex:outputField value="{!eCls.detailRecord.ASI_TnE_Payment_Request__c}" styleClass="ASI_TnE_Payment_Request"/>
                                                        </apex:outputtext>
                                                    <apex:outputtext rendered="{!headerRecType == 'HK'}"> <br/>
                                                        <apex:outputField value="{!eCls.detailRecord.ASI_TnE_CAP_Plan__c}" styleClass="ASI_TnE_CAP_Plan"/>
                                                    </apex:outputtext>
                                                </td>
                                            </apex:outputtext>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                
                            </apex:outputPanel>
                            <script>
                                <apex:repeat value="{!detailWrapper}" var="eCls">
                                    $('#category_{!eCls.rowIndex}').val('{!eCls.expCategory}');
                                    updateDependentList($('#row_{!eCls.countryCode}_{!eCls.rowIndex}'), '{!eCls.rowIndex}', false);
                                    //updateExchangeRate($('#row_{!eCls.countryCode}_{!eCls.rowIndex}'));
                                    $('#classification_{!eCls.rowIndex}').val('{!eCls.expClassification}');
                                    readOnlyFields_Classification($('#row_{!eCls.countryCode}_{!eCls.rowIndex}'), '{!eCls.rowIndex}', false);
                                    readOnlyFields_Classification($('#row_SG_{!eCls.rowIndex}'), '{!eCls.rowIndex}', true);
                                    marketChargedEnabled($('#row_{!eCls.countryCode}_{!eCls.rowIndex}'));
                                    //enableTaxAmt($('#row_{!eCls.countryCode}_{!eCls.rowIndex}'));
                                </apex:repeat>
                            </script>
                        </apex:pageBlock>
                    </div>
                </div>
                
                <script>
                $ = jQuery.noConflict();
                $("#detailTabs").tabs();
                </script>
            </apex:pageBlock>
        </apex:form>
    </body>
</apex:page>