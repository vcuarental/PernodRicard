<apex:page applyBodyTag="false" contentType="application/vnd.ms-excel;charset=GBK;#{!YEAR(TODAY())}{!MONTH(TODAY())}{!DAY(TODAY())}ApprovalHistory.csv" controller="ASI_MFM_CN_ApprovalHistoryCTRL">Document Number,Object Type,Owner,BU<apex:variable rendered="{!selectedObject == 'ASI_MFM_PO__c'}" value="1" var="1">,PO Start Date,PO End Date,PO Remark</apex:variable><apex:variable rendered="{!selectedObject == 'ASI_MFM_Payment__c'}" value="1" var="1">,Supplier Name,One Off Payee,Alternate Payee,Bank Details,Remarks,Discount Pool,Related POs,Payment Amount Net of Tax</apex:variable>,Amount,Start Date,Submitter,Approver,Actual Approver,Status,Initial Submitted Date,Comment
<apex:repeat value="{!csvList}" var="detail" id="detailList2">   
{!detail.headerNumber},{!detail.objectTypeStr},{!detail.owner},{!detail.BU}<apex:variable rendered="{!selectedObject == 'ASI_MFM_PO__c'}" value="1" var="1">,{!detail.poStart},{!detail.poEnd},{!detail.remark}</apex:variable><apex:variable rendered="{!selectedObject == 'ASI_MFM_Payment__c'}" value="1" var="1">,{!detail.supplierName},{!detail.oneOffPayee},{!detail.alternatePayee},{!detail.bankDetails},{!detail.remark},{!detail.discountPool},{!detail.relatedPO},{!detail.paymentAmountNetOfTax}</apex:variable>,{!detail.amount},{!detail.startDate},{!detail.submitter},{!detail.currentApprover},{!detail.actualApprover},{!if(detail.currentStatus == "Removed", "Recalled", if(detail.currentStatus == "Started", "Submitted", detail.currentStatus))},{!detail.submissionDate},<apex:outputText escape="true" value="{!detail.comments}"></apex:outputText>
</apex:repeat>
</apex:page>