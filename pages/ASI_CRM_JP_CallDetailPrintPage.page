<apex:page standardController="ASI_CRM_Call_Detail__c" extensions="ASI_CRM_JP_CallDetailPrintController" recordSetVar="details" showHeader="false" sidebar="false" applyHTMLTag="false" applyBodyTag="false" renderAs="PDF">
<html>
    <head>
        <style>
            @Page{
                size: landscape;
                margin:0.25in;


                @PageBreak{
                    page-break-inside:avoid;
                    page-break:always;
                }       

                @top-center {
                    content: element(header); 

                }
                @bottom-center {
                    content: counter(page);
                }    
            }
            div.header {
                position: running(header);
            }


            .nobreak{
                page-break-inside: avoid;       
            }


            table {
                <!--         -fs-table-paginate: paginate; -->
                <!--        page-break-inside: auto;    -->
                border-spacing: 0;
            }

            tr{
                page-break-inside:avoid;
            }

            body{
                font-family: Arial Unicode MS;
                font-size: 7pt;
            }

            tbody {display:table-row-group;
            }

            .standardtd{
                border: solid 1px black;    
            }

            .approvertd {
                width:50pt;
                text-align:center;            
            }
            
            .break { page-break-after: always; }

            .tableHeader {
                text-align:center;
            }
            thead {
                display: table-header-group;
                border-top: solid 1px black;
            }
            
            #footer
            {
                clear: both;
                position:relative;
                z-index: 10;
                height: 3em;
                margin-top: 10em;
                page-break-inside: avoid;
            }
            </style>
    </head>
    <body>    
         <apex:variable var="cnt" value="{!0}" />  
         <apex:repeat value="{!detailsgroup}" var="detail" > 
             <apex:outputPanel layout="block" rendered="{!detail.detail.ASI_CRM_Payment_Option__c != 'Invoice'}">
             <div style = "{!if(cnt < 1, 'page-break-before:avoid;','page-break-before:always;')}">
                 <div style="font-size: 12pt;float:left">
                    <h3><b>{!$Label.ASI_CRM_JP_Print_Payment_Title} (<apex:outputField value="{!detail.detail.ASI_CRM_Payment_Option__c}"/>) - {!detail.detail.Name}</b></h3>
                 </div>
                 <div style="float:right;width:30%;border:1px solid;allign:center;">
                     <center>
                     Printed By {!$User.FirstName} {!$User.LastName} &nbsp; <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!now()}" date_time_format="yyyy/MM/dd HH:mm:ss"></c:ASI_CRM_JP_Formatted_Datetime>
                     </center>
                 </div>
                 <div style="clear:both;"></div>
                 <div style="float:left;width:35%;margin-top:5px">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 50%;padding-left:5px;"/>
                         <col span="1" style="width: 50%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Owner}</td>
                         <td class="tableHeader" >{!header.ASI_CRM_Sales_Group__c} {!header.ASI_CRM_Staff_Code__c} {!header.owner.name}</td>
                     </tr>
                     <tr>
                        <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Plan_Visit_Period}</td>
                        <td class="tableHeader" >
                            <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!header.ASI_CRM_Period_From__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>~<c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!header.ASI_CRM_Period_To__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>
                        </td>
                     </tr>
                 </table>
                 </div>
                 
                 <apex:outputPanel layout="block" rendered="{!detail.detail.ASI_CRM_Payment_Option__c == 'Invoice'}">
                 <div style="float:left;margin-left:29px;width:62%">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                 <colgroup>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                </colgroup>
                <tr style="height:8px;">    
                    <td class="tableHeader" style="height:8px;">Applicant</td>
                    <td class="tableHeader">Supervisor</td>
                    <td class="tableHeader">Manager</td>
                    <td class="tableHeader">Regional Mgr</td>
                    <td class="tableHeader">Sr. Manager</td>
                    <td class="tableHeader">Sales General Mgr</td>
                    <td class="tableHeader">CEO</td>
                </tr>
                <tr>    
                    <td height="40pt;">&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr style="height:8px">
                    <td style="height:8px">&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                </table>
                </div>
                </apex:outputPanel>
                <div style="clear:both;"></div>
                <br/>
                 
                 <apex:outputPanel layout="block" rendered="{!detail.detail.ASI_CRM_Customer__r.recordtype.developername = 'ASI_CRM_JP_On_Trade_Outlet'}">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                 <colgroup>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                </colgroup>
                <tr>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Visitation_Visitation_Date}</td>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Detail_Visit_Period}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Customer__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_AccountsAdditionalField__c.fields.ASI_CRM_VN_Channel__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Actual_Amount__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Total_Number_of_Attendees__c.Label}</td>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Detail_Class}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Dohan__c.Label}</td>
                </tr>
                <tr>
                     <td class="tableHeader" >
                         <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_From__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>
                     </td>
                     <td class="tableHeader" >
                         <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_From__c}" date_time_format="HH:mm"></c:ASI_CRM_JP_Formatted_Datetime>&nbsp;~&nbsp;<c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_To__c}" date_time_format="HH:mm"></c:ASI_CRM_JP_Formatted_Datetime>
                     </td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.Name}</td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.ASI_TH_CRM_OutletType__r.Name}</td>
                     <td class="tableHeader"> <apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Actual_Amount__c}" /></apex:outputText></td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Total_Number_of_Attendees__c}</td> 
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.ASI_TH_CRM_OutletType__r.ASI_CRM_Class__c}</td>
                     <td class="tableHeader" ><apex:outputPanel rendered="{!detail.detail.ASI_CRM_Dohan__c}"> &radic; </apex:outputPanel></td> 
                </tr>
                </table>
                </apex:outputPanel>
                
                <apex:outputPanel layout="block" rendered="{!detail.detail.ASI_CRM_Customer__r.recordtype.developername != 'ASI_CRM_JP_On_Trade_Outlet'}">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                 <colgroup>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     <col span="1" style="width: 12.5%;padding-left:5px;"/>
                </colgroup>
                <tr>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Visitation_Visitation_Date}</td>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Detail_Visit_Period}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Customer__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_AccountsAdditionalField__c.fields.ASI_CRM_VN_Channel__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Actual_Amount__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Total_Number_of_Attendees__c.Label}</td>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Detail_Class}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Dohan__c.Label}</td>
                </tr>
                <tr>
                     <td class="tableHeader" >
                         <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_From__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>
                     </td>
                     <td class="tableHeader" >
                         <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_From__c}" date_time_format="HH:mm"></c:ASI_CRM_JP_Formatted_Datetime>&nbsp;~&nbsp;<c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_To__c}" date_time_format="HH:mm"></c:ASI_CRM_JP_Formatted_Datetime>
                     </td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.Name}</td>
                     <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Customer__r.ASI_CRM_VN_Channel__c}"/></td>
                     <td class="tableHeader"> <apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Actual_Amount__c}" /></apex:outputText></td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Total_Number_of_Attendees__c}</td> 
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.ASI_TH_CRM_OutletType__r.ASI_CRM_Class__c}</td>
                     <td class="tableHeader" ><apex:outputPanel rendered="{!detail.detail.ASI_CRM_Dohan__c}"> &radic; </apex:outputPanel></td> 
                </tr>
                </table>
                </apex:outputPanel>
                
                <br/>
                <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Interviewee__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Interviewee__c}</td> 
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Attendees_PRJ__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Attendees_PRJ__c}</td> 
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Attendees_BS__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Attendees_BS__c}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Attendees_Other__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Attendees_Other__c}</td>
                     </tr>
                     <tr>
                         <td class="tableHeader">{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_JP_All_Attendees__c.Label}</td>
                         <td colspan="7">&nbsp;&nbsp;&nbsp;&nbsp;{!detail.detail.ASI_CRM_JP_All_Attendees__c}</td> 
                     </tr>
                 </table>
                 <br/>
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Purpose__c.Label}</td>
                         <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Activity_Purpose__c}"/></td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Result__c.Label}</td>
                         <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Activity_Result__c}"/></td>
                         <td class="tableHeader" >{!$ObjectType.ASI_MFM_SKU_Code__c.fields.ASI_CRM_Standard_Cost__c.Label}</td>
                         <td class="tableHeader" >
                            <apex:outputText value="{0, number,###,###,##0}">
                                <apex:param value="{!(
                                  IF(detail.detail.ASI_CRM_Actual_Taxable_Amount__c == Null, 0, detail.detail.ASI_CRM_Actual_Taxable_Amount__c) - 
                                  IF(detail.detail.ASI_CRM_Price_of_SKU1__c == Null, 0, detail.detail.ASI_CRM_Price_of_SKU1__c)* IF(detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c == Null, 0, detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c) - 
                                  IF(detail.detail.ASI_CRM_Price_of_SKU2__c == Null, 0, detail.detail.ASI_CRM_Price_of_SKU2__c)* IF(detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c == Null, 0, detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c) -
                                  IF(detail.detail.ASI_CRM_Price_of_SKU3__c == Null, 0, detail.detail.ASI_CRM_Price_of_SKU3__c)* IF(detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c == Null, 0, detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c)
                                  )
                                  /detail.totalAttendees}" />
                            </apex:outputText>
                         </td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Tax_Routing__c.Label}</td>
                         <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Tax_Routing__r.Name}"/></td>
                     </tr>
                 </table>
                 <br/>
                 {!$Label.ASI_CRM_JP_Visitation_Percentage}
                 <table border="1" cellpadding="1" cellspacing="1" width="75%">
                     <colgroup>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Sub_brand_1__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Activity_Sub_brand_1__r.Name}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Sub_brand_2__c.Label}</td>
                         <td class="tableHeader" >{!If(detail.detail.ASI_CRM_Activity_Sub_brand_2__r = null, 'N/A', detail.detail.ASI_CRM_Activity_Sub_brand_2__r.Name)}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Sub_brand_3__c.Label}</td>
                         <td class="tableHeader" >{!If(detail.detail.ASI_CRM_Activity_Sub_brand_3__r = null, 'N/A', detail.detail.ASI_CRM_Activity_Sub_brand_3__r.Name)}</td>
                     </tr>
                 </table>
                 <br/>
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 10%;padding-left:5px;"/>
                         <col span="1" style="width: 90%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Remarks__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Remarks__c}</td>
                     </tr>
                 </table>
                 <br/>
                 {!$Label.ASI_CRM_JP_Item_Details}
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Item_Group}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_No_Of_Item_Consumed}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Price_Of_Item}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Total_Amount}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Monthly_Sales}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Monthly_Sales_Listing_List}</td>
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_1__c), 'none', 'table-row')};">
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Item_1__r.Name}</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Price_of_SKU1__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c * detail.detail.ASI_CRM_Price_of_SKU1__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Monthly_Sales_1__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.mthSale1}" /></apex:outputText></td>  
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_2__c), 'none', 'table-row')};">
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Item_2__r.Name}</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Price_of_SKU2__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c * detail.detail.ASI_CRM_Price_of_SKU2__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Monthly_Sales_2__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.mthSale2}" /></apex:outputText></td>
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_3__c), 'none', 'table-row')};">
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Item_3__r.Name}</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Price_of_SKU3__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c * detail.detail.ASI_CRM_Price_of_SKU3__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Monthly_Sales_3__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.mthSale3}" /></apex:outputText></td>
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_1__c), 'none', 'table-row')};">
                         <td class="tableHeader" >Total:</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Qty_of_Bottles_Consumed_Total__c}" /></apex:outputText></td>
                         <td class="tableHeader" ></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c * If(detail.detail.ASI_CRM_Price_of_SKU1__c = null, 0, detail.detail.ASI_CRM_Price_of_SKU1__c) + detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c * If(detail.detail.ASI_CRM_Price_of_SKU2__c = null, 0, detail.detail.ASI_CRM_Price_of_SKU2__c) + detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c * If(detail.detail.ASI_CRM_Price_of_SKU3__c = null, 0, detail.detail.ASI_CRM_Price_of_SKU3__c)}" /></apex:outputText></td>
                         <td class="tableHeader" ></td>
                         <td class="tableHeader" ></td>
                     </tr>
                </table>
                <apex:variable var="cnt" value="{!cnt+1}"/>
             </div>
             </apex:outputPanel>
             
             
             <apex:outputPanel layout="block" rendered="{!detail.detail.ASI_CRM_Payment_Option__c == 'Invoice'}">
             <div style = "{!if(cnt < 1, 'page-break-before:avoid;','page-break-before:always;')}">
                 <div style="font-size: 12pt;float:left">
                    <h3><b>{!$Label.ASI_CRM_JP_Print_Payment_Title} (<apex:outputField value="{!detail.detail.ASI_CRM_Payment_Option__c}"/>) - {!detail.detail.Name}</b></h3>
                 </div>
                 <div style="float:right;width:30%;border:1px solid;allign:center;">
                     <center>
                     Printed By {!$User.FirstName} {!$User.LastName} &nbsp; <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!now()}" date_time_format="yyyy/MM/dd HH:mm:ss"></c:ASI_CRM_JP_Formatted_Datetime>
                     </center>
                 </div>
                 <div style="clear:both;"></div>
                 <div style="float:left;width:62%;margin-top:5px">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 25%;padding-left:5px;"/>
                         <col span="1" style="width: 25%;padding-left:5px;"/>
                         <col span="1" style="width: 25%;padding-left:5px;"/>
                         <col span="1" style="width: 25%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Owner}</td>
                         <td class="tableHeader" >{!header.ASI_CRM_Sales_Group__c} {!header.ASI_CRM_Staff_Code__c} {!header.owner.name}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Plan_Visit_Period}</td>
                         <td class="tableHeader" >
                            <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!header.ASI_CRM_Period_From__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>~<c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!header.ASI_CRM_Period_To__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>
                         </td>
                     </tr>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Invoice_Date__c.Label}</td>
                         <td class="tableHeader" ><c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Invoice_Date__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime></td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Tax_Rate__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Tax_Rate__c}%</td>
                     </tr>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Invoice_No__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Invoice_No__c}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Payment_Date__c.Label}</td>
                         <td class="tableHeader" ><c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Payment_Date__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime></td>
                     </tr>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Pay_To__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Pay_To__r.Name}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Pay_To__c.fields.ASI_CRM_Account_Number__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Pay_To__r.ASI_CRM_Account_Number__c}</td>
                     </tr>
                 </table>
                 </div>
                 
                 <div style="float:left;margin-left:29px;width:35%;margin-top:5px">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                 <colgroup>
                     <col span="1" style="width: 50%;padding-left:5px;"/>
                     <col span="1" style="width: 50%;padding-left:5px;"/>
                 </colgroup>
                 <tr>    
                    <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Actual_Taxable_Amount__c.Label}</td>
                    <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Actual_Taxable_Amount__c}" /></apex:outputText></td>
                </tr>
                <tr>    
                    <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Actual_Tax_Amount__c.Label}</td>
                    <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Actual_Tax_Amount__c}" /></apex:outputText></td>
                </tr>
                <tr>
                    <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Actual_Amount__c.Label}</td>
                    <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Actual_Amount__c}" /></apex:outputText></td>
                </tr>
                </table>
                </div>
                <div style="clear:both;"></div>
                <br/>
                 
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                 <colgroup>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                     <col span="1" style="width: 14.3%;padding-left:5px;"/>
                </colgroup>
                <tr>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Visitation_Visitation_Date}</td>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Detail_Visit_Period}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Customer__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_AccountsAdditionalField__c.fields.ASI_CRM_VN_Channel__c.Label}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Total_Number_of_Attendees__c.Label}</td>
                     <td class="tableHeader" >{!$Label.ASI_CRM_JP_Call_Detail_Class}</td>
                     <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Dohan__c.Label}</td>
                </tr>
                <tr>
                     <td class="tableHeader" >
                         <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_From__c}" date_time_format="yy/MM/dd"></c:ASI_CRM_JP_Formatted_Datetime>
                     </td>
                     <td class="tableHeader" >
                         <c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_From__c}" date_time_format="HH:mm"></c:ASI_CRM_JP_Formatted_Datetime>&nbsp;~&nbsp;<c:ASI_CRM_JP_Formatted_Datetime date_time_value="{!detail.detail.ASI_CRM_Visit_Date_To__c}" date_time_format="HH:mm"></c:ASI_CRM_JP_Formatted_Datetime>
                     </td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.Name}</td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.ASI_TH_CRM_OutletType__r.Name}</td>
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Total_Number_of_Attendees__c}</td> 
                     <td class="tableHeader" >{!detail.detail.ASI_CRM_Customer__r.ASI_TH_CRM_OutletType__r.ASI_CRM_Class__c}</td>
                     <td class="tableHeader" ><apex:outputPanel rendered="{!detail.detail.ASI_CRM_Dohan__c}"> &radic; </apex:outputPanel></td>
                </tr>
                </table>
                
                <br/>
                <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Interviewee__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Interviewee__c}</td> 
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Attendees_PRJ__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Attendees_PRJ__c}</td> 
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Attendees_BS__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Attendees_BS__c}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Attendees_Other__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Attendees_Other__c}</td>
                     </tr>
                     <tr>
                         <td class="tableHeader">{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_JP_All_Attendees__c.Label}</td>
                         <td colspan="7">&nbsp;&nbsp;&nbsp;&nbsp;{!detail.detail.ASI_CRM_JP_All_Attendees__c}</td> 
                     </tr>
                 </table>
                 <br/>
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                         <col span="1" style="width: 12.5%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Purpose__c.Label}</td>
                         <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Activity_Purpose__c}"/></td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Result__c.Label}</td>
                         <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Activity_Result__c}"/></td>
                         <td class="tableHeader" >{!$ObjectType.ASI_MFM_SKU_Code__c.fields.ASI_CRM_Standard_Cost__c.Label}</td>
                         <td class="tableHeader" >
                            <apex:outputText value="{0, number,###,###,##0}">
                                <apex:param value="{!(
                                  IF(detail.detail.ASI_CRM_Actual_Taxable_Amount__c == Null, 0, detail.detail.ASI_CRM_Actual_Taxable_Amount__c) - 
                                  IF(detail.detail.ASI_CRM_Price_of_SKU1__c == Null, 0, detail.detail.ASI_CRM_Price_of_SKU1__c)* IF(detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c == Null, 0, detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c) - 
                                  IF(detail.detail.ASI_CRM_Price_of_SKU2__c == Null, 0, detail.detail.ASI_CRM_Price_of_SKU2__c)* IF(detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c == Null, 0, detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c) -
                                  IF(detail.detail.ASI_CRM_Price_of_SKU3__c == Null, 0, detail.detail.ASI_CRM_Price_of_SKU3__c)* IF(detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c == Null, 0, detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c)
                                  )
                                  /detail.totalAttendees}" />
                            </apex:outputText>
                         </td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Tax_Routing__c.Label}</td>
                         <td class="tableHeader" ><apex:outputField value="{!detail.detail.ASI_CRM_Tax_Routing__r.Name}"/></td>
                     </tr>
                 </table>
                 <br/>
                 {!$Label.ASI_CRM_JP_Visitation_Percentage}
                 <table border="1" cellpadding="1" cellspacing="1" width="75%">
                     <colgroup>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Sub_brand_1__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Activity_Sub_brand_1__r.Name}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Sub_brand_2__c.Label}</td>
                         <td class="tableHeader" >{!If(detail.detail.ASI_CRM_Activity_Sub_brand_2__r = null, 'N/A', detail.detail.ASI_CRM_Activity_Sub_brand_2__r.Name)}</td>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Activity_Sub_brand_3__c.Label}</td>
                         <td class="tableHeader" >{!If(detail.detail.ASI_CRM_Activity_Sub_brand_3__r = null, 'N/A', detail.detail.ASI_CRM_Activity_Sub_brand_3__r.Name)}</td>
                     </tr>
                 </table>
                 <br/>
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 10%;padding-left:5px;"/>
                         <col span="1" style="width: 90%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$ObjectType.ASI_CRM_Call_Detail__c.fields.ASI_CRM_Remarks__c.Label}</td>
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Remarks__c}</td>
                     </tr>
                 </table>
                 <br/>
                 {!$Label.ASI_CRM_JP_Item_Details}
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                     <colgroup>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                         <col span="1" style="width: 16.6%;padding-left:5px;"/>
                     </colgroup>
                     <tr>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Item_Group}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_No_Of_Item_Consumed}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Price_Of_Item}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Total_Amount}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Monthly_Sales}</td>
                         <td class="tableHeader" >{!$Label.ASI_CRM_JP_Monthly_Sales_Listing_List}</td>
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_1__c), 'none', 'table-row')};">
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Item_1__r.Name}</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Price_of_SKU1__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c * detail.detail.ASI_CRM_Price_of_SKU1__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Monthly_Sales_1__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.mthSale1}" /></apex:outputText></td>  
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_2__c), 'none', 'table-row')};">
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Item_2__r.Name}</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Price_of_SKU2__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c * detail.detail.ASI_CRM_Price_of_SKU2__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Monthly_Sales_2__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.mthSale2}" /></apex:outputText></td>
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_3__c), 'none', 'table-row')};">
                         <td class="tableHeader" >{!detail.detail.ASI_CRM_Item_3__r.Name}</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Price_of_SKU3__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c * detail.detail.ASI_CRM_Price_of_SKU3__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Monthly_Sales_3__c}" /></apex:outputText></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.mthSale3}" /></apex:outputText></td>
                     </tr>
                     <tr style="display: {!IF(ISBLANK(detail.detail.ASI_CRM_Item_1__c), 'none', 'table-row')};">
                         <td class="tableHeader" >Total:</td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Qty_of_Bottles_Consumed_Total__c}" /></apex:outputText></td>
                         <td class="tableHeader" ></td>
                         <td class="tableHeader" ><apex:outputText value="{0, number,###,###,##0}"><apex:param value="{!detail.detail.ASI_CRM_Number_of_SKU1_Consumed__c * If(detail.detail.ASI_CRM_Price_of_SKU1__c = null, 0, detail.detail.ASI_CRM_Price_of_SKU1__c) + detail.detail.ASI_CRM_Number_of_SKU2_Consumed__c * If(detail.detail.ASI_CRM_Price_of_SKU2__c = null, 0, detail.detail.ASI_CRM_Price_of_SKU2__c) + detail.detail.ASI_CRM_Number_of_SKU3_Consumed__c * If(detail.detail.ASI_CRM_Price_of_SKU3__c = null, 0, detail.detail.ASI_CRM_Price_of_SKU3__c)}" /></apex:outputText></td>
                         <td class="tableHeader" ></td>
                         <td class="tableHeader" ></td>
                     </tr>
                </table>
                <br/>
                <div style="float:left;margin-left:376px;width:62%">
                 <table border="1" cellpadding="1" cellspacing="1" width="100%">
                 <colgroup>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                     <col span="1" style="width: 14.2%;padding-left:5px;"/>
                </colgroup>
                <tr style="height:8px;">    
                    <td class="tableHeader" style="height:8px;">Applicant</td>
                    <td class="tableHeader">Supervisor</td>
                    <td class="tableHeader">Manager</td>
                    <td class="tableHeader">Regional Mgr</td>
                    <td class="tableHeader">Sr. Manager</td>
                    <td class="tableHeader">Sales General Mgr</td>
                    <td class="tableHeader">CEO</td>
                </tr>
                <tr>    
                    <td height="40pt;">&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr style="height:8px">
                    <td style="height:8px">&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                </table>
                </div>
                <apex:variable var="cnt" value="{!cnt+1}"/>
             </div>
             </apex:outputPanel>
         </apex:repeat>
    </body>
</html>
</apex:page>