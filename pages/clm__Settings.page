<!--    @author: Nikita Chursin  -->
<!--    @date: 20.01.2014  -->
<!--    @description: page for changing mobile app settings  -->

<apex:page id="settingsPage" controller="clm.SettingsController" title="{!$Label.clm__ms_settingstitle}" >

    <style>
        .tableData {border:none; width: 100%;}  
        .tableData td {border-bottom:1px solid #d5d5d5; border-top:none; border-left:none; border-right:none;}  
        .tableData td:first-child {text-align: right !important;font-weight:bold;}  
        .tableData td:nth-child(3n){text-align: left !important;}  
        .tableData td:nth-child(4){text-align: right !important;font-weight:bold;}
        .helpRow {width: 15px}
        #gbox_ActivityDataCustomTable {width: 100% !important}
        #gview_ActivityDataCustomTable #ActivityDataCustomTable td {width: 100% !important}
        #gview_ActivityDataCustomTable {width: 100% !important}
        #gview_ActivityDataCustomTable .ui-jqgrid {width: 100% !important}
        #gview_ActivityDataCustomTable .ui-jqgrid-hdiv {width: 100% !important}
        #gview_ActivityDataCustomTable .ui-jqgrid-htable {width: 101.35% !important} 
        #gview_ActivityDataCustomTable .ui-jqgrid-btable {width: 100% !important}
        #gview_ActivityDataCustomTable .ui-jqgrid-bdiv {width: 100% !important}
        #gview_ActivityDataCustomTable th.ui-state-default {width: 100% !important} 
        #gview_ActivityDataCustomTable th.ui-th-column {width: 100% !important}   
        #gview_ActivityDataCustomTable th.ui-th-ltr {width: 100% !important} 
        #pager {width: 100% !important}
        
        #sortableInact, #sortableAct { list-style-type: none; margin: 0; padding: 0; float: left; margin-right: 10px; background: #eee; padding: 5px; width: 130px; height:auto; min-height:410px;}
        #sortableInact li, #sortableAct li { margin: 0 5px 5px 5px; padding: 5px; font-size: 1.2em; width: 120px; }
        .connectedSortable { list-style-type: none; margin: 0; padding: 0; float: left; margin-right: 10px; background: #eee; padding: 5px; width: auto; height:auto;  min-width:130px; min-height:410px;}
        .connectedSortable li { margin: 0 5px 5px 5px; padding: 7px; font-size: 1.2em; width: auto; }
        .ui-tabs-vertical { width: auto; } 
        .ui-tabs-vertical .ui-tabs-nav { padding: .2em .1em .2em .2em; float: left; width: auto; } 
        .ui-tabs-vertical .ui-tabs-nav li { clear: left; width: 100%; border-bottom-width: 1px !important; border-right-width: 0 !important; margin: 0 -1px .2em 0; } 
        .ui-tabs-vertical .ui-tabs-nav li a { display:block; } 
        .ui-tabs-vertical .ui-tabs-nav li.ui-tabs-active { padding-bottom: 0; padding-right: .1em; border-right-width: 1px; border-right-width: 1px; } 
        .ui-tabs-vertical .ui-tabs-panel { padding: 0em; padding-right: 24em !important; float: middle; width: 100%;} 
        
        #dialog label, #dialog input { display:block; }
        #dialog label { margin-top: 0.5em; }
        #dialog input, #dialog textarea { width: 95%; }
        
        .connectedSortableAdc { list-style-type: none; margin: 0; padding: 0; float: left; margin-right: 10px; background: #eee; padding: 5px; width: 150px; height:300px; min-height:300px;}
        .connectedSortableAdc li { margin: 0 5px 5px 5px; padding: 5px; font-size: 0.9em; width: 120px; }
        .ui-dialog {width: auto !important;}
        .ui-dialog .ui-dialog-content { overflow: hidden !important}
        .scroll {overflow: scroll; overflow-y: scroll; overflow-x: hidden;}
        
        table#MiniLayoutTable {border-collapse: collapse; width: 100%;}
        table#MiniLayoutTable table {border-collapse: collapse; margin: 10px; width: 400px; border: 2px solid #bbbbbb;}
        table#MiniLayoutTable table tr td select {width: 200px;}
        table#MiniLayoutTable table th:first {width: 230px;}
        table#MiniLayoutTable table td.tdAdd {text-align: center;}
        table#MiniLayoutTable th {background: #f2f3f3;color: #000;font-size: .9em;font-weight: bold;padding: 5px 2px 4px 5px;border: 1px solid #e0e3e5;}
        table#MiniLayoutTable tbody {background-color: #fff;}
        table#MiniLayoutTable table tbody {background-color: #fff;}
        table#MiniLayoutTable td { padding: 4px 2px 4px 5px;}
        table#MiniLayoutTable tr {border: 1px solid #ededed;}
        table#MiniLayoutTable .sort select {width: 200px;}
        table#MiniLayoutTable .RecordTypeDev select {width: 150px;}
        table#MiniLayoutTable tr:hover {background-color: #e3f3ff;}
        table#MiniLayoutTable .hide {display: none;}
        table#MiniLayoutTable .show {}
        table#MiniLayoutTable td.show-hide {font-weight: bold; font-size: 14px;}
        
     </style> 
        
        <apex:variable id="mas" value="{!MasController}" var="mas" />
        <apex:variable id="adc" value="{!AdcController}" var="adc" />
        <apex:variable id="ucc" value="{!UccController}" var="ucc" />
        <apex:variable id="mls" value="{!MlsController}" var="mls" />
<!--         <apex:variable id="mms" value="{!MmsController}" var="mms" /> -->
        <apex:variable id="mcc" value="{!MccController}" var="mcc" />
        <apex:variable id="tlo" value="{!TloController}" var="tlo" />
        
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="/soap/ajax/28.0/connection.js" type="text/javascript"></script>
    <script src="/soap/ajax/28.0/apex.js" type="text/javascript"></script>
    
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'jscolor/jscolor.js')}"></script>
    
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/jquery.min.js')}"></script>
    
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/grid.locale-en.js')}"></script>
    
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/jquery-ui.min.js')}"></script>

    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/jquery.ui.datepicker-ru.js')}"></script>
    
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'jquery-picklist/jquery.ui.widget.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'jquery-picklist/jquery.ui.widget.min.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'jquery-picklist/jquery-picklist.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'jquery-picklist/jquery-picklist.min.js')}"></script>

    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/jquery-ui.css')}"/>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/ui.jqgrid.css')}"/>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.CLMRes,'jquery-picklist/jquery-picklist-ie7.css')}"/>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.CLMRes,'jquery-picklist/jquery-picklist.css')}"/>
    
    <script type="text/javascript">

        jQuery.jgrid.no_legacy_api = true;
        jQuery.jgrid.useJSON = true;
    </script>
   <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/jquery.jqGrid.src.js')}" ></script>
   <script type="text/javascript" src="{!URLFOR($Resource.CLMRes,'JTreeTable/JqTG/grid.subgrid.js')}"></script>
   
        <script type="text/javascript">   
        jQuery.noConflict();
                var currentStatusField = '';

                function changeTheme (){
                    //console.log('changeTheme');
                    //  //console.log(j$('[id$=outPan]').css('display'));
                    var picker = document.getElementById('colorPicker');
                    //console.log(jQuery("#colorPicker").css("background-color"));
                    connectorCol=jQuery("#colorPicker").css("background-color");
                    changeColor(connectorCol);
                    //console.log('Theme >> {!mas.Theme}');
                    //console.log('CurrentTheme >> {!mas.CurrentTheme}');
                }
            
            function showDialog(stitle, sbody){
                var box = new SimpleDialog("ctdialog", false); 
                    parent.box = box; 
                    box.setTitle(stitle); 
                    box.createDialog();
                    box.setWidth(350); 
                    box.setContentInnerHTML("<p align='center'>" + sbody + "</p><p align='center'><img src='{!$Resource.LoaderIcon}' style='margin:0 5px;'/></p><p align='center'>Please Wait...</p>"); 
                    box.show();
            }
            
            function hideDialog(){
                parent.window.box.hide();
                var d = parent.document.body;
                var floatbox = parent.document.getElementById("ctdialog");
                var throwaway = d.removeChild(floatbox);
            }
            
            function rerenderPage(){
                rerenderAll();
            }
            
            function changeStatusFieldOpts(){
                var f = jQuery('[id*=actStatus] :selected').val();
                var o = jQuery('[id*=ActivityPicklist] :selected').val();
                console.log('f >> ' + f);
                console.log('o >> ' + o);
                formStatusOpts(f,o);
            }
            
            function formSelect(jsonSrc, selectId, selectName){
                result = '<select ';
                if('' != selectId && null != selectId){
                    result += 'id="' + selectId + '" ';
                }
                if('' != selectName && null != selectName){
                    result += 'id="' + selectName + '" ';
                }
                result += '>';
                var parsed = jQuery.parseJSON(jsonSrc);
                for(i = 0; i < parsed.data.length; i++){
                    var cur = parsed.data[i];
                    result += '<option value="' + cur.value + '" >' + cur.label + '</option>';
                }
                result += '</select>';
                return result;
            }
            
            function getRemoteAccount() {
                var accountName = 'clm__Application__c';
            
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.SettingsController.getAllFieldsOptRem}', 
                    accountName, 
                    function(result, event){
                        if (event.status) {
                            alert('ok');
                            console.log('res >> ' + result);
                        } else if (event.type === 'exception') {
                           alert('pizdets');
                        }
                    }
                );
            }
            
           
            
            </script>
            
   <apex:form > 
   
<!--    <div id="objectOptions" style="display: none">{!ObjectNamesJson}</div> -->
             <apex:actionFunction name="rerenderAll"  rerender="settingsPage"/>
   <apex:sectionHeader title="{!$Label.clm__ms_settingstitle}" />
   <apex:pageBlock id="settings">
        <apex:pageBlockButtons id="buttons">
<!--            <apex:commandButton onclick="saveAll(); return false;" action="{!saveSettings}" value="Save Settings" rerender="adc, mas"/> -->
<!-- var conTop = document.getElementById('selected').innerHTML;saveMAS(conTop); -->
            <apex:commandButton value="{!$Label.clm__ms_savesettingsbtn}" action="{!saveSettings}" onclick="showDialog('','Operation In Progress');" oncomplete="hideDialog();rerenderPage();" />
<!--             updateMenuSettings(); -->
            <apex:commandButton value="{!$Label.clm__ms_refreshcloudtoken}" action="{!mas.refreshCloudToken}" onclick="showDialog('','Operation In Progress');" oncomplete="hideDialog();" rerender="cloudtoken"/>
            <apex:commandButton action="{!createDemoApp}" value="{!$Label.clm__ms_demoappcreate}" onclick="showDialog('','Operation In Progress');" oncomplete="hideDialog();" rendered="{!NOT(isDemoExist)}" />
        </apex:pageBlockButtons>
<!--    <input id = "saveBtn" type="button" value="Save Settings" > -->
<!--     <apex:outputPanel id="saveButton"> -->
<!--     <button id="saveBtn" > -->
<!--        Save Settings {!saveSettings}-->
<!--        <apex:actionSupport event="onclick" action="{!saveSettings}" rerender="saveButton"/> -->
<!--     </button> -->
<!--    {!saveSettings} saveAll(); return false; -->
<!--         <apex:actionStatus startText="Saving..." stopText="Saved!" id="saveStatus"/> -->
        
<!--     </apex:outputPanel> -->
    
<!--    <apex:outputPanel onclick="saveAll()" styleClass="btn" id="saveButton">  -->
<!--         Save Settings -->
<!--     </apex:outputPanel> -->
    <apex:outputPanel id="tabPanel">
    <apex:pageMessages id="msg" />
     <apex:tabPanel switchType="client" selectedTab="SelTab" id="CustomSettings" 
         style="width: 100%; height: 500px"> 
        
         <apex:tab label="{!$Label.clm__ms_mas_tablabel}" name="MobileApplicationSetup" id="MobileApplicationSetup"> 
<!--             <div id="GeneralSettings" style="display: none">{!mas.jsonSettings}</div> -->
<!--             <apex:variable id="mas" value="{!MasController}" var="mas" /> -->
<!--                  Activity Object API Name <br></br>   -->
<!--                  <apex:selectList value="{!mas.ActivityObject}" multiselect="false" size="1" id="ActivityPicklist">  -->
<!--                      <apex:selectOptions value="{!ObjectNames}"/>  -->
<!--                      <apex:actionSupport event="onchange"  rerender="activityPanel"/>  -->
<!--                  </apex:selectList><p/>   -->
<!--                  Current Activity Object API Name: <apex:outputText value="{!mas.CurrentActivityObject}"/>  -->
<!--                  <br></br>  -->
<!--                  <br></br>  -->
                
                 <apex:outputPanel id="MobAppSetup"> 
                
                     <table border = "1" class="tableData"> 
                         <tr> 
                            
                            <td> 
                                 {!$Label.MS_ActivityObjectAPIName}
                             </td> 
                             <td class = "helpRow">  
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityObjectHelp))}">  
                                 <span class="helpButton" id="ActivityObject-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.ActivityObjectHelp}';  
                                         sfdcPage.setHelp('ActivityObject', help);  
                                     </script>  
                                 </span>  
                                </apex:outputPanel>
                             </td>  
                             <td> 
                                 <apex:selectList value="{!mas.ActivityObject}" multiselect="false" size="1" id="ActivityPicklist" style="width : 150px"> 
                                    <apex:selectOptions value="{!ObjectNames}"/> 
                                    <apex:actionSupport event="onchange"  rerender="actStatus, actIsDone, actTitle, actEnd, actSubtitle, actStart, actIsLocked, actDesc, actGeo, ActRT, actLUfield"/> 
                                </apex:selectList><p/>
                             </td>
                         
                             <td> 
                                 {!$Label.MS_ActStatusField}
                             </td> 
                             <td class = "helpRow">  
                             
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityStatusHelp))}">  
                                 <span class="helpButton" id="ActivityStatus-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.ActivityStatusHelp}';  
                                         sfdcPage.setHelp('ActivityStatus', help);  
                                     </script>  
                                 </span>  
                                </apex:outputPanel>
                             </td>  
                             <td> 
                                 <apex:selectList id="actStatus" value="{!mas.ActivityStatusField}" multiselect="false" size="1" style="width : 150px" > 
                                     <apex:selectOptions value="{!mas.ActivityOptPicklistFields}"/> 
                                     <apex:actionSupport event="onchange" onsubmit="jQuery('#onStatusApiChange').dialog('open');" rerender="none"/>
                                 </apex:selectList><p/> 
                                 <apex:actionFunction name="rerenderStatusApi" rerender="actStatus" />
                             </td>  

                        </tr> 
                        
                         <tr>                            
                            
                             <td> 
                                {!$Label.MS_ActIsDoneField}
                             </td> 
                             <td class = "helpRow">  
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.isDoneHelp))}">  
                                 <span class="helpButton" id="isDone-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.isDoneHelp}';  
                                         sfdcPage.setHelp('isDone', help);  
                                     </script>  
                                 </span> 
                                 </apex:outputPanel> 
                             </td>  
                             <td> 
                                 <apex:selectList id="actIsDone" value="{!mas.isDoneField}" multiselect="false" size="1" style="width : 150px"> 
                                     <apex:selectOptions value="{!mas.ActivityOptBoolFields}"/> 
                                 </apex:selectList><p/> 
                             </td> 
                         
                             <td> 
                                {!$Label.clm__ms_actenddatefield}
                             </td> 
                             <td>  
                               <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityEndDateHelp))}">  
                                 <span class="helpButton" id="ActivityEndDate-_help" >  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.ActivityEndDateHelp}';  
                                         sfdcPage.setHelp('ActivityEndDate', help);  
                                     </script>  
                                 </span>  
                               </apex:outputPanel>  
                             </td>  
                             <td> 
                                 <apex:selectList id="actEnd" value="{!mas.ActivityEndDateField}" multiselect="false" size="1" style="width : 150px"> 
                                     <apex:selectOptions value="{!mas.ActivityOptDateFields}"/> 
                                 </apex:selectList><p/> 
                             </td> 
                           
                        </tr> 
                        
                         <tr> 
                            
                             <td> 
                                {!$Label.clm__ms_actstartdatefield}
                             </td> 
                             <td>  
                               <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityStartDateHelp))}">  
                                 <span class="helpButton" id="ActivityStartDate-_help" >  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.ActivityStartDateHelp}';  
                                         sfdcPage.setHelp('ActivityStartDate', help);  
                                     </script>  
                                 </span>  
                               </apex:outputPanel>  
                             </td>  
                             <td> 
                                 <apex:selectList id="actStart" value="{!mas.ActivityStartDateField}" multiselect="false" size="1" style="width : 150px"> 
                                     <apex:selectOptions value="{!mas.ActivityOptDateFields}"/> 
                                 </apex:selectList><p/> 
                             </td> 
                            
                         
                             <td> 
                               {!$Label.clm__ms_actislocked}
                             </td> 
                             <td> 
                               <apex:outputPanel rendered="{!NOT(ISNULL(mas.isLockedHelp))}"> 
                                 <span class="helpButton" id="isLocked-_help"> 
                                     <img src="/s.gif" class="helpOrb"/> 
                                     <script type="text/javascript"> 
                                        var help = '{!mas.isLockedHelp}'; 
                                        sfdcPage.setHelp('isLocked', help); 
                                     </script>  
                                 </span> 
                               </apex:outputPanel> 
                             </td> 
                             <td> 
                                 <apex:selectList id="actIsLocked" value="{!mas.isLockedField}" multiselect="false" size="1" style="width : 150px"> 
                                     <apex:selectOptions value="{!mas.ActivityOptBoolFields}"/> 
                                 </apex:selectList><p/> 
                             </td> 
                             
                         </tr> 
                         
                         <tr>
                            
                            <td> 
                                {!$Label.clm__ms_actdescfield}
                            </td>
                             
                            <td>
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityDescriptionFieldHelp))}"> 
                                    <span class="helpButton" id="ActivityDescriptionField-_help">  
                                         <img src="/s.gif" class="helpOrb"/>  
                                         <script type="text/javascript">  
                                             var help = '{!mas.ActivityDescriptionFieldHelp}';
                                             sfdcPage.setHelp('ActivityDescriptionField', help);  
                                         </script>
                                     </span>  
                                 </apex:outputPanel>
                             </td>  
                             <td> 
                                <apex:selectList id="actDesc" value="{!mas.ActivityDescriptionField}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.ActivityOptAllfields}"/> 
                                </apex:selectList><p/> 
                             </td>
                      
                             <td>
                                {!$Label.clm__ms_refobjectnamefield}
                             </td>
                             
                             <td>
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ReferenceObjectHelp))}"> 
                                    <span class="helpButton" id="ReferenceObject-_help">  
                                         <img src="/s.gif" class="helpOrb"/>  
                                         <script type="text/javascript">  
                                             var help = '{!mas.ReferenceObjectHelp}';
                                             sfdcPage.setHelp('ReferenceObject', help);  
                                         </script>
                                     </span>  
                                 </apex:outputPanel>
                             </td>
                             
                             <td>
                                <apex:selectList value="{!mas.ReferenceObject}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!ObjectNames}"/> 
                                    <apex:actionSupport event="onchange"  rerender="refTitleField, refSubtitleField"/> 
                                </apex:selectList><p/> 
                             </td>
                             
                         </tr>

                         <tr> 
                         
                         <td> 
                             {!$Label.MS_ProductObjNameField}
                         </td> 
                             <td class = "helpRow">  
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ProductObjectHelp))}"> 
                                 <span class="helpButton" id="ProductObject-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = "{!mas.ProductObjectHelp}";  
                                         sfdcPage.setHelp('ProductObject', help);  
                                     </script>  
                                 </span>  
                                 </apex:outputPanel>
                             </td>  
                             <td> 
                                 <apex:selectList value="{!mas.ProductObject}" multiselect="false" size="1" id="ProductPicklist" style="width : 150px"> 
                                    <apex:selectOptions value="{!ObjectNames}"/> 
                                    <apex:actionSupport event="onchange"  rerender="prodLookUp"/> 
                                </apex:selectList><p/>  
                             </td>
                         
                         
                            <td> 
                                {!$Label.MS_ProdLookupField}
                             </td> 
                             <td class = "helpRow">  
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ProductLookupField))}"> 
                                 <span class="helpButton" id="ProductLookupField-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.ProductLookupFieldHelp}';  
                                         sfdcPage.setHelp('ProductLookupField', help);  
                                     </script>  
                                 </span>  
                                 </apex:outputPanel>
                             </td> 
                             <td> 
                                 <apex:selectList id="prodLookUp" value="{!mas.ProductLookupField}" multiselect="false" size="1" style="width : 150px"> 
                                     <apex:selectOptions value="{!mas.ProductOptRefFields}"/> 
                                 </apex:selectList><p/>  
                             </td> 
                             
                         </tr>
                         
                         

                         
                         <tr> 
                         
 

                         
                            <td> 
                               {!$Label.MS_AccGeolocField}
                             </td> 
                             <td class = "helpRow">
                               <apex:outputPanel rendered="{!NOT(ISNULL(mas.AccountGeolocationAPIFieldHelp))}"> 
                                <span class="helpButton" id="AccountGeolocationAPIField-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.AccountGeolocationAPIFieldHelp}';
                                         sfdcPage.setHelp('AccountGeolocationAPIField', help);  
                                     </script>
                                 </span>  
                                 </apex:outputPanel>
                                
                             </td> 
                             <td>
                                    
                                <apex:selectList value="{!mas.AccountGeolocationAPIField}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.AccountGeolocOpt}"/> 
                                </apex:selectList><p/> 
                                 
                             </td> 
                             
                         </tr>
                         
                         <tr> 
                         
                            <td> 
                                {!$Label.MS_AccFullAddress}
                             </td> 
                             <td class = "helpRow">
                               <apex:outputPanel rendered="{!NOT(ISNULL(mas.AccountFullAddressAPIFieldHelp))}"> 
                                <span class="helpButton" id="AccountFullAddressAPIFieldHelp_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.AccountFullAddressAPIFieldHelp}';
                                         sfdcPage.setHelp('AccountFullAddressAPIFieldHelp', help);  
                                     </script>
                                 </span>  
                                 </apex:outputPanel>
                                
                             </td> 
                             <td>
                                    
                                <apex:selectList value="{!mas.AccountFullAddressAPIField}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.AccountOptAllFields}"/> 
                                </apex:selectList><p/> 
                                 
                             </td> 
                             
                             <td> 
                                {!$Label.clm__ms_supportemail}
                            </td>
                             
                            <td>
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.supEmailHelp))}"> 
                                    <span class="helpButton" id="supEmail-_help">  
                                         <img src="/s.gif" class="helpOrb"/>  
                                         <script type="text/javascript">  
                                             var help = '{!mas.supEmailHelp}';
                                             sfdcPage.setHelp('supEmail', help);  
                                         </script>
                                     </span>  
                                 </apex:outputPanel>
                             </td>  
                             <td> 
                                <apex:inputField value="{!mas.newSettings.clm__SupportEmail__c}" style="width: 150px" />
                             </td>
                        </tr>


                        <tr>
                            <td> 
                               {!$Label.MS_DebugLvl}
                            </td>                    
                            <td>
<!--                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.pushKeyHelp))}">  -->
<!--                                    <span class="helpButton" id="pushKeyHelp-_help">   -->
<!--                                         <img src="/s.gif" class="helpOrb"/>   -->
<!--                                         <script type="text/javascript">   -->
<!--                                             var help = '{!mas.pushKeyHelp}'; -->
<!--                                             sfdcPage.setHelp('pushKeyHelp', help);   -->
<!--                                         </script> -->
<!--                                     </span>   -->
<!--                                  </apex:outputPanel> -->
                             </td>  
                             <td> 
                                <apex:selectList value="{!mas.newSettings.clm__DebugLevel__c}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.DebugLvlOpt}"/> 
                                </apex:selectList><p/> 
                             </td>
                             
                             <td> 
                               {!$Label.clm__ms_personaccenabled}
                            </td>
                             <td>
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.isPersonAccEnabledHelp))}"> 
                                    <span class="helpButton" id="isPersonAccEnabledHelp-_help">  
                                         <img src="/s.gif" class="helpOrb"/>  
                                         <script type="text/javascript">  
                                             var help = '{!mas.isPersonAccEnabledHelp}';
                                             sfdcPage.setHelp('isPersonAccEnabledHelp', help);  
                                         </script>
                                     </span>  
                                 </apex:outputPanel>
                            </td>  
                             <td> 
                                <apex:inputCheckbox value="{!mas.newSettings.clm__IsPersonAccountsEnabled__c}"  />
                            </td>
                        </tr>

                        
                        <tr>
                        
                            <td> 
                                {!$Label.clm__ms_theme}
                            </td>
                             <td>
                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.ThemeHelp))}"> 
                                    <span class="helpButton" id="ThemeHelp-_help">  
                                         <img src="/s.gif" class="helpOrb"/>  
                                         <script type="text/javascript">  
                                             var help = '{!mas.ThemeHelp}';
                                             sfdcPage.setHelp('ThemeHelp', help);  
                                         </script>
                                     </span>  
                                 </apex:outputPanel>
                            </td>  
                             <td> 
                                <input id="colorPicker" class="color" value="{!mas.Theme}" onchange="changeTheme()" />
<!--                                 <apex:inputText class="color" value="{!mas.Theme}" /> -->
                            </td>
                            
                            <td> 
                                {!$Label.MS_ActGeolocField}
                             </td> 
                             <td class = "helpRow">
                               <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityGeolocationAPIFieldHelp))}"> 
                                <span class="helpButton" id="ActivityGeolocationAPIFieldHelp-_help">  
                                     <img src="/s.gif" class="helpOrb"/>  
                                     <script type="text/javascript">  
                                         var help = '{!mas.ActivityGeolocationAPIFieldHelp}';
                                         sfdcPage.setHelp('ActivityGeolocationAPIFieldHelp', help);  
                                     </script>
                                 </span>  
                                 </apex:outputPanel>
                                
                             </td> 
                             <td>
                                <apex:selectList id="actGeo" value="{!mas.ActivityGeolocationAPIField}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.ActivityGeolocOpt}"/> 
                                </apex:selectList><p/> 
                             </td> 
                        
                        </tr>
                        
                        <tr>
                            <td> 
                               {!$Label.MS_CloudToken}
                            </td>                    
                            <td>
<!--                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.pushKeyHelp))}">  -->
<!--                                    <span class="helpButton" id="pushKeyHelp-_help">   -->
<!--                                         <img src="/s.gif" class="helpOrb"/>   -->
<!--                                         <script type="text/javascript">   -->
<!--                                             var help = '{!mas.pushKeyHelp}'; -->
<!--                                             sfdcPage.setHelp('pushKeyHelp', help);   -->
<!--                                         </script> -->
<!--                                     </span>   -->
<!--                                  </apex:outputPanel> -->
                             </td>  
                             <td> 
                                <apex:outputField id="cloudtoken" value="{!mas.newSettings.clm__CloudToken__c}" style="width : 150px" /> 
                             </td>
                             
                             <td> 
                                {!$Label.MS_IsWebShareAllowed}
                            </td>
                             <td>
<!--                                 <apex:outputPanel rendered="{!NOT(ISNULL(mas.isPersonAccEnabledHelp))}">  -->
<!--                                     <span class="helpButton" id="isPersonAccEnabledHelp-_help">   -->
<!--                                          <img src="/s.gif" class="helpOrb"/>   -->
<!--                                          <script type="text/javascript">   -->
<!--                                              var help = '{!mas.isPersonAccEnabledHelp}'; -->
<!--                                              sfdcPage.setHelp('isPersonAccEnabledHelp', help);   -->
<!--                                          </script> -->
<!--                                      </span>   -->
<!--                                  </apex:outputPanel> -->
                            </td>  
                             <td> 
                                <apex:inputCheckbox value="{!mas.newSettings.clm__AllowWebSharing__c}"  />
                            </td>
                        </tr>
                        
                        
                        <tr>
                            <td> 
                               Calendar View
                            </td>                    
                            <td>
<!--                                 <apex:outputPanel rendered="{!NOT(ISNULL(mas.isPersonAccEnabledHelp))}">  -->
<!--                                     <span class="helpButton" id="isPersonAccEnabledHelp-_help">   -->
<!--                                          <img src="/s.gif" class="helpOrb"/>   -->
<!--                                          <script type="text/javascript">   -->
<!--                                              var help = '{!mas.isPersonAccEnabledHelp}'; -->
<!--                                              sfdcPage.setHelp('isPersonAccEnabledHelp', help);   -->
<!--                                          </script> -->
<!--                                      </span>   -->
<!--                                  </apex:outputPanel> -->
                             </td>  
                             <td> 
                                <apex:selectList id="calendarView" value="{!mas.newSettings.clm__CalendarView__c}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.CalendarViewOpt}"/> 
                                </apex:selectList><p/> 
                             </td>
                             
                             <td> 
                                Default Event Duration (minutes)
                            </td>
                             <td>
<!--                                 <apex:outputPanel rendered="{!NOT(ISNULL(mas.isPersonAccEnabledHelp))}">  -->
<!--                                     <span class="helpButton" id="isPersonAccEnabledHelp-_help">   -->
<!--                                          <img src="/s.gif" class="helpOrb"/>   -->
<!--                                          <script type="text/javascript">   -->
<!--                                              var help = '{!mas.isPersonAccEnabledHelp}'; -->
<!--                                              sfdcPage.setHelp('isPersonAccEnabledHelp', help);   -->
<!--                                          </script> -->
<!--                                      </span>   -->
<!--                                  </apex:outputPanel> -->
                            </td>  
                             <td> 
                                <apex:inputField value="{!mas.newSettings.clm__DefaultEventDuration__c}"  />
                            </td>
                        </tr>
                        
                        <tr>
                            <td> 
                               Is Week Switch Allowed
                            </td>                    
                            <td>
<!--                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.pushKeyHelp))}">  -->
<!--                                    <span class="helpButton" id="pushKeyHelp-_help">   -->
<!--                                         <img src="/s.gif" class="helpOrb"/>   -->
<!--                                         <script type="text/javascript">   -->
<!--                                             var help = '{!mas.pushKeyHelp}'; -->
<!--                                             sfdcPage.setHelp('pushKeyHelp', help);   -->
<!--                                         </script> -->
<!--                                     </span>   -->
<!--                                  </apex:outputPanel> -->
                             </td>  
                             <td> 
                                <apex:inputCheckbox value="{!mas.newSettings.clm__IsWeekSwitchShowed__c}"  /> 
                             </td>
                             
                             <td> 
                                Enable passcode
                             </td>
                             <td>
<!--                                 <apex:outputPanel rendered="{!NOT(ISNULL(mas.isPersonAccEnabledHelp))}">  -->
<!--                                     <span class="helpButton" id="isPersonAccEnabledHelp-_help">   -->
<!--                                          <img src="/s.gif" class="helpOrb"/>   -->
<!--                                          <script type="text/javascript">   -->
<!--                                              var help = '{!mas.isPersonAccEnabledHelp}'; -->
<!--                                              sfdcPage.setHelp('isPersonAccEnabledHelp', help);   -->
<!--                                          </script> -->
<!--                                      </span>   -->
<!--                                  </apex:outputPanel> -->
                             </td>  
                             <td> 
                                <apex:inputCheckbox value="{!mas.newSettings.clm__IsPasscodeEnabled__c}"  />
                             </td>
                        </tr>
                        
                        <tr>
                            <td> 
                               Visible Hour Range
                            </td>                    
                            <td>
<!--                                <apex:outputPanel rendered="{!NOT(ISNULL(mas.pushKeyHelp))}">  -->
<!--                                    <span class="helpButton" id="pushKeyHelp-_help">   -->
<!--                                         <img src="/s.gif" class="helpOrb"/>   -->
<!--                                         <script type="text/javascript">   -->
<!--                                             var help = '{!mas.pushKeyHelp}'; -->
<!--                                             sfdcPage.setHelp('pushKeyHelp', help);   -->
<!--                                         </script> -->
<!--                                     </span>   -->
<!--                                  </apex:outputPanel> -->
                             </td>  
                             <td> 
                                <apex:selectList id="startHourRange" value="{!mas.StartHour}" multiselect="false" size="1" style="width : 70px"> 
                                    <apex:selectOptions value="{!mas.HourRangeOpts}"/> 
                                </apex:selectList>
                                &nbsp;&nbsp;
                                <apex:selectList id="endHourRange" value="{!mas.EndHour}" multiselect="false" size="1" style="width : 70px"> 
                                    <apex:selectOptions value="{!mas.HourRangeOpts}"/> 
                                </apex:selectList>
                                <p/> 
                             </td>
                             
                             <td> 
                                 Activity LookUp Field API Name
                             </td> 
                             <td class = "helpRow">  
<!--                                 <apex:outputPanel rendered="{!NOT(ISNULL(mas.ActivityObjectHelp))}">   -->
<!--                                  <span class="helpButton" id="ActivityObject-_help">   -->
<!--                                      <img src="/s.gif" class="helpOrb"/>   -->
<!--                                      <script type="text/javascript">   -->
<!--                                          var help = '{!mas.ActivityObjectHelp}';   -->
<!--                                          sfdcPage.setHelp('ActivityObject', help);   -->
<!--                                      </script>   -->
<!--                                  </span>   -->
<!--                                 </apex:outputPanel> -->
                             </td>  
                             <td> 
                                 <apex:selectList id="actLUfield" value="{!mas.ActivityLookupField}" multiselect="false" size="1" style="width : 150px"> 
                                    <apex:selectOptions value="{!mas.AppStatsToActivityOpt}"/> 
                                </apex:selectList><p/>  
                             </td>
                        </tr>
                        
                     </table> 
                 </apex:outputPanel> 
                 
                 <apex:actionFunction name="changeColor" action="{!mas.setTheme}" rerender="">
                    <apex:param name="connectorCol" assignTo="{!mas.connector}" value=""  />
                </apex:actionFunction>
                 

         </apex:tab> 

         <apex:tab label="{!$Label.clm__ms_actdatatab}" name="ActivityDataCustomization" id="ActivityDataCustomization">
            <script id="scripts" type="text/javascript">
                function openDialogSort(ind) {
                        jQuery( "#"+ind+"-dialog" ).dialog( 'open' );
                    }
                    
                jQuery(function(){
                    initDialog();
                    
                    currentStatusField = jQuery('[id*=actStatus] :selected').val();
                    
                    jQuery('#onStatusApiChange').dialog({
                        autoOpen: false,
                        modal: true,
                        buttons: {
                            Continue: function(){
                                changeStatusFieldOpts();
                                currentStatusField = jQuery('[id*=actStatus] :selected').val();
                                jQuery( this ).dialog( "close" );
                            },
                            Cancel: function(){
                                console.log('currentStatusField >> ' + currentStatusField);
                                jQuery('[id*=actStatus] :selected').val(currentStatusField);
                                rerenderStatusApi();
                                jQuery( this ).dialog( "close" );
                            }
                        }
                    });
                });
                
                function initDialog(){
                    var k = 1;
                    for(var i = 0; k > i; i++){
                        if (jQuery("#"+i+"-dialog").html() == undefined){
                            break;
                        }
                        //console.log('diealog search >> ' + jQuery("#"+i+"-dialog").html());
                        k++;
                    }
                    k--;
                    //console.log('BORDER >> ' + k);
                    for(var i = 0; k > i; i++){
                        jQuery( "#" + i + "-dialog" ).dialog({
                                    autoOpen: false,
                                    modal: true,
                                    buttons: {
                                        Submit: function() {
                                            var curId = this.id;
                                            curId = curId.replace('-dialog','');
                                            var connector = this.id + '/' + jQuery("#" + curId + "-active").sortable( "toArray" );
                                            console.log('connector >> ' + connector);
                                            //setNewLayout(connector);
                                            var lishki = jQuery("#" + curId + "-active > li");
                                            var reqconnector = this.id + '/'; 
                                            jQuery.each(lishki,function(){
                                                var cl = jQuery(this).attr('class');
                                                try{
                                                    if(cl.contains('ui-state-red-highlight')){
                                                        reqconnector+='true,';
                                                    }else{
                                                        reqconnector+='false,';
                                                    }
                                                }catch(ex){
                                                    
                                                }
                                            });
                                            reqconnector = reqconnector.substring(0, connector.length-1);
                                            setNewLayout(connector, reqconnector);
                                            //jQuery( this ).dialog().remove();
                                            jQuery( this ).dialog( "close" );
                                        },
                                        Cancel: function() {
                                            jQuery( this ).dialog( "close" );
                                        }
                                    },
                                    close: function() {
                                        //form[ 0 ].reset();
                                    }
                                });
                                
                        //try{
                            var sorts = formSortList(i);
                            //console.log('sorts >> ' + sorts);
                            jQuery( "#" + i + "-sortables" ).html(sorts);
                        //}catch(ex){
                            ////console.log('exception >> ' + ex);
                        //}
                        
                    }
                    jQuery( ".connectedSortableAdc" ).sortable({
                                        connectWith: "ul",
                                        dropOnEmpty: true
                                    });
                    jQuery(".connectedSortableAdc").sortable({
                        connectWith: ".connectedSortableAdc",
                        update: function(){
                            jQuery( "[id*=-active].connectedSortableAdc > li" ).addClass('toggler');
                            jQuery( "[id*=-inactive].connectedSortableAdc > li" ).addClass('ui-state-default');
                            jQuery( "[id*=-inactive].connectedSortableAdc > li" ).removeClass('ui-state-red-highlight');
                            jQuery( "[id*=-inactive].connectedSortableAdc > li" ).removeClass('toggler');
                        }
                    }).disableSelection();
                    tog();
                }
                
                function tog(){
                    console.log('toggler on');
                    jQuery( ".connectedSortableAdc > li" ).dblclick(function(){
                        var cl = jQuery(this).attr('class');
                        console.log('cl >> ' + cl);
                        if(-1 != cl.split(' ').indexOf("toggler")){
                            jQuery(this).toggleClass('ui-state-red-highlight');
                            jQuery(this).toggleClass('ui-state-default');
                        }
                    });
                }
                
                        
                function formSortList(rowid){
                        //console.log('rowid >> ' + rowid);
                        var layoutId = rowid+"-customLayout";
                        var reqAttrId = rowid+"-reqAttr";
                        //console.log('layoutId >> ' + layoutId);
                        var actives = document.getElementById(layoutId).innerHTML;
                        var atrs = document.getElementById(reqAttrId).innerHTML;
                        var attrArray = atrs.split(',');
                            
                            //console.log('SortListStr >> ' + SortListStr);
                            var SortListStr = document.getElementById(rowid+"-sortOpts").innerHTML;
                            //console.log('SortListStr >> ' + SortListStr);
                            var sortListObj = jQuery.parseJSON(SortListStr);
                            if(null == sortListObj){ return 'There is no data object set' }
                            //console.log('sortListObj.vals >> ' + sortListObj.vals);
                            //console.log('sortListObj.types >> ' + sortListObj.types);
                            var outputSort = SortableLists(sortListObj.vals, sortListObj.labs, actives, rowid, attrArray);
                            
                            return outputSort;
                    }
                    
                    function SortableLists(vals, labs, actives, shareId, attrArray){
                        var actArr = actives.split(',');
                        
                        var outputTotal = '<div id="sortableLists"><table id="sortTable"><tr><th>Options</th><th>Current Layout</th></tr><tr>';
                        var outputEnd = '</tr></table></div>';
                        var outputAct = '<td style="vertical-align: top"><ul id="'+shareId+'-active" class="connectedSortableAdc scroll">';
                        var outputInact = '<td style="vertical-align: top"><ul id="'+shareId+'-inactive" class="connectedSortableAdc scroll">';
                        var valueArray;
                        var labelArray;
                        
                            valueArray = vals.split(';');
                            labelArray = labs.split(';');
                        var actIndex = 0;
                        for (var i=0; i<valueArray.length-1; i++){
                            if(-1 != actArr.indexOf(valueArray[i])){
                                if('true' == attrArray[actIndex]){
                                    outputAct += "<li id='"+ valueArray[i] +"' val='"+ valueArray[i] +"' class='ui-state-red-highlight toggler'>"+ labelArray[i] +"</li>";
                                }else{
                                    outputAct += "<li id='"+ valueArray[i] +"' val='"+ valueArray[i] +"' class='ui-state-default toggler'>"+ labelArray[i] +"</li>";
                                }
                                actIndex++;
                            }else{
                                outputInact += "<li id='"+ valueArray[i] +"' val='"+ valueArray[i] +"' class='ui-state-default'>"+ labelArray[i] +"</li>";
                            }
                        }
                        outputAct += '</ul></td>';
                            
                        outputInact += '</ul></td>';
                        
                        outputTotal += outputInact + outputAct + outputEnd;
                        return outputTotal;
                    }
                
                
            </script>
            
                <apex:pageBlock >
                    <apex:pageBlockTable value="{!adc.CurrentSettingsWrap}" var="item" id="table">
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_name}</apex:facet>
                            <apex:inputField value="{!item.controller.Name}" />
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_dataobjectname}</apex:facet>
                            <apex:selectList value="{!item.controller.clm__DataObjectName__c}" multiselect="false" size="1" >
                                <apex:selectOptions value="{!adc.ObjectNames}"/>
                                <apex:actionSupport event="onchange" oncomplete="initDialog();" rerender="table, scripts" />
                            </apex:selectList>
                            <div id="{!item.index}-dialog">
                                <div id="{!item.index}-sortables" />
                            </div>
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_datarecordtype}</apex:facet>
                            <apex:selectList value="{!item.controller.clm__DataRecordType__c}" multiselect="false" size="1" >
                                <apex:selectOptions value="{!item.DataRecordTypeOpt}"/>
                            </apex:selectList>
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_sortingfieldname}</apex:facet>
                            <apex:selectList value="{!item.controller.clm__SortingFieldName__c}" multiselect="false" size="1" >
                                <apex:selectOptions value="{!item.SortingFieldNameOpt}"/>
                            </apex:selectList>
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_tablabelfield}</apex:facet>
                            <apex:inputField value="{!item.controller.clm__TabLabel__c}" />
                        </apex:column>
                    
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_recordcondition}</apex:facet>
                            <apex:inputField value="{!item.controller.clm__RecordCondition__c}" />
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_isrecordadditionallowed}</apex:facet>
                            <apex:inputCheckbox value="{!item.controller.clm__IsRecordAdditionAllowed__c}"/>
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_recdellallow}</apex:facet>
                            <apex:inputCheckbox value="{!item.controller.clm__IsRecordDeleteAllowed__c}"/>
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_isrelatedlistlayout}</apex:facet>
                            <apex:inputCheckbox value="{!item.controller.clm__IsRelatedListLayout__c}" >
                                <apex:actionSupport event="onchange" rerender="dialogData" />
                            </apex:inputCheckbox>
                        </apex:column>
                        
                        <apex:column >
                            <apex:facet name="header">{!$Label.clm__ms_adc_customlayoutrow}</apex:facet>
                            <apex:outputPanel id="dialogData" >
                                <apex:commandButton onclick='var t="{!item.index}"; console.log("t >> " + t);openDialogSort(t);' value="{!$Label.clm__ms_adc_editcustomlayoutbtn}" oncomplete="" rendered="{!NOT(item.controller.clm__IsRelatedListLayout__c)}"/>
                                <div id="{!item.index}-sortOpts" style="display: none" >{!item.sortOpts}</div>
                                <div id="{!item.index}-customLayout" style="display: none" >{!item.controller.clm__CustomFieldsLayout__c}</div>
                                <div id="{!item.index}-reqAttr" style="display: none" >{!item.controller.clm__RequiredAttribute__c}</div>
                            </apex:outputPanel>
                        </apex:column>
                        
                        <apex:column >
                            <apex:commandButton value="{!$Label.clm__ms_delete}" action="{!adc.delSetting}" rerender="table" >
                                <apex:param name="indexToDel" assignTo="{!adc.connector}" value="{!item.index}" />
                            </apex:commandButton>
                        </apex:column>
                    
                    </apex:pageBlockTable>
        <!--                display:none -->
                    <apex:pageBlockButtons location="bottom" >
                        <apex:commandButton action="{!adc.addSetting}" value="{!$Label.clm__ms_add}" rerender="table, scripts, checkString" oncomplete="initDialog();" />
<!--                        <apex:commandButton action="{!adc.saveSettings}" value="Save" rerender="table, scripts, checkString" oncomplete="initDialog();" /> -->
                    </apex:pageBlockButtons>
        
                </apex:pageBlock>
                
                
                <apex:actionFunction action="{!adc.setNewLayout}" name="setNewLayout" rerender="dialogData, tryoutToggle" >
                    <apex:param name="connector" assignTo="{!adc.connector}" value="" />
                    <apex:param name="reqConnector" assignTo="{!adc.reqConnector}" value="" />
                </apex:actionFunction>
            
         </apex:tab> 
         
<!--          <apex:tab label="{!$Label.MS_TOP_Objects}" name="TopLvlObjects" id="TopLvlObjects">  -->
<!--             <apex:outputText id="topLvlMap" value="{!tlo.selected}" escape="false" style="display: none" /> -->
<!--             <apex:outputText id="menuMap" value="{!tlo.SelectedMenu}" escape="false" style="display: none" /> -->
<!--             <apex:outputText id="groupMap" value="{!tlo.SelectedGroups}" escape="false" style="display: none" /> -->
<!--             <div id="profToStore" style="display: none"></div> -->
<!--             <div id='allobjects' style="display: none">{!tlo.TopOptions}</div> -->
            
<!--                 <apex:pageBlock id="pickListsTop" > -->
                    
<!--                     <apex:pageBlockSection columns="2"> -->
<!--                         <apex:pageBlockSectionItem labelStyle="float: left" dataStyle="float: left" > -->
<!--                             <apex:outputLabel for="profPicklist" value="{!$Label.MS_Profile}" /> -->
<!--                             <apex:selectList id="profPicklist" value="{!tlo.prof}" multiselect="false" size="1"> -->
<!--                                     <apex:selectOption id="profileActLabel" itemValue="sett" itemLabel="{!$Label.MS_TOP_ActiveProfiles}" itemDisabled="true" /> -->
<!--                                     <apex:selectOptions id="activeProfiles" value="{!tlo.ProfilePicklist}"/> -->
<!--                                     <apex:selectOption id="inactProfileLabel" itemValue="nosett" itemLabel="{!$Label.MS_TOP_InactiveProfiles}" itemDisabled="true" /> -->
<!--                                     <apex:selectOptions value="{!tlo.ProfileLeftPicklist}"/> -->
<!--                                 <apex:actionSupport event="onchange" onsubmit="showDialog('','Operation In Progress');" action="{!tlo.initTopLvlObjs}" oncomplete="refreshPicklist();hideDialog();" rerender="msg1, settingsTable, createButton" /> -->
<!--                                 <apex:actionSupport event="onload" oncomplete="grouping();" /> -->
<!--                             </apex:selectList> -->
<!--                         </apex:pageBlockSectionItem> -->
                        
<!--                         <apex:pageBlockSectionItem > -->
<!--                            <apex:commandButton value="Store Settings" onclick="showDialog('','Operation In Progress');storeSetts();" oncomplete="hideDialog();alert('Settings stored');" rerender="none"/> -->
<!--                            <apex:commandButton value="Paste Settings" onclick="beforePaste();" rerender="settingsTable" /> -->
<!--                         </apex:pageBlockSectionItem> -->
                        
<!--                     </apex:pageBlockSection> -->
                    
<!--                     <apex:pageBlockSection columns="2"> -->
                        
<!--                         <apex:pageBlockSectionItem id="objectPickList" dataStyle="min-width: 450px"> -->
<!--                             <apex:pageBlock title="Top Level Objects"> -->
<!--                                 <apex:pageBlockButtons > -->
<!--                                     <apex:commandButton id="createBtn" value="{!$Label.MS_TOP_ShowRt}" onclick="showDialog('','Operation In Progress');var sel = getFirstSelected();initBtn(sel);" oncomplete="" rerender="me"/> -->
<!--                                 </apex:pageBlockButtons> -->
<!--                                     <div id="objectSelect" ></div> -->
<!--                             </apex:pageBlock> -->
<!--                         </apex:pageBlockSectionItem> -->
                                            
<!--                         <apex:pageBlockSectionItem id="objectMenuList" dataStyle="min-width: 450px" > -->
<!--                             <apex:pageBlock title="Menu Settings"> -->
<!--                                 <apex:pageBlockButtons > -->
<!--                                     <apex:commandButton id="openDialogAddOpt" value="{!$Label.MS_AddOption}" onclick="openAddOptDialog();" oncomplete="" rerender="me"/> -->
<!--                                     <apex:commandButton id="openChangeGroup" value="Change grouping field" onclick="showDialog('','Operation In Progress');formChangePickList(getFirstMenuSelected());" oncomplete="" rerender="none"/> -->
<!--                                 </apex:pageBlockButtons> -->
<!--                                     <div id="menuSelect" ></div> -->
<!--                             </apex:pageBlock> -->
<!--                         </apex:pageBlockSectionItem> -->
                        
<!--                     </apex:pageBlockSection> -->
<!--                     <p/><p/> -->
                    
<!--                     <script type="text/javascript"> -->
<!--                         jQuery.noConflict(); -->
                        
<!--                         jQuery(function(){ -->
<!--                             refreshPicklist(); -->
<!--                             refreshMenuList(); -->
<!--                             //grouping(); -->
<!--                         }); -->
                        
<!--                         jQuery.fn.outerHTML = function(s) { -->
<!--                             return s -->
<!--                                 ? this.before(s).remove() -->
<!--                                 : jQuery("<p>").append(this.eq(0).clone()).html(); -->
<!--                         }; -->
                        
<!--                         function grouping(){ -->
<!--                             var all = jQuery("[id*=profPicklist]").html(); -->
<!--                             var toRep1 = jQuery("[value=sett]").outerHTML(); -->
<!--                             var toRep2 = jQuery("[value=nosett]").outerHTML(); -->
<!--                             var newVal1 = '<optgroup id="actProfGr" label="{!$Label.MS_TOP_ActiveProfiles}">'; -->
<!--                             var newVal2 = '</optgroup><optgroup id="inactProfGr" label="{!$Label.MS_TOP_InactiveProfiles}">'; -->
<!--                             var toAppend = '</optgroup>'; -->
<!--                             all = all.replace(toRep1, newVal1); -->
<!--                             all = all.replace(toRep2, newVal2); -->
<!--                             jQuery("[id*=profPicklist]").html(all); -->
<!--                             jQuery("[id*=profPicklist]").append(toAppend); -->
<!--                         } -->
                        
<!--                         function refreshPicklist(){ -->
<!--                             var selArr; -->
<!--                             var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                             //alert('profSel >> ' + profSel); -->
<!--                             try{ -->
<!--                                 var selected = document.getElementById(profSel).innerHTML; -->
<!--                                 //alert('selected >> ' + selected); -->
<!--                                 if('' != selected){ -->
<!--                                     selArr = selected.split(','); -->
<!--                                 } -->
<!--                             }catch(ex){ -->
                                
<!--                             } -->
<!--                             var output = '<select id="topLvlObjs" name="topLvlObjs" multiple="multiple">'; -->
<!--                             var options = document.getElementById('allobjects').innerHTML; -->
<!--                             var opts = jQuery.parseJSON(options); -->
<!--                             var vals = opts.vals.split(','); -->
<!--                             var labs = opts.labs.split(','); -->
<!--                             //console.log('vals.size() >> ' + vals.length); -->
<!--                             if(null != selArr){ -->
<!--                                 for(var i = 0; selArr.length > i; i++){ -->
<!--                                     if(-1 != vals.indexOf(selArr[i])){ -->
<!--                                         var ind = vals.indexOf(selArr[i]); -->
<!--                                         output += '<option value="' + vals[ind] + '" selected="selected">' + labs[ind] + '</option>'; -->
<!--                                     }else{ -->
<!--                                         output += '<option value="' + selArr[i] + '" selected="selected">' + selArr[i] + '</option>'; -->
<!--                                     } -->
<!--                                 } -->
<!--                             } -->
<!--                             for(var i = 0; vals.length > i; i++){ -->
<!--                                 if(null != selArr){ -->
<!--                                     //alert('null != selArr'); -->
<!--                                     if(-1 != selArr.indexOf(vals[i])){ -->
<!--                                         //output += '<option value="' + vals[i] + '" selected="selected">' + labs[i] + '</option>'; -->
<!--                                     }else{ -->
<!--                                         output += '<option value="' + vals[i] + '" >' + labs[i] + '</option>'; -->
<!--                                     } -->
<!--                                 }else{ -->
<!--                                     //alert('null == selArr'); -->
<!--                                     output += '<option value="' + vals[i] + '" >' + labs[i] + '</option>'; -->
<!--                                 } -->
<!--                             } -->
                            
<!--                             output += '</select>'; -->
                            
<!--                             //alert('output >> ' + output); -->
                            
<!--                             jQuery("#objectSelect").html(output); -->
<!--                             //document.getElementById('objectSelect').innerHTML = output; -->
<!--                             //alert('put'); -->
<!--                             jQuery("#topLvlObjs").pickList({ -->
<!--                                 onChange: function(){ -->
<!--                                     var arr = jQuery('.pickList_targetList > li.pickList_listItem'); -->
<!--                                     //console.log('arr >> ' + arr); -->
<!--                                     var str = ''; -->
<!--                                     jQuery.each(arr, function(){ -->
<!--                                         //console.log('data-value >> ' + jQuery(this).attr('data-value')); -->
<!--                                         str += jQuery(this).attr('data-value') + ','; -->
<!--                                     }); -->
<!--                                     str = str.substring(0, str.length - 1); -->
<!--                                     //console.log('str >> ' + str); -->
<!--                                     var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                     //console.log('prof >> ' + profSel); -->
<!--                                     if(null != jQuery('#'+profSel).html()){ -->
<!--                                         var checkStr = str.split(','); -->
<!--                                         var checkStr2 = jQuery('#'+profSel).html().split(','); -->
<!--                                         jQuery('#'+profSel).html(str); -->
<!--                                     }else{ -->
<!--                                         jQuery('[id*=topLvlMap]').append('<div id="'+profSel+'" class="mappingDiv">'+str+'</div>'); -->
<!--                                     } -->
<!--                                     if(null != jQuery('#'+profSel).html() && '' != jQuery('#'+profSel).html()){ -->
<!--                                         //alert('Add profile'); -->
<!--                                         addProfile(profSel); -->
<!--                                     }else{ -->
<!--                                         //alert('Del profile'); -->
<!--                                         delProfile(profSel); -->
<!--                                     } -->
<!--                                     refreshMenuList(); -->
<!--                                 }, -->
<!--                                 options:{ -->
<!--                                     sortItems: false -->
<!--                                 } -->
<!--                             }); -->
                            
<!--                             jQuery(".pickList_targetList").sortable({ -->
<!--                                 update : function(){ -->
<!--                                     var arr = jQuery('.pickList_targetList > li.pickList_listItem'); -->
<!--                                     //console.log('arr >> ' + arr); -->
<!--                                     var str = ''; -->
<!--                                     jQuery.each(arr, function(){ -->
<!--                                         //console.log('data-value >> ' + jQuery(this).attr('data-value')); -->
<!--                                         str += jQuery(this).attr('data-value') + ','; -->
<!--                                     }); -->
<!--                                     str = str.substring(0, str.length - 1); -->
<!--                                     //console.log('str >> ' + str); -->
<!--                                     var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                     //console.log('prof >> ' + profSel); -->
<!--                                     if(null != jQuery('#'+profSel).html()){ -->
<!--                                         jQuery('#'+profSel).html(str); -->
<!--                                     }else{ -->
<!--                                         jQuery('[id*=topLvlMap]').append('<div id="'+profSel+'" class="mappingDiv">'+str+'</div>'); -->
<!--                                     } -->
<!--                                     if(null != jQuery('#'+profSel).html() && '' != jQuery('#'+profSel).html()){ -->
<!--                                         //alert('Add profile');v -->
<!--                                            addProfile(profSel); -->
<!--                                     }else{ -->
<!--                                         //alert('Del profile'); -->
<!--                                         delProfile(profSel); -->
<!--                                     } -->
<!--                                 } -->
<!--                             }); -->
<!--                             jQuery("#addOptionDialog").dialog({ -->
<!--                                 autoOpen: false, -->
<!--                                 modal: true, -->
<!--                                 buttons: { -->
<!--                                     "{!$Label.clm__ms_add}": function() { -->
<!--                                         var opt = jQuery("[id*=newOptName]").val(); -->
<!--                                         var check = ''; -->
<!--                                         var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                         if(null != jQuery('#menu__'+profSel).html()){ -->
<!--                                             check = jQuery('#menu__'+profSel).html(); -->
<!--                                         } -->
<!--                                         //alert('opt >> ' + opt); -->
<!--                                         if(null != check){ -->
<!--                                             if(-1 != check.split(',').indexOf(opt)){ -->
<!--                                                 jQuery("#addOptWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                             if(-1 != check.split(',').indexOf(opt+'__c')){ -->
<!--                                                 jQuery("#addOptWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                             if(-1 != check.split(',').indexOf('clm__'+opt+'__c')){ -->
<!--                                                 jQuery("#addOptWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                             if(-1 != opt.indexOf(',')){ -->
<!--                                                 jQuery("#addOptSymbolWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                             if(-1 != opt.indexOf(';')){ -->
<!--                                                 jQuery("#addOptSymbolWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                             if(-1 != opt.indexOf(':')){ -->
<!--                                                 jQuery("#addOptSymbolWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                             if(-1 != opt.indexOf('/')){ -->
<!--                                                 jQuery("#addOptSymbolWarning").css('display', 'block'); -->
<!--                                                 return false; -->
<!--                                             } -->
<!--                                         }else{ -->
<!--                                             jQuery( this ).dialog( "close" ); -->
<!--                                         } -->
<!--                                         addOption(opt); -->
<!--                                         //jQuery("#addOptionDialog").dialog().remove(); -->
<!--                                         jQuery("[id*=newOptName]").val(''); -->
<!--                                         jQuery("#addOptWarning").css('display', 'none'); -->
<!--                                         jQuery( this ).dialog( "close" ); -->
<!--                                     }, -->
<!--                                     "{!$Label.MS_Cancel}": function() { -->
<!--                                         jQuery("[id*=newOptName]").val(''); -->
<!--                                         jQuery("#addOptWarning").css('display', 'none'); -->
<!--                                         jQuery("#addOptSymbolWarning").css('display', 'none'); -->
<!--                                         jQuery( this ).dialog( "close" ); -->
<!--                                     } -->
<!--                                 }, -->
<!--                                 close: function() { -->
<!--                                     //form[ 0 ].reset(); -->
<!--                                 } -->
<!--                             }); -->
                            
<!--                         } -->
                        
<!--                         function openAddOptDialog() { -->
<!--                                 jQuery( "#addOptionDialog" ).dialog( 'open' ); -->
<!--                             } -->
                        
<!--                         function getFirstSelected(){ -->
<!--                             var sels = jQuery('.pickList_targetList > li.ui-selected'); -->
<!--                             //alert('sels >> ' + sels.attr('data-value')); -->
<!--                             return sels.attr('data-value'); -->
<!--                         } -->
                        
<!--                         function getFirstMenuSelected(){ -->
<!--                             var sels = jQuery('.menulist_targetList > li.ui-selected'); -->
<!--                             //alert('sels >> ' + sels.attr('data-value')); -->
<!--                             return sels.attr('data-value'); -->
<!--                         } -->
                        
<!--                         function saveTopLvls (){ -->
<!--                             var tops = jQuery('div.mappingDiv'); -->
<!--                             var str = ''; -->
<!--                             jQuery.each(tops, function(){ -->
<!--                                 console.log('this.id >> ' + jQuery(this).attr('id')); -->
<!--                                 var menuId = 'menu__' + jQuery(this).attr('id'); -->
<!--                                 var groupPartId = 'gr__'+jQuery(this).attr('id')+'__'; -->
<!--                                 var groups = jQuery('[id*='+groupPartId+']'); -->
<!--                                 var groupStr = ''; -->
<!--                                 jQuery.each(groups, function(){ -->
<!--                                    groupStr += jQuery(this).html() + ','; -->
<!--                                 }); -->
<!--                                 groupStr = groupStr.substring(0, groupStr.length -1); -->
<!--                                 console.log('groupStr >> ' + groupStr); -->
<!--                                 str += jQuery(this).attr('id') + ';' + jQuery(this).html() + ':' + jQuery('#'+menuId).html() + ':' + groupStr + '/'; -->
<!--                             }); -->
<!--                             str = str.substring(0, str.length - 1); -->
<!--                             saveTops(str); -->
<!--                             saveTopLvlObjs(); -->
<!--                         } -->
                        
<!--                         function addOption(opt){ -->
<!--                             jQuery("#menuObjs").pickList("insert", -->
<!--                                 { -->
<!--                                     value: opt, -->
<!--                                     label: opt, -->
<!--                                     selected: true -->
<!--                                 }); -->
<!--                         } -->
                        
<!--                         function refreshMenuList(){ -->
<!--                             var selArr; -->
<!--                             var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                             try{ -->
<!--                                 var selected = document.getElementById('menu__'+profSel).innerHTML; -->
<!--                                 if('' != selected){ -->
<!--                                     selArr = selected.split(','); -->
<!--                                 } -->
<!--                             }catch(ex){ -->
                                
<!--                             } -->
<!--                             var output = '<select id="menuObjs" name="menuObjs" multiple="multiple">'; -->
<!--                             var options1 = document.getElementById('allobjects').innerHTML -->
<!--                             var options = document.getElementById(profSel).innerHTML -->
<!--                             var opts = jQuery.parseJSON(options1); -->
<!--                             var vals = opts.vals.split(','); -->
<!--                             var labs = opts.labs.split(','); -->
<!--                             //console.log('vals.size() >> ' + vals.length); -->
<!--                             if(null != selArr){ -->
<!--                                 for(var i = 0; selArr.length > i; i++){ -->
<!--                                     if(-1 != options.split(',').indexOf(selArr[i])){ -->
<!--                                         if(-1 != vals.indexOf(selArr[i])){ -->
<!--                                             var ind = vals.indexOf(selArr[i]); -->
<!--                                             output += '<option value="' + vals[ind] + '" selected="selected">' + labs[ind] + '</option>'; -->
<!--                                         }else{ -->
<!--                                             output += '<option value="' + selArr[i] + '" selected="selected">' + selArr[i] + '</option>'; -->
<!--                                         } -->
<!--                                     }else if(-1 == vals.indexOf(selArr[i])){ -->
<!--                                         output += '<option value="' + selArr[i] + '" selected="selected">' + selArr[i] + '</option>'; -->
<!--                                     } -->
<!--                                 } -->
<!--                             } -->
<!--                             for(var i = 0; options.split(',').length > i; i++){ -->
<!--                                 if(null != selArr){ -->
<!--                                     if(-1 == selArr.indexOf(options.split(',')[i])){ -->
<!--                                         if(-1 != vals.indexOf(options.split(',')[i])){ -->
<!--                                             var ind = vals.indexOf(options.split(',')[i]); -->
<!--                                             output += '<option value="' + vals[ind] + '" >' + labs[ind] + '</option>'; -->
<!--                                         }else{ -->
<!--                                             output += '<option value="' + options.split(',')[i] + '" >' + options.split(',')[i] + '</option>'; -->
<!--                                         } -->
<!--                                     } -->
<!--                                 }else{ -->
<!--                                     if(-1 != vals.indexOf(options.split(',')[i])){ -->
<!--                                         var ind = vals.indexOf(options.split(',')[i]); -->
<!--                                         output += '<option value="' + vals[ind] + '" >' + labs[ind] + '</option>'; -->
<!--                                     }else{ -->
<!--                                         output += '<option value="' + options.split(',')[i] + '" >' + options.split(',')[i] + '</option>'; -->
<!--                                     } -->
<!--                                 } -->
<!--                             } -->
                            
<!--                             output += '</select>'; -->
                            
<!--                             //console.log('output >> ' + output); -->
                            
<!--                             jQuery("#menuSelect").html(output); -->
<!--                             //console.log('jQuery("#menuSelect").html() >> ' + jQuery("#menuSelect").html()); -->
<!--                             jQuery("#menuObjs").pickList({ -->
<!--                                 targetListClass: 'menulist_targetList', -->
<!--                                 onChange: function(){ -->
<!--                                     var arr = jQuery('.menulist_targetList > li.pickList_listItem'); -->
<!--                                     var str = ''; -->
<!--                                     var groups = ''; -->
<!--                                     var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                     jQuery.each(arr, function(){ -->
<!--                                         str += jQuery(this).attr('data-value') + ','; -->
<!--                                         var idCheck = jQuery(this).attr('data-value'); -->
<!--                                         console.log('idCheck >> ' + idCheck); -->
<!--                                         var gr = jQuery('#gr__'+profSel+'__'+idCheck).outerHTML(); -->
<!--                                         console.log('gr >> ' + gr); -->
<!--                                         if(null == gr || '' == gr){ -->
<!--                                            if('Home' != idCheck && 'Settings' != idCheck){ -->
<!--                                                gr = '<div id=\'gr__'+profSel+'__'+idCheck+'\'>null</div>'; -->
<!--                                            }else{ -->
<!--                                                gr = '<div id=\'gr__'+profSel+'__'+idCheck+'\'>null</div>'; -->
<!--                                            } -->
<!--                                         } -->
<!--                                         groups += gr; -->
<!--                                     }); -->
<!--                                     str = str.substring(0, str.length - 1); -->
<!--                                     //var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                     console.log('ddd >>> ' + jQuery("#menu__"+profSel).html()); -->
<!--                                     console.log('menu__'+profSel); -->
<!--                                     if(null != jQuery("#menu__"+profSel).html() && '' != jQuery('#menu__'+profSel).html()){ -->
<!--                                         var checkStr = str.split(','); -->
<!--                                         var checkStr2 = jQuery("#menu__"+profSel).html().split(','); -->
<!--                                         if(-1 == checkStr.indexOf('Home')){ -->
<!--                                             if(-1 != checkStr2.indexOf('Home')){ -->
<!--                                                 refreshPicklist(); -->
<!--                                             } -->
<!--                                             return false; -->
<!--                                         } -->
<!--                                         if(-1 == checkStr.indexOf('Settings')){ -->
<!--                                             if(-1 != checkStr2.indexOf('Settings')){ -->
<!--                                                 refreshPicklist(); -->
<!--                                             } -->
<!--                                             return false; -->
<!--                                         } -->
<!--                                         jQuery("#menu__"+profSel).html(str); -->
<!--                                         jQuery("#group__"+ profSel).html(groups); -->
<!--                                     }else{ -->
<!--                                        console.log('ELSE'); -->
<!--                                         if('' == str){ -->
<!--                                            console.log('\'\' == str'); -->
<!--                                             str = 'Home,Settings'; -->
<!--                                             console.log('str = ' + str); -->
<!--                                             groups = '<div id=\'gr__'+profSel+'__Home\'>null</div><div id=\'gr__'+profSel+'__Settings\'>null</div>'; -->
<!--                                         }else{ -->
<!--                                            console.log('ELSE'); -->
<!--                                             str += ',Home,Settings' -->
<!--                                             groups += '<div id=\'gr__'+profSel+'__Home\'>null</div><div id=\'gr__'+profSel+'__Settings\'>null</div>'; -->
<!--                                         } -->
<!--                                         console.log('if exit'); -->
<!--                                         jQuery("[id*=menuMap]").append('<div id="menu__'+profSel+'" class="mappingMenuDiv">'+str+'</div>'); -->
<!--                                         jQuery("[id*=groupMap]").append('<div id="group__'+ profSel + '" class="mappingGroupDiv" >' + groups + "</div>"); -->
<!--                                         refreshMenuList(); -->
<!--                                     } -->
<!--                                     if(null != jQuery('#menu__'+profSel).html() && '' != jQuery('#menu__'+profSel).html()){ -->
<!--                                         //if('Home,Settings' == jQuery('#menu__'+profSel).html() || 'Settings,Home' == jQuery('#menu__'+profSel).html()){ -->
<!--                                         //  delProfile(profSel); -->
<!--                                         //  return false; -->
<!--                                         //} -->
<!--                                         //alert('Add profile'); -->
<!--                                         var toCheck = jQuery('#menu__'+profSel).html() -->
<!--                                         if('Home,Settings' != toCheck){ -->
<!--                                            addProfile(profSel); -->
<!--                                         }else{ -->
<!--                                            if(null == jQuery('#'+profSel).html()){ -->
<!--                                                delProfile(profSel); -->
<!--                                            } -->
<!--                                         } -->
<!--                                     }else{ -->
<!--                                         //alert('Del profile'); -->
<!--                                         delProfile(profSel); -->
<!--                                     } -->
<!--                                 } -->
<!--                             }); -->
<!--                             jQuery(".menulist_targetList").sortable({ -->
<!--                                 update : function(){ -->
<!--                                     var arr = jQuery('.menulist_targetList > li.pickList_listItem'); -->
<!--                                     var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                     //console.log('arr >> ' + arr); -->
<!--                                     var str = ''; -->
<!--                                     var groups = ''; -->
<!--                                     jQuery.each(arr, function(){ -->
<!--                                         //console.log('data-value >> ' + jQuery(this).attr('data-value')); -->
<!--                                         str += jQuery(this).attr('data-value') + ','; -->
<!--                                         var idCheck = jQuery(this).attr('data-value'); -->
<!--                                         groups += jQuery('#gr__'+profSel+'__'+idCheck).outerHTML(); -->
<!--                                     }); -->
<!--                                     str = str.substring(0, str.length - 1); -->
<!--                                     //console.log('str >> ' + str); -->
<!--                                     //console.log('prof >> ' + profSel); -->
<!--                                     if(null != jQuery('#menu__'+profSel).html()){ -->
<!--                                         jQuery('#menu__'+profSel).html(str); -->
<!--                                     }else{ -->
<!--                                         jQuery('[id*=menuMap]').append('<div id="menu__'+profSel+'" class="mappingDiv">'+str+'</div>'); -->
<!--                                     } -->
<!--                                     //console.log('groups >> ' + groups); -->
<!--                                     //console.log('jQuery(\'#group__\' + profSel).html >> ' + jQuery('#group__' + profSel).html()); -->
<!--                                     jQuery('#group__' + profSel).html(groups); -->
<!--                                     var toCheck = jQuery('#menu__'+profSel).html() -->
<!--                                     if('Home,Settings' != toCheck){ -->
<!--                                        addProfile(profSel); -->
<!--                                     }else{ -->
<!--                                        if(null == jQuery('#'+profSel).html()){ -->
<!--                                            delProfile(profSel); -->
<!--                                        } -->
<!--                                     } -->
<!--                                 } -->
<!--                             }); -->
                            
<!--                             jQuery("#changeGroupDialog").dialog({ -->
<!--                                 autoOpen: false, -->
<!--                                 modal: true, -->
<!--                                 buttons: { -->
<!--                                     Submit: function() { -->
<!--                                        var fieldSel = jQuery('[id*=groupFieldSelectList] :selected').val(); -->
<!--                                        var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                                        var objSel = getFirstMenuSelected(); -->
<!--                                        jQuery('#gr__'+profSel+'__'+objSel).html(fieldSel); -->
<!--                                         jQuery( this ).dialog( "close" ); -->
<!--                                         //.remove() -->
<!--                                     }, -->
<!--                                     "{!$Label.MS_Cancel}": function() { -->
<!--                                         jQuery( this ).dialog( "close" ); -->
<!--                                         //.remove() -->
<!--                                     } -->
<!--                                 }, -->
<!--                                 close: function() { -->
<!--                                     //form[ 0 ].reset(); -->
<!--                                 } -->
<!--                             }); -->
                            
<!--                             jQuery("#SettExistPaste").dialog({ -->
<!--                                autoOpen: false, -->
<!--                                modal: true, -->
<!--                                buttons: { -->
<!--                                    'Continue': function() { -->
<!--                                        showDialog('','Operation in progress'); -->
<!--                                        pasteSettings(); -->
<!--                                        jQuery( this ).dialog( "close" ); -->
<!--                                    }, -->
<!--                                    "{!$Label.MS_Cancel}": function() { -->
<!--                                        jQuery( this ).dialog( "close" ); -->
<!--                                        //.remove() -->
<!--                                    } -->
<!--                                }, -->
<!--                                close: function() { -->
<!--                                    //form[ 0 ].reset(); -->
<!--                                } -->
<!--                            }); -->
<!--                         } -->
                        
                        
<!-- //                      jQuery("#soqlListDialog").dialog({ -->
<!-- //                          autoOpen: false, -->
<!-- //                          modal: true, -->
<!-- //                          buttons: { -->
<!-- //                          "{!$Label.MS_Cancel}": function() { -->
<!-- //                                  jQuery("[id*=newOptName]").val(''); -->
<!-- //                                  jQuery("#addOptWarning").css('display', 'none'); -->
<!-- //                                  jQuery("#addOptSymbolWarning").css('display', 'none'); -->
<!-- //                                  jQuery( this ).dialog( "close" ); -->
<!-- //                              } -->
<!-- //                          }, -->
<!-- //                          close: function() { -->
<!-- //                              //form[ 0 ].reset(); -->
<!-- //                          } -->
<!-- //                      }); -->
                    
<!--                    function openGroupFieldSelect(){ -->
<!--                        console.log('opening'); -->
<!--                        var fieldSel = jQuery('[id*=groupFieldSelectList] :selected').val(); -->
<!--                            var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                            var objSel = getFirstMenuSelected(); -->
<!--                            var def = jQuery('#gr__'+profSel+'__'+objSel).html(); -->
<!--                            console.log('def >> ' + def); -->
<!--                        jQuery('select[id*=groupFieldSelectList]').val(def); -->
<!--                        jQuery("#changeGroupDialog").dialog( 'open' ); -->
<!--                    } -->
                    
<!--                    function storeSetts(){ -->
<!--                        var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                        jQuery('#profToStore').html(profSel); -->
<!--                    } -->
                    
<!--                    function pasteSettings(){ -->
<!--                        var profStore = jQuery('#profToStore').html(); -->
<!--                        var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                        var topStore = jQuery('#'+profStore).html(); -->
<!--                        var topMenu = jQuery('#menu__'+profStore).html(); -->
<!--                        var topGroup = jQuery('#group__'+profStore).html(); -->
                        
<!--                        var re = new RegExp(profStore, "g"); -->
                        
<!--                        topGroup = topGroup.replace(re, profSel); -->
<!--                        console.log('profStore >> ' + profStore); -->
<!--                        console.log('profSel >> ' + profSel); -->
<!--                        console.log('topGroup >> ' + topGroup); -->
<!--                        jQuery('#'+profSel).html(topStore); -->
<!--                        jQuery('#menu__'+profSel).html(topMenu); -->
<!--                        jQuery('#group__'+profSel).html(topGroup); -->
<!--                        var grs = jQuery('[id*=gr__'+profSel+']'); -->
<!--                        var topGroupStr = ''; -->
<!--                        jQuery.each(grs,function(){ -->
<!--                            topGroupStr += jQuery(this).html() + ','; -->
<!--                        }); -->
<!--                        topGroupStr = topGroupStr.substring(0, topGroupStr.length - 1); -->
<!--                        var topsStore = 'clm__TopLvlObjects__c:' + topStore + ';clm__MenuSettings__c:' + topMenu + ';clm__GroupFields__c:' + topGroupStr; -->
<!--                        pasteSettingsAF(profStore, topsStore); -->
<!--                        rerenderPicklists(); -->
<!--                    } -->
                    
<!--                    function beforePaste(){ -->
<!--                        var checker = jQuery('#actProfGr').html(); -->
<!--                        var profSel = jQuery('[id*=profPicklist] :selected').val(); -->
<!--                        var str = 'value="'+profSel+'"'; -->
<!--                        console.log('checker >> ' + checker); -->
<!--                        console.log('profSel >> ' + profSel); -->
<!--                        console.log('str >> ' + str); -->
<!--                        var profCheck = jQuery('#profToStore').html(); -->
<!--                        if(null == profCheck){ -->
<!--                            alert('No settings stored!'); -->
<!--                        }else{ -->
<!--                            if(checker.contains(str)){ -->
<!--                                console.log('dialog'); -->
<!--                                jQuery("#SettExistPaste").dialog( 'open' ); -->
<!--                            }else{ -->
<!--                                console.log('paste'); -->
<!--                                showDialog('','Operation in progress'); -->
<!--                                pasteSettings(); -->
<!--                            } -->
<!--                        } -->
<!--                    } -->
                    
<!--                     </script> -->
                    
<!--                     <div id="SettExistPaste" title="Warning!" style="min-width: 250px"> -->
<!--                         <fieldset class="ui-helper-reset"> -->
<!--                            <apex:outputText value="Settings exist for current profile. If you proceed they will be rewritten" /> -->
<!--                         </fieldset> -->
<!--                     </div> -->
                    
<!--                     <apex:actionFunction name="pasteSettingsAF" action="{!tlo.pasteSettings}" oncomplete="hideDialog();alert('Settings pasted');" rerender="none" > -->
<!--                        <apex:param name="tloProfCopyConn" assignTo="{!tlo.profIdConnector}" value="" /> -->
<!--                        <apex:param name="topStore" assignTo="{!tlo.topsCopyConnector}" value="" /> -->
<!--                     </apex:actionFunction> -->
                    
<!--                     <apex:actionFunction name="rerenderPicklists" oncomplete="refreshPicklist();"> -->
<!--                     </apex:actionFunction> -->
                    
<!--                     <div id="addOptionDialog" title="{!$Label.MS_MS_SelectOwnerDialName}" > -->
<!--                             <fieldset class="ui-helper-reset"> -->
<!--                                 <div id="addOptWarning" style="display: none"> -->
<!--                                     <apex:pageMessage summary="This option already exists" severity="FATAL" strength="2" /> -->
<!--                                 </div> -->
<!--                                 <div id="addOptSymbolWarning" style="display: none"> -->
<!--                                     <apex:pageMessage summary="Symbols ',', '/', ':', ';' are not allowed in names" severity="FATAL" strength="2" /> -->
<!--                                 </div> -->
<!--                                 <apex:outputLabel for="newOptName" value="{!$Label.MS_TOP_EnterOptionName}" /> -->
<!--                                 <apex:inputText id="newOptName" /> -->
<!--                             </fieldset> -->
<!--                     </div> -->
                    
<!--                     <div id="changeGroupDialog" title="Change Group Field" style="min-width: 250px"> -->
<!--                             <fieldset class="ui-helper-reset"> -->
<!--                                <apex:pageMessages id="msgChange" /> -->
<!--                                <apex:outputLabel for="groupFieldSelectList" value="select Grouping Field"/> -->
<!--                                <apex:selectList id="groupFieldSelectList" value="{!tlo.groupField}" size="1"> -->
<!--                                    <apex:selectOptions value="{!tlo.groupFieldOpts}" /> -->
<!--                                </apex:selectList> -->
<!--                             </fieldset> -->
<!--                     </div> -->
                    
<!-- <!--                    <div id="soqlListDialog" title="Import SOQL Filter" > --> 
<!-- <!--                            <fieldset class="ui-helper-reset"> -->
<!-- <!--                                <apex:pageBlockTable id="importSoql" value="{!tlo.soqlList}" var="soqlFilter"> -->
<!-- <!--                                    <apex:column > -->
<!-- <!--                                        <apex:facet name="header">{!$Label.MS_TOP_SOQLFilter}</apex:facet> -->
<!-- <!--                                        <apex:outputText value="{!soqlFilter}" style="min-width: 300px" /> -->
<!-- <!--                                    </apex:column> -->
                                    
<!-- <!--                                    <apex:column > -->
<!-- <!--                                        <apex:facet name="header">{!$Label.MS_TOP_SOQLFilter}</apex:facet> -->
<!-- <!--                                        <apex:outputText value="{!soqlFilter}" style="min-width: 300px" /> -->
<!-- <!--                                    </apex:column> -->
<!-- <!--                                </apex:pageBlockTable> -->
<!-- <!--                            </fieldset> -->
<!-- <!--                    </div> -->
                    
<!--                 </apex:pageBlock> -->
                
<!--                 <apex:actionFunction name="formChangePickList" action="{!tlo.formFieldPicklist}" oncomplete="console.log('ready to open');hideDialog();openGroupFieldSelect();" rerender="groupFieldSelectList, msgChange"> -->
<!--                    <apex:param name="connTLOgroupField" assignTo="{!tlo.fieldConnector}" value="" /> -->
<!--                 </apex:actionFunction> -->
                
<!--                 <apex:actionFunction name="initBtn" action="{!tlo.initButton}" oncomplete="hideDialog();" rerender="msg1, settingsTable, objList"> -->
<!--                    <apex:param name="connTLO" assignTo="{!tlo.connector}" value="" /> -->
<!--                 </apex:actionFunction> -->
                
<!--                 <apex:pageBlock id="settingsTable" > -->
<!--                action="{!tlo.init}" -->
<!-- <!--                    <apex:pageBlockButtons location="top"> -->
<!-- <!--                        <apex:commandButton id="createBtn" value="{!$Label.MS_TOP_ShowRt}" onclick="showDialog('','Operation In Progress');var sel = getFirstSelected();initBtn(sel);" oncomplete="" rerender="me"/> -->
<!-- <!--                    </apex:pageBlockButtons> -->
                    
<!-- <!--                     <apex:pageMessages id="msg1" /> -->
                    
<!--                     <apex:pageBlockSection columns="1" title="Base sObject Filter" collapsible="false" rendered="{!tlo.objectExist}" > -->
<!--                         <apex:pageBlockTable id="objFilter" value="{!tlo.nonRelatedFilters}" var="item" rendered="{!tlo.objectExist}"> -->
<!--                             <apex:column > -->
<!--                                 <apex:facet name="header">sObject</apex:facet> -->
<!--                                 <apex:outputText value="{!tlo.sobjectLabelMap[item.sObjectRelated__c]}" /> -->
<!--                             </apex:column> -->
                            
<!--                             <apex:column > -->
<!--                                 <apex:facet name="header">{!$Label.MS_TOP_SOQLFilter}</apex:facet> -->
<!--                                 <apex:inputField value="{!item.SOQL__c}" style="min-width: 300px" /> -->
<!--                             </apex:column> -->
                            
<!--                             <apex:column > -->
<!--                                 <apex:facet name="header">{!$Label.MS_TOP_CreateAllowed}</apex:facet> -->
<!--                                 <apex:inputField id="createMainAllowedMain" value="{!item.isCreateAllowed__c}" /> -->
<!--                             </apex:column> -->
                            
<!--                             <apex:column > -->
<!--                                 <apex:facet name="header">{!$Label.MS_TOP_DeleteAllowed}</apex:facet> -->
<!--                                 <apex:inputField id="deleteMainAllowed" value="{!item.isDeleteAllowed__c}" /> -->
<!--                             </apex:column> -->
<!--                         </apex:pageBlockTable> -->
<!--                     </apex:pageBlockSection> -->
                    
<!--                     <apex:pageMessages id="msg1" /> -->
                    
<!--                     <apex:pageBlockSection columns="1" title="Related sObjects Filters" collapsible="false" rendered="{!tlo.filtersFilled}" > -->
<!--                         <apex:pageBlockTable id="settingsTable1" value="{!tlo.filterMap}" var="item" rendered="{!tlo.filtersFilled}"> -->
<!--                             <apex:column > -->
<!--                                 <apex:facet name="header">{!$Label.MS_RecordType}</apex:facet> -->
<!--                                 <apex:outputText value="{!item}" /> -->
<!--                             </apex:column> -->
                            
<!--                             <apex:column > -->
<!--                                 <apex:pageBlockTable id="settingsTable1" value="{!tlo.filterMap[item]}" var="filter" rendered="true" > -->
<!--                                     <apex:column > -->
<!--                                         <apex:facet name="header">{!$Label.MS_TOP_RelatedsObject}</apex:facet> -->
<!--                                         <apex:outputText id="relatedSobject" value="{!tlo.sobjectLabelMap[filter.clm__sObjectRelated__c]}" /> -->
<!--                                     </apex:column> -->
                                    
<!--                                     <apex:column > -->
<!--                                         <apex:facet name="header">{!$Label.MS_TOP_SOQLFilter}</apex:facet> -->
<!--                                         <apex:inputField id="soql" value="{!filter.clm__SOQL__c}" /> -->
<!--                                     </apex:column> -->
                                    
<!--                                     <apex:column > -->
<!--                                         <apex:facet name="header">{!$Label.MS_TOP_CreateAllowed}</apex:facet> -->
<!--                                         <apex:inputField id="createAllowed" value="{!filter.clm__isCreateAllowed__c}" /> -->
<!--                                     </apex:column> -->
                                    
<!--                                     <apex:column > -->
<!--                                         <apex:facet name="header">{!$Label.MS_TOP_DeleteAllowed}</apex:facet> -->
<!--                                         <apex:inputField id="deleteAllowed" value="{!filter.clm__isDeleteAllowed__c}" /> -->
<!--                                     </apex:column> -->
                                    
<!--                                     <apex:column > -->
<!--                                         <apex:facet name="header">{!$Label.MS_TOP_CopySetting}</apex:facet> -->
<!--                                         <apex:commandButton id="copyBtn" value="Copy Setings"  -->
<!--                                             onclick="var thisId = jQuery(this).attr('id');copySoql(thisId);"  -->
<!--                                             rerender="me" /> -->
                                            
<!--                                             <script type="text/javascript"> -->
<!--                                                 function copySoql(thisId){ -->
<!--                                                     var newId = thisId.replace('copyBtn','soql'); -->
<!--                                                     newId = newId.replace(/:/g,'\\:'); -->
<!--                                                     var sobjId = newId.replace('soql','relatedSobject'); -->
<!--                                                     var createId = newId.replace('soql','createAllowed'); -->
<!--                                                     var deleteId = newId.replace('soql','deleteAllowed'); -->
<!--                                                     //alert(jQuery('#'+newId).val()); -->
<!--                                                     //alert(jQuery('#'+sobjId).html()); -->
<!--                                                     var src = jQuery('#'+sobjId).html(); -->
<!--                                                     var soql = jQuery('#'+newId).val(); -->
<!--                                                     var createAllowed = jQuery('#'+createId).attr('checked'); -->
<!--                                                     var deleteAllowed = jQuery('#'+deleteId).attr('checked'); -->
<!--                                                     var allObjs = jQuery('[id*=relatedSobject]'); -->
<!--                                                     jQuery.each(allObjs, function(){ -->
<!--                                                         if(src == jQuery(this).html()){ -->
<!--                                                             var targetId = jQuery(this).attr('id'); -->
<!--                                                             targetId = targetId.replace('relatedSobject','soql'); -->
<!--                                                             targetId = targetId.replace(/:/g,'\\:'); -->
<!--                                                             var targetCreate = targetId.replace('soql','createAllowed'); -->
<!--                                                             var targetDelete = targetId.replace('soql','deleteAllowed'); -->
<!--                                                             jQuery('#'+targetId).val(soql); -->
<!--                                                             if(createAllowed === 'checked'){ -->
<!--                                                                 jQuery('#'+targetCreate).attr('checked',createAllowed); -->
<!--                                                             }else{ -->
<!--                                                                 //alert('createAllowed >> ' + createAllowed); -->
<!--                                                                 jQuery('#'+targetCreate).attr('checked',false); -->
<!--                                                             } -->
<!--                                                             if(deleteAllowed === 'checked'){ -->
<!--                                                                 jQuery('#'+targetDelete).attr('checked',deleteAllowed); -->
<!--                                                             }else{ -->
<!--                                                                 //alert('deleteAllowed >> ' + deleteAllowed); -->
<!--                                                                 jQuery('#'+targetDelete).attr('checked',false); -->
<!--                                                             } -->
<!--                                                             //alert(jQuery('#'+targetId).val()); -->
<!--                                                         } -->
<!--                                                     }); -->
<!--                                                 } -->
<!--                                             </script> -->
<!--                                     </apex:column> -->
<!--                                 </apex:pageBlockTable> -->
<!--                             </apex:column> -->
<!--                         </apex:pageBlockTable> -->
<!--                     </apex:pageBlockSection> -->
                    
<!--                 </apex:pageBlock> -->
            
<!--             <apex:actionFunction name="saveTops" action="{!tlo.saveTops}" rerender="me" > -->
<!--                 <apex:param name="topConn" assignTo="{!tlo.topConn}" value="" /> -->
<!--             </apex:actionFunction> -->
            
<!--             <apex:actionFunction name="saveTopLvlObjs" action="{!tlo.saveTopLvlObjs}" rerender="me" > -->
<!--             </apex:actionFunction> -->
            
<!--             <apex:actionFunction name="addProfile" action="{!tlo.addProfileSettExist}" rerender="profPicklist" oncomplete="grouping();" > -->
<!--                 <apex:param name="prof" assignTo="{!tlo.connector}" value="" /> -->
<!--             </apex:actionFunction> -->
<!--             <apex:actionFunction name="delProfile" action="{!tlo.delProfileSettExist}" rerender="profPicklist" oncomplete="grouping();" > -->
<!--                 <apex:param name="prof" assignTo="{!tlo.connector}" value="" /> -->
<!--             </apex:actionFunction> -->
            
<!--         </apex:tab>  -->
         
<!--          <apex:tab label="{!$Label.MS_MS_MenuSettingsTabName}" name="MenuSettings" id="MenuSettings"> -->
<!--             <apex:outputPanel id="settingTab"> -->
<!--                 <div id="tabs"></div> -->
            
            
<!--                 <div id="mmSettings"  style="display: none">{!mms.DataString}</div> -->
                
<!--                 <script type="text/javascript"> -->
                    
<!--                     var pageContent = ''; // var stores all the code inserted. -->
                    
<!--                     var tabNamesString = "{!mms.tabString}"; -->
<!--                     var tabIdString = "{!mms.tabIdString}"; -->
<!--                     //console.log("{!mms.tabIdString}"); -->
<!--                     //console.log('tabNamesString >> ' + tabNamesString); -->
<!--                     //console.log('tabIdString >> ' + tabIdString); -->
                    
<!--                     var tabNames = tabNamesString.split(";"); -->
<!--                     var tabId = tabIdString.split(";"); -->
<!--                     //for (var i=0; i<tabNames.length-1; i++){ -->
                        
<!--                     //} -->
                    
<!--                     var outputTabs = "<ul id='ulTabs'>"; -->
<!--                     var outputTotal = ''; -->
                    
<!--                     var MMSet = document.getElementById('mmSettings').innerHTML; -->
<!--                     var MMObj = jQuery.parseJSON(MMSet); -->
<!--                     //console.log('MMSet >> ' + MMSet); -->
<!--                     //console.log('MMObj >> ' + MMObj); -->
<!--                     var tabNumber = 0; -->
<!--                     jQuery.each(MMObj, function() { -->
                            
<!--                             //console.log('outputTabs >> ' + outputTabs); -->
<!--                             if(0 == tabNumber){ -->
<!--                                 outputTabs += "<li id='"+ tabId[tabNumber] +"'> <a href='#tabs-" + tabId[tabNumber] + "' >" + tabNames[tabNumber] + "</a> </li>"; -->
<!--                             }else{ -->
<!--                                 outputTabs += "<li id='"+ tabId[tabNumber] +"'> <span class='ui-icon ui-icon-close' role='presentation'>Remove Setting</span> <a href='#tabs-" + tabId[tabNumber] + "' >" + tabNames[tabNumber] + "</a> </li>"; -->
<!--                             } -->
                            
<!--                             jQuery( ".connectedSortable" ).sortable({ -->
<!--                                 connectWith: "ul", -->
<!--                                 dropOnEmpty: true -->
<!--                             }); -->
                            
<!--                             //console.log('MMObj.ValsInact >> ' + this.ValsInact); -->
                            
<!--                             var valString = new String(this.ValsInact); -->
<!--                             //console.log('valString >> ' + valString); -->
                            
<!--                             var labString = new String(this.LabsInact); -->
<!--                             //console.log('labString >> ' + labString); -->
                                
<!--                             var divstart = "<div id='tabs-" + tabId[tabNumber] + "' ><table><tr><td>{!$Label.MS_MS_HiddenTitle}</td><td>{!$Label.MS_MS_ShowingTitle}</td></tr><tr>"; -->
                            
<!--                             var outputInact = "<td><div id='div-"+tabId[tabNumber]+"-inactive'></div><ul id='sortable-"+tabId[tabNumber]+"-Inact' class='connectedSortable'>"; -->
                            
<!--                             if (valString != "" && labString != ""){ -->
<!--                                 var valueArray = valString.split(";"); -->
<!--                                 var labelArray = labString.split(";"); -->
                                
<!--                                    for (var i=0; i<valueArray.length-1; i++){ -->
<!--                                        outputInact += "<li id='"+ valueArray[i] +"' val='"+ valueArray[i] +"' class='ui-state-default'>"+ labelArray[i] +"</li>"; -->
<!--                                    } -->
<!--                             } -->
                            
<!--                             outputInact += "</ul></div></td>"; -->
<!--                             ////console.log('outputInact >> '+outputInact); -->
                            
<!--                             var valStringAct = new String(this.ValsAct); -->
<!--                             //console.log('valString >> ' + valStringAct); -->
                            
<!--                             var labStringAct = new String(this.LabsAct); -->
<!--                             //console.log('labString >> ' + labStringAct); -->
                            
<!--                             var outputAct = "<td><div id='div-"+tabId[i]+"-active'><ul id='sortable-"+tabId[tabNumber]+"-Act' class='connectedSortable'>"; -->
                            
<!--                             if (valStringAct != "" && valStringAct != ""){ -->
<!--                                 var valueArrayAct = valStringAct.split(";"); -->
<!--                                 var labelArrayAct = labStringAct.split(";"); -->
                                
<!--                                    for (var i=0; i<valueArrayAct.length-1; i++){ -->
<!--                                        outputAct += "<li id='"+ labelArrayAct[i] +"' val='"+ labelArrayAct[i] +"' class='ui-state-default'>"+ valueArrayAct[i] +"</li>"; -->
<!--                                    } -->
<!--                             } -->
                            
<!--                             outputAct += "</ul></div></td></tr></table></div>"; -->
<!--                             ////console.log('outputAct >> '+outputAct); -->
<!--                             outputTotal = outputTotal + divstart+" "+outputInact+" "+outputAct; -->
<!--                             //jQuery("#sortInact").html(output); -->
                            
<!--                             jQuery(function(){ -->
<!--                               //jQuery("#sortable-"+tabId[tabNumber]+"-Act").sortable({connectWith: "#sortable-"+tabId[tabNumber]+"-Inact"}); -->
<!--                               //jQuery("#sortable-"+tabId[tabNumber]+"-Inact").disableSelection(); -->
<!--                               //jQuery( "#sortable-"+tabId[tabNumber]+"-Act, #sortable-"+tabId[tabNumber]+"-Inact" ).sortable({ -->
<!--                                 //  connectWith: ".connectedSortable" -->
<!--                                 //}).disableSelection(); -->
                                
<!--                                 jQuery(".connectedSortable").sortable({connectWith: ".connectedSortable"}).disableSelection(); -->
<!--                             }); -->
                            
                            
<!--                             tabNumber++; -->
<!--                         }); -->
<!--                     outputTotal += "</div>" -->
                    
<!--                     outputTabs += "</ul>"; -->
<!--                     //console.log('outputTabs >> ' + outputTabs); -->
<!--                     outputTotal = outputTabs + outputTotal; -->
                    
<!--                     jQuery("#tabs").html(outputTotal); -->
                    
<!--                     jQuery(function() { -->
<!--                         //console.log('tab class set'); -->
<!--                         jQuery( "#tabs" ).tabs().addClass( "ui-tabs-vertical ui-helper-clearfix" ); -->
<!--                         jQuery( "#tabs li" ).removeClass( "ui-corner-top" ).addClass( "ui-corner-left" ); -->
<!--                     }); -->
                    
<!--                     jQuery( "ul.connectedSortable" ).sortable({ -->
                            
<!--                                 connectWith: "ul", -->
<!--                                 dropOnEmpty: true -->
<!--                             }); -->
<!--                 </script> -->
                
<!--                 <div id="dialog" title="{!$Label.MS_MS_SelectOwnerDialName}" > -->
<!--                         <fieldset class="ui-helper-reset"> -->
<!--                             <apex:outputLabel for="ownerSelect" value="{!$Label.MS_MS_SelectOwner}"></apex:outputLabel> -->
<!--                             <apex:selectList id="ownerSelect" value="{!mms.newOwner}" multiselect="false" size="1"> -->
<!--                                 <apex:selectOptions value="{!mms.ProfileOpt}"/> -->
<!--                             </apex:selectList><p/> -->
<!--                         </fieldset> -->
<!--                 </div> -->
                
<!--                 <script type="text/javascript"> -->
<!--                     tabNumber=0; -->
<!--                     //console.log('tabNames.length >> '+tabNames.length); -->
<!--                     for(var tabNumber = 0; tabNames.length-1 > tabNumber; tabNumber++) { -->
<!--                         //console.log('tabId['+tabNumber+'] >> ' + tabId[tabNumber]); -->
<!--                         jQuery("#sortable-"+tabId[tabNumber]+"-Act").sortable({ -->
<!--                                 receive : function(event, ui) { -->
<!--                                             ////console.log(jQuery(this).data().uiSortable.currentItem); -->
<!--                                             ////console.log(this.id+';'+jQuery(this).sortable( "toArray" )); -->
<!--                                             //var connector = this.id+';'+jQuery(this).sortable( "toArray" ); -->
<!--                                             //sendData(connector); -->
<!--                                             return true; -->
<!--                                         }, -->
<!--                                 update : function(event, ui) { -->
<!--                                             ////console.log(jQuery(this).data().uiSortable.currentItem); -->
<!--                                             //console.log(this.id+';'+jQuery(this).sortable( "toArray" )); -->
<!--                                             var connector = this.id+';'+jQuery(this).sortable( "toArray" ); -->
<!--                                             setrefreshDataSave(connector); -->
<!--                                             return true; -->
<!--                                         }, -->
<!--                                 remove : function(event, ui) { -->
<!--                                             ////console.log(jQuery(this).data().uiSortable.currentItem); -->
<!--                                             ////console.log(this.id+';'+jQuery(this).sortable( "toArray" )); -->
<!--                                             //var connector = this.id+';'+jQuery(this).sortable( "toArray" ); -->
<!--                                             //sendData(connector); -->
<!--                                             return true; -->
<!--                                         } -->
<!--                         }).disableSelection(); -->
                        
<!--                     } -->
                    
<!--                     function updateMenuSettings(){ -->
<!--                         //console.log('updateMenuSettings, tabNames.length >> ' + tabNames.length); -->
<!--                         var connector = ''; -->
<!--                         for(var tabNumber = 0; tabNames.length-1 > tabNumber; tabNumber++) { -->
<!--                             connector += tabId[tabNumber] + ';' + jQuery("#sortable-"+tabId[tabNumber]+"-Act").sortable( "toArray" ) + '/'; -->
<!--                             //console.log('tabId[tabNumber] MENU >> ' + tabId[tabNumber]); -->
<!--                             //console.log('connector MENU >> ' + connector); -->
                            
<!--                         } -->
<!--                         sendDataMMS(connector); -->
<!--                     } -->
                    
<!--                     jQuery( "#tabs" ).tabs().delegate( "span.ui-icon-close", "click", function() { -->
<!--                             //console.log('ololloolololololo'); -->
<!--                             var panelId = jQuery( this ).closest( "li" ); -->
<!--                             //console.log('panelId >> ' + panelId.attr('id')); -->
<!--                             //console.log('panelId >> ' + panelId.html()); -->
<!--                             connector = panelId.attr('id'); -->
<!--                             Del(connector); -->
<!--                             jQuery("#dialog").dialog().remove(); -->
<!--                         }); -->
                    
<!--                     jQuery(function() { -->
<!--                         var newOwner = jQuery("#ownerSelect"); -->
<!--                         //console.log('newOwner >> ' + newOwner); -->
<!--                         //console.log('dialog init'); -->
<!--                         var dialog = jQuery( "#dialog" ).dialog({ -->
<!--                             autoOpen: false, -->
<!--                             modal: true, -->
<!--                             buttons: { -->
<!--                                 "{!$Label.clm__ms_add}": function() { -->
<!--                                     //console.log('newOwner >> ' + jQuery("#dialog :selected").val()); -->
<!--                                     connector = jQuery("#dialog :selected").val(); -->
<!--                                     ////console.log('newOwner.val >> ' + jQuery("#j_id0:j_id2:ownerSelect :selected").val()); -->
<!--                                     ////console.log('newOwner.text >> ' + jQuery("#j_id0:j_id2:ownerSelect :selected").text()); -->
<!--                                     Add(connector); -->
<!--                                     //console.log('submit'); -->
<!--                                     jQuery("#dialog").dialog().remove(); -->
<!--                                     //jQuery( this ).dialog( "close" ); -->
<!--                                 }, -->
<!--                                 "{!$Label.MS_Cancel}": function() { -->
<!--                                     ////console.log('newOwner >> ' + jQuery("#dialog :selected").val()); -->
<!--                                     ////console.log('newOwner.val >> ' + (this).document.getElementById( "j_id0:j_id2:ownerSelect" ).val); -->
<!--                                     ////console.log('newOwner.text >> ' + newOwner.text()); -->
<!--                                     jQuery( this ).dialog( "close" ); -->
<!--                                 } -->
<!--                             }, -->
<!--                             close: function() { -->
<!--                                 //form[ 0 ].reset(); -->
<!--                             } -->
<!--                         }); -->
                        
<!--                     }); -->
                    
<!--                     function openDialog() { -->
<!--                             jQuery( "#dialog" ).dialog( 'open' ); -->
<!--                         } -->
                
<!--                 </script> -->
<!--                         <apex:actionFunction name="sendDataMMS" action="{!mms.setNewVal}" rerender=""> -->
<!--                             <apex:param name="connector" assignTo="{!mms.connector}" value="" /> -->
<!--                         </apex:actionFunction> -->
<!--                         <apex:actionFunction name="Add" action="{!mms.addSetting}" rerender="settingTab" > -->
<!--                             <apex:param name="connector" assignTo="{!mms.connector}" value="" /> -->
<!--                         </apex:actionFunction> -->
<!--                         <apex:actionFunction name="Del" action="{!mms.addToDel}" rerender="settingTab" > -->
<!--                             <apex:param name="connector" assignTo="{!mms.connector}" value="" /> -->
<!--                         </apex:actionFunction> -->
                        
<!--                         <apex:actionFunction name="setrefreshDataSave" action="{!mms.setrefreshDataSave}" rerender=""> -->
<!--                             <apex:param name="connector" assignTo="{!mms.connector}" value="" /> -->
<!--                         </apex:actionFunction> -->
                        
<!--                         <apex:commandButton onclick="openDialog();" value="{!$Label.clm__ms_add}" oncomplete=""/> -->
<!--                     </apex:outputPanel>  -->
                    
<!--          </apex:tab> -->
        
        <apex:tab label="{!$Label.clm__ms_mls_minilayoutsettingstabname}" name="MiniLayoutSettings" id="MiniLayoutSettings">
        
            <script type="text/javascript">
                var check;
                jQuery(function() {
                    jQuery('td.show-hide').live('click', function(){
                        var id = '#' + 'show-hide' + jQuery(this).attr("id");               
                                if (jQuery(id).attr("class") == "hide") {
                                    //alert('hide');
                                    jQuery(this).html("-");
                                    jQuery(id).attr("class", "show");
                                } else {
                                    //alert('show');
                                    jQuery(this).html("+");
                                    jQuery(id).attr("class", "hide");
                                }
                    });
                });
                
                function showHide(idTR){        
                    
                            var id = '#' + 'show-hide' + idTR;              
                            if (jQuery(id).attr("class") == "hide") {
                                //alert('hide');
                                jQuery(this).html("-");
                                jQuery(id).attr("class", "show");
                            } else {
                                //alert('show');
                                jQuery(this).html("+");
                                jQuery(id).attr("class", "hide");
                            }
                    
                }
                
            </script>
        
            <apex:pageBlock id="MLSTable">

                <table id="MiniLayoutTable">
                <thead>
                    <tr>
                        <th></th>
                        <th>{!$Label.clm__ms_name}</th>
                        <th>{!$Label.MS_MLS_Sobject}</th>
                        <th>{!$Label.MS_MLS_Action}</th>
                        <th>{!$Label.MS_MLS_RecordType}</th>
                        <th>{!$Label.MS_MLS_Sort}</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                <apex:repeat value="{!mls.CurrentSettingsWrap}" var="item">
                    <tr>
                        <td id="{!item.index}" class="show-hide">+</td>
                        <td>
                            <apex:inputField value="{!item.controller.Name}" />
                        </td>
                        <td>
                            <apex:selectList value="{!item.controller.clm__SObject__c}" multiselect="false" size="1">
                                <apex:selectOptions value="{!mls.SObjectOption}"/>
                                <apex:actionSupport event="onchange"  rerender="MLSTable" onsubmit="showDialog('','Operation In Progress');check = true; var id = '#' + 'show-hide' + '{!item.index}'; if(jQuery(id).attr('class') == 'hide') {check = false;}" oncomplete="console.log('check >> '+check);if(check){showHide('{!item.index}');} hideDialog();" >
                                    <apex:param name="indexParent" assignTo="{!mls.connector}" value="{!item.index}" />
                                </apex:actionSupport>
                            </apex:selectList>
                        </td>
                        <td>
                            <apex:selectList value="{!item.controller.clm__Action__c}" multiselect="false" size="1">
                                <apex:selectOptions value="{!mls.ActionOption}"/>
                                <apex:actionSupport event="onchange" rerender="MLSTable" onsubmit="showDialog('','Operation In Progress');check = true; var id = '#' + 'show-hide' + '{!item.index}'; if(jQuery(id).attr('class') == 'hide') {check = false;}" oncomplete="console.log('check >> '+check);if(check){showHide('{!item.index}');} hideDialog();" />
                            </apex:selectList>  
                        </td>
                        <td class="RecordTypeDev">
                            <apex:selectList value="{!item.controller.clm__RecordtypeDeveloperName__c}" multiselect="false" size="1">
                                <apex:selectOptions value="{!item.DataRecordTypeOpt}"/>
                            </apex:selectList>
                        </td>
                        <td class="sort">
                            <apex:selectList value="{!item.controller.clm__Sort__c}" multiselect="false" size="1" disabled="{!If(item.showRead=item.showReq, false, true)}">
                                <apex:selectOptions value="{!item.SortingFieldNameOpt}"/>
                            </apex:selectList>
                        </td>                   
                        <td>
                            <apex:commandButton action="{!mls.delSetting}" value="{!$Label.clm__ms_delete}" rerender="MLSTable" >
                                <apex:param assignTo="{!mls.connector}" value="{!item.index}" name="indexToDel"/>
                            </apex:commandButton>
                        </td>
                    </tr>   
                    
                    
                    
                    <tr id="show-hide{!item.index}" class="hide">
                        <td colspan="7">
                            <table>
                                <thead>
                                    <tr>
                                        <th>
                                            {!$Label.MS_MLS_Field}
                                        </th>
<!--                                        <apex:outputPanel rendered="{!item.showRead}"> -->
                                            <th class="read-{!item.index}">
                                                {!$Label.MS_MLS_ReadAttribute}
                                            </th>
<!--                                        </apex:outputPanel> -->
<!--                                        <apex:outputPanel rendered="{!item.showReq}"> -->
                                            <th class="req-{!item.index}">
                                                {!$Label.MS_MLS_RequiredAttribute}
                                            </th>
<!--                                        </apex:outputPanel> -->
                                        <th></th> 
                                    </tr>
                                </thead>
                                <tbody>
                            <apex:repeat value="{!item.listChild}" var="field">
                                <tr>
                                    <td>
                                        <apex:selectList value="{!field.field}" multiselect="false" size="1">
                                            <apex:selectOptions value="{!item.SortingFieldNameOpt}"/>
                                        </apex:selectList>
                                    </td>
<!--                                    <apex:outputPanel rendered="{!item.showRead}"> -->
                                        <td class="read-{!item.index}">
                                            <apex:inputCheckbox value="{!field.read}" disabled="{!Not(item.showRead)}" />
                                        </td>
<!--                                    </apex:outputPanel> -->
<!--                                    <apex:outputPanel rendered="{!item.showReq}"> -->
                                        <td class="req-{!item.index}">
                                            <apex:inputCheckbox value="{!field.required}" disabled="{!Not(item.showReq)}"/>
                                        </td>
<!--                                    </apex:outputPanel> -->
                                    <td>
                                        <apex:commandButton action="{!mls.delChildSetting}" value="{!$Label.clm__ms_delete}" rerender="MLSTable" oncomplete="showHide('{!MlsController.connector2}');">
                                            <apex:param assignTo="{!mls.connector}" value="{!item.index}_{!field.index}" name="indexToDel"/>
                                            <apex:param assignTo="{!mls.connector2}" value="{!item.index}" name="indexToDel1"/>
                                        </apex:commandButton>
                                    </td>
                                </tr>
                            </apex:repeat>
                                <tr>                                
                                    <td colspan="4" class="tdAdd">
                                        <apex:commandButton value="{!$Label.clm__ms_add}" action="{!mls.addChildSetting}" rerender="MLSTable" oncomplete="showHide('{!MlsController.connector}');">
                                            <apex:param name="indexParent" assignTo="{!mls.connector}" value="{!item.index}" />
                                        </apex:commandButton>
                                    </td>                               
                                </tr>
                                </tbody>
                                <script type="text/javascript">
                                    //console.log('read >> ' + {!item.showReq});
                                    if({!item.showReq}){
                                    //console.log('block');
                                        jQuery(".req-{!item.index}").css('display','');
                                    }else{
                                        //console.log('none');
                                        jQuery(".req-{!item.index}").css('display','none');
                                    }
                                    
                                    //console.log('read >> ' + {!item.showRead});
                                    if({!item.showRead}){
                                        //console.log('block');
                                        jQuery(".read-{!item.index}").css('display','');
                                    }else{
                                        //console.log('none');
                                        jQuery(".read-{!item.index}").css('display','none');
                                    }
                               </script>
                            </table>
                        </td>
                    </tr>
                </apex:repeat>                  
                </tbody>
                </table>
                        <apex:pageBlockButtons location="bottom">
                            <apex:commandButton action="{!mls.addSetting}" rerender="MLSTable" value="{!$Label.clm__ms_add}" id="theButton"/>
<!--                            <apex:commandButton action="{!mls.saveSettings}" rerender="MLSTable" value="save" id="theButton2"/> -->
                        </apex:pageBlockButtons>    
            </apex:pageBlock>

         </apex:tab>

         <apex:tab label="{!$Label.clm__ms_cd_credentialdatatabname}" name="CredentialData" id="CredentialData"> 
         
<!--              <apex:sectionHeader description="Please enter new admin credentials for CT Mobile access." subtitle="CT Mobile Credentials"/> -->
        <apex:pageBlock title="{!$Label.clm__ms_cd_credentials}">
        <apex:pageMessages id="uccMsg" />
            <apex:pageBlockButtons id="buttonsCred" location="bottom" >
                <apex:commandButton action="{!ucc.save}" value="{!$Label.clm__ms_cd_newkeybtn}" onclick="showDialog('','Operation In Progress');" oncomplete="hideDialog();" rerender="uccMsg" />
            </apex:pageBlockButtons>
            
            <apex:outputText value="{!$Label.clm__ms_cd_plsenter}" /> 
            <apex:pageBlockSection columns="1">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel for="theLogin" value="{!$Label.clm__ms_cd_login}"></apex:outputLabel>
                    <apex:inputText value="{!ucc.user.login}" id="theLogin"></apex:inputText>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel for="thePassword" value="{!$Label.clm__ms_cd_pswd}"></apex:outputLabel>
                    <apex:inputSecret value="{!ucc.user.password}" id="thePassword"></apex:inputSecret>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel for="theToken" value="{!$Label.clm__ms_cd_token}"></apex:outputLabel>
                    <apex:inputSecret value="{!ucc.user.token}" id="theToken"></apex:inputSecret>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
<!--             <apex:pageBlockButtons location="bottom"> -->
<!--                 <apex:commandButton action="{!ucc.save}" value="Save" rerender="res, mes"/> -->
<!--             </apex:pageBlockButtons> -->
        </apex:pageBlock>
        
         </apex:tab> 
         
     </apex:tabPanel> 
     </apex:outputPanel>
     </apex:pageBlock>
     </apex:form>   
</apex:page>