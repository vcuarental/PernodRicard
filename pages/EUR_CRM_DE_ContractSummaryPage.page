<apex:page standardController="EUR_CRM_Contract__c" extensions="EUR_CRM_DE_ContractBuilderController">

<apex:variable var="PouringRefundWrapper" value="{!mechanicTypeWrapperMap['Pouring Refund']}" />
<apex:variable var="OthersWrapper" value="{!mechanicTypeWrapperMap['Others']}" />
<apex:variable var="DrinksMenuWrapper" value="{!mechanicTypeWrapperMap['Drinks Menu']}" />
<apex:variable var="WKZFixAmountWrapper" value="{!mechanicTypeWrapperMap['WKZ Fix Amount']}" />
<apex:variable var="NapkinsWrapper" value="{!mechanicTypeWrapperMap['Napkins']}" />
<apex:variable var="EventsWrapper" value="{!mechanicTypeWrapperMap['Events']}" />
<apex:variable var="TrainingWrapper" value="{!mechanicTypeWrapperMap['Training']}" />
<apex:variable var="VisibilityWrapper" value="{!mechanicTypeWrapperMap['Visibility/ Branding']}" />
<apex:variable var="POSMaterialWrapper" value="{!mechanicTypeWrapperMap['POS Material']}" />
<apex:variable var="POSWKZWrapper" value="{!mechanicTypeWrapperMap['POS WKZ']}" />
<apex:variable var="HousePouringWrapper" value="{!mechanicTypeWrapperMap['House Pouring']}" />
<apex:variable var="ListingWrapper" value="{!mechanicTypeWrapperMap['Listing']}" />

<head>
<apex:stylesheet value="/sCSS/21.0/sprites/1297816277000/Theme3/default/gc/versioning.css" />   

<apex:stylesheet value="{!URLFOR($Resource.EUR_CRM_jQuery_Lib, '/libs/jquery/css/redmond/jquery-ui-1.10.3.custom.min.css')}" />
<apex:stylesheet value="{!URLFOR($Resource.EUR_CRM_jQuery_Lib, '/styles/common.css')}" />

<link href="{!URLFOR($Resource.EUR_CRM_JQuery_DataTable_German, 'css/jquery.dataTables.css')}" media="screen" rel="stylesheet" type="text/css" />

<apex:includeScript value="{!URLFOR($Resource.EUR_CRM_jQuery_Lib, '/libs/jquery/js/jquery-1.9.1.min.js')}" />
<apex:includeScript value="{!URLFOR($Resource.EUR_CRM_JQuery_DataTable_German, 'js/jquery.dataTables.js')}"/>

<script>
    $ = jQuery.noConflict();

    //var colLabel_Action = "Action";
    var colLabel_Brand = "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Brand__c.label}";
    var colLabel_BrandQuality = "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Brand_Quality__c.label}";
    var colLabel_Volume = 'Volume';
    
    var basicDataTableProperties = {
        "bDestroy":true,
        "bStateSave":true,
        "aaSorting": [[0, "asc"]],
        "bSearch":false,
        "bFilter" : true
    };
    
    //Contract Mechanic Column Definition
    var contractLineItemColumns = [
        {"sTitle": colLabel_Brand}
    ]
    
    //DataTable Variable
    var cliOthers;
    var cmOthers;
    var cliDrinksMenu;
    var cmDrinksMenu;
    var cliWKZFixAmount;
    var cmWKZFixAmount;
    var cliNapkins;
    var cmNapkins;
    var cliEvents;
    var cmEvents;
    var cliTraining;
    var cmTraining;
    var cliVisibility;
    var cmVisibility;
    var cliPOSMaterial;
    var cmPOSMaterial;
    var cliPOSWKZ;
    var cmPOSWKZ;
    var summaryEvents;
    var summaryTraining;
    
    
    $(document).ready(
        function(){
            console.log("##INIT - Contract Builder Page");
            setTables();
            
            console.log("CHECK BUTTONS: {!NOT(ISBLANK(contractObj.EUR_CRM_Contract_Approved_Date__c))} - {!contractObj.EUR_CRM_Active__c}");
            validateButtons();
            hideAllButtons();
        }
    );
    
    function setPouringRefundTable(){
        var cliPouringRefund_dataTableProperties = basicDataTableProperties;
        cliPouringRefund_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_BrandQuality},
            {"sTitle": colLabel_Volume},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Unit__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Amount__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Total_Spent__c.label}"}
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!PouringRefundWrapper.mechanicTypeId}"), function(index, cliPouringRefund) {
            $(cliPouringRefund).dataTable(cliPouringRefund_dataTableProperties);
        });
    }
    
    function setOthersTable(){
        setOthersCLITable();
    }
    
    function setOthersCLITable(){
        var cliOthers_dataTableProperties = basicDataTableProperties;
        cliOthers_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Description__c.label}"}
        ];
        
        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!OthersWrapper.mechanicTypeId}"), function(index, cliOthers) {
            $(cliOthers).dataTable(cliOthers_dataTableProperties);
        });
    }
    
    function setDrinksMenuTable(){
        var cliDrinksMenu_dataTableProperties = basicDataTableProperties;
        cliDrinksMenu_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Description__c.label}"}
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!DrinksMenuWrapper.mechanicTypeId}"), function(index, cliDrinksMenu) {
            $(cliDrinksMenu).dataTable(cliDrinksMenu_dataTableProperties);
        });
    }
    
    function setWKZFixAmountTable(){
        var cliWKZFixAmount_dataTableProperties = basicDataTableProperties;
        cliWKZFixAmount_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": colLabel_Volume},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Unit__c.label}"}
        ]

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!WKZFixAmountWrapper.mechanicTypeId}"), function(index, cliWKZFixAmount) {
            $(cliWKZFixAmount).dataTable(cliWKZFixAmount_dataTableProperties);
        });
    }
    
    function setNapkinsTable(){
        var cliNapkins_dataTableProperties = basicDataTableProperties;
        cliNapkins_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_BrandQuality},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Quantity__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_With_Logo__c.label}"}
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!NapkinsWrapper.mechanicTypeId}"), function(index, cliNapkins) {
            $(cliNapkins).dataTable(cliNapkins_dataTableProperties);
        });
    }

    function setHousePouringTable(){
        var cliHousePouring_dataTableProperties = basicDataTableProperties;
        cliHousePouring_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_BrandQuality}
            <!--{"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Quantity__c.label}"},-->
            <!--{"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_With_Logo__c.label}"}-->
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!HousePouringWrapper.mechanicTypeId}"), function(index, cliHousePourings) {
            $(cliHousePourings).dataTable(cliHousePouring_dataTableProperties);
        });
    }

    function setListingTable(){
        var cliListing_dataTableProperties = basicDataTableProperties;
        cliListing_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_BrandQuality}
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!ListingWrapper.mechanicTypeId}"), function(index, cliListings) {
            $(cliListings).dataTable(cliListing_dataTableProperties);
        });
    }

    function setEventsTable(){
        // cliEvents = setLineItemTable("{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!EventsWrapper.mechanicTypeId}");
        // setEventsSummaryTable();
        setEventsCLITable();
    }

    function setEventsCLITable(){
        var cliOthers_dataTableProperties = basicDataTableProperties;
        cliOthers_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Description__c.label}"}
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!EventsWrapper.mechanicTypeId}"), function(index, cliEvents) {
            $(cliEvents).dataTable(cliOthers_dataTableProperties);
        });
    }

    function setTrainingTable(){
        // cliTraining = setLineItemTable("{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!TrainingWrapper.mechanicTypeId}");
        // setTrainingSummaryTable();
        setTrainingCLITable();
    }

    function setTrainingCLITable(){
        var cliOthers_dataTableProperties = basicDataTableProperties;
        cliOthers_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Product_Item__c.fields.EUR_CRM_Description__c.label}"}
        ];

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!TrainingWrapper.mechanicTypeId}"), function(index, cliTrainings) {
            $(cliTrainings).dataTable(cliOthers_dataTableProperties);
        });
    }
    
    function setVisibilityTable(){
        var cliVisibility_dataTableProperties = basicDataTableProperties;
        cliVisibility_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Description__c.label}"}
        ]

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!VisibilityWrapper.mechanicTypeId}"), function(index, cliVisibility) {
            $(cliVisibility).dataTable(cliVisibility_dataTableProperties);
        });
    }
    
    function setPOSMaterialTable(){
        var cliPOSMaterial_dataTableProperties = basicDataTableProperties;
        cliPOSMaterial_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Description__c.label}"}
        ]

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!POSMaterialWrapper.mechanicTypeId}"), function(index, cliPOSMaterial) {
            $(cliPOSMaterial).dataTable(cliPOSMaterial_dataTableProperties);
        });
    }
    
    function setPOSWKZTable(){
        //cliPOSWKZ = setLineItemTable("{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!POSWKZWrapper.mechanicTypeId}");
        var cliPOSWKZ_dataTableProperties = basicDataTableProperties;
        cliPOSWKZ_dataTableProperties["aoColumns"] = [
            {"sTitle":colLabel_Brand},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Description__c.label}"}
        ]

        $.each($(".{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!POSWKZWrapper.mechanicTypeId}"), function(index, cliPOSWKZ) {
            $(cliPOSWKZ).dataTable(cliPOSWKZ_dataTableProperties);
        });
    }
    
    function setEventsSummaryTable(){
        var summaryEvents_dataTableProperties = basicDataTableProperties;
        summaryEvents_dataTableProperties["aoColumns"] = [
            {"sTitle":"{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.Name.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Description__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Vendor__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Start_Date__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_End_Date__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Amount__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Payment_Term__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Exclude_Budget_Deduction__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Is_PR_Event__c.label}"},
            {"sTitle": "{!$Label.EUR_CRM_Product_List}"}
        ];
        
        summaryEvents =  $("#{!CONTRACT_SUMMARY_ITEM_PREFIX}{!EventsWrapper.mechanicTypeId}").dataTable(summaryEvents_dataTableProperties);
        console.log('Set Summary events');
    }
    
    function setTrainingSummaryTable(){
        var summaryTraining_dataTableProperties = basicDataTableProperties;
        summaryTraining_dataTableProperties["aoColumns"] = [
            {"sTitle":"{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.Name.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Description__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Vendor__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Start_Date__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_End_Date__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Amount__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Payment_Term__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Is_PR_Training__c.label}"},
            {"sTitle": "{!$ObjectType.EUR_CRM_Contract_Activity_Item__c.fields.EUR_CRM_Exclude_Budget_Deduction__c.label}"},
            {"sTitle": "{!$Label.EUR_CRM_Product_List}"}
        ];
        
        summaryTraining =  $("#{!CONTRACT_SUMMARY_ITEM_PREFIX}{!TrainingWrapper.mechanicTypeId}").dataTable(summaryTraining_dataTableProperties);
    }
    
    function setTables(){
        //Set all line item and contract mechanic tables (for all mechanic type)
        setPouringRefundTable();
        setOthersTable();
        setDrinksMenuTable();
        setWKZFixAmountTable();
        setNapkinsTable();
        setEventsTable();
        setTrainingTable();
        setVisibilityTable();
        setPOSMaterialTable();
        setPOSWKZTable();
        setHousePouringTable();
        setListingTable();
    }
    
    function setLineItemTable(lineItemTableId){
        var lineItem_dataTableProperties = basicDataTableProperties;
        lineItem_dataTableProperties ["aoColumns"] = contractLineItemColumns;
        lineItemTable= $("#"+lineItemTableId).dataTable(lineItem_dataTableProperties );
        console.log ("Set Line Item Table: " + lineItemTableId);
    }
    
    function setContractMechanicTable(contractMechanicTableId){
        var contractMechanic_dataTableProperties = basicDataTableProperties;
        contractMechanic_dataTableProperties ["aoColumns"] = contractMechanicColumns;
        contractMechanicTable= $("#"+contractMechanicTableId).dataTable(contractMechanic_dataTableProperties);
         console.log ("Set Contract Mechanic Table: " + contractMechanicTableId);
    }
    
    function validateButtons(){
        $('input[name="eur_crm_activate_contract"]').hide();
       $('input[name="eur_crm_view_volume_tracker"]').hide();
        $('input[name="eur_crm_deactivate_contract"]').hide();
        $('input[name="eur_crm_invoice_tracker"]').hide(); //added dec.17.2014 - rey
         $('input[name="eur_crm_cancel"]').hide(); //New: 12/22/14
        $('input[name="eur_crm_finalize"]').hide(); //New: 12/23/14
        
        //Approved show: publish, cancel, activate 
        if ({!NOT(ISBLANK(contractObj.EUR_CRM_Contract_Approved_Date__c))} || '{!contractObj.EUR_CRM_Status__c}' == 'Submitted'){ 
            $('input[name="edit"]').hide();
            $('input[name="del"]').hide();
            $('input[name="eur_crm_set_contract_details"]').hide();
            
            //$('input[name="eur_crm_publish_contract"]').show();

            if({!NOT(contractObj.EUR_CRM_Active__c)} && {!contractObj.EUR_CRM_Contract_Uploaded__c} 
            &&({!ISBLANK(contractObj.EUR_CRM_Customer_Approved_Date__c)} 
            || ({!NOT(contractObj.EUR_CRM_Contract_Signed__c)} && "{!contractObj.EUR_CRM_Contract_Sub_Type__c}"!="Basic Contract"))){
                $('input[name="eur_crm_finalize"]').show(); //New 12/23/14: Button to invoke custom edit page, to edit customer approved date and signed checkbox
            }
        }
        
        if (({!NOT(ISBLANK(contractObj.EUR_CRM_Contract_Approved_Date__c))}
            && {!NOT(contractObj.EUR_CRM_Active__c)} 
            && {!contractObj.EUR_CRM_Contract_Uploaded__c}
                && {!NOT(ISBLANK(contractObj.EUR_CRM_Customer_Approved_Date__c))}
                && (
                    ({!contractObj.EUR_CRM_Contract_Signed__c})
                    || ({!NOT(contractObj.EUR_CRM_Contract_Signed__c)} && "{!contractObj.EUR_CRM_Contract_Sub_Type__c}"=="Basic Contract")))
            || (("{!contractObj.EUR_CRM_Contract_Sub_Type__c}"=="Concept Contract")
                && '{!contractObj.EUR_CRM_Status__c}' == 'Approved')
            )
        {
            $('input[name="eur_crm_activate_contract"]').show();
        }
        
        //Active show: Deactivate, Volume Tracker, Invoice Tracker
        console.log('Validate buttons:' + "{!ISBLANK(contractObj.EUR_CRM_Contract_Approved_Date__c)} "+" {!NOT(contractObj.EUR_CRM_Active__c)}");
        if ({!contractObj.EUR_CRM_Active__c}){
            $('input[name="eur_crm_activate_contract"]').hide();
            $('input[name="eur_crm_view_volume_tracker"]').show();
            $('input[name="eur_crm_deactivate_contract"]').show();
            $('input[name="eur_crm_invoice_tracker"]').show();//added dec.17.2014 - rey
        }
        
        if({!IF(OR(ISBLANK(contractObj.EUR_CRM_DE_Actual_Contract_Total__c), contractObj.EUR_CRM_DE_Actual_Contract_Total__c<=0, contractObj.EUR_CRM_Contract_Uploaded__c, contractObj.EUR_CRM_Status__c == 'Activated'), true, false)}){
            $('input[name="eur_crm_publish_contract"]').hide();
        }
        
        //added dec.17.2014 - rey
        console.log("FLAG - CONTRACT STATUS - VALIDATE BUTTONS:" + '{!contractObj.EUR_CRM_Status__c}');
        if('{!contractObj.EUR_CRM_Status__c}' == 'Activated' || '{!contractObj.EUR_CRM_Status__c}' == 'Deactivated'){
            console.log('approved!');
            $('input[name="eur_crm_invoice_tracker"]').show();//added dec.17.2014 - rey
            $('input[name="eur_crm_view_volume_tracker"]').show(); //Edit:12/22/14
        }
        
        if('{!contractObj.EUR_CRM_Status__c}' == 'Deactivated'){
            $('input[name="eur_crm_activate_contract"]').hide();
        }
        
        //Start - Add: 12/18 - Hide Submit for Approval if remaining balance (including contract reserve) is less than 0 
        console.log("Check Rem balance:" + {!contractObj.EUR_CRM_Budget_Balance_Reference__c}<0 + "--" +{!contractObj.EUR_CRM_Budget_Balance_Reference__c});
        //if({!contractObj.EUR_CRM_Budget_Balance_Reference__c}<0){
        if({!isInsufficientBalance}){
            // $('input[name="piSubmit"]').hide();
            $('input[name="submit"]').hide();
        }
        //End
        
        //New: 12/22 - Show Cancel button, when contract is not signed yet (no contract copy uploaded yet)
        if ({!NOT(contractObj.EUR_CRM_Contract_Uploaded__c)} && "{!contractObj.EUR_CRM_Status__c}" != "Cancelled"&& "{!contractObj.EUR_CRM_Status__c}" != "Activated"){
            $('input[name="eur_crm_cancel"]').show();
        }

        if('{!userProfileName}' == 'EUR DE ON Trade Customer Service User'  ){
            $("input[type=button]").hide(); 
             if('{!contractObj.EUR_CRM_Status__c}' == 'Activated' || '{!contractObj.EUR_CRM_Status__c}' == 'Deactivated'){
                console.log('approved!');
                 $('input[name="eur_crm_invoice_tracker"]').show();//added dec.17.2014 - rey
            }
        }

        var submitOnclick = $($('input[name="submit"]')[0]).attr('onclick');
        if(submitOnclick){
            submitOnclick = submitOnclick.toString().replace(/(confirm|Confirm)\((.*?)\)/g, "confirm('{!$Label.EUR_CRM_Contract_Submit}')");
            $('input[name="submit"]').attr('onclick', submitOnclick);
        }
    }
    
    function hideAllButtons(){
        if ("{!contractObj.EUR_CRM_Status__c}" == "Cancelled"){
            $("input[type=button]").hide();
        }
    }
</script>
</head>
    <apex:actionStatus id="loadingStatus">
        <apex:facet name="start">
            <c:EUR_CRM_LoadingStatus BackColor="#ffffff" borderColor="#6B6B6B"
                borderSize="1" height="50px" width="150px" margintop="-25px"
                marginleft="-60px" ImageUrl="{!$Resource.loadingStatus}"
                Message="Loading..." />
        </apex:facet>
    </apex:actionStatus>
    
        <apex:pageMessages /> 
            <apex:pageMessage summary="{!$Label.EUR_CRM_NoApproval_RemBalanceBelow0}" severity="warning" strength="3" 
            rendered="{!IF(isInsufficientBalance && contractObj.EUR_CRM_Status__c == 'Draft', true, false)}"/>  
            <apex:pageMessage summary="{!$Label.EUR_CRM_RequireFinalizeContractButton}" severity="warning" strength="3" rendered="{!IF(AND(
            NOT(ISBLANK(contractObj.EUR_CRM_Contract_Approved_Date__c)), 
            NOT(contractObj.EUR_CRM_Active__c), 
            contractObj.EUR_CRM_Contract_Uploaded__c, 
            OR(
                ISBLANK(contractObj.EUR_CRM_Customer_Approved_Date__c), 
                AND(
                        NOT(contractObj.EUR_CRM_Contract_Signed__c), 
                        OR(
                            contractObj.EUR_CRM_Contract_Sub_Type__c!='Basic Contract'
                        )
                    )
                )
            ), true, false)}"/>
            
            <apex:pageMessage summary="{!$Label.EUR_CRM_RequireActivateContractButton}" severity="warning" strength="3" 
                rendered="{!   contractObj.EUR_CRM_Contract_Uploaded__c &&
                              !contractObj.EUR_CRM_Active__c &&
                              !ISBLANK(contractObj.EUR_CRM_Customer_Approved_Date__c)&&
                              contractObj.eur_crm_status__c == 'Approved' &&
                               ((contractObj.EUR_CRM_Contract_Signed__c && contractObj.EUR_CRM_Contract_Sub_Type__c!='Basic Contract') || contractObj.EUR_CRM_Contract_Sub_Type__c=='Basic Contract') }"/>
            
            <!--<apex:pageMessage summary="{!$Label.EUR_CRM_AttachContractPDF}" severity="warning" strength="3" -->
            <!--rendered="{! !contractObj.EUR_CRM_Contract_Uploaded__c &&-->
                          <!--contractObj.eur_crm_status__c == 'Approved' &&-->
                          <!--(contractObj.EUR_CRM_Contract_Type__c == 'Flagship Contract' ||-->
                           <!--contractObj.EUR_CRM_DE_Actual_Contract_Total__c  > 3500)}"/>-->

        <br/>
        <div class="bPageTitle ">
        <div class="ptBreadcrumb">
        &nbsp;Â«&nbsp;
        <apex:outputLink value="/{!LEFT(EUR_CRM_Contract__c.Id,3)}">Back to List: Contracts</apex:outputLink>
        </div>
        </div>
        
        <apex:detail subject="{!EUR_CRM_Contract__c.Id}" relatedList="false" title="true" 
            inlineEdit="{!IF(ISBLANK(contractObj.EUR_CRM_Contract_Approved_Date__c),false,false)}">
        </apex:detail>
        <apex:pageBlock title="{!$Label.EUR_CRM_User_Budget_Details}" rendered="false">
            <apex:pageBlockSection columns="2">
                <apex:outputField value="{!contractObj.EUR_CRM_Budget__c}"/>
                <apex:pageBlockSectionItem >
                <apex:outputLabel value="Remaining Contract Balance"/>
                <apex:outputText value="{!remainingUserBudgetTotalStr}"/>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!contractObj.EUR_CRM_Budget__r.EUR_CRM_Current_Balance__c}"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:relatedList list="EUR_CRM_Contract_Focus_Brands__r" title="{!$Label.EUR_CRM_Contract_Focus_Brand}"/>
        <apex:relatedList list="EUR_CRM_Contract_Listing_Pouring__r" title="{!$Label.EUR_CRM_Contract_Pouring_Listing}"/>
        
        <apex:form >
        <apex:pageBlock title="{!$Label.EUR_CRM_Contract_Activity_Item}">

            <apex:pageBlockSection title="{!HousePouringWrapper.mechanicTypeTranslatedName}" columns="1"
                                   rendered="{!HousePouringWrapper.hasProductItems}">
                <apex:repeat var="caKey" value="{!HousePouringWrapper.contractActivityItems}">
                    <apex:repeat var="caObj" value="{!HousePouringWrapper.contractActivityItems[caKey]}">
                        <apex:pageBlock id="pageBlock_HousePouring">
                            <apex:pageBlockSection id="section_lineItem_HousePouring" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                                <apex:outputPanel layout="block">
                                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!HousePouringWrapper.mechanicTypeId}">
                                        <tbody>
                                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                                            <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                                                <tr class="dataRow">
                                                    <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand_Quality__c}"/></td>
                                                </tr>
                                            </apex:repeat>
                                        </apex:repeat>
                                        </tbody>
                                    </table>
                                </apex:outputPanel>
                            </apex:pageBlockSection>
                        </apex:pageBlock>
                    </apex:repeat>
                </apex:repeat>
            </apex:pageBlockSection>

            <apex:pageBlockSection title="{!ListingWrapper.mechanicTypeTranslatedName}" columns="1"
                                   rendered="{!ListingWrapper.hasProductItems}">
                <apex:repeat var="caKey" value="{!ListingWrapper.contractActivityItems}">
                    <apex:repeat var="caObj" value="{!ListingWrapper.contractActivityItems[caKey]}">
                        <apex:pageBlock id="pageBlock_Listing">
                            <apex:pageBlockSection id="section_lineItem_Listing" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                                <apex:outputPanel layout="block">
                                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!ListingWrapper.mechanicTypeId}">
                                        <tbody>
                                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                                            <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                                                <tr class="dataRow">
                                                    <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand_Quality__c}"/></td>
                                                </tr>
                                            </apex:repeat>
                                        </apex:repeat>
                                        </tbody>
                                    </table>
                                </apex:outputPanel>
                            </apex:pageBlockSection>
                        </apex:pageBlock>
                    </apex:repeat>
                </apex:repeat>
            </apex:pageBlockSection>
        <apex:pageBlockSection title="{!PouringRefundWrapper.mechanicTypeTranslatedName}" columns="1" 
        rendered="{!PouringRefundWrapper.hasProductItems}">
            <apex:repeat var="caKey" value="{!PouringRefundWrapper.contractActivityItems}">
            <apex:repeat var="caObj" value="{!PouringRefundWrapper.contractActivityItems[caKey]}">
                <apex:pageBlock id="pageBlock_PouringRefund">
                    <apex:pageBlockSection columns="2" rendered="true" >
                        <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                        <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Total_Pouring_Refund__c}" rendered="{!!caObj.isOldContract}" />
                        <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Product_Items_Total__c}" rendered="{!caObj.isOldContract}"/>
                        <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                        <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                        <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                    </apex:pageBlockSection>
                    <apex:pageBlockSection id="section_lineItem_PouringRefund" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                        <apex:outputPanel layout="block" id="panel_lineItem_PouringRefund">
                            <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!PouringRefundWrapper.mechanicTypeId}">
                                <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                                <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                                <tr class="dataRow">
                                    <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand_Quality__c}"/></td>
                                    <td>
                                        <apex:outputField value="{!cpiObj.EUR_CRM_Volume_lt__c}" rendered="{!!caObj.isOldContract}"/>
                                        <apex:outputField value="{!cpiObj.EUR_CRM_Quantity__c}" rendered="{!caObj.isOldContract}"/>
                                    </td>
                                    <td><apex:outputField value="{!cpiObj.EUR_CRM_Unit__c}"/></td>
                                    <td><apex:outputField value="{!cpiObj.EUR_CRM_Amount__c}"/></td>
                                    <td>
                                        <apex:outputField value="{!cpiObj.EUR_CRM_Total_Spent__c}" rendered="{!!caObj.isOldContract}"/>
                                        <apex:outputField value="{!cpiObj.EUR_CRM_Amount_Spent__c}" rendered="{!caObj.isOldContract}"/>
                                    </td>
                                </tr>
                                </apex:repeat>
                                </apex:repeat>
                            </table>
                        </apex:outputPanel>
                    </apex:pageBlockSection>
                </apex:pageBlock>
            </apex:repeat>
            </apex:repeat>
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!WKZFixAmountWrapper.mechanicTypeTranslatedName}" columns="1"
        rendered="{!WKZFixAmountWrapper.hasProductItems}">
        <apex:repeat var="caKey" value="{!WKZFixAmountWrapper.contractActivityItems}">
        <apex:repeat var="caObj" value="{!WKZFixAmountWrapper.contractActivityItems[caKey]}">
        <apex:pageBlock id="pageBlock_WKZFixAmount">
           <apex:pageBlockSection columns="2" rendered="true" >
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!WKZFixAmountWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
               <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
               <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
           </apex:pageBlockSection>
            <apex:pageBlockSection id="section_lineItem_WKZFixAmount" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                <apex:outputPanel layout="block">
                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!WKZFixAmountWrapper.mechanicTypeId}">
                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                        <tr class="dataRow">
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                            <td>
                                <apex:outputField value="{!cpiObj.EUR_CRM_Volume_lt__c}" rendered="{!!caObj.isOldContract}"/>
                                <apex:outputField value="{!cpiObj.EUR_CRM_Quantity__c}" rendered="{!caObj.isOldContract}"/>
                            </td>
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Unit__c}"/></td>
                        </tr>
                        </apex:repeat>
                        </apex:repeat>
                    </table>
                </apex:outputPanel>
            </apex:pageBlockSection>
        </apex:pageBlock>
        </apex:repeat>
        </apex:repeat>
        </apex:pageBlockSection>

        <apex:pageBlockSection title="{!DrinksMenuWrapper.mechanicTypeTranslatedName}" columns="1"
             rendered="{!DrinksMenuWrapper.hasProductItems}">
            <apex:repeat var="caKey" value="{!DrinksMenuWrapper.contractActivityItems}">
            <apex:repeat var="caObj" value="{!DrinksMenuWrapper.contractActivityItems[caKey]}">
            <apex:pageBlock id="pageBlock_DrinksMenu">
                <apex:pageBlockSection columns="2" rendered="true" >
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!DrinksMenuWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                </apex:pageBlockSection>
                <apex:pageBlockSection id="section_lineItem_DrinksMenu" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                    <apex:outputPanel layout="block">
                        <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!DrinksMenuWrapper.mechanicTypeId}">
                            <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                            <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                            <tr class="dataRow">
                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>
                            </tr>
                            </apex:repeat>
                            </apex:repeat>
                        </table>
                    </apex:outputPanel>
                </apex:pageBlockSection>
            </apex:pageBlock>
            </apex:repeat>
            </apex:repeat>
        </apex:pageBlockSection>
                        
        <apex:pageBlockSection title="{!EventsWrapper.mechanicTypeTranslatedName}" columns="1"
        rendered="{!EventsWrapper.hasProductItems}">
            <apex:repeat var="caKey" value="{!EventsWrapper.contractActivityItems}">
                <apex:repeat var="caObj" value="{!EventsWrapper.contractActivityItems[caKey]}">
                    <apex:pageBlock id="pageBlock_Events">
                        <apex:pageBlockSection columns="2" rendered="true" >
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!EventsWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}" />
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Is_PR_Event__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}" rendered="{!EventsWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="section_lineItem_Events" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                            <apex:outputPanel layout="block" id="panel_lineItem_Events">
                                <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!EventsWrapper.mechanicTypeId}">
                                    <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                                            <tr class="dataRow">
                                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </apex:repeat>
                                </table>
                            </apex:outputPanel>
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:repeat>
            </apex:repeat>
        <!--<apex:pageBlock id="pageBlock_EventSummary" rendered="{!NOT(EventsWrapper.isEditMode)}">-->
            <!--<apex:outputPanel layout="block">-->
                <!--<table id="{!CONTRACT_SUMMARY_ITEM_PREFIX}{!EventsWrapper.mechanicTypeId}">-->
                    <!--<apex:repeat var="caKey" value="{!EventsWrapper.contractActivityItems}">-->
                    <!--<apex:repeat var="caObj" value="{!EventsWrapper.contractActivityItems[caKey]}">-->
                    <!--<tr class="dataRow">-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Name__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Description__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Is_PR_Event__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<table>-->
                                <!--<apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">-->
                                <!--<apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">-->
                                <!--<tr class="dataRow">-->
                                    <!--<td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}" rendered="{!IF(cpiObj.EUR_CRM_Brand__c!=null,true,false)}"/>-->
                                        <!--<apex:outputField value="{!cpiObj.EUR_CRM_Description__c}" rendered="{!IF(AND(cpiObj.EUR_CRM_Description__c!=null,cpiObj.EUR_CRM_Brand__c==null),true,false)}"/>-->
                                    <!--</td>-->
                                <!--</tr>-->
                                <!--</apex:repeat>-->
                                <!--</apex:repeat>-->
                            <!--</table>-->
                        <!--</td>-->
                    <!--</tr>-->
                    <!--</apex:repeat>-->
                    <!--</apex:repeat>-->
                <!--</table>-->
            <!--</apex:outputPanel>-->
        <!--</apex:pageBlock>-->
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!VisibilityWrapper.mechanicTypeTranslatedName}" columns="1"
        rendered="{!VisibilityWrapper.hasProductItems}">
        <apex:repeat var="caKey" value="{!VisibilityWrapper.contractActivityItems}">
        <apex:repeat var="caObj" value="{!VisibilityWrapper.contractActivityItems[caKey]}">
        <apex:pageBlock id="pageBlock_VisibilityBranding">
            <apex:pageBlockSection columns="2" rendered="true" >
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!VisibilityWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}" />
                <apex:pageBlockSectionItem rendered="{!NOT(VisibilityWrapper.mechanicType.EUR_CRM_Has_Vendor__c)}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection id="section_lineItem_VisibilityBranding" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                <apex:outputPanel layout="block">
                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!VisibilityWrapper.mechanicTypeId}">
                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                        <tr class="dataRow">
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>
                        </tr>
                        </apex:repeat>
                        </apex:repeat>
                    </table>
                </apex:outputPanel>
            </apex:pageBlockSection>
        </apex:pageBlock>
        </apex:repeat>
        </apex:repeat>
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!POSMaterialWrapper.mechanicTypeTranslatedName}" columns="1"
        rendered="{!POSMaterialWrapper.hasProductItems}">
        <apex:repeat var="caKey" value="{!POSMaterialWrapper.contractActivityItems}">
        <apex:repeat var="caObj" value="{!POSMaterialWrapper.contractActivityItems[caKey]}">
        <apex:pageBlock id="pageBlock_POSMaterial">
            <apex:pageBlockSection columns="2" rendered="true" >
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!POSMaterialWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}" />
                <apex:pageBlockSectionItem rendered="{!NOT(POSMaterialWrapper.mechanicType.EUR_CRM_Has_Vendor__c)}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}" rendered="{!POSMaterialWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="section_lineItem_POSMaterial" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                <apex:outputPanel layout="block">
                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!POSMaterialWrapper.mechanicTypeId}">
                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                        <tr class="dataRow">
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>
                        </tr>
                        </apex:repeat>
                        </apex:repeat>
                    </table>
                </apex:outputPanel>
            </apex:pageBlockSection>
        </apex:pageBlock>
        </apex:repeat>
        </apex:repeat>
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!POSWKZWrapper.mechanicTypeTranslatedName}" columns="1"
        rendered="{!POSWKZWrapper.hasProductItems}">
        <apex:repeat var="caKey" value="{!POSWKZWrapper.contractActivityItems}">
        <apex:repeat var="caObj" value="{!POSWKZWrapper.contractActivityItems[caKey]}">
        <apex:pageBlock id="pageBlock_POSWKZ">
            <apex:pageBlockSection columns="2" rendered="true" >
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!POSWKZWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}" rendered="{!POSWKZWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="section_lineItem_POSWKZ" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                <apex:outputPanel layout="block">
                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!POSWKZWrapper.mechanicTypeId}">
                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                        <tr class="dataRow">
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>

                        </tr>
                        </apex:repeat>
                        </apex:repeat>
                    </table>
                </apex:outputPanel>
            </apex:pageBlockSection>
        </apex:pageBlock>
        </apex:repeat>
        </apex:repeat>
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!NapkinsWrapper.mechanicTypeTranslatedName}" columns="1"
         rendered="{!NapkinsWrapper.hasProductItems}">
        <apex:repeat var="caKey" value="{!NapkinsWrapper.contractActivityItems}">
        <apex:repeat var="caObj" value="{!NapkinsWrapper.contractActivityItems[caKey]}">
        <apex:pageBlock id="pageBlock_Napkins">
            <apex:pageBlockSection columns="2" rendered="true" >
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!NapkinsWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}" rendered="{!NapkinsWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
                <apex:pageBlockSectionItem rendered="{!NapkinsWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
                <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Product_Qty_Total__c}"/>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="section_lineItem_Napkins" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                <apex:outputPanel layout="block">
                    <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!NapkinsWrapper.mechanicTypeId}">
                        <tbody>
                        <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                        <tr class="dataRow">
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_Quantity__c}"/></td>
                            <td><apex:outputField value="{!cpiObj.EUR_CRM_With_Logo__c}"/></td>
                        </tr>
                        </apex:repeat>
                        </apex:repeat>
                        </tbody>
                    </table>
                </apex:outputPanel>
            </apex:pageBlockSection>
        </apex:pageBlock>
        </apex:repeat>
        </apex:repeat>
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="{!TrainingWrapper.mechanicTypeTranslatedName}" columns="1"
        rendered="{!TrainingWrapper.hasProductItems}">
            <apex:repeat var="caKey" value="{!TrainingWrapper.contractActivityItems}">
                <apex:repeat var="caObj" value="{!TrainingWrapper.contractActivityItems[caKey]}">
                    <apex:pageBlock id="pageBlock_Trainings">
                        <apex:pageBlockSection columns="2" rendered="true" >
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!TrainingWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}" />
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Is_PR_Training__c}"/>
                            <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}" rendered="{!TrainingWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="section_lineItem_Trainings" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                            <apex:outputPanel layout="block" id="panel_lineItem_Trainings">
                                <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!TrainingWrapper.mechanicTypeId}">
                                    <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                                        <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                                            <tr class="dataRow">
                                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>
                                            </tr>
                                        </apex:repeat>
                                    </apex:repeat>
                                </table>
                            </apex:outputPanel>
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:repeat>
            </apex:repeat>
        <!--<apex:pageBlock id="pageBlock_TrainingSummary" rendered="{!NOT(TrainingWrapper.isEditMode)}">-->
            <!--<apex:outputPanel layout="block">-->
                <!--<table id="{!CONTRACT_SUMMARY_ITEM_PREFIX}{!TrainingWrapper.mechanicTypeId}">-->
                    <!--<apex:repeat var="caKey" value="{!TrainingWrapper.contractActivityItems}">-->
                    <!--<apex:repeat var="caObj" value="{!TrainingWrapper.contractActivityItems[caKey]}">-->
                    <!--<tr class="dataRow">-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Name__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Description__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Is_PR_Training__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}"/>-->
                        <!--</td>-->
                        <!--<td>-->
                            <!--<table>-->
                                <!--<apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">-->
                                <!--<apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">-->
                                <!--<tr class="dataRow">-->
                                    <!--<td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}" rendered="{!IF(cpiObj.EUR_CRM_Brand__c!=null,true,false)}"/>-->
                                        <!--<apex:outputField value="{!cpiObj.EUR_CRM_Description__c}" rendered="{!IF(AND(cpiObj.EUR_CRM_Description__c!=null,cpiObj.EUR_CRM_Brand__c==null),true,false)}"/>-->
                                    <!--</td>-->
                                <!--</tr>-->
                                <!--</apex:repeat>-->
                                <!--</apex:repeat>-->
                            <!--</table>-->
                        <!--</td>-->
                    <!--</tr>-->
                    <!--</apex:repeat>-->
                    <!--</apex:repeat>-->
                <!--</table>-->
            <!--</apex:outputPanel>-->
        <!--</apex:pageBlock>-->
        </apex:pageBlockSection>
        
         <apex:pageBlockSection title="{!OthersWrapper.mechanicTypeTranslatedName}" columns="1"
         rendered="{!OthersWrapper.hasProductItems}">
            <apex:repeat var="caKey" value="{!OthersWrapper.contractActivityItems}">
            <apex:repeat var="caObj" value="{!OthersWrapper.contractActivityItems[caKey]}">
            <apex:pageBlock id="pageBlock_Others">
                <apex:pageBlockSection columns="2" rendered="true" >
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Vendor__c}" rendered="{!OthersWrapper.mechanicType.EUR_CRM_Has_Vendor__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Amount__c}" />
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Start_Date__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term__c}" />
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_End_Date__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Payment_Term_By_SR__c}" rendered="{!caObj.isOldContract}" />
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Is_PR_Other__c}"/>
                    <apex:outputField value="{!caObj.contractActivityItem.EUR_CRM_Exclude_Budget_Deduction__c}" rendered="{!OthersWrapper.mechanicType.EUR_CRM_Has_Budget_Exclusion_Option__c}"/>
                </apex:pageBlockSection>
                <apex:pageBlockSection id="section_lineItem_Others" title="{!$Label.EUR_CRM_Contract_Line_Items}" columns="1">
                    <apex:outputPanel layout="block" id="panel_lineItem_Others">
                        <table class="{!CONTRACT_LINE_ITEM_TABLE_PREFIX}{!OthersWrapper.mechanicTypeId}">
                            <apex:repeat var="cpiKey" value="{!caObj.contractProductItems}">
                            <apex:repeat var="cpiObj" value="{!caObj.contractProductItems[cpiKey]}">
                            <tr class="dataRow">
                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Brand__c}"/></td>
                                <td><apex:outputField value="{!cpiObj.EUR_CRM_Description__c}"/></td>
                            </tr>
                            </apex:repeat>
                            </apex:repeat>
                        </table>
                    </apex:outputPanel>
                </apex:pageBlockSection>
            </apex:pageBlock>
            </apex:repeat>
            </apex:repeat>
        </apex:pageBlockSection>

    </apex:pageBlock>
    </apex:form>
    
    <apex:relatedList list="EUR_CRM_Volume_Trackers__r"/>
    <apex:relatedList list="ProcessSteps"/>
    <apex:relatedList list="CombinedAttachments"/>
    
    

</apex:page>