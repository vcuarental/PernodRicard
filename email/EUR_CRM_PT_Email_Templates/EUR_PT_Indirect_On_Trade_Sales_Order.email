<messaging:emailTemplate subject="New Order for {!Relatedto.EUR_CRM_Account__r.Name} - {!Relatedto.Name}" recipientType="User" relatedToType="EUR_CRM_Sales_Order__c"    language="en_GB"><messaging:HtmlEmailBody > Caro Parceiro {!Relatedto.EUR_CRM_Distributor__r.Name}, <br/> <br/>Por favor considere a encomenda abaixo:<br/>  <apex:outputPanel layout="none"> <br/> <table> <tr>            <td>                <strong>Número de Emcomenda: </strong>            </td>            <td>               {!Relatedto.Name}             </td>        </tr>               <tr>            <td>                <strong>Nome de cliente: </strong>            </td>            <td>               {!Relatedto.EUR_CRM_Account__r.Name}             </td>        </tr>              <tr>            <td>                <strong>Numero de contribuinte de cliente: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_Account_VAT_Number__c}            </td>        </tr>         <tr>            <td>                <strong>Contacto: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_Contact__r.Name}            </td>        </tr>           <tr>            <td>                <strong>Morada: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_Street__c}            </td>        </tr>        <tr>            <td>                <strong>Cidade: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_City__c}            </td>        </tr>              <br/>        <tr>            <td>                <strong>Distribuidor: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_Distributor__r.Name}            </td>        </tr>         <tr>            <td>                <strong>Email Distribuidor: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_Distributor_Email__c}            </td>        </tr>         <tr>            <td>                <strong>Data da Encomenda: </strong>            </td>            <td>                <apex:outputText value="{0,date,dd/MM/yyyy}">                    <apex:param value="{!Relatedto.EUR_CRM_Order_Date__c}" />                </apex:outputText>            </td>        </tr>        <tr>            <td>                <strong>Status da Encomenda: </strong>            </td>            <td>                {!Relatedto.EUR_CRM_Order_Status__c}            </td>        </tr>                                                <tr>            <td>                <strong>Data de Entrega: </strong>            </td>            <td>                <apex:outputText value="{0,date,dd/MM/yyyy}">                    <apex:param value="{!Relatedto.EUR_CRM_Delivery_Date__c}" />                </apex:outputText>            </td>        </tr>                <tr>            <td>                <strong>Período de entrega: </strong>            </td>            <td>              {!Relatedto.EUR_CRM_Delivery_Time_Range__c}            </td>        </tr>         </table>       </apex:outputPanel>    <apex:outputPanel layout="none" rendered="{!RelatedTo.EUR_CRM_Street__c != RelatedTo.EUR_CRM_Delivery_Street__c}">        <br/>        <table>            <tr>                <td>                    <strong>Morada Alternativa: </strong>                </td>            </tr>            <tr>                <td>                    <strong>Contacto Entrega: </strong>                 </td>                <td>                    {!RelatedTo.EUR_CRM_Delivery_Contact__c}                </td>            </tr>            <tr>                <td>                        <strong>Morada Entrega: </strong>                </td>                <td>                    {!RelatedTo.EUR_CRM_Delivery_Street__c}                </td>            </tr>            <tr>                <td>                    <strong>Localidade Entrega: </strong>                </td>                <td>                    {!RelatedTo.EUR_CRM_Delivery_City__c}                </td>            </tr>        </table>        </apex:outputPanel><br/><strong>Notas: </strong> <br/>{!Relatedto.EUR_CRM_Notes__c}<br/><br/><table style="border: 1px solid black; border-collapse: collapse; text-align:left; ">    <tr style="">        <th style="border: 1px solid black; padding: 5px;">            <strong>                SKU ID            </strong>        </th>        <th style="border: 1px solid black; padding: 5px;">            <strong>                Descrição SKU            </strong>        </th>                <th style="border: 1px solid black; padding: 5px;">            <strong>                Unidade            </strong>        </th>        <th style="border: 1px solid black; padding: 5px;">            <strong>                Quantidade            </strong>        </th>           </tr><apex:repeat var="item" value="{!relatedTo.Sales_Order_Items__r}">    <tr style="padding: 10px;">        <td style="border: 1px solid black;padding: 6px;">            {!item.EUR_CRM_SKU__r.EUR_CRM_SKU_Code__c}         </td>                 <td style="border: 1px solid black;padding: 6px;">            {!item.EUR_CRM_SKU__r.Name}        </td>                    <td style="border: 1px solid black;padding: 6px;">            {!item.EUR_CRM_Unit__c}         </td>       <td style="border: 1px solid black;padding: 6px;">             {!Text(item.EUR_CRM_Quantity__c)}         </td>            </tr></apex:repeat></table><br/>Para ver mais detalhes da encomenda aceda a este link: <a href="{!LEFT($Api.Partner_Server_URL_340, FIND(".com/",$Api.Partner_Server_URL_340)+3)}/{!relatedTo.Id}">        {!relatedTo.Name}    </a>   <br/>Esta encomenda foi preparada por {!Relatedto.CreatedBy.Name} <apex:outputText rendered="{!Relatedto.CreatedBy.MobilePhone != null}"> ({!Relatedto.CreatedBy.MobilePhone}) </apex:outputText><apex:outputText rendered="{!Relatedto.CreatedBy.Email != null}"> ({!Relatedto.CreatedBy.Email}) </apex:outputText> </messaging:htmlEmailBody></messaging:emailTemplate>