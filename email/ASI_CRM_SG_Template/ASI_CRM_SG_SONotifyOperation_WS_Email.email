<messaging:emailTemplate subject="Sales Order Request {!relatedTo.Name} (Revision {!relatedTo.ASI_CRM_SG_Version_No__c}) has been submitted by {!RelatedTo.ASI_CRM_SG_Ship_To__r.name}" recipientType="User" relatedToType="ASI_KOR_Sales_Order_Request__c"><messaging:htmlEmailBody > <html>    <body>        <p>            Please note the following Sales Order Request has been submitted by {!RelatedTo.ASI_CRM_SG_Ship_To__r.name}.         </p>         <table>            <tr>                <td>                Sales Order Request Name&nbsp;                </td>                <td>                 : {!RelatedTo.name}                </td>            </tr>            <tr>                <td>                Version No.&nbsp;                </td>                <td>                 : {!RelatedTo.ASI_CRM_SG_Version_No__c}                </td>            </tr>            <tr>                <td>                Owner&nbsp;                </td>                <td>                 : {!RelatedTo.Owner.name}                </td>            </tr>            <tr>                <td>                Order Date&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,date,dd/MM/yyyy}">                     <apex:param value="{!RelatedTo.ASI_CRM_SG_Order_Date__c}" />                 </apex:outputText>                </td>            </tr>            <tr>                <td>                Expected Delivery Date&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,date,dd/MM/yyyy}">                     <apex:param value="{!RelatedTo.ASI_CRM_Expected_Delivery_Date__c}" />                 </apex:outputText>                </td>            </tr>                       <tr>                <td>                Customer PO No.&nbsp;                </td>                <td>                 : {!RelatedTo.ASI_KOR_Customer_PO_No__c}                </td>            </tr>            <tr>                <td>                Ship To&nbsp;                </td>                <td>                 : {!RelatedTo.ASI_CRM_SG_Ship_To__r.name}                </td>            </tr>            <tr>                <td>                Alternate Address&nbsp;                </td>                <td>                 : {!RelatedTo.ASI_CRM_Alternate_Address_Line_1__c}                </td>            </tr>            <tr>                <td>                </td>                <td>                &nbsp;&nbsp;{!RelatedTo.ASI_CRM_Alternate_Address_Line_2__c}                </td>            </tr>            <tr>                <td>                </td>                <td>                &nbsp;&nbsp;{!RelatedTo.ASI_CRM_Alternate_Address_Line_3__c}                </td>            </tr>            <tr>                <td>                </td>                <td>                &nbsp;&nbsp;{!RelatedTo.ASI_CRM_Alternate_Address_Line_4__c}                </td>            </tr>            <tr>                <td>                Delivery Remarks&nbsp;                </td>                <td>                 : {!RelatedTo.ASI_CRM_Delivery_Remarks__c}                </td>            </tr>            <tr>                <td>                Wholesaler Remarks&nbsp;                </td>                <td>                 : {!RelatedTo.ASI_CRM_Remarks__c}                </td>            </tr>            <tr>                <td>                Total Price&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,number,#,##0}" style="color:{!IF(RelatedTo.ASI_CRM_SG_Total_Price__c < 20000, 'red', 'black')};">                        <apex:param value="{!RelatedTo.ASI_CRM_SG_Total_Price__c}"/>                    </apex:outputText>                </td>            </tr>                       <tr>                <td>                Total Request Quantity (Bottle)&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,number,#,##0}">                        <apex:param value="{!RelatedTo.ASI_CRM_SG_Total_Request_Quantity_Bottle__c}"/>                    </apex:outputText>                </td>            </tr>            <tr>                <td>                Total FOC (Computed)&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,number,#,##0}">                        <apex:param value="{!RelatedTo.ASI_CRM_SG_Total_FOC__c}"/>                    </apex:outputText>                </td>            </tr>            <tr>                <td>                Total FOC (Additional)&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,number,#,##0}">                        <apex:param value="{!RelatedTo.ASI_CRM_Total_FOC_Additional__c}"/>                    </apex:outputText>                </td>            </tr>            <tr>                <td>                Total FOC&nbsp;                </td>                <td>                 :&nbsp; <apex:outputText value="{0,number,#,##0}">                        <apex:param value="{!RelatedTo.ASI_CRM_SG_Total_FOC__c + RelatedTo.ASI_CRM_Total_FOC_Additional__c}"/>                    </apex:outputText>                </td>            </tr>        </table>        <p>        To view the Sales Order Request, click this&nbsp;         <apex:outputLink value="{!LEFT($Api.Partner_Server_URL_140, FIND('.com/',$Api.Partner_Server_URL_140)+3)}/{!RelatedTo.id}">link</apex:outputLink>        </p>    </body> </html></messaging:htmlEmailBody><messaging:attachment renderAs="PDF"  filename="Sales Order Request - {!RelatedTo.name}">    <c:ASI_CRM_SG_SalesOrderPDFComponent headerId="{!RelatedTo.Id}"/></messaging:attachment></messaging:emailTemplate>