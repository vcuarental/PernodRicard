<messaging:emailTemplate subject=" {!relatedto.ASI_MFM_Urgent_Text__c} {!if(relatedto.ASI_MFM_Sys_Rejected__c, '(Re-submit) ', '')}A {!relatedTo.ASI_MFM_Prefix__r.ASI_MFM_CN_eMail_Subject__c} Payment-<{!relatedto.Name}> Application is pending for approval" recipientType="User" relatedToType="ASI_MFM_Payment__c"><messaging:htmlEmailBody >To approve, click this link <a href="{!LEFT($Api.Partner_Server_URL_140, FIND(".com/",$Api.Partner_Server_URL_140)+3)}/{!relatedto.id}">{!LEFT($Api.Partner_Server_URL_140, FIND(".com/",$Api.Partner_Server_URL_140)+3)}/{!relatedto.id}</a> or by reply this email with keywords - <apex:outputText value=" APPROVE, APPROVED, YES, OK, REJECT, REJECTED, NO." style="color:red;font-weight:bold; "/>.<br/><br/>Please note the following Payment Request is waiting for your approval.<br/> <br/><table border="1" style="border:5px black;border-collapse:collapse;"><tr><td>Request Date: </td><td><apex:outputText value="{0,date,YYYY/mm/dd}"><apex:param value="{!relatedto.ASI_MFM_Payment_Date__c}"/></apex:outputText></td></tr><tr><td>Payment Request ID: </td><td><apex:outputText value="{!relatedto.name}"/></td></tr><tr><td>Budget Owner: </td><td>{!relatedto.ASI_MFM_Budget_Owner__r.name}</td></tr><tr><td>Supplier Name and Number: </td><td>{!relatedto.ASI_MFM_Supplier_Name__r.name} </td></tr><tr><td>Remarks: </td><td>{!relatedto.ASI_MFM_Remarks__c}</td></tr><tr><td>Currency: </td><td>{!relatedto.ASI_MFM_Currency__c} </td></tr><tr><td>Invoice Amount: </td><td><apex:outputtext value="{0,number,#,###,###,##0.00}"><apex:param value="{!relatedto.ASI_MFM_Payment_Amount__c}"/></apex:outputtext> </td></tr></table><c:ASI_MFM_CN_AttachmentList ParentIDAtt="{!relatedto.id}" SObjectNameAtt="ASI_MFM_Payment"/><br/><br/>Finance Information<br/><table border="1" style="border:5px black;border-collapse:collapse;"><tr><td>BU: </td><td>{!relatedto.ASI_MFM_BU__r.name} </td></tr><tr><td>PO Payment Amount: </td><td><apex:outputtext value="{0,number,#,###,###,##0.00}"><apex:param value="{!relatedto.ASI_MFM_CN_Payment_Amount_Net_of_Tax__c}"/></apex:outputtext> </td></tr><tr><td>Tax Code: </td><td>{!relatedto.ASI_MFM_Tax_Code__r.ASI_MFM_Description__c} </td></tr><tr><td>Deductabe Tax Amount: </td><td><apex:outputtext value="{0,number,#,###,###,##0.00}"><apex:param value="{!relatedto.ASI_MFM_CN_VAT_Amount__c}"/></apex:outputtext> </td></tr><apex:outputPanel rendered="{!NOT(ISBLANK(relatedto.ASI_MFM_One_Off_Payee__c))}"><tr><td>One off payee: </td><td>{!relatedto.ASI_MFM_One_Off_Payee__c} </td></tr><tr><td>Bank Details: </td><td>{!relatedto.ASI_MFM_Bank_Details__c}</td></tr></apex:outputPanel></table>   <apex:OutputField value="{!relatedto.ASI_MFM_VAT_Percentage__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_One_Off_Payee__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_AlternatePayee__r.Name}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Supplier_Name__r.Name}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_WT_Percentage__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Insurance_Percentage__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_VAT_Amount__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_WT_Amount__c}" rendered="false" />     <apex:OutputField value="{!relatedto.ASI_MFM_Insurance_Amount__c}" rendered="false" />        <apex:OutputField value="{!relatedto.ASI_MFM_Approved__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_BU__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Bank_Details__c}" rendered="false" />    <apex:OutputField value="{!relatedto.CreatedById}" rendered="false" />    <apex:OutputField value="{!relatedto.CreatedDate}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Currency__c}" rendered="false" />    <apex:OutputField value="{!relatedto.CurrencyIsoCode}" rendered="false" />    <apex:OutputField value="{!relatedto.IsDeleted}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_ETL__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Exchange_Rate__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Cashflow_Date__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_G_L_Date__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Insurance_Percentage__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Insurance_Amount__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Invoice_Date__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Invoice_Number__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Is_Retainer_Agency__c}" rendered="false" />    <apex:OutputField value="{!relatedto.LastActivityDate}" rendered="false" />    <apex:OutputField value="{!relatedto.LastModifiedById}" rendered="false" />    <apex:OutputField value="{!relatedto.LastModifiedDate}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_One_Off_Payee__c}" rendered="false" />    <apex:OutputField value="{!relatedto.OwnerId}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Payment_Amount__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Payment_External_ID__c}" rendered="false" />    <apex:OutputField value="{!relatedto.Name}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Payment_Term__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Pre_payment__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Prefix__c}" rendered="false" />    <apex:OutputField value="{!relatedto.Id}" rendered="false" />    <apex:OutputField value="{!relatedto.RecordTypeId}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Remarks__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Payment_Date__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Status__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Supplier_Name__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Local_Currency__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_1__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_2__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_3__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_4__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_5__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_6__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_SYS_Approver_7__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_SYS_Approver_8__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_SYS_Approver_9__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Approver_Email_Address__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Reject_Comments__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Rejected__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Submitter_Email_Address__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Sys_Sync_Time__c}" rendered="false" />    <apex:OutputField value="{!relatedto.SystemModstamp}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Tax_Code__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Urgent__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Urgent_Text__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_VAT_Amount__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_VAT_Rate__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_VAT_Percentage__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_WT_Amount__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_WT_Percentage__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Web_Service_Error_Message__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Web_Service_Failed__c}" rendered="false" />    <apex:OutputField value="{!relatedto.Owner.Name}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Supplier_Name__r.Name}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Supplier_Name__r.ASI_MFM_Customer_Supplier_Number__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Supplier_Name__r.ASI_MFM_Customer_Supplier_Name__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Budget_Owner__r.name}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_CN_Finance__c}" rendered="false" />    <apex:OutputField value="{!relatedto.ASI_MFM_Asia_Approver__c}" rendered="false" />            <apex:repeat var="a" value="{!relatedto.Payment_Line_Items__r}" >        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.ASI_MFM_Plan__r.Name}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.Name}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.ASI_MFM_PO_Type__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.id}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_List_Item_Description__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_A_C_Code__r.Name}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_A_C_Code__r.ASI_MFM_A_C_Code__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_Customer_Name__r.ASI_HK_CRM_Customer_Code__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Payment_Amount__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.ASI_MFM_Plan__r.ASI_MFM_Status__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.ASI_MFM_Plan__r.ASI_MFM_Plan_Amount__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.ASI_MFM_Plan__r.id}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_SKU_Code__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO__r.name}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Invoice_Number__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Payee__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Payee__r.Name}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Invoice_Date__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_Sub_brand_Code__r.ASI_MFM_Sub_brand_Code__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_PO__r.ASI_MFM_Remarks__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_PO_Line_Item__r.ASI_MFM_Currency__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Payment_List_Item_Description__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Po_Line_Item__r.ASI_MFM_PO_Remark__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Po_Line_Item__r.ASI_MFM_Amount__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Tax_Amount__c}" rendered="false" />        <apex:OutputField value="{!a.ASI_MFM_Payment_Amount_Net_of_Tax__c}" rendered="false" />    </apex:repeat></messaging:htmlEmailBody><messaging:attachment filename="Payment-{!relatedto.name}.pdf" renderAs="pdf">                <c:ASI_MFM_CN_Payment_PDF_Component paymentObject="{!relatedto}"/></messaging:attachment></messaging:emailTemplate>