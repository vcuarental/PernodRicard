<messaging:emailTemplate subject="Notification of MFM Payment #{!RelatedTo.Name} Application is rejected" recipientType="User" relatedToType="ASI_MFM_Payment__c">    <messaging:htmlEmailBody >        <p>Please note the following Payment Request #{!RelatedTo.Name} is rejected.</p>        <p><strong>Details:</strong></p>        <table>            <tr>                <td>Owner:</td>                <td>{!RelatedTo.Owner.name} </td>            </tr>            <tr>                <td>Payment ID:</td>                <td>{!RelatedTo.Name} </td>            </tr>            <tr>                <td>Invoice Number:</td>                <td>{!RelatedTo.ASI_MFM_Invoice_Number__c} </td>            </tr>            <tr>                <td>Invoice Date:</td>                <td><apex:outputText value="{0,date,MM/dd/yyyy}">                           <apex:param value="{!RelatedTo.ASI_MFM_Invoice_Date__c}" />                   </apex:outputText></td>            </tr>            <tr>                <td>Payee</td>                <td>{!RelatedTo.ASI_MFM_Supplier_Name__r.Name} </td>            </tr>            <tr>                <td>Currency: </td>                <td>{!RelatedTo.ASI_MFM_Currency__c}</td>            </tr>            <tr>                <td>Exchange Rate:</td>                <td><apex:outputText value="{0, number, ##.0000000}">                       <apex:param value="{!RelatedTo.ASI_MFM_Exchange_Rate__c}" />                    </apex:outputText></td>            </tr>            <tr>                <td>Payment Amount: </td>                <td><apex:outputText value="{0, number, ###,###,###,###,##0.00}"><apex:param value="{!RelatedTo.ASI_MFM_Payment_Amount__c}" /></apex:outputText></td>            </tr>        <tr>                <td>Request Date:</td>                <td><apex:outputText value="{0,date,MM/dd/yyyy}">                           <apex:param value="{!RelatedTo.ASI_MFM_Payment_Date__c}" />                   </apex:outputText></td>            </tr>                       <tr>                <td>G/L Date: </td>                <td><apex:outputText value="{0,date,MM/dd/yyyy}">                           <apex:param value="{!RelatedTo.ASI_MFM_G_L_Date__c}" />                   </apex:outputText></td>            </tr>            <tr>                <td>Remarks:</td>                <td>{!RelatedTo.ASI_MFM_Remarks__c}</td>            </tr>            <tr>                <td>Rejected By: </td>                <td>{!RelatedTo.LastModifiedBy.name}</td>           </tr>           <tr>                <td>Reject Reason:</td>                <td>{!RelatedTo.ASI_MFM_Sys_Reject_Comments__c}</td>           </tr>              </table>        <p>Please kindly click this link (             <apex:outputLink value="{!LEFT($Api.Partner_Server_URL_140, FIND('.com/',$Api.Partner_Server_URL_140)+3)}/{!RelatedTo.id}"> Payment#{!RelatedTo.Name}                </apex:outputLink>            ) for more details.         </p>                </messaging:htmlEmailBody><messaging:attachment renderAs="PDF"  filename="{!RelatedTo.name}">    <c:ASI_MFM_TH_Payment_PDF_Component payment_ID="{!RelatedTo.Id}" /><c:ASI_MFM_Approval_History_Component Input_ID="{!RelatedTo.Id}" Input_Object="ASI_MFM_Payment__c"/></messaging:attachment></messaging:emailTemplate>