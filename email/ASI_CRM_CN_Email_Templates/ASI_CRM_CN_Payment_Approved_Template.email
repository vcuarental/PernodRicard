<messaging:emailTemplate subject="PO Payment ({!relatedto.ASI_CRM_CN_OutletWS__r.Name} / {!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c})-[{!relatedTo.Name}] is approved" recipientType="User" relatedToType="ASI_TH_CRM_PaymentRequest__c">    <messaging:htmlEmailBody >    <style>body{     font-family: Arial Unicode MS;     font-size: 10px; } </style> <body>                Please note the following Payment Request is approved.        <br/>        To view the eForm, click this link <a href="{!LEFT($Api.Partner_Server_URL_140, FIND(".com/",$Api.Partner_Server_URL_140)+3)}/{!relatedto.id}">{!LEFT($Api.Partner_Server_URL_140, FIND(".com/",$Api.Partner_Server_URL_140)+3)}/{!relatedto.id}</a>          <br/>        <br/>                <c:ASI_CRM_CN_PaymentRequestForm_Cmpnt PRForm="{!relatedto}" />                <apex:OutputField value="{!relatedto.id}" rendered="false" /><apex:OutputField value="{!relatedto.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Chi_Name__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Region__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_No__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Bottle_Collection_Rate__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_BRSF_Start_Date__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Adjustment__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_BRSF_End_Date__c }" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Currency__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Total_Amount__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_CCity__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Description__c}" rendered="false"/><apex:OutputField value="{!relatedto.ASI_CRM_CN_Promotion_Type__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_V0_0_PO_version__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_Contract_Cost_Total__c }" rendered="false" /><apex:OutputField value="{!relatedto.Owner.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PSF_Start__c }" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PSF_End__c }" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Contract_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Overpayment_Reason__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Last_Payment__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Payment_Type__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Sub_Channel__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_Area__r.ASI_CRM_Division__r.ASI_CRM_Region__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_Area__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_Version__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Last_Payment__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_Remain_Amount__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Total_Other_Amount__c }" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Total_PSF_Amount__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Total_BRSF_Amount__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_No_of_Months__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Payment_Raised_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_No_of_Months__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Total_Payment__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_National_Group_Contract__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c}" rendered="false" /> <apex:outputField value="{!relatedto.ASI_CRM_CN_Other_Reason__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_New_FY_Payment__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_New_FY_PO__c}" rendered="false" /> <!--20160624,Leo@Elufa--><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_PO_Channel__r.Name}" rendered="false" /> <!--20160624,Leo@Elufa--><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_PO_Province__r.Name}" rendered="false" /> <!--20160624,Leo@Elufa--><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__c }" rendered="false" /> <!--20160721,Leo@Elufa--><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__r.Name }" rendered="false" /> <!--20160721,Leo@Elufa--><apex:outputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__r.ASI_CRM_CN_City_Tier__c }" rendered="false" /> <!--20160721,Leo@Elufa-->    <apex:OutputField value="{!relatedto.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_NewChannel__c}" rendered="false" /><!--20170414 Elufa-->    <apex:OutputField value="{!relatedto.ASI_TH_CRM_Contract__r.ASI_CRM_Investment_Type__c}" rendered="false" /><!--<apex:repeat var="a" value="{!relatedto.ASI_TH_CRM_PRLI_PaymentRequest__r}" ><apex:OutputField value="{!a.ASI_CRM_CN_Contract_BRSF_Line_Item__r.ASI_CRM_CN_Contract__c}" rendered="false" /></apex:repeat>--></body>    </messaging:htmlEmailBody>    <messaging:plainTextEmailBody >        </messaging:plainTextEmailBody><!--<messaging:attachment filename="PRForm-{!relatedto.name}.pdf" renderAs="pdf">    <c:ASI_CRM_CN_PaymentRequestForm_Cmpnt PRForm="{!relatedto}" /></messaging:attachment>--><!-- comment by wilson<messaging:attachment filename="BRSF-{!relatedto.name}.pdf" renderAs="pdf">    <c:ASI_CRM_CN_BRSFForm_Cmpnt BRSFFormObject="{!relatedto}"/></messaging:attachment><messaging:attachment filename="PSF-{!relatedto.name}.pdf" renderAs="pdf">    <c:ASI_CRM_CN_PSFForm_Cmpnt PSFFormObject="{!relatedto}"/></messaging:attachment>--></messaging:emailTemplate>