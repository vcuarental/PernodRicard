<messaging:emailTemplate subject="{!IF(relatedto.ASI_CRM_CN_Last_Rejected_By__c != '', '***Resubmit*** ', '')}{!relatedto.ASI_CRM_CN_Email_Subject__c} ({!relatedto.ASI_CRM_CN_Outlet_WS__r.Name}/{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c})-[{!relatedTo.ASI_CRM_CN_PO_No__c}] Application is pending for approval" recipientType="User" relatedToType="ASI_TH_CRM_Contract__c"><messaging:htmlEmailBody ><style>body{     font-family: Arial Unicode MS;     font-size: 10px; }</style><body>    <apex:outputPanel rendered="{!relatedto.ASI_CRM_CN_Last_Rejected_By__c != ''}">    Please note the following {!relatedto.ASI_CRM_CN_Email_Subject__c} is resubmitted.    <br/>    <table width="50%" border="0" cellpadding="3" cellspacing="0" style="font-size: 12px">    <tr><td width="50%" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!IF(relatedto.ASI_CRM_CN_Return_Flag__c, 'Returned', 'Rejected')} by:</td><td width="50%" style="font-family: Arial Unicode MS; border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!relatedto.ASI_CRM_CN_Last_Rejected_By__c}</td></tr>    <tr><td width="50%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!IF(relatedto.ASI_CRM_CN_Return_Flag__c, 'Returned', 'Rejected')} reason:</td><td width="50%" style="font-family: Arial Unicode MS; border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputField value="{!relatedto.ASI_CRM_CN_Return_Comments__c}"/></td></tr>    <tr><td width="50%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!IF(relatedto.ASI_CRM_CN_Return_Flag__c, 'Returned', 'Rejected')} date:</td><td width="50%" style="font-family: Arial Unicode MS; border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,date,dd/MM/yyyy}"><apex:param value="{!relatedto.ASI_CRM_CN_Last_Rejected_Date__c}" /></apex:outputText></td></tr>    </table>    <br/>    </apex:outputPanel>    To approve the eForm, click this link <a href="{!LEFT($Api.Partner_Server_URL_140, FIND(".com/",$Api.Partner_Server_URL_140)+3)}/{!relatedto.id}">{!LEFT($Api.Partner_Server_URL_140, FIND(".com/",$Api.Partner_Server_URL_140)+3)}/{!relatedto.id}</a>  or by reply this email with keywords - <apex:outputText value=" APPROVE, APPROVED, YES, REJECT, REJECTED, NO." style="color:red;font-weight:bold; "/><br/>    <br/>     <apex:outputpanel id="first" rendered="{!relatedto.ASI_CRM_CN_PO_Modification__c==false}">    Please note the following PO Application is waiting for your approval.    <br/>    </apex:outputpanel>        <!---PO Modification checked-->    <apex:outputpanel id="second" rendered="{!relatedto.ASI_CRM_CN_PO_Modification__c==true}">    Please note the following PO Modification is waiting for your approval.    <br/>    </apex:outputpanel><c:ASI_CRM_CN_ContractEmail_Cmpnt ContractEmailObject="{!relatedto}" PDF="0"/><apex:OutputField value="{!relatedto.id}" rendered="false" /><apex:OutputField value="{!relatedto.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_Area__r.ASI_CRM_Division__r.ASI_CRM_Region__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_WS_Tier__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_TH_CRM_OutletType__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_No_of_Months__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_No_of_Months__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Vol_Budget_LE__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Budget_LE__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sales_Rep__r.Name}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Contract_Estimate_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Contract_Est_Fixed_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Contract_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Contract_Fixed_Cost_Total__c }" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Contract_Est_Var_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Contract_Variable_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_TH_CRM_Promotion_Type__c}" rendered="false" /><apex:OutputField value="{!relatedto.Owner.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_PO_Modification__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_City_Tier__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_PO_No__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_PO_Version__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Bottle_Collection_Rate__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Currency__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_V0_0_PO_version__r.id}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_Total_Contract_Amount__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_V0_0_Amount_Gap__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Last_Version_Amount_Gap__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Source_of_Contract__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Description__c}" rendered="false"/><apex:outputField value="{!relatedto.ASI_CRM_CN_Reason_without_Budget__c}" rendered="false"/><apex:outputField value="{!relatedto.ASI_CRM_CN_Source_Others__c}" rendered="false"/><apex:outputField value="{!relatedto.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_V0_0_PO_version__r.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_Contract_Est_Fixed_Cost_Total__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_Start_Date__c}" rendered="false" /><apex:OutputField value="{!relatedto.ASI_CRM_CN_PO_End_Date__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_PO_No__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Region__c}" rendered="false" /><apex:outputField value="{!relatedto.Owner.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Chi_Name__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Email_Subject__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_PO_Version__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_National_Group_Contract__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.Name}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}" rendered="false" /><apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_NewChannel__c}" rendered="false" /><!--20170213 Elufa-->        <!--20160614 Ben @ Elufa-->        <apex:outputField value="{!relatedto.ASI_CRM_New_FY_PO__c}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_PO_Channel__c}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_PO_Province__c}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_PO_Channel__r.Name}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_PO_Province__r.Name}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_PO_City__r.Name}" rendered="false" />        <apex:outputField value="{!relatedto.ASI_CRM_PO_City__r.ASI_CRM_CN_City_Tier__c}" rendered="false" />        <!--20160614 End-->                <apex:outputField value="{!relatedto.ASI_CRM_Investment_Type__c}" rendered="false" /><br/><c:ASI_CRM_CN_AttachAttachmentComponent currentHeaderId="{!RelatedTo.Id}" /><p>You can click this link to view the <apex:outputLink rendered="{!relatedto.ASI_CRM_CN_PO_Modification__c==true}" value="{!LEFT($Api.Partner_Server_URL_140, FIND('.com/',$Api.Partner_Server_URL_140)+3)}/apex/ASI_CRM_CN_PSFCTDPDF_Page?id={!RelatedTo.id}"> CTD Volume</apex:outputLink><apex:outputLink rendered="{!relatedto.ASI_CRM_CN_PO_Modification__c==false}" value="{!LEFT($Api.Partner_Server_URL_140, FIND('.com/',$Api.Partner_Server_URL_140)+3)}/apex/ASI_CRM_CN_ContractProfitShuttlePDF_Page?id={!RelatedTo.id}"> Profit Shuttle</apex:outputLink> reports.</p></body></messaging:htmlEmailBody><messaging:plainTextEmailBody ></messaging:plainTextEmailBody><!--<messaging:attachment filename="ProfitShuttle-{!relatedto.name}.pdf" renderAs="pdf" rendered="{!relatedto.ASI_CRM_CN_PO_Modification__c==false}">    <c:ASI_CRM_CN_ContractProfitShuttle_Cmpnt ContractProfitShuttle="{!relatedto}" PDF="0"/></messaging:attachment><messaging:attachment filename="CTDPSFForm-{!relatedto.name}.pdf" renderAs="pdf" rendered="{!relatedto.ASI_CRM_CN_PO_Modification__c==true}">    <c:ASI_CRM_CN_PSFCTD_Cmpnt PSFFormObject="{!relatedto}"/></messaging:attachment>--></messaging:emailTemplate>