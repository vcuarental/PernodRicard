<apex:component controller="ASI_CRM_CN_ContractEmailCtrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar"/>
    <apex:attribute name="ContractEmailObject" description="Contract" type="ASI_TH_CRM_Contract__c" assignto="{!thisCC}"/>
    <apex:attribute name="PDF" description="Check AD identity" type="string" assignto="{!strPDF}"/>
    <apex:attribute name="TEST" description="Check AD identity" type="string" assignto="{!isTest}"/>
    <apex:attribute name="CUTOFF" description="Check AD identity" type="string" assignto="{!isTestDate}"/>
    <apex:outputpanel id="first" rendered="{!thisCC.ASI_CRM_CN_PO_Version__c='0.0'}">
        <table cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">
            <tr>
                <td valign="top" width="20%" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>PO No<br/>PO号</b></td>
                <td valign="top" width="30%" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_PO_No__c}</td>
                <td valign="top"  width="20%" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>Start Date<br/>起始日期</b></td>
                <td valign="top"  width="30%" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,date,dd/MM/yyyy}" ><apex:param value="{!thisCC.ASI_CRM_CN_PO_Start_Date__c}" /></apex:outputText></td>
            </tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>Outlet Name<br/>店家名称</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.Name}<apex:outputText value="/{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c}" rendered="{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != null && thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != ''}" /></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><b>End Date<br/>结束日期</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,date,dd/MM/yyyy}">
                    <apex:param value="{!thisCC.ASI_CRM_CN_PO_End_Date__c}" />
                    </apex:outputText></td>
            </tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>City Name<br/>城市</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!IF(thisCC.ASI_CRM_PO_City__c != null,thisCC.ASI_CRM_PO_City__r.Name,thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name)}</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><b>Outlet Type<br/>店家类别</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.Name}
                    <apex:variable var="outletType" value="" rendered="{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c!=null}">&nbsp;-</apex:variable>
                    {!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}
                </td>
            </tr> 
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO Type', 'Promotion Type')}<br/>{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO 类别', '促销类别')}:</b></td><!--20160614 Ben @ Elufa-->
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_TH_CRM_Promotion_Type__c}</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><b>Outlet Segment<br/>店家形象</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}</td>
            </tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>National Contract<br/>全国合同</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="Yes" rendered="{!thisCC.ASI_CRM_CN_National_Group_Contract__c}"/>
                    <apex:outputText value="No" rendered="{!NOT(thisCC.ASI_CRM_CN_National_Group_Contract__c)}"/></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><b>Source of Contract<br/>合同来源</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_CN_Source_of_Contract__c}" rendered="{!thisCC.ASI_CRM_CN_Source_of_Contract__c!='Others'}" />
                    <apex:outputText value="{!thisCC.ASI_CRM_CN_Source_Others__c}" rendered="{!thisCC.ASI_CRM_CN_Source_of_Contract__c=='Others'}" /></td>
            </tr>
            <!--20160614 Ben @ Elufa-->
            <apex:variable var="a" value="{!thisCC.ASI_CRM_New_FY_PO__c}" rendered="{!thisCC.ASI_CRM_New_FY_PO__c}">
                <tr>
                    <td valign="top" style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;">PO Channel<br/>PO渠道</td>
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_PO_Channel__r.Name}" /></td>
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">PO Province<br/>PO省份</td>
                    <td valign="top" colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_PO_Province__r.Name}"/></td>
                </tr>
            </apex:variable>
            <!--20160614 End-->
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>Description<br/>备注</b></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_CN_Description__c}"/></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Investment Type<br/>投资类型</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_Investment_Type__c}"/></td>
            </tr>
        </table>
        <br/>
        
        <apex:outputpanel id="noAD" rendered="{!AdorAbove!=true}">    
            <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 12px">
                <tr>
                    <td colspan="8" bgcolor="#99CCFF" style="border:1px solid black;" align="center"><font color="white"><strong><apex:outputText value="P&L REVIEW (in RMB) 利润分析表 （元）" /></strong></font></td>
                </tr>
                <tr>
                    <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical Contract<br/>历史合同      
                    </td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">New Contract<br/>新合同</td>
                    <td rowspan="2" style="border-bottom: 1px solid black;" align="center">Budget/LE<br/>预算</td>
                    <td rowspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">vs Est<br/>新合同预估</td>
                </tr>
                <tr>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black" align="center">v0.0<br/>预估</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black" align="center">vFinal<br/>完成</td>
                    <td style="border-bottom: 1px solid black;" align="center">Estimate<br/>预估</td>
                    <td style="border-right: 1px dotted gray; border-bottom: 1px solid black" align="center">% vFinal对比历史完成<br/></td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract合同<br/></td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strV0!=0&&VolumeData.strV0!=null}" ><apex:param value="{!VolumeData.strV0}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strV0==0||VolumeData.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strA!=0&&VolumeData.strA!=null}" ><apex:param value="{!VolumeData.strA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strA==0||VolumeData.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strB!=0&&VolumeData.strB!=null}"><apex:param value="{!VolumeData.strB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strB==0||VolumeData.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VolumeData.strC!=0&&VolumeData.strC!=null}"><apex:param value="{!VolumeData.strC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strC==0||VolumeData.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strD!=0&&VolumeData.strD!=null}"><apex:param value="{!VolumeData.strD}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strD==0||VolumeData.strD==null}"/></td>     
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strE!=0&&VolumeData.strE!=null}" ><apex:param value="{!VolumeData.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strE==0||VolumeData.strE==null}"/></td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strF!=0&&VolumeData.strF!=null}"><apex:param value="{!VolumeData.strF}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strF==0||VolumeData.strF==null}"/></td>
                </tr>
                <apex:repeat value="{!sbGroup_map}" var="sbgroup">
                    <tr>
                        <td style="border-left: 1px solid black; border-right: 1px solid black;">{!RIGHT(sbgroup,LEN(sbgroup)-3)}</td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strV0!=0}"><apex:param value="{!sbGroup_map[sbgroup].strV0}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strV0==0||sbGroup_map[sbgroup].strV0==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strA!=0}" ><apex:param value="{!sbGroup_map[sbgroup].strA}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strA==0||sbGroup_map[sbgroup].strA==null}"/></td>
                        <td align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strB!=0}"><apex:param value="{!sbGroup_map[sbgroup].strB}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strB==0||sbGroup_map[sbgroup].strB==null}"/></td>
                        <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!sbGroup_map[sbgroup].strC!=0}" ><apex:param value="{!sbGroup_map[sbgroup].strC}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strC==0||sbGroup_map[sbgroup].strC==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strD!=0}" ><apex:param value="{!sbGroup_map[sbgroup].strD}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strD==0||sbGroup_map[sbgroup].strD==null}"/></td>
                        <td>&nbsp;</td>
                        <td style="border-right: 1px solid black;">&nbsp;</td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td> 
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strV0!=null}"><apex:param value="{!TradeExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strA!=null}"><apex:param value="{!TradeExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strB!=null}"><apex:param value="{!TradeExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!TradeExpense.strC!=null}"><apex:param value="{!TradeExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strD!=null}"><apex:param value="{!TradeExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strD==null}"/></strong></td>      
                    <td bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strE!=null&&TradeExpense.strE!=0}"><apex:param value="{!TradeExpense.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strE==null||TradeExpense.strE==0}"/></strong></td>
                    <td style="border-right: 1px solid black;" bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!TradeExpense.strF!=null&&TradeExpense.strF!=0}"><apex:param value="{!TradeExpense.strF}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strF==null||TradeExpense.strF==0}"/></strong></td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>       
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strV0!=null&&GrossSales.strV0!=0}"><apex:param value="{!GrossSales.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strV0==null||GrossSales.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strA!=null&&GrossSales.strA!=0}"><apex:param value="{!GrossSales.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strA==null||GrossSales.strA==0}"/></td>
                    <td align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strB!=null&&GrossSales.strB!=0}"><apex:param value="{!GrossSales.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strB==null||GrossSales.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strC!=null&&GrossSales.strC!=0}"><apex:param value="{!GrossSales.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strC==null||GrossSales.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strD!=null&&GrossSales.strD!=0}"><apex:param value="{!GrossSales.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strD==null||GrossSales.strD==0}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 Extra eq btl  折CR12新境单瓶投入</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strV0!=null&&InvestmentCR12.strV0!=0}"><apex:param value="{!InvestmentCR12.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strV0==null||InvestmentCR12.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strA!=null&&InvestmentCR12.strA!=0}"><apex:param value="{!InvestmentCR12.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strA==null||InvestmentCR12.strA==0}"/></td>
                    <td align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strB!=null&&InvestmentCR12.strB!=0}"><apex:param value="{!InvestmentCR12.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strB==null||InvestmentCR12.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right" valign="top"><apex:outputText value="{0,number,#,###,###}%" rendered="{!InvestmentCR12.strC!=null&&InvestmentCR12.strC!=0}"><apex:param value="{!InvestmentCR12.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strC==null||InvestmentCR12.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strD!=null&&InvestmentCR12.strD!=0}"><apex:param value="{!InvestmentCR12.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strD==null||InvestmentCR12.strD==0}"/></td>
                    <td align="right" valign="top">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strV0!=null}"><apex:param value="{!VExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strA!=null}"><apex:param value="{!VExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strB!=null}"><apex:param value="{!VExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VExpense.strC!=null}"><apex:param value="{!VExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strD!=null}"><apex:param value="{!VExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strV0!=null}"><apex:param value="{!FExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strA!=null}"><apex:param value="{!FExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strB!=null}"><apex:param value="{!FExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpense.strC!=null}"><apex:param value="{!FExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strD!=null}"><apex:param value="{!FExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 % </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strV0!=null}"><apex:param value="{!FExpenseRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strA!=null}"><apex:param value="{!FExpenseRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strB!=null}"><apex:param value="{!FExpenseRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strC!=null}"><apex:param value="{!FExpenseRate.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strD!=null}"><apex:param value="{!FExpenseRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strD==null}"/></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!BCRate.strName}空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strV0!=null&&BCRate.strV0!=0}"><apex:param value="{!BCRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strV0==null||BCRate.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strA!=null&&BCRate.strA!=0}"><apex:param value="{!BCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strA==null||BCRate.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strB!=null&&BCRate.strB!=0}"><apex:param value="{!BCRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strB==null||BCRate.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strD!=null&&BCRate.strD!=0}"><apex:param value="{!BCRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strD==null||BCRate.strD==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                 <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!NetBCRate.strName}净空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                     </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!NetBCRate.strA!=null&&NetBCRate.strA!=0}">
                        <apex:param value="{!NetBCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NetBCRate.strA==null||NetBCRate.strA==0}"/></strong>
                     </td>
                    <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
            </table>
        </apex:outputpanel>
        <!------------------------------------------- FOR AD or Above------------------------------------------>
        <apex:outputpanel id="ROI" rendered="{!AdorAbove}">
            <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 12px">
                <tr>
                    <td colspan="8" bgcolor="#99CCFF" style="border:1px solid black;"  align="center"><font color="white"><strong><apex:outputText value="P&L REVIEW (in RMB) 利润分析表 （元）" /></strong></font></td>
                </tr>
                <tr>
                    <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical Contract<br/>历史合同      
                    </td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">New Contract<br/>新合同</td>
                    <td rowspan="2" style="border-bottom: 1px solid black;" align="center">Budget/LE<br/>预算</td>
                    <td rowspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">vs Est<br/>对比预估</td>
                </tr>
                <tr>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black" align="center">v0.0<br/>预估</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black" align="center">vFinal<br/>完成</td>
                    <td style="border-bottom: 1px solid black;" align="center">Estimate<br/>预估</td>
                    <td style="border-right: 1px dotted gray; border-bottom: 1px solid black" align="center">% vFinal<br/>对比历史完成</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract<br/>合同</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">销量 (in 9L cs)</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strV0!=0&&VolumeData.strV0!=null}" ><apex:param value="{!VolumeData.strV0}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strV0==0||VolumeData.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strA!=0&&VolumeData.strA!=null}" ><apex:param value="{!VolumeData.strA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strA==0||VolumeData.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strB!=0&&VolumeData.strB!=null}"><apex:param value="{!VolumeData.strB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strB==0||VolumeData.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VolumeData.strC!=0&&VolumeData.strC!=null}"><apex:param value="{!VolumeData.strC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strC==0||VolumeData.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strD!=0&&VolumeData.strD!=null}"><apex:param value="{!VolumeData.strD}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strD==0||VolumeData.strD==null}"/></td>  
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strE!=0&&VolumeData.strE!=null}" ><apex:param value="{!VolumeData.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strE==0||VolumeData.strE==null}"/></td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strF!=0&&VolumeData.strF!=null}"><apex:param value="{!VolumeData.strF}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strF==0||VolumeData.strF==null}"/></td>     
                </tr>
                <apex:repeat value="{!sbGroup_map}" var="sbgroup">
                    <tr>
                        <td style="border-left: 1px solid black; border-right: 1px solid black;">{!RIGHT(sbgroup,LEN(sbgroup)-3)}</td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strV0!=0}"><apex:param value="{!sbGroup_map[sbgroup].strV0}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strV0==0||sbGroup_map[sbgroup].strV0==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strA!=0}" ><apex:param value="{!sbGroup_map[sbgroup].strA}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strA==0||sbGroup_map[sbgroup].strA==null}"/></td>
                        <td align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strB!=0}"><apex:param value="{!sbGroup_map[sbgroup].strB}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strB==0||sbGroup_map[sbgroup].strB==null}"/></td>
                        <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!sbGroup_map[sbgroup].strC!=0}" ><apex:param value="{!sbGroup_map[sbgroup].strC}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strC==0||sbGroup_map[sbgroup].strC==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strD!=0}" ><apex:param value="{!sbGroup_map[sbgroup].strD}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strD==0||sbGroup_map[sbgroup].strD==null}"/></td>
                        <td>&nbsp;</td>
                        <td style="border-right: 1px solid black;">&nbsp;</td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strV0!=null}"><apex:param value="{!TradeExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strA!=null}"><apex:param value="{!TradeExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strB!=null}"><apex:param value="{!TradeExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!TradeExpense.strC!=null}"><apex:param value="{!TradeExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strD!=null}"><apex:param value="{!TradeExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strD==null}"/></strong></td>      
                    <td bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strE!=null&&TradeExpense.strE!=0}"><apex:param value="{!TradeExpense.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strE==null||TradeExpense.strE==0}"/></strong></td>
                    <td style="border-right: 1px solid black;" bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!TradeExpense.strF!=null&&TradeExpense.strF!=0}"><apex:param value="{!TradeExpense.strF}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strF==null||TradeExpense.strF==0}"/></strong></td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>       
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strV0!=null&&GrossSales.strV0!=0}"><apex:param value="{!GrossSales.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strV0==null||GrossSales.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strA!=null&&GrossSales.strA!=0}"><apex:param value="{!GrossSales.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strA==null||GrossSales.strA==0}"/></td>
                    <td align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strB!=null&&GrossSales.strB!=0}"><apex:param value="{!GrossSales.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strB==null||GrossSales.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strC!=null&&GrossSales.strC!=0}"><apex:param value="{!GrossSales.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strC==null||GrossSales.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strD!=null&&GrossSales.strD!=0}"><apex:param value="{!GrossSales.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strD==null||GrossSales.strD==0}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 Extra eq btl  折CR12新境单瓶投入</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strV0!=null&&InvestmentCR12.strV0!=0}"><apex:param value="{!InvestmentCR12.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strV0==null||InvestmentCR12.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strA!=null&&InvestmentCR12.strA!=0}"><apex:param value="{!InvestmentCR12.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strA==null||InvestmentCR12.strA==0}"/></td>
                    <td align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strB!=null&&InvestmentCR12.strB!=0}"><apex:param value="{!InvestmentCR12.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strB==null||InvestmentCR12.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right" valign="top"><apex:outputText value="{0,number,#,###,###}%" rendered="{!InvestmentCR12.strC!=null&&InvestmentCR12.strC!=0}"><apex:param value="{!InvestmentCR12.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strC==null||InvestmentCR12.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strD!=null&&InvestmentCR12.strD!=0}"><apex:param value="{!InvestmentCR12.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strD==null||InvestmentCR12.strD==0}"/></td>
                    <td align="right" valign="top">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strV0!=null}"><apex:param value="{!VExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strA!=null}"><apex:param value="{!VExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strB!=null}"><apex:param value="{!VExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VExpense.strC!=null}"><apex:param value="{!VExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strD!=null}"><apex:param value="{!VExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strV0!=null}"><apex:param value="{!FExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strA!=null}"><apex:param value="{!FExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strB!=null}"><apex:param value="{!FExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpense.strC!=null}"><apex:param value="{!FExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strD!=null}"><apex:param value="{!FExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 % </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strV0!=null}"><apex:param value="{!FExpenseRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strA!=null}"><apex:param value="{!FExpenseRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strB!=null}"><apex:param value="{!FExpenseRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strC!=null}"><apex:param value="{!FExpenseRate.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strD!=null}"><apex:param value="{!FExpenseRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>{!MarginAP.strName}</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strV0!=null&&MarginAP.strV0!=0}"><apex:param value="{!MarginAP.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strV0==0||MarginAP.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strA!=null&&MarginAP.strA!=0}"><apex:param value="{!MarginAP.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strA==0||MarginAP.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strB!=null&&MarginAP.strB!=0}"><apex:param value="{!MarginAP.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strB==0||MarginAP.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!MarginAP.strC!=null&&MarginAP.strC!=0}"><apex:param value="{!MarginAP.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strC==0||MarginAP.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strD!=null&&MarginAP.strD!=0}"><apex:param value="{!MarginAP.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strD==0||MarginAP.strD==null}"/></strong></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                    
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>{!MarginperBottle.strName}</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strV0!=null&&MarginperBottle.strV0!=0}"><apex:param value="{!MarginperBottle.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strV0==0||MarginperBottle.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strA!=null&&MarginperBottle.strA!=0}"><apex:param value="{!MarginperBottle.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strA==0||MarginperBottle.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strB!=null&&MarginperBottle.strB!=0}"><apex:param value="{!MarginperBottle.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strB==0||MarginperBottle.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!MarginperBottle.strC!=null&&MarginperBottle.strC!=0}"><apex:param value="{!MarginperBottle.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strC==0||MarginperBottle.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strD!=null&&MarginperBottle.strD!=0}"><apex:param value="{!MarginperBottle.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strD==0||MarginperBottle.strD==null}"/></strong></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>{!ROI.strName} 投资回报率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strV0!=null&&ROI.strV0!=0}"><apex:param value="{!ROI.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strV0==null||ROI.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strA!=null&&ROI.strA!=0}"><apex:param value="{!ROI.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strA==null||ROI.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strB!=null&&ROI.strB!=0}"><apex:param value="{!ROI.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strB==null||ROI.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!ROI.strC!=null&&ROI.strC!=0}"><apex:param value="{!ROI.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strC==null||ROI.strC==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strD!=null&&ROI.strD!=0}"><apex:param value="{!ROI.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strD==null||ROI.strD==0}"/></strong></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
               
                <!-- added by Alan Wong (Elufa) 20150618 -->
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>{!ProForma_ROI.strName} 预设投资回报率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strV0!=null&&ProForma_ROI.strV0!=0}"><apex:param value="{!ProForma_ROI.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strV0==null||ProForma_ROI.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strA!=null&&ProForma_ROI.strA!=0}"><apex:param value="{!ProForma_ROI.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strA==null||ProForma_ROI.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strB!=null&&ProForma_ROI.strB!=0}"><apex:param value="{!ProForma_ROI.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strB==null||ProForma_ROI.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!ProForma_ROI.strC!=null&&ProForma_ROI.strC!=0}"><apex:param value="{!ProForma_ROI.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strC==null||ProForma_ROI.strC==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strD!=null&&ProForma_ROI.strD!=0}"><apex:param value="{!ProForma_ROI.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strD==null||ProForma_ROI.strD==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                 <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!BCRate.strName}空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strV0!=null&&BCRate.strV0!=0}"><apex:param value="{!BCRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strV0==null||BCRate.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strA!=null&&BCRate.strA!=0}"><apex:param value="{!BCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strA==null||BCRate.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strB!=null&&BCRate.strB!=0}"><apex:param value="{!BCRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strB==null||BCRate.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strD!=null&&BCRate.strD!=0}"><apex:param value="{!BCRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strD==null||BCRate.strD==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                 <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!NetBCRate.strName}净空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                     </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!NetBCRate.strA!=null&&NetBCRate.strA!=0}">
                        <apex:param value="{!NetBCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NetBCRate.strA==null||NetBCRate.strA==0}"/></strong>
                     </td>
                    <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <!-- End -->
            </table>
            <!--20160616 Ben @ Elufa
            <br/>
        <apex:variable value="{!thisCC.ASI_CRM_New_FY_PO__c}" var="va" rendered="{!thisCC.ASI_CRM_New_FY_PO__c}">
            <table border="0" cellspacing="0" width="100%" style="font-size: 12px">
                <thead>
                    <tr>
                        <td width="13.333%" colspan="2" style="border-bottom: 1px solid black;">&nbsp;</td>
                        <td width="28.667%" colspan="4" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Current PO Version</td>
                    </tr>
                    <tr>
                        <td colspan="2" style=" border-left: 1px solid black; border-bottom: 1px solid black;">A/C CODE</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">CNY 春节(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">MAF 中秋(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">OTHERS 其他(预估)</td>
                        <td colspan="1" style=" border-right: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">TOTAL 总金额</td>
                    </tr>
                </thead>
                <apex:repeat value="{!mapSeasonExpense_diff}" var="varitem">
                    <apex:variable var="vb" value="{!mapSeasonExpense_diff[varitem].strH}" rendered="{!mapSeasonExpense_diff[varitem].strH != 0}">
                        <tr>
                            <td colspan="2" style=" border-left: 1px solid black; border-bottom: 1px solid black;">{!varitem}</td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strE != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strE}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strE == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strF != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strF}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strF == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strG != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strG}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strG == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strH != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strH}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strH == 0}"/>
                            </td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
            </table>
            <br/>
        </apex:variable>
        <!--20160616 End-->
        </apex:outputPanel>
        
        <br />
    </apex:outputpanel>
    <!---PO Modification checked-->
    <apex:outputpanel id="second" rendered="{!thisCC.ASI_CRM_CN_PO_Version__c!='0.0'}">
        <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">
            <tr>
                <td valign="top" width="20%" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">PO No<br/>PO号</td>
                <td valign="top" width="30%" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_PO_No__c}</td>
                <td valign="top" width="20%" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">PO Start Date<br/>PO起始日期</td>
                <td valign="top" width="30%" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,date,dd/MM/yyyy}" ><apex:param value="{!thisCC.ASI_CRM_CN_PO_Start_Date__c}"/></apex:outputText></td></tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">PO Version<br/>PO版本</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_PO_Version__c}</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">PO End Date<br/>PO结束日期</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,date,dd/MM/yyyy}">
                    <apex:param value="{!thisCC.ASI_CRM_CN_PO_End_Date__c}" /></apex:outputText></td>
            </tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Outlet Name<br/>店家名称</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.Name}<apex:outputText value=" / {!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c}" rendered="{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != null && thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != ''}" /></td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Outlet Type<br/>店家类别</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.Name}
                    <apex:variable var="outletType" value="" rendered="{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c!=null}">-</apex:variable>
                    {!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}</td>
            </tr>
            <tr><td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">City Name<br/>城市</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!IF(thisCC.ASI_CRM_PO_City__c != null,thisCC.ASI_CRM_PO_City__r.Name,thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name)}</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Outlet Segment<br/>店家形象</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}</td>
            </tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO Type', 'Promotion Type')}<br/>{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO 类别', '促销类别')}</td><!--20160614 Ben @ Elufa-->
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">{!thisCC.ASI_TH_CRM_Promotion_Type__c}</td>
                <td valign="top" rowspan="{!if(thisCC.ASI_CRM_New_FY_PO__c, 1, 2)}" style="border-right: 1px solid black; border-bottom: 1px solid black;">Bottle Collection Rate<br/>合同回瓶率</td>
                <td valign="top" rowspan="{!if(thisCC.ASI_CRM_New_FY_PO__c, 1, 2)}" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=null}" >
                    <apex:param value="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c}"/></apex:outputText></td>
            </tr>
            <tr>
                <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">National Contract<br/>全国合同</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="Yes" rendered="{!thisCC.ASI_CRM_CN_National_Group_Contract__c=true}"/>
                    <apex:outputText value="No" rendered="{!thisCC.ASI_CRM_CN_National_Group_Contract__c=false}"/>
                </td>
                <!--20160614 Ben @ Elufa-->
                <apex:variable var="c" value="{!thisCC.ASI_CRM_New_FY_PO__c}" rendered="{!thisCC.ASI_CRM_New_FY_PO__c}">
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">PO Channel<br/>PO渠道</td>
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_PO_Channel__r.Name}" /></td>
                </apex:variable>
                <!--20160614 End-->
            </tr>
            <tr>
                <td valign="top" style="border-right: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">Description<br/>备注</td>
                <td valign="top" colspan="{!if(thisCC.ASI_CRM_New_FY_PO__c, 1, 3)}" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_CN_Description__c}"/></td>
                <!--20160614 Ben @ Elufa-->
                <apex:variable var="b" value="{!thisCC.ASI_CRM_New_FY_PO__c}" rendered="{!thisCC.ASI_CRM_New_FY_PO__c}">
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">PO Province<br/>PO省份</td>
                    <td valign="top" colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_PO_Province__r.Name}"/></td>
                </apex:variable>
                <!--20160614 End-->
            </tr>
            <tr>
                <td valign="top" style="border-right: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">Investment Type<br/>投资类型</td>
                <td valign="top" colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{!thisCC.ASI_CRM_Investment_Type__c}"/></td>
            </tr>
        </table>
        <br/>
        <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
            <thead><tr>
                <td width="30%" valign="top">&nbsp;</td>
                <td width="14%" valign="top" align="center">Last Estimate Amount<br/>预估总金额</td>
                <td width="14%" valign="top" align="center">Paid Amount<br/>已支付金额</td>
                <td width="14%" valign="top" align="center">Remaining Amount<br/>剩余金额</td>
                <td width="14%" valign="top" align="center">+/- Amount<br/>本次增减变动金额</td>
                <td width="14%" valign="top" align="center">Revised Est Amount<br/>最终预估金额</td>
                </tr></thead>
            <apex:repeat value="{!paymentRequestSummary}" var="ps">
                <tr>
                    <td valign="top">
                        <apex:outputText value="{!ps.feeName}" rendered="{!ps.feeName!=null}" /> <apex:outputText value=" / {!ps.feeChiName}" rendered="{!ps.feeChiName!=null}" /> </td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ps.LastPOEstimateAmt!=null&&ps.LastPOEstimateAmt!=0}" ><apex:param value="{!ps.LastPOEstimateAmt}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ps.LastPOEstimateAmt==null||ps.LastPOEstimateAmt==0}" /></td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ps.PaidAmt!=null&&ps.PaidAmt!=0}"><apex:param value="{!ps.PaidAmt}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ps.PaidAmt==null||ps.PaidAmt==0}" /></td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ps.PORemainAmt!=null&&ps.PORemainAmt!=0}"><apex:param value="{!ps.PORemainAmt}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ps.PORemainAmt==null||ps.PORemainAmt==0}" /></td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ps.PODeltaAmt!=null&&ps.PODeltaAmt!=0}"><apex:param value="{!ps.PODeltaAmt}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ps.PODeltaAmt==null||ps.PODeltaAmt==0}" /></td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ps.POEstimateAmt!=null&&ps.POEstimateAmt!=0}"><apex:param value="{!ps.POEstimateAmt}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ps.POEstimateAmt==null||ps.POEstimateAmt==0}" /></td>
                </tr>
            </apex:repeat>
            <tr>
                <td valign="top">Total Investment / 总金额</td>
                <td valign="top" align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalLastEstAmt!=null&&PS_TotalLastEstAmt!=0}" ><apex:param value="{!PS_TotalLastEstAmt}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalLastEstAmt==null||PS_TotalLastEstAmt==0}" /></td>
                <td valign="top" align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalPaidAmt!=null&&PS_TotalPaidAmt!=0}" ><apex:param value="{!PS_TotalPaidAmt}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalPaidAmt==null||PS_TotalPaidAmt==0}" /></td>
                <td valign="top" align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalPORemainAmt!=null&&PS_TotalPORemainAmt!=0}" ><apex:param value="{!PS_TotalPORemainAmt}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalPORemainAmt==null||PS_TotalPORemainAmt==0}" /></td>
                <td valign="top" align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalPODeltaAmt!=null&&PS_TotalPODeltaAmt!=0}" ><apex:param value="{!PS_TotalPODeltaAmt}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalPODeltaAmt==null||PS_TotalPODeltaAmt==0}" /></td>
                <td valign="top" align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalPOEstAmt!=null&&PS_TotalPOEstAmt!=0}" ><apex:param value="{!PS_TotalPOEstAmt}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalPOEstAmt==null||PS_TotalPOEstAmt==0}" /></td>
            </tr>
        </table>
        <br />
        <table border="0" cellspacing="0" celpadding="2" width="100%" style="font-size: 12px">
            <thead><tr>
                <td width="34%" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" valign="top" align="center">Contract Period vs. Last Version<br/>合同期间与上版本变化</td>
                <td width="33%" bgcolor="#99CCFF" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" valign="top" align="center">Last Version<br/>上个版本</td>
                <td width="33%" bgcolor="#99CCFF" style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" valign="top" align="center">Modified Version<br/>本次修改版本</td>
                </tr></thead>
            <tr>
                <td width="34%" style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" valign="top">Contract Period / 合同期间</td>
                <td width="33%" style="border-right: 1px solid black;border-bottom: 1px solid black;" valign="top"><apex:outputText value="From" rendered="{!thisCC.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c!=null}" />
                    <apex:outputText value="{0, date, dd/MM/yyyy}">
                        <apex:param value="{!thisCC.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c}" /> 
                    </apex:outputText>
                    <apex:outputText value=" to" rendered="{!thisCC.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c!=null}" />
                    <apex:outputText value="{0, date, dd/MM/yyyy}">
                        <apex:param value="{!thisCC.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_End_Date__c}" /> 
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_End_Date__c==null&&thisCC.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c==null}" />
                </td>
                <apex:variable var="v1" value="" rendered="{!NOT(boolCheckCCPeriod)}">
                    <td width="33%" style="border-right: 1px solid black;border-bottom: 1px solid black;" valign="top">From 
                        <apex:outputText value="{0, date, dd/MM/yyyy}">
                            <apex:param value="{!thisCC.ASI_CRM_CN_PO_Start_Date__c}" /> 
                        </apex:outputText>
                        <apex:outputText value=" to" rendered="{!thisCC.ASI_CRM_CN_PO_Start_Date__c!=null}" /> 
                        <apex:outputText value="{0, date, dd/MM/yyyy}">
                            <apex:param value="{!thisCC.ASI_CRM_CN_PO_End_Date__c}" /> 
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_PO_End_Date__c==null&&thisCC.ASI_CRM_CN_PO_Start_Date__c==null}" />
                    </td>
                </apex:variable>
                <apex:variable var="v2" value="" rendered="{!boolCheckCCPeriod}">
                    <td width="33%" style="border-right: 1px solid black;border-bottom: 1px solid black;" valign="top">No Change</td>
                </apex:variable>
            </tr>
            <!--
<tr>
<td width="34%" valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black;border-bottom: 1px solid black;">Estimated Amount / 预估总金额</td>
<td width="33%" valign="top" style="text-align:right; border-right: 1px solid black; border-top: 1px solid black;border-bottom: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalLastEstAmt!=0&&PS_TotalLastEstAmt!=null}"><apex:param value="{!PS_TotalLastEstAmt}" /></apex:outputText>
<apex:outputText value=" - " rendered="{!PS_TotalLastEstAmt==0||PS_TotalLastEstAmt==null}" /></td>
<td width="33%" valign="top" style="text-align:right; border-right: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalPOEstAmt!=0&&PS_TotalPOEstAmt!=null}" ><apex:param value="{!PS_TotalPOEstAmt}" /></apex:outputText>
<apex:outputText value=" - "  rendered="{!PS_TotalPOEstAmt==0||PS_TotalPOEstAmt==null}" /></td>
</tr>
-->
        </table>
        <br/>
        <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
            <thead><tr>
                <td width="25%"></td>
                <td width="25%" align="center">Theoretical Amount<br/>建议预估金额</td>
                <td width="25%" align="center">Modified Amount<br/>本次修改金额</td>
                <td width="25%" align="center">Gap<br/>差异</td>
                </tr></thead>
            <apex:variable var="vc" value="" rendered="{!boolVariableCost}">
                <tr>
                    <td>Variable Cost / 变动费用</td>
                    <td  style="border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ActVSEst_Vol!=null&&ActVSEst_Vol!=0}"><apex:param value="{!ActVSEst_Vol}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActVSEst_Vol==null||ActVSEst_Vol==0}" /></td>
                    <td  style="border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!Mod_VCost!=null&&Mod_VCost!=0}"><apex:param value="{!Mod_VCost}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!Mod_VCost==null||Mod_VCost==0}" /></td>
                    <apex:outputText value="{!normalBlack}" rendered="{!THVarGap==null||THVarGap==0}" escape="false"/>
                    <apex:outputText value="{!negativeRed}" rendered="{!THVarGap<0}" escape="false"/>
                    <apex:outputText value="{!positiveGreen}" rendered="{!THVarGap>0}" escape="false"/>
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!THVarGap!=0&&THVarGap!=null}"><apex:param value="{!THVarGap}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!THVarGap==0||THVarGap==null}" /><apex:outputText value="{!td_end}" escape="false" />
                </tr>
            </apex:variable>
            <apex:variable var="vf" value="" rendered="{!boolFixedCost}">
                <tr>
                    <td>Fixed Cost / 固定费用</td>
                    <td  style="border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!strv0FixCost!=null&&strv0FixCost!=0}"><apex:param value="{!strv0FixCost}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!strv0FixCost==null||strv0FixCost==0}" /></td>
                    <td  style="border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c!=null&&thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c!=0}"><apex:param value="{!thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c==null||thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c==0}" /></td>
                    <apex:outputText value="{!normalBlack}" rendered="{!THFixGap==null||THFixGap==0}" escape="false"/>
                    <apex:outputText value="{!negativeRed}" rendered="{!THFixGap<0}" escape="false"/>
                    <apex:outputText value="{!positiveGreen}" rendered="{!THFixGap>0}" escape="false"/>
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!THFixGap!=0&&THFixGap!=null}"><apex:param value="{!THFixGap}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!THFixGap==0||THFixGap==null}" /><apex:outputText value="{!td_end}" escape="false" />
                </tr>
            </apex:variable>
            <tr>
                <td>Total Investment / 总金额</td>
                <td  style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!THAmount!=null&&THAmount!=0}"><apex:param value="{!THAmount}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!THAmount==null||THAmount==0}" /></td>
                <td  style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                    
                    <!--
<apex:outputText value="{0,number,#,###,##0.00}" rendered="{!thisCC.ASI_CRM_CN_Total_Contract_Amount__c!=null&&thisCC.ASI_CRM_CN_Total_Contract_Amount__c!=0}"><apex:param value="{!thisCC.ASI_CRM_CN_Total_Contract_Amount__c}"/></apex:outputText>
<apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Total_Contract_Amount__c==null||thisCC.ASI_CRM_CN_Total_Contract_Amount__c==0}" />
-->
                    
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!Mod_VCost + thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c!=0}"><apex:param value="{!Mod_VCost + thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!Mod_VCost + thisCC.ASI_CRM_CN_Contract_Fixed_Cost_Total__c == 0}" />
                    
                </td>
                <apex:outputText value="{!normalBlack_bottom}" rendered="{!THGap==null||THGap==0}" escape="false" />
                <apex:outputText value="{!negativeRed_bottom}" rendered="{!THGap<0}" escape="false" />
                <apex:outputText value="{!positiveGreen_bottom}" rendered="{!THGap>0}" escape="false" />
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!THGap!=0&&THGap!=null}"><apex:param value="{!THGap}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!THGap==0||THGap==null}" /><apex:outputText value="{!td_end}" escape="false" />
            </tr>
        </table>
        <br/>
        
        <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">
            <thead><tr>
                <td width="50%" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">Key Fin. Indicator / 财务指标</td>
                <td width="50%" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Result / 结果</td>
                </tr></thead>
            <tr>
                <td style="border-left: 1px solid black; border-bottom: 1px solid black;">V0.0 Investment per CR12 Extra btl/V0.0折CR12新境单瓶投入</td>
                <td style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12_POM.strA!=null&&InvestmentCR12_POM.strA!=0}"><apex:param value="{!InvestmentCR12_POM.strA}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!InvestmentCR12_POM.strA==null||InvestmentCR12_POM.strA==0}"/></td> 
            </tr>
            <tr>
                <td style="border-left: 1px solid black;">Latest Investment per CR12 Extra btl/修改后折CR12新境单瓶投入</td>
                <td style="text-align:right;border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12_POM.strB!=null&&InvestmentCR12_POM.strB!=0}"><apex:param value="{!InvestmentCR12_POM.strB}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!InvestmentCR12_POM.strB==null||InvestmentCR12_POM.strB==0}"/></td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;">Variance / 差异</td>
                <apex:outputText value="{!normalBlack_bottom}" rendered="{!InvestmentCR12_POM.strC==null||InvestmentCR12_POM.strC==0}" escape="false" />
                <apex:outputText value="{!negativeRed_bottom}" rendered="{!InvestmentCR12_POM.strC<0}" escape="false" />
                <apex:outputText value="{!positiveGreen_bottom}" rendered="{!InvestmentCR12_POM.strC>0}" escape="false" />
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!InvestmentCR12_POM.strC!=0&&InvestmentCR12_POM.strC!=null}"><apex:param value="{!InvestmentCR12_POM.strC}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!InvestmentCR12_POM.strC==0||InvestmentCR12_POM.strC==null}" /><apex:outputText value="{!td_end}" escape="false" />
            </tr>
        </table>
        <br />
        <apex:outputpanel id="ad_indicator" rendered="{!ADorAbove}">
            <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">
                <thead><tr>
                    <td bgcolor="#FF9999" style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">ROI / 投资回报率</td>
                    <td bgcolor="#FF9999" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Result / 结果</td>
                    </tr></thead>
                <tr>
                    <td width="50%" style="border-left: 1px solid black; border-bottom: 1px solid black;">V0.0 ROI</td>
                    <td width="50%" style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI_POM.strA!=null&&ROI_POM.strA!=0}"><apex:param value="{!ROI_POM.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI_POM.strA==null||ROI_POM.strA==0}"/></td> 
                </tr>
                <tr>
                    <td style="border-left: 1px solid black;">Lastest ROI / 修改后ROI</td>
                    <td style="text-align:right; border-left: 1px solid black;border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI_POM.strB!=null&&ROI_POM.strB!=0}"><apex:param value="{!ROI_POM.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI_POM.strB==null||ROI_POM.strB==0}"/></td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black;">Variance / 差异</td>
                    <apex:outputText value="{!normalBlack_bottom}" rendered="{!ROI_POM.strC==null||ROI_POM.strC==0}" escape="false" />
                    <apex:outputText value="{!negativeRed_bottom}" rendered="{!ROI_POM.strC<0}" escape="false" />
                    <apex:outputText value="{!positiveGreen_bottom}" rendered="{!ROI_POM.strC>0}" escape="false" />
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!ROI_POM.strC!=0&&ROI_POM.strC!=null}">
                        <apex:param value="{!ROI_POM.strC}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!ROI_POM.strC==0||ROI_POM.strC==null}" /><apex:outputText value="{!td_end}" escape="false" />
                </tr>
                <tr>
                    <td width="50%" style="border-left: 1px solid black; border-bottom: 1px solid black;">V0.0 ROI (Pro-Forma) 预设投资回报率</td>
                    <td width="50%" style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI_POM.ProFormaROIstrA!=null&&ROI_POM.ProFormaROIstrA!=0}"><apex:param value="{!ROI_POM.ProFormaROIstrA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI_POM.ProFormaROIstrA==null||ROI_POM.ProFormaROIstrA==0}"/></td> 
                </tr>
                <tr>
                    <td style="border-left: 1px solid black;">Latest ROI (Pro-Forma) 修改后预设投资回报率</td>
                    <td style="text-align:right; border-left: 1px solid black;border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI_POM.ProFormaROIstrB!=null&&ROI_POM.ProFormaROIstrB!=0}"><apex:param value="{!ROI_POM.ProFormaROIstrB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI_POM.ProFormaROIstrB==null||ROI_POM.ProFormaROIstrB==0}"/></td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black;">Variance / 差异</td>
                    <apex:outputText value="{!normalBlack_bottom}" rendered="{!ROI_POM.ProFormaROIstrC==null||ROI_POM.ProFormaROIstrC==0}" escape="false" />
                    <apex:outputText value="{!negativeRed_bottom}" rendered="{!ROI_POM.ProFormaROIstrC<0}" escape="false" />
                    <apex:outputText value="{!positiveGreen_bottom}" rendered="{!ROI_POM.ProFormaROIstrC>0}" escape="false" />
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!ROI_POM.ProFormaROIstrC!=0&&ROI_POM.ProFormaROIstrC!=null}">
                        <apex:param value="{!ROI_POM.ProFormaROIstrC}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!ROI_POM.ProFormaROIstrC==0||ROI_POM.ProFormaROIstrC==null}" /><apex:outputText value="{!td_end}" escape="false" />
                </tr>
            </table>
            <br/>  
        </apex:outputpanel>
        
        <!--20160616 Ben @ Elufa-->
        <apex:variable value="{!thisCC.ASI_CRM_New_FY_PO__c}" var="va" rendered="{!thisCC.ASI_CRM_New_FY_PO__c && isFE}">
            <table border="0" cellspacing="0" width="100%" style="font-size: 10px">
                <thead>
                    <tr>
                        <td width="13.333%" colspan="2" style="border-bottom: 1px solid black;">&nbsp;</td>
                        <td width="28.667%" colspan="4" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;" align="center">Last PO Version 上一合同版本</td>
                        <td width="3.667%" colspan="1" style="border-left: 1px solid black;">&nbsp;</td>
                        <td width="22%" colspan="3" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;" align="center">+/-</td>
                        <td width="3.667%" colspan="1" style="border-left: 1px solid black;">&nbsp;</td>
                        <td width="28.667%" colspan="4" bgcolor="#99CCFF" style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Current PO Version 当前合同版本</td>
                    </tr>
                    <tr>
                        <td colspan="2" style=" border-left: 1px solid black; border-bottom: 1px solid black;">A/C CODE</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">CNY 春节(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">MAF 中秋(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">OTHERS 其他(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">Estimate Total 预计总金额</td>
                        <td colspan="1" style=" border-left: 1px solid black;">&nbsp;</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">CNY 春节(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">MAF 中秋(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">OTHERS 其他(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black;">&nbsp;</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">CNY 春节(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">MAF 中秋(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">OTHERS 其他(预估)</td>
                        <td colspan="1" style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Estimate Total 预计总金额</td>
                    </tr>
                </thead>
                <apex:repeat value="{!mapSeasonExpense_diff}" var="varitem">
                    <apex:variable var="v2" value="{!mapSeasonExpense_diff[varitem].strD}" rendered="{!mapSeasonExpense_diff[varitem].strD != 0 || mapSeasonExpense_diff[varitem].strH != 0}">
                        <tr>
                            <td colspan="2" style=" border-left: 1px solid black; border-bottom: 1px solid black;">{!varitem}</td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strA != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strA}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strA == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strB != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strB}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strB == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strC != 0}" style="{!if(mapSeasonExpense_diff[varitem].strC < 0, 'color:red;', '')}" ><apex:param value="{!mapSeasonExpense_diff[varitem].strC}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strC == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strD != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strD}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strD == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black;">&nbsp;</td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!(mapSeasonExpense_diff[varitem].strE - mapSeasonExpense_diff[varitem].strA) != 0}" style="{!if(mapSeasonExpense_diff[varitem].strE - mapSeasonExpense_diff[varitem].strA < 0, 'color:red;', '')}"><apex:param value="{!mapSeasonExpense_diff[varitem].strE - mapSeasonExpense_diff[varitem].strA}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!(mapSeasonExpense_diff[varitem].strE - mapSeasonExpense_diff[varitem].strA) == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!(mapSeasonExpense_diff[varitem].strF - mapSeasonExpense_diff[varitem].strB) != 0}" style="{!if(mapSeasonExpense_diff[varitem].strF - mapSeasonExpense_diff[varitem].strB < 0, 'color:red;', '')}"><apex:param value="{!mapSeasonExpense_diff[varitem].strF - mapSeasonExpense_diff[varitem].strB}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!(mapSeasonExpense_diff[varitem].strF - mapSeasonExpense_diff[varitem].strB) == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!(mapSeasonExpense_diff[varitem].strG - mapSeasonExpense_diff[varitem].strC) != 0}" style="{!if(mapSeasonExpense_diff[varitem].strG - mapSeasonExpense_diff[varitem].strC < 0, 'color:red;', '')}"><apex:param value="{!mapSeasonExpense_diff[varitem].strG - mapSeasonExpense_diff[varitem].strC}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!(mapSeasonExpense_diff[varitem].strG - mapSeasonExpense_diff[varitem].strC) == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black;">&nbsp;</td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strE != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strE}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strE == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strF != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strF}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strF == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strG != 0}" style="{!if(mapSeasonExpense_diff[varitem].strG < 0, 'color:red;', '')}" ><apex:param value="{!mapSeasonExpense_diff[varitem].strG}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strG == 0}"/>
                            </td>
                            <td colspan="1" style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_diff[varitem].strH != 0}"><apex:param value="{!mapSeasonExpense_diff[varitem].strH}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_diff[varitem].strH == 0}"/>
                            </td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
                <tr>
                    <td bgcolor="#FFFFCC" colspan="2" style=" border-left: 1px solid black; border-bottom: 1px solid black;">Total</td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[0] != 0}"><apex:param value="{!seasonExpenseDiff_Total[0]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[0] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[1] != 0}"><apex:param value="{!seasonExpenseDiff_Total[1]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[1] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;" >
                        <apex:outputText style="{!if(seasonExpenseDiff_Total[2] < 0, 'color:red;', '')}" value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[2] != 0}"><apex:param value="{!seasonExpenseDiff_Total[2]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[2] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[3] != 0}"><apex:param value="{!seasonExpenseDiff_Total[3]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[3] == 0}"/>
                    </td>
                    
                    <td colspan="1" style=" border-left: 1px solid black;">&nbsp;</td>
                    
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;" >
                        <apex:outputText style="{!if(seasonExpenseDiff_Total[4] - seasonExpenseDiff_Total[0] < 0, 'color:red;', '')}" value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[4] - seasonExpenseDiff_Total[0] != 0}"><apex:param value="{!seasonExpenseDiff_Total[4] - seasonExpenseDiff_Total[0]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[4] - seasonExpenseDiff_Total[0] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;" >
                        <apex:outputText style="{!if(seasonExpenseDiff_Total[5] - seasonExpenseDiff_Total[1] < 0, 'color:red;', '')}" value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[5] - seasonExpenseDiff_Total[1] != 0}"><apex:param value="{!seasonExpenseDiff_Total[5] - seasonExpenseDiff_Total[1]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[5] - seasonExpenseDiff_Total[1] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;" >
                        <apex:outputText style="{!if(seasonExpenseDiff_Total[6] - seasonExpenseDiff_Total[2] < 0, 'color:red;', '')}" value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[6] - seasonExpenseDiff_Total[2] != 0}"><apex:param value="{!seasonExpenseDiff_Total[6] - seasonExpenseDiff_Total[2]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[6] - seasonExpenseDiff_Total[2] == 0}"/>
                    </td>
                    
                    <td colspan="1" style=" border-left: 1px solid black;">&nbsp;</td>
                    
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[4] != 0}"><apex:param value="{!seasonExpenseDiff_Total[4]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[4] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[5] != 0}"><apex:param value="{!seasonExpenseDiff_Total[5]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[5] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-left: 1px solid black; border-bottom: 1px solid black;" >
                        <apex:outputText style="{!if(seasonExpenseDiff_Total[6] < 0, 'color:red;', '')}" value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[6] != 0}"><apex:param value="{!seasonExpenseDiff_Total[6]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[6] == 0}"/>
                    </td>
                    <td bgcolor="#FFFFCC" colspan="1" style=" border-right: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!seasonExpenseDiff_Total[7] != 0}"><apex:param value="{!seasonExpenseDiff_Total[7]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!seasonExpenseDiff_Total[7] == 0}"/>
                    </td>
                </tr>
            </table>
            <br/>
        </apex:variable>
        <!--20160616 End-->
    </apex:outputpanel>
    
    <apex:variable value="v1" var="" rendered="{!ApprovalComment=='new'}">  
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
            <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="a. Background & Objective" /></td></tr> 
            <tr>
                <td valign="top" style="font-size: 12px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c}" rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c!=null && lstApprovalComment[0].ASI_CRM_Background_Objective__c!=''}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c==null || lstApprovalComment[0].ASI_CRM_Background_Objective__c==''}"/>
                </td>
            </tr>
            <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="b. New Contract Analysis" /></td></tr>   
            <tr>
                <td valign="top" style="font-size: 12px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c}" rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=null  && lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=''}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==null || lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==''}"/>
                </td>
            </tr>    
            <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="c. Historical Contract Performance" /></td></tr>
            <tr>
                <td valign="top" style="font-size: 12px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c}" rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=null && lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=''}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==null || lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==''}"/>
                </td>
            </tr>  
        </table>
    </apex:variable>
    
    <apex:variable value="v2" var="" rendered="{!ApprovalComment=='po'}">  
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
            <tr><td valign="top" style="font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Finance Comments</td></tr> 
            <tr>
                <td valign="top" style="font-size: 12px; line-height: 15px; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black; ">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_BA_comments__c}" rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c!=null}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c==null}"/>
                </td>
            </tr>   
        </table>
    </apex:variable>
</apex:component>