<!--
  @File Name          : ASI_CRM_CN_HeavyPOModificationPDFComp2nd.component
  @Description        : 
  @Author             : pengchen@bluelinksys.com
  @Group              : 
  @Last Modified By   : pengchen@bluelinksys.com
  @Last Modified On   : 4/27/2020, 7:01:10 PM
  @Modification Log   : 
  Ver       Date            Author      		    Modification
  1.0    4/13/2020   pengchen@bluelinksys.com     Initial Version
-->
<apex:component controller="ASI_CRM_CN_HeavyPOModificationPDFCtrl" access="global">

    <apex:attribute name="headerId" type="String" description=" " assignTo="{!currentHeaderId}" />
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar" />
    <apex:attribute name="PDF" description="is this pdf?" type="string" assignto="{!strPDF}" />

    <head>

        <!-- <style>
            @page {
                size: A4;
                margin-top: 0;
            }
     
        </style> -->
        <!-- <style>
            .border{
            width: 100%;border: 1px solid #000000;          
            }
            
            .bold{
            font-weight:bold;   
            }   
            
            h1{
            font-size:20px; 
            font-family: Arial Unicode MS;    
            }
            
            h2{
            font-weight:bold;
            }
            
            table {
            -fs-table-paginate: paginate;
            }
            @page {                       
            size: Landscape;
            margin-top: 5.5cm;
            
            @PageBreak{
            page-break:always;
            page-break-inside:avoid;
            }                   
            
            @top-center {
            content: element(header);
            }
            
            @bottom-right {
            content: counter(page);
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            } 
            @bottom-left {
            content: "BRSF Form";
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            }              
            }
            
            div.header {
            position: running(header);
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            }
            
            body{
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            }
            
            tbody {display:table-row-group;
            }            
            .nobreak{
            page-break-inside: avoid;
            }
            @media print{
            thead{
            display:table-header-group;
            }
            }
            }           
        </style> -->
    </head>

    <div class="header">
        <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr>
                <td colspan="8" align="center">
                    <apex:image height="2cm" width="7cm" url="{!URLFOR($Resource.ASI_MFM_CN_Logo)}" />
                </td>
            </tr>
            <tr>
                <td colspan="8" align="center">
                    <h3>PO Modification Form</h3>
                </td>
            </tr>
        </table>
    </div>
    
    <body style="font-family: Arial Unicode MS;">
        
        
        <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 10px">
            <!-- <tr>
                <td colspan="10" align="center"><apex:image height="2cm" width="7cm" url="{!URLFOR($Resource.ASI_MFM_CN_Logo)}"/></td>
            </tr>
            <tr>
                <td colspan="10" align="center"><h1>CONTRACT PROFITABILITY SHUTTLE 合同利润分析表</h1>
                </td>
                
            </tr> -->
            <tr style="vertical-align: bottom;">
                <td width="15%" style="" align="left"><Strong>REGION/区域</Strong></td>
                <td width="15%" style="border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_Area__r.ASI_CRM_Division__r.ASI_CRM_Region__r.Name}</td>
                <td width="5%"></td>
                <td width="15%" style="" align="center"><Strong>CITY LEVEL/城市级别</Strong></td>
                <td width="5%" style="border-bottom: 1px solid black;" >{!IF(ContractSelected.ASI_CRM_PO_City__c != null,ContractSelected.ASI_CRM_PO_City__r.ASI_CRM_CN_City_Tier__c,ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_City_Tier__c)}</td>
                <td width="5%"> &nbsp;</td>
                <td width="20%" style="" align="center"><strong>CITY NAME/城市</strong></td>
                <td width="20%" style="border-bottom: 1px solid black;" >{!IF(ContractSelected.ASI_CRM_PO_City__c != null,ContractSelected.ASI_CRM_PO_City__r.Name,ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name)}</td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="" align="left"><Strong>OUTLET NAME/店家名称</Strong></td>
                <td colspan="4" style="border-bottom: 1px solid black;">{!ContractSelected.ASI_CRM_CN_Outlet_WS__r.Name}<apex:outputText value=" / {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c}" rendered="{!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != null && ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != ''}" /></td>
                <td width="5%">&nbsp;</td>
                <td style="" align="center" ><Strong>OUTLET TYPE/渠道类别</Strong></td>
                <td style="border-bottom: 1px solid black;">{!ContractSelected.ASI_CRM_PO_Channel__r.Name}</td>
            </tr>
            
            <tr style="vertical-align: bottom;">
                <td style="" align="left"><Strong>PO No/PO号</Strong></td>
                <td style="border-bottom: 1px solid black;">{!ContractSelected.ASI_CRM_CN_PO_No__c}</td>
                <td ></td>
                <td style="" align="center"><Strong>OUTLET SEGMENT/店家形象</Strong></td>
                <td  style="border-bottom: 1px solid black;" >{!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_New_Image__c}</td>
                <td ></td>
                <td style="" align="center" ><Strong>Group Contract/全国合同</Strong></td>
                <td style="border-bottom: 1px solid black;">{!ContractSelected.ASI_CRM_CN_Group_Contract__r.Name}</td>
                <!-- <td></td> -->
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="" align="left" ><Strong>合同编号</Strong></td>
                <td style="border-bottom: 1px solid black;">{!ContractSelected.Name}</td>
            </tr>

        </table>
        <!-- <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">
            <tr>
                <td valign="top" width="20%"
                    style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    PO No<br />PO号</td>
                <td valign="top" width="30%"
                    style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_PO_No__c}</td>
                <td valign="top" width="20%"
                    style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    PO Start Date<br />PO起始日期</td>
                <td valign="top" width="30%"
                    style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,date,dd/MM/yyyy}">
                        <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c}" />
                    </apex:outputText>
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    PO Version<br />PO版本</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_PO_Version__c}</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">PO End
                    Date<br />PO结束日期</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,date,dd/MM/yyyy}">
                        <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_End_Date__c}" />
                    </apex:outputText>
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    Outlet Name<br />店家名称</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.Name}
                    <apex:outputText value=" / {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c}"
                        rendered="{!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != null && ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != ''}" />
                </td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Outlet
                    Type<br />店家类别</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_NewChannel__r.Name}
                    <apex:variable var="outletType" value=""
                        rendered="{!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c!=null}">-
                    </apex:variable>
                    {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}</td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    City Name<br />城市</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!IF(ContractSelected.ASI_CRM_PO_City__c !=
                    null,ContractSelected.ASI_CRM_PO_City__r.Name,ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name)}
                </td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Outlet
                    Segment<br />店家形象</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_New_Image__c}</td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    Promotion Type<br />促销类别</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_TH_CRM_Promotion_Type__c}</td>
                <td valign="top" rowspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    Bottle Collection Rate<br />合同回瓶率</td>
                <td valign="top" rowspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.00}%"
                        rendered="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c!=null}">
                        <apex:param value="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c}" />
                    </apex:outputText>
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    Group Contract<br />全国合同</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    {!ContractSelected.ASI_CRM_CN_Group_Contract__r.Name}
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-right: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">
                    Description<br />备注</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{!ContractSelected.ASI_CRM_CN_Description__c}" />
                </td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Investment
                    type<br />投资类型</td>
                <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{!ContractSelected.ASI_CRM_Investment_Type__c}" />
                </td>
            </tr>
        </table> -->
        <br />
<!--         
        <br/>
 -->
    <table border="0" cellspacing="0" celpadding="2" width="100%" style="font-size: 12px">
        <thead>
            <tr>
                <td width="34%" bgcolor="#99CCFF"
                    style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                    valign="top" align="center">
                    Key Changes vs. Last Version<br />合同期间与上版本变化</td>
                <td width="33%" bgcolor="#99CCFF"
                    style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                    valign="top" align="center">Last Version<br />上个版本</td>
                <td width="33%" bgcolor="#99CCFF"
                    style="border-top: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                    valign="top" align="center">Modified Version<br />本次修改版本</td>
            </tr>
        </thead>
        <tr>
            <td width="34%"
                style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;"
                valign="top">Contract Period / 合同期间</td>
            <td width="33%" style="border-right: 1px solid black;border-bottom: 1px solid black;" valign="top"
                align="center">
                <apex:outputText value="From"
                    rendered="{!ContractSelected.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c!=null}" />
                <apex:outputText value="{0, date, dd/MM/yyyy}">
                    <apex:param value="{!ContractSelected.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c}" />
                </apex:outputText>
                <apex:outputText value=" to "
                    rendered="{!ContractSelected.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c!=null}" />
                <apex:outputText value="{0, date, dd/MM/yyyy}">
                    <apex:param value="{!ContractSelected.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_End_Date__c}" />
                </apex:outputText>
                <apex:outputText value=" - "
                    rendered="{!ContractSelected.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_End_Date__c==null && ContractSelected.ASI_CRM_CN_Last_PO_version__r.ASI_CRM_CN_PO_Start_Date__c==null}" />
            </td>
            <apex:variable var="v1" value="" rendered="{!NOT(boolCheckCCPeriod)}">
                <td width="33%"
                    style="border-right: 1px solid black;border-bottom: 1px solid black;text-align: center;"
                    valign="top">From
                    <apex:outputText value="{0, date, dd/MM/yyyy}">
                        <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c}" />
                    </apex:outputText>
                    <apex:outputText value=" to "
                        rendered="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c!=null}" />
                    <apex:outputText value="{0, date, dd/MM/yyyy}">
                        <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_End_Date__c}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!ContractSelected.ASI_CRM_CN_PO_End_Date__c==null && ContractSelected.ASI_CRM_CN_PO_Start_Date__c==null}" />
                </td>
            </apex:variable>
            <apex:variable var="v2" value="" rendered="{!boolCheckCCPeriod}">
                <td width="33%"
                    style="border-right: 1px solid black;border-bottom: 1px solid black;text-align: center;"
                    valign="top">No Change</td>
            </apex:variable>
        </tr>

        <tr>
            <td
                style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                Covered Outlet / 覆盖店家数
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;text-align: center;">
                {!PreviousCoveredOutletSize}
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;text-align: center;">

                <apex:outputText value="{!CurrentCoveredOutletSize}"
                    rendered="{!CurrentCoveredOutletSize!=PreviousCoveredOutletSize}"></apex:outputText>
                <apex:outputText value="No Change"
                    rendered="{!CurrentCoveredOutletSize==PreviousCoveredOutletSize}"></apex:outputText>

            </td>
        </tr>


    </table>


    <br />


    <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 12px;">
        <tr>
            <td colspan="6" bgcolor="#99CCFF" style="border:1px solid black;border-bottom: 1px solid black;" align="center" ><strong>P&amp;L REVIEW (in RMB) 利润分析表 （元）</strong></td>
        </tr>
        <tr>
            <td width="30%" style="border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;"></td>
            <td width="16%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>

            <td width="16%" align="center" style="border-right: 1px solid black; border-bottom: 1px solid black;">EstimateV0.0<br/>预估V0.0</td>

            <td width="16%" align="center" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                Latest version<br/>修改后合同
            </td>
            <td width="11%" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                vs Estimation<br/>vs 预估V0.0
            </td>
            <td width="11%" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                vs Contract
            </td>
        </tr>
        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
            <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.Volumes!=0&&NewContactV0Contract2nd.Volumes!=null}" >
                    <apex:param value="{!NewContactV0Contract2nd.Volumes}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.Volumes==0||NewContactV0Contract2nd.Volumes==null}"/>
            </td>


            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0EsitContract2nd.Volumes!=0 && NewContractV0EsitContract2nd.Volumes!=null}" >
                    <apex:param value="{!NewContractV0EsitContract2nd.Volumes}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.Volumes==0||NewContractV0EsitContract2nd.Volumes==null}"/>
            </td>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}"  rendered="{!CurrentContract2nd.Volumes!=0 && CurrentContract2nd.Volumes!=null }" >
                    <apex:param value="{!CurrentContract2nd.Volumes}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.Volumes==0 || CurrentContract2nd.Volumes==null}"/>
            </td>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.Volumes!=0 && CurrentContract2nd.Volumes!=null}"><apex:param value="{!(CurrentContract2nd.Volumes-NewContractV0EsitContract2nd.Volumes)}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.Volumes==0||CurrentContract2nd.Volumes==null}"/>
            </td>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.Volumes!=0 && CurrentContract2nd.Volumes!=null}"><apex:param value="{!(CurrentContract2nd.Volumes-NewContactV0Contract2nd.Volumes)}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.Volumes==0||CurrentContract2nd.Volumes==null}"/>
            </td>
        </tr>
        <apex:repeat value="{!nameList}" var="sbgroup">
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">{!sbgroup.CEnName}</td>

                <td align="right" style="border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]==0||NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>

                <td align="right" style="border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0EsitContract2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!NewContractV0EsitContract2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.CategoryMap[sbgroup.Cname]==0||NewContractV0EsitContract2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>

                <td align="right" style="border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]==0||CurrentContract2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>

                <td align="right" style=" border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!(CurrentContract2nd.CategoryMap[sbgroup.Cname]-NewContractV0EsitContract2nd.CategoryMap[sbgroup.Cname])}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]==0||CurrentContract2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>

                <td align="right" style="border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!(CurrentContract2nd.CategoryMap[sbgroup.Cname]-NewContactV0Contract2nd.CategoryMap[sbgroup.Cname])}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.CategoryMap[sbgroup.Cname]==0||CurrentContract2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>

            </tr>
        </apex:repeat>
        <apex:variable var="" value="" rendered="false">
        <tr style="{!IF(contains(groupStr,'C'),'','display:none;')}">
            <td style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Gross Sales 营业额</td>
            <td style="border-right: 1px solid black;border-top: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.GrossSalesTotal!=null}"><apex:param value="{!NewContactV0Contract2nd.GrossSalesTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesTotal==null}"/>
            </td>
            <td style="border-right: 1px solid black;border-top: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0EsitContract2nd.GrossSalesTotal!=null}"><apex:param value="{!NewContractV0EsitContract2nd.GrossSalesTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.GrossSalesTotal==null}"/>
            </td>
            <td style=" border-right: 1px solid black;border-top: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.GrossSalesTotal!=null}">
                    <apex:param value="{!CurrentContract2nd.GrossSalesTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.GrossSalesTotal==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;border-top: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.GrossSalesTotal!=null}"><apex:param value="{!CurrentContract2nd.GrossSalesTotal - NewContractV0EsitContract2nd.GrossSalesTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.GrossSalesTotal==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;border-top: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.GrossSalesTotal!=null}"><apex:param value="{!CurrentContract2nd.GrossSalesTotal - NewContactV0Contract2nd.GrossSalesTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.GrossSalesTotal==null}"/>
            </td>
        </tr>
        </apex:variable>
        <tr>
            <td style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td>
            <td style="border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract2nd.TradeExpenses!=null}"><apex:param value="{!NewContactV0Contract2nd.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.TradeExpenses==null}"/></strong>
            </td>
            <td style="border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0EsitContract2nd.TradeExpenses!=null}"><apex:param value="{!NewContractV0EsitContract2nd.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.TradeExpenses==null}"/></strong>
            </td>

            <td style="border-top: 1px solid black; border-right: 1px solid black;" align="right"  bgcolor="#E3DFDA" >
                <apex:outputText value="({0,number,#,###,###})"  rendered="{!CurrentContract2nd.TradeExpenses!=0}">
                    <apex:param value="{!CurrentContract2nd.TradeExpenses}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.TradeExpenses==0||CurrentContract2nd.TradeExpenses==null}"/>
            </td>

            <td style="border-top: 1px solid black; border-right: 1px solid black;" align="right"  bgcolor="#E3DFDA" >
                <apex:outputText value="{0,number,#,###,###}"  rendered="{!CurrentContract2nd.TradeExpenses!=0}">
                    <apex:param value="{!CurrentContract2nd.TradeExpenses - NewContractV0EsitContract2nd.TradeExpenses}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.TradeExpenses==0||CurrentContract2nd.TradeExpenses==null}"/>
            </td>

            <td style="border-top: 1px solid black; border-right: 1px solid black;" align="right"  bgcolor="#E3DFDA" >
                <apex:outputText value="{0,number,#,###,###}"  rendered="{!CurrentContract2nd.TradeExpenses!=0}">
                    <apex:param value="{!CurrentContract2nd.TradeExpenses - NewContactV0Contract2nd.TradeExpenses}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.TradeExpenses==0||CurrentContract2nd.TradeExpenses==null}"/>
            </td>
        </tr>

        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract2nd.VariableExpense!=null}"><apex:param value="{!NewContactV0Contract2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==null}"/>
            </td>
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0EsitContract2nd.VariableExpense!=null}"><apex:param value="{!NewContractV0EsitContract2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.VariableExpense==null}"/>
            </td>
            <td style=" border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!CurrentContract2nd.VariableExpense!=null}">
                    <apex:param value="{!CurrentContract2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.VariableExpense==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.VariableExpense!=null}"><apex:param value="{!CurrentContract2nd.VariableExpense - NewContractV0EsitContract2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.VariableExpense==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.VariableExpense!=null}"><apex:param value="{!CurrentContract2nd.VariableExpense - NewContactV0Contract2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.VariableExpense==null}"/>
            </td>
        </tr>

        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
            
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract2nd.FixedExpense!=null}"><apex:param value="{!NewContactV0Contract2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpense==null}"/>
            </td>
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0EsitContract2nd.FixedExpense!=null}"><apex:param value="{!NewContractV0EsitContract2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.FixedExpense==null}"/>
            </td>
            <td style=" border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!CurrentContract2nd.FixedExpense!=null}">
                    <apex:param value="{!CurrentContract2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.FixedExpense==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.FixedExpense!=null}"><apex:param value="{!CurrentContract2nd.FixedExpense - NewContractV0EsitContract2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.FixedExpense==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.FixedExpense!=null}"><apex:param value="{!CurrentContract2nd.FixedExpense - NewContactV0Contract2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.FixedExpense==null}"/>
            </td>

        </tr>
        <tr>
            <td style=" border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 % </td>
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=null}"><apex:param value="{!NewContactV0Contract2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpenseRate==null}"/>
            </td>
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0EsitContract2nd.FixedExpenseRate!=null}"><apex:param value="{!NewContractV0EsitContract2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.FixedExpenseRate==null}"/>
            </td>
            <td style=" border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.FixedExpenseRate!=null}">
                    <apex:param value="{!CurrentContract2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.FixedExpenseRate==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.FixedExpenseRate!=null}"><apex:param value="{!CurrentContract2nd.FixedExpenseRate - NewContractV0EsitContract2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.FixedExpenseRate==null}"/>
            </td>

            <td align="right" style="border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.FixedExpenseRate!=null}"><apex:param value="{!CurrentContract2nd.FixedExpenseRate - NewContactV0Contract2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.FixedExpenseRate==null}"/>
            </td>
        </tr>
        <apex:variable rendered="{!contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A')}" value="" var="">
            <tr style="{!IF(contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'A'),'','display:none;')}">
                <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>

                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=null}"><apex:param value="{!NewContactV0Contract2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma==null}"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0EsitContract2nd.GrossSalesRateProForma!=null}"><apex:param value="{!NewContractV0EsitContract2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.GrossSalesRateProForma==null}"/>
                </td>
                <td style=" border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.GrossSalesRateProForma!=null}">
                        <apex:param value="{!CurrentContract2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.GrossSalesRateProForma==null}"/>
                </td>

                <td align="right" style="border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.GrossSalesRateProForma!=null}"><apex:param value="{!CurrentContract2nd.GrossSalesRateProForma - NewContractV0EsitContract2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.GrossSalesRateProForma==null}"/>
                </td>

                <td align="right" style="border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.GrossSalesRateProForma!=null}"><apex:param value="{!CurrentContract2nd.GrossSalesRateProForma - NewContactV0Contract2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.GrossSalesRateProForma==null}"/>
                </td>
            </tr>
        </apex:variable>

        <apex:variable rendered="{!contains(groupStr,'C') ||contains(groupStr,'D')}" value="" var="">
            <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
                <td style=" border-left: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin per Case 单箱净利润 </strong></td>

                <td style=" border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.MarginPerCase!=null}"><apex:param value="{!NewContactV0Contract2nd.MarginPerCase}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginPerCase==null}"/>
                </td>
                <td style=" border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0EsitContract2nd.MarginPerCase!=null}"><apex:param value="{!NewContractV0EsitContract2nd.MarginPerCase}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.MarginPerCase==null}"/>
                </td>
                <td style="  border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.MarginPerCase!=null}">
                        <apex:param value="{!CurrentContract2nd.MarginPerCase}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.MarginPerCase==null}"/>
                </td>

                <td align="right" bgcolor="#FFFF99" style=" border-right: 1px solid black;border-top: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.MarginPerCase!=null && NewContractV0EsitContract2nd.MarginPerCase != null}"><apex:param value="{!CurrentContract2nd.MarginPerCase - NewContractV0EsitContract2nd.MarginPerCase}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.MarginPerCase==null || NewContractV0EsitContract2nd.MarginPerCase == null}"/>
                </td>

                <td align="right" bgcolor="#FFFF99" style=" border-right: 1px solid black;border-top: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.MarginPerCase!=null && NewContactV0Contract2nd.MarginPerCase!=null}"><apex:param value="{!CurrentContract2nd.MarginPerCase - NewContactV0Contract2nd.MarginPerCase}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.MarginPerCase==null || NewContactV0Contract2nd.MarginPerCase==null}"/>
                </td>
            </tr>

            <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" bgcolor="#FFFF99"><strong>CM/NS% 净销售利润率</strong></td>

                <td style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.CMNSRateProForma!=null}"><apex:param value="{!NewContactV0Contract2nd.CMNSRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CMNSRateProForma==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0EsitContract2nd.CMNSRateProForma!=null}"><apex:param value="{!NewContractV0EsitContract2nd.CMNSRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.CMNSRateProForma==null}"/>
                </td>
                <td style=" border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.CMNSRateProForma!=null}">
                        <apex:param value="{!CurrentContract2nd.CMNSRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.CMNSRateProForma==null}"/>
                </td>

                <td align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.CMNSRateProForma!=null}"><apex:param value="{!CurrentContract2nd.CMNSRateProForma - NewContractV0EsitContract2nd.CMNSRateProForma}"/></apex:outputText>
                    <apex:outputText value=" 0% " rendered="{!CurrentContract2nd.CMNSRateProForma==null}"/>
                </td>

                <td align="right" bgcolor="#FFFF99" style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!CurrentContract2nd.CMNSRateProForma!=null}"><apex:param value="{!CurrentContract2nd.CMNSRateProForma - NewContactV0Contract2nd.CMNSRateProForma}"/></apex:outputText>
                    <apex:outputText value=" 0% " rendered="{!CurrentContract2nd.CMNSRateProForma==null}"/>
                </td>
            </tr>
        </apex:variable>
        <tr style=""  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Contract index</strong></td>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma!=null}"><apex:param value="{!NewContactV0Contract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0EsitContract2nd.DomesticContractIndexProForma!=null}"><apex:param value="{!NewContractV0EsitContract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.DomesticContractIndexProForma==null}"/>
            </td>
            <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.DomesticContractIndexProForma!=null}">
                    <apex:param value="{!CurrentContract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.DomesticContractIndexProForma==null}"/>
            </td>

            <td align="right" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.DomesticContractIndexProForma!=null}"><apex:param value="{!CurrentContract2nd.DomesticContractIndexProForma - NewContractV0EsitContract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.DomesticContractIndexProForma==null}"/>
            </td>

            <td align="right" bgcolor="#E3DFDA" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.DomesticContractIndexProForma!=null}"><apex:param value="{!CurrentContract2nd.DomesticContractIndexProForma - NewContactV0Contract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.DomesticContractIndexProForma==null}"/>
            </td>
        </tr>
        <!-- <apex:variable rendered="{!contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A')}" value="" var=""> -->
            <tr style=""  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>vs . Regional Average Index</strong></td>

                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText style="{!IF(NewContactV0Contract2nd.VsRegionalAverageIndexProForma != null && NewContactV0Contract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=null}"><apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText style="{!IF(NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma != null && NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma!=null}"><apex:param value="{!NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma==null}"/>
                </td>
                <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText style="{!IF(CurrentContract2nd.VsRegionalAverageIndexProForma != null && CurrentContract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.VsRegionalAverageIndexProForma!=null}">
                        <apex:param value="{!CurrentContract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.VsRegionalAverageIndexProForma==null}"/>
                </td>

                <td align="right" bgcolor="#E3DFDA" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText style="{!IF(CurrentContract2nd.VsRegionalAverageIndexProForma != null && CurrentContract2nd.VsRegionalAverageIndexProForma - NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.VsRegionalAverageIndexProForma!=null}"><apex:param value="{!CurrentContract2nd.VsRegionalAverageIndexProForma - NewContractV0EsitContract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.VsRegionalAverageIndexProForma==null}"/>
                </td>

                <td align="right" bgcolor="#E3DFDA" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText style="{!IF(CurrentContract2nd.VsRegionalAverageIndexProForma != null && CurrentContract2nd.VsRegionalAverageIndexProForma - NewContactV0Contract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}"  value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.VsRegionalAverageIndexProForma!=null}"><apex:param value="{!CurrentContract2nd.VsRegionalAverageIndexProForma - NewContactV0Contract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!CurrentContract2nd.VsRegionalAverageIndexProForma==null}"/>
                </td>
            </tr>
        <!-- </apex:variable> -->
        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>Total BC %  空瓶回收率(Martell BC%)</strong></td>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContactV0Contract2nd.BCRate!=null}"><apex:param value="{!NewContactV0Contract2nd.BCRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.BCRate==null}"/>

                <apex:outputText value="(" rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}"/>

                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}">
                    <apex:param value="{!NewContactV0Contract2nd.TotalMBCRate}"/>
                </apex:outputText>

                <apex:outputText value=")" rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractV0EsitContract2nd.BCRate!=null}"><apex:param value="{!NewContractV0EsitContract2nd.BCRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0EsitContract2nd.BCRate==null}"/>

                <apex:outputText value="(" rendered="{!NewContractV0EsitContract2nd.TotalMBCRate!=null && NewContractV0EsitContract2nd.TotalMBCRate!=0}"/>

                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractV0EsitContract2nd.TotalMBCRate!=null && NewContractV0EsitContract2nd.TotalMBCRate!=0}">
                    <apex:param value="{!NewContractV0EsitContract2nd.TotalMBCRate}"/>
                </apex:outputText>

                <apex:outputText value=")" rendered="{!NewContractV0EsitContract2nd.TotalMBCRate!=null && NewContractV0EsitContract2nd.TotalMBCRate!=0}"/>
            </td>
            <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.BCRate!=null}">
                    <apex:param value="{!CurrentContract2nd.BCRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.BCRate==null}"/>

                <apex:outputText value="(" rendered="{!CurrentContract2nd.TotalMBCRate!=null && CurrentContract2nd.TotalMBCRate!=0}"/>

                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.TotalMBCRate!=null && CurrentContract2nd.TotalMBCRate!=0}">
                    <apex:param value="{!CurrentContract2nd.TotalMBCRate}"/>
                </apex:outputText>

                <apex:outputText value=")" rendered="{!CurrentContract2nd.TotalMBCRate!=null && CurrentContract2nd.TotalMBCRate!=0}"/>
            </td>

            <td align="right" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.BCRate!=null}">
                    <apex:param value="{!CurrentContract2nd.BCRate - NewContractV0EsitContract2nd.BCRate}"/>
                </apex:outputText>
                <apex:outputText value=" 0% " rendered="{!CurrentContract2nd.BCRate==null}"/>

                <apex:outputText value="(" rendered="{!CurrentContract2nd.TotalMBCRate!=null}"/>

                <!-- <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.TotalMBCRate!=null">
                    <apex:param value="{!CurrentContract2nd.TotalMBCRate-NewContractV0EsitContract2nd.TotalMBCRate}"/>
                </apex:outputText> -->

                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.TotalMBCRate!=null}">
                    <apex:param value="{!CurrentContract2nd.TotalMBCRate - NewContractV0EsitContract2nd.TotalMBCRate}"/>
                </apex:outputText>

                <apex:outputText value=")" rendered="{!CurrentContract2nd.TotalMBCRate!=null}"/>
            </td>

            <td align="right" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.BCRate!=null}">
                    <apex:param value="{!CurrentContract2nd.BCRate - NewContactV0Contract2nd.BCRate}"/>
                </apex:outputText>

                <apex:outputText value=" 0% " rendered="{!CurrentContract2nd.BCRate==null}"/>

                <apex:outputText value="(" rendered="{!CurrentContract2nd.TotalMBCRate!=null}"/>

                <!-- <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.TotalMBCRate!=null">
                    <apex:param value="{!(CurrentContract2nd.TotalMBCRate-NewContactV0Contract2nd.TotalMBCRate)}"/>
                </apex:outputText> -->

                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!CurrentContract2nd.TotalMBCRate!=null}">
                    <apex:param value="{!CurrentContract2nd.TotalMBCRate - NewContactV0Contract2nd.TotalMBCRate}"/>
                </apex:outputText>

                <apex:outputText value=")" rendered="{!CurrentContract2nd.TotalMBCRate!=null}"/>
            </td>
        </tr>
    </table>

    <br/>

    <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">
            <apex:variable value="{!0}" var="TotalvolumeSTD" />
            <apex:variable value="{!0}" var="TotalvolumeSTDVsCon" />
            <apex:variable value="{!0}" var="TotalvolumeSTDVsEst" />
            <apex:variable value="{!0}" var="TotalmonthlyVolumeSTD" />
            <apex:variable value="{!0}" var="TotalmonthlyVolumeSTDVsCon" />
            <apex:variable value="{!0}" var="TotalmonthlyVolumeSTDVsEst" />

            <apex:repeat value="{!subbrandList}" var="sub">
                <apex:variable var="TotalvolumeSTD"
                    value="{!TotalvolumeSTD+sub.volumeSTD}" />
                <apex:variable var="TotalvolumeSTDVsCon"
                    value="{!TotalvolumeSTDVsCon+sub.volumeSTDVsCon}" />
                <apex:variable var="TotalvolumeSTDVsEst"
                    value="{!TotalvolumeSTDVsEst+sub.volumeSTDVsEst}" />
                <apex:variable var="TotalmonthlyVolumeSTD"
                    value="{!TotalmonthlyVolumeSTD+sub.monthlyVolumeSTD}" />
                <apex:variable var="TotalmonthlyVolumeSTDVsCon"
                    value="{!TotalmonthlyVolumeSTDVsCon+sub.monthlyVolumeSTDVsCon}" />
                <apex:variable var="TotalmonthlyVolumeSTDVsEst"
                    value="{!TotalmonthlyVolumeSTDVsEst+sub.monthlyVolumeSTDVsEst}" />
            </apex:repeat>

            <thead>
                <tr>
                    <td rowspan="2"
                    width="22%"
                    style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">
                    Sub-Brands 品牌</td>
                    <td width="78%" bgcolor="#99CCFF" colspan="6" align="center"
                        style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; ">
                        Volume by subbrand (std)品牌销量(标准瓶)</td>
                </tr>
                <tr>
                    <td width="13%" align="center"
                    style="border-left: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black;">
                    Latest total<br/>volume修改<br/>后总销量</td>
                    <td width="13%" align="center" style="border-bottom: 1px solid black;border-top: 1px solid black;border-left: 1px solid black;">vs Contract 对比合同
                    </td>
                    <td width="13%" align="center" style="border-bottom: 1px solid black;border-top: 1px solid black;border-left: 1px solid black;">vs Estimate 对比预估</td>
                    <td width="13%" align="center" style="border-bottom: 1px solid black;border-top: 1px solid black;border-left: 1px solid black;">Latest monthly<br/>volume修改<br/>后月销量</td>
                    <td width="13%" align="center" style="border-bottom: 1px solid black;border-top: 1px solid black;border-left: 1px solid black;">vs Contract 对比合同</td>
                    <td width="13%" align="center" style="border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;border-top: 1px solid black;">vs Estimate 对比预估</td>
                </tr>
            </thead>
            <apex:repeat value="{!subbrandList}" var="sub" rows="20">
                <apex:variable rendered="{!!(sub.subString == '999' || ((sub.volumeSTDVsCon == 0 || sub.volumeSTDVsCon == null) && (sub.volumeSTDVsEst ==0 || sub.volumeSTDVsEst == null)&&(sub.monthlyVolumeSTDVsCon == 0 || sub.monthlyVolumeSTDVsCon == null) && (sub.monthlyVolumeSTDVsEst == 0  || sub.monthlyVolumeSTDVsEst == null)))}" value="" var="">
                    <tr style="{!IF(sub.subString == '999' || ((sub.volumeSTDVsCon == 0 || sub.volumeSTDVsCon == null) && (sub.volumeSTDVsEst ==0 || sub.volumeSTDVsEst == null)&&(sub.monthlyVolumeSTDVsCon == 0 || sub.monthlyVolumeSTDVsCon == null) && (sub.monthlyVolumeSTDVsEst == 0  || sub.monthlyVolumeSTDVsEst == null)), 'display:none; ', '')}">
                        <td style="border-left: 1px solid black; border-bottom: 1px solid black;">
                            {!sub.subString}
                        </td>
                        <td align="center" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!sub.volumeSTD!=null && sub.volumeSTD!=0}">
                                <apex:param value="{!sub.volumeSTD}"/>
                            </apex:outputText>
                            <apex:outputText value="-"
                            rendered="{!sub.volumeSTD==null || sub.volumeSTD==0}" />
                        </td>
                        <td align="center" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                            <apex:variable rendered="{!sub.volumeSTDVsCon!=null && sub.volumeSTDVsCon >= 0}" value="" var="">
                            <apex:outputText rendered="{!sub.volumeSTDVsCon!=null}" style="{!IF(sub.volumeSTDVsCon < 0, 'display: none;', 'color: green;')}" value="+"/>
                            </apex:variable>
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!sub.volumeSTDVsCon!=null}"
                                             style="color:{!IF(sub.volumeSTDVsCon < 0, 'red', 'green')};">
                                <apex:param value="{!sub.volumeSTDVsCon}" />
                            </apex:outputText>
                            <apex:outputText value="-"
                            rendered="{!sub.volumeSTDVsCon==null}" />
                        </td>

                        <td align="center" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                            <apex:variable rendered="{!sub.volumeSTDVsEst!=null && sub.volumeSTDVsEst >= 0}" value="" var="">
                            <apex:outputText rendered="{!sub.volumeSTDVsEst!=null}" style="{!IF(sub.volumeSTDVsEst < 0, 'display: none;', 'color: green;')}" value="+"/>
                            </apex:variable>
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!sub.volumeSTDVsEst!=null}"
                                             style="color:{!IF(sub.volumeSTDVsEst < 0, 'red', 'green')};">
                                <apex:param value="{!sub.volumeSTDVsEst}" />
                            </apex:outputText>
                            <apex:outputText value="-"
                            rendered="{!sub.volumeSTDVsEst==null}" />
                        </td>
                        <td align="center" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!sub.monthlyVolumeSTD!=null && sub.monthlyVolumeSTD!=0}">
                                <apex:param value="{!sub.monthlyVolumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value="-"
                            rendered="{!sub.monthlyVolumeSTD==null || sub.monthlyVolumeSTD==0}" />
                        </td>
                        <td align="center" style=" border-left: 1px solid black; border-bottom: 1px solid black;">
                            <apex:variable rendered="{!sub.monthlyVolumeSTDVsCon!=null && sub.monthlyVolumeSTDVsCon >= 0}" value="" var="">
                                <apex:outputText rendered="{!sub.monthlyVolumeSTDVsCon!=null}" style="{!IF(sub.monthlyVolumeSTDVsCon < 0, 'display: none;', 'color: green;')}" value="+"/>
                            </apex:variable>
                            <!-- <apex:outputText rendered="{!sub.monthlyVolumeSTDVsCon!=null}" style="{!IF(sub.monthlyVolumeSTDVsCon <= 0, 'display: none;', 'color: green;')}" value="+"/> -->
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!sub.monthlyVolumeSTDVsCon!=null}"
                                             style="color:{!IF(sub.monthlyVolumeSTDVsCon < 0, 'red', 'green')};">
                                <apex:param value="{!sub.monthlyVolumeSTDVsCon}" />
                            </apex:outputText>
                            <apex:outputText value="-"
                            rendered="{!sub.monthlyVolumeSTDVsCon==null}" />
                        </td>
                        <td align="center" style=" border-left: 1px solid black;border-right:1px solid black; border-bottom: 1px solid black;">
                            <apex:variable rendered="{!sub.monthlyVolumeSTDVsEst!=null && sub.monthlyVolumeSTDVsEst >= 0}" value="" var="">
                                <apex:outputText rendered="{!sub.monthlyVolumeSTDVsEst!=null}" style="{!IF(sub.monthlyVolumeSTDVsEst < 0, 'display: none;', 'color: green;')}" value="+"/>
                            </apex:variable>
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!sub.monthlyVolumeSTDVsEst!=null}"
                                             style="color:{!IF(sub.monthlyVolumeSTDVsEst < 0, 'red', 'green')};">
                                <apex:param value="{!sub.monthlyVolumeSTDVsEst}" />
                            </apex:outputText>
                            <apex:outputText value="-"
                            rendered="{!sub.monthlyVolumeSTDVsEst==null}" />
                        </td>
                    </tr>
                </apex:variable>
            </apex:repeat>
                <tr>
                    <td bgcolor="#E3DFDA" style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        All products  品牌合计
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                                         rendered="{!TotalvolumeSTD!=null && TotalvolumeSTD!=0}">
                            <apex:param value="{!TotalvolumeSTD}"/>
                        </apex:outputText>
                        <apex:outputText value="-"
                        rendered="{!TotalvolumeSTD==null||TotalvolumeSTD==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:variable rendered="{!TotalvolumeSTDVsCon > 0}" value="" var="">
                            <apex:outputText rendered="{!TotalvolumeSTDVsCon!=null && TotalvolumeSTDVsCon!=0}" style="{!IF(TotalvolumeSTDVsCon < 0, 'display: none;', 'color: green;')}" value="+"/>
                        </apex:variable>
                        <apex:outputText value="{0,number,#,###,###}"
                                         rendered="{!TotalvolumeSTDVsCon!=null && TotalvolumeSTDVsCon!=0}"
                                         style="color:{!IF(TotalvolumeSTDVsCon < 0, 'red', 'green')};">
                            <apex:param value="{!TotalvolumeSTDVsCon}" />
                        </apex:outputText>
                        <apex:outputText value="-"
                        rendered="{!TotalvolumeSTDVsCon==null||TotalvolumeSTDVsCon==0}" />
                    </td>

                    <td align="center" bgcolor="#E3DFDA" style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:variable rendered="{!TotalvolumeSTDVsEst >= 0}" value="" var="">
                            <apex:outputText rendered="{!TotalvolumeSTDVsEst!=null && TotalvolumeSTDVsEst!=0}" style="{!IF(TotalvolumeSTDVsEst < 0, 'display: none;', 'color: green;')}" value="+"/>
                        </apex:variable>
                        <apex:outputText value="{0,number,#,###,###}"
                                         rendered="{!TotalvolumeSTDVsEst!=null && TotalvolumeSTDVsEst!=0}"
                                         style="color:{!IF(TotalvolumeSTDVsEst < 0, 'red', 'green')};">
                            <apex:param value="{!TotalvolumeSTDVsEst}" />
                        </apex:outputText>
                        <apex:outputText value="-"
                        rendered="{!TotalvolumeSTDVsEst==null||TotalvolumeSTDVsEst==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                                         rendered="{!TotalmonthlyVolumeSTD!=null && TotalmonthlyVolumeSTD!=0}">
                            <apex:param value="{!TotalmonthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value="-"
                        rendered="{!TotalmonthlyVolumeSTD==null||TotalmonthlyVolumeSTD==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        <apex:variable rendered="{!TotalmonthlyVolumeSTDVsCon >= 0}" value="" var="">
                            <apex:outputText rendered="{!TotalmonthlyVolumeSTDVsCon!=null && TotalmonthlyVolumeSTDVsCon!=0}" style="{!IF(TotalmonthlyVolumeSTDVsCon < 0, 'display: none;', 'color: green;')}" value="+"/>
                        </apex:variable>
                        <apex:outputText value="{0,number,#,###,###}"
                                         rendered="{!TotalmonthlyVolumeSTDVsCon!=null && TotalmonthlyVolumeSTDVsCon!=0}"
                                         style="color:{!IF(TotalmonthlyVolumeSTDVsCon < 0, 'red', 'green')};">
                            <apex:param value="{!TotalmonthlyVolumeSTDVsCon}" />
                        </apex:outputText>
                        <apex:outputText value="-"
                        rendered="{!TotalmonthlyVolumeSTDVsCon==null||TotalmonthlyVolumeSTDVsCon==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;">
                        <apex:variable rendered="{!TotalmonthlyVolumeSTDVsEst >= 0}" value="" var="">
                            <apex:outputText rendered="{!TotalmonthlyVolumeSTDVsEst!=null && TotalmonthlyVolumeSTDVsEst!=0}" style="{!IF(TotalmonthlyVolumeSTDVsEst < 0, 'display: none;', 'color: green;')}" value="+"/>
                        </apex:variable>
                        <apex:outputText value="{0,number,#,###,###}"
                                         rendered="{!TotalmonthlyVolumeSTDVsEst!=null && TotalmonthlyVolumeSTDVsEst!=0}"
                                         style="color:{!IF(TotalmonthlyVolumeSTDVsEst < 0, 'red', 'green')};">
                            <apex:param value="{!TotalmonthlyVolumeSTDVsEst}" />
                        </apex:outputText>
                        <apex:outputText value="-"
                        rendered="{!TotalmonthlyVolumeSTDVsEst==null||TotalmonthlyVolumeSTDVsEst==0}" />
                    </td>
                </tr>
    </table>
    <br/>


    <apex:variable rendered="{!contains(groupStr,'A') || contains(groupStr,'B') || contains(groupStr,'C')}" value="" var="">
        <table width="100%" cellspacing="0" cellpadding="2" style="{!IF(contains(groupStr,'A') || contains(groupStr,'B') || contains(groupStr,'C'),'','display:none;')} font-size: 12px;">
            <apex:variable value="{!0}" var="PS_TotalLastEstAmt" />
            <apex:variable value="{!0}" var="PS_TotalPaidAmt" />
            <apex:variable value="{!0}" var="PS_TotalPOEstAmt" />

            <thead>
                <tr>
                    <td width="30%" valign="top">&nbsp;</td>
                    <td width="14%" valign="top" align="center">上版预估金额</td>
                    <td width="14%" valign="top" align="center">已支付金额</td>
                    <td width="14%" valign="top" align="center">剩余金额</td>
                    <td width="14%" valign="top" align="center">本次增减变动金额</td>
                    <td width="14%" valign="top" align="center">最终预估金额</td>
                </tr>
            </thead>
            <apex:repeat value="{!paymentRequestSummary}" var="ps">

                <apex:variable var="PS_TotalLastEstAmt"
                    value="{!PS_TotalLastEstAmt+ps.LastVersion_POEstimatedAmount}" />
                <apex:variable var="PS_TotalPaidAmt" value="{!PS_TotalPaidAmt+ps.PaymentRequestAmount}" />
                <apex:variable var="PS_TotalPOEstAmt" value="{!PS_TotalPOEstAmt+ps.POEstimatedAmount}" />

                <tr>
                    <td valign="top">
                        <!-- <apex:outputText value="{!ps.EnglishDescription}" rendered="{!ps.EnglishDescription!=null}" /> -->
                        <apex:outputText value="{!ps.Name}" rendered="{!ps.Name!=null}" />
                    </td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ps.LastVersion_POEstimatedAmount!=null&&ps.LastVersion_POEstimatedAmount!=0}">
                            <apex:param value="{!ps.LastVersion_POEstimatedAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ps.LastVersion_POEstimatedAmount==null||ps.LastVersion_POEstimatedAmount==0}" />
                    </td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ps.PaymentRequestAmount!=null&&ps.PaymentRequestAmount!=0}">
                            <apex:param value="{!ps.PaymentRequestAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ps.PaymentRequestAmount==null||ps.PaymentRequestAmount==0}" />
                    </td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ps.LastVersion_POEstimatedAmount!=null&&ps.PaymentRequestAmount!=null}">
                            <apex:param value="{!ps.LastVersion_POEstimatedAmount-ps.PaymentRequestAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ps.LastVersion_POEstimatedAmount==null||ps.PaymentRequestAmount==null}" />
                    </td>
                    <td align="right" valign="top" style="border-top: 1px solid black; border-left: 1px solid black;">
                        <apex:variable rendered="{!ps.POEstimatedAmount-ps.LastVersion_POEstimatedAmount > 0}" value="" var="">
                            <apex:outputText value="+"/>
                        </apex:variable>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ps.POEstimatedAmount!=null&&ps.LastVersion_POEstimatedAmount!=null && ps.POEstimatedAmount!=ps.LastVersion_POEstimatedAmount}">
                            <apex:param value="{!ps.POEstimatedAmount-ps.LastVersion_POEstimatedAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ps.POEstimatedAmount==null||ps.LastVersion_POEstimatedAmount==null|| ps.POEstimatedAmount==ps.LastVersion_POEstimatedAmount}" />
                    </td>
                    <td align="right" valign="top"
                        style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ps.POEstimatedAmount!=null&&ps.POEstimatedAmount!=0}">
                            <apex:param value="{!ps.POEstimatedAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ps.POEstimatedAmount==null||ps.POEstimatedAmount==0}" />
                    </td>


                </tr>
            </apex:repeat>

            <tr>
                <td valign="top">Total Investment / 总金额</td>
                <td valign="top" align="right" bgcolor="#FFFF99"
                    style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!PS_TotalLastEstAmt!=null&&PS_TotalLastEstAmt!=0}">
                        <apex:param value="{!PS_TotalLastEstAmt}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalLastEstAmt==null||PS_TotalLastEstAmt==0}" />
                </td>
                <td valign="top" align="right" bgcolor="#FFFF99"
                    style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!PS_TotalPaidAmt!=null&&PS_TotalPaidAmt!=0}">
                        <apex:param value="{!PS_TotalPaidAmt}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalPaidAmt==null||PS_TotalPaidAmt==0}" />
                </td>
                <td valign="top" align="right" bgcolor="#FFFF99"
                    style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!PS_TotalLastEstAmt!=null&&PS_TotalPaidAmt!=null&&PS_TotalLastEstAmt!=PS_TotalPaidAmt}">
                        <apex:param value="{!PS_TotalLastEstAmt-PS_TotalPaidAmt}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!PS_TotalLastEstAmt==null||PS_TotalPaidAmt==null ||PS_TotalLastEstAmt==PS_TotalPaidAmt }" />
                </td>
                <td valign="top" align="right" bgcolor="#FFFF99"
                    style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black;">
                    <apex:outputText value="+" rendered="{!PS_TotalPOEstAmt-PS_TotalLastEstAmt > 0}"/>
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!PS_TotalPOEstAmt!=null&&PS_TotalLastEstAmt!=null&&PS_TotalPOEstAmt!=PS_TotalLastEstAmt}">
                        <apex:param value="{!PS_TotalPOEstAmt-PS_TotalLastEstAmt}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!PS_TotalPOEstAmt==null||PS_TotalLastEstAmt==null || PS_TotalPOEstAmt==PS_TotalLastEstAmt}" />
                </td>
                <td valign="top" align="right" bgcolor="#FFFF99"
                    style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!PS_TotalPOEstAmt!=null&&PS_TotalPOEstAmt!=0}">
                        <apex:param value="{!PS_TotalPOEstAmt}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!PS_TotalPOEstAmt==null||PS_TotalPOEstAmt==0}" />
                </td>
            </tr>

        </table>
    </apex:variable>
    <br/>
        

        <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
            <thead>
                <tr>
                    <td width="20%"></td>
                    <td width="20%" align="center">Theoretical Amount<br />建议预估金额</td>
                    <td width="20%" align="center">Modified Amount<br />本次修改金额</td>
                    <td width="20%" align="center">vs Theoretical<br />Amount vs 建议<br />预估金额</td>
                    <td width="20%" align="center">+/- Amount 本次<br />增减变动金额</td>
                </tr>
            </thead>
            <apex:variable value="{!0}" var="THVarGap" />
            <apex:variable value="{!0}" var="THFixGap" />
            <apex:variable value="{!0}" var="THAmount" />
            <apex:variable value="{!0}" var="THGap" />

            <apex:variable var="vc" value="" rendered="{!boolVariableCost}">

                <apex:variable var="THAmount" value="{!THAmount+ActVSEst_Vol}" />
                <apex:variable var="THVarGap" value="{!Mod_VCost-ActVSEst_Vol}" />
                <tr>
                    <td>Variable Cost / 变动费用</td>
                    <td
                        style="border-top:1px solid black;border-bottom:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActVSEst_Vol!=null&&ActVSEst_Vol!=0}">
                            <apex:param value="{!ActVSEst_Vol}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActVSEst_Vol==null||ActVSEst_Vol==0}" />
                    </td>
                    <td
                        style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!Mod_VCost!=null&&Mod_VCost!=0}">
                            <apex:param value="{!Mod_VCost}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!Mod_VCost==null||Mod_VCost==0}" />
                    </td>
                    <!--
                <td style=" {!IF(THVarGap<0,'color:#FF0000;','')} ;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;text-align:right;margin-left:30px;{!IF(THVarGap>0,'color:#33CC33;','')}">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!THVarGap!=0 && THVarGap!=null}"><apex:param value="{!THVarGap}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!THVarGap==0||THVarGap==null}" />
                </td>
                -->
                    <apex:outputText value="{!normalBlack_Top_bottom}" rendered="{!THVarGap==null||THVarGap==0}"
                        escape="false" />
                    <apex:outputText value="{!negativeRed_Top_bottom}" rendered="{!THVarGap<0}" escape="false" />
                    <apex:outputText value="{!positiveGreen_Top_bottom}" rendered="{!THVarGap>0}" escape="false" />
                    <apex:variable var="" value="" rendered="{!THVarGap!=0&&THVarGap!=null && THVarGap > 0}">
                        <apex:outputText value="+" style="color: red;"/>
                        <apex:outputText style="color: red;" value="{0,number,#,###,###}" rendered="{!THVarGap!=0&&THVarGap!=null}">
                            <apex:param value="{!THVarGap}" />
                        </apex:outputText>
                    </apex:variable>
                    <apex:variable var="" value="" rendered="{!THVarGap!=0&&THVarGap!=null && THVarGap < 0}">
                        <apex:outputText value="{0,number,#,###,###}" style="color: green;" rendered="{!THVarGap!=0&&THVarGap!=null}">
                            <apex:param value="{!THVarGap}" />
                        </apex:outputText>
                    </apex:variable>
                    
                    <apex:outputText value=" - " rendered="{!THVarGap==0||THVarGap==null}" />
                    <apex:outputText value="{!td_end}" escape="false" />
                    <td
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;text-align:right;margin-left:30px;">
                        <apex:variable var="" value="" rendered="{!ModVCAmount >= 0}">
                            <apex:outputText value="+"/>
                        </apex:variable>
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!ModVCAmount!=null&&ModVCAmount!=0}">
                            <apex:param value="{!ModVCAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ModVCAmount==null||ModVCAmount==0}" />
                    </td>
                </tr>
            </apex:variable>

            <apex:variable var="vf" value="" rendered="{!boolFixedCost}">
                <apex:variable var="THAmount" value="{!THAmount+strv0FixCost}" />
                <apex:variable var="THVarGap" value="{!strv0FixCost-strv0FixCost}" />
                <tr>
                    <td>Fixed Cost / 固定费用</td>
                    <td
                        style="border-bottom:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!strv0FixCost!=null&&strv0FixCost!=0}">
                            <apex:param value="{!strv0FixCost}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!strv0FixCost==null||strv0FixCost==0}" />
                    </td>
                    <td
                        style="border-bottom:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!strv0FixCost!=null&&strv0FixCost!=0}">
                            <apex:param value="{!strv0FixCost}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!strv0FixCost==null||strv0FixCost==0}" />
                    </td>
                    <!--
                <td style=" {!IF(THFixGap<0,'color:#FF0000;','')} ;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;text-align:right;margin-left:30px;
                           {!IF(THFixGap>0,'color:#33CC33;','')}" >
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!THFixGap!=0&&THFixGap!=null}">
                        <apex:param value="{!THFixGap}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!THFixGap==0||THFixGap==null}" />
                </td>
                -->
                    <apex:outputText value="{!normalBlack_bottom}" rendered="{!THFixGap==null||THFixGap==0}"
                        escape="false" />
                    <apex:outputText value="{!negativeRed_bottom}" rendered="{!THFixGap<0}" escape="false" />
                    <apex:outputText value="{!positiveGreen_bottom}" rendered="{!THFixGap>0}" escape="false" />
                    <apex:variable var="" value="" rendered="{!THFixGap!=0&&THFixGap!=null && THFixGap > 0}">
                        <apex:outputText value="+" style="color: red;"/>
                        <apex:outputText style="color: red;" value="{0,number,#,###,###}" rendered="{!THFixGap!=0&&THFixGap!=null}">
                            <apex:param value="{!THFixGap}" />
                        </apex:outputText>
                    </apex:variable>
                    <apex:variable var="" value="" rendered="{!THFixGap!=0&&THFixGap!=null && THFixGap < 0}">
                        <apex:outputText value="{0,number,#,###,###}" style="color: green;" rendered="{!THFixGap!=0&&THFixGap!=null}">
                            <apex:param value="{!THFixGap}" />
                        </apex:outputText>
                    </apex:variable>

                    <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!THFixGap!=0&&THFixGap!=null}">
                        <apex:param value="{!THFixGap}" />
                    </apex:outputText> -->
                    <apex:outputText value=" - " rendered="{!THFixGap==0||THFixGap==null}" />
                    <apex:outputText value="{!td_end}" escape="false" />
                    <td
                        style="border-bottom:1px solid black;border-right:1px solid black;text-align:right;margin-left:30px;">
                        <apex:outputText value="+" rendered="{!ModFCAmount!=null&&ModFCAmount!=0&&ModFCAmount > 0}"/>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ModFCAmount!=null&&ModFCAmount!=0}">
                            <apex:param value="{!ModFCAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ModFCAmount==null||ModFCAmount==0}" />
                    </td>
                </tr>
            </apex:variable>

            <tr>
                <apex:variable var="THGap" value="{!Mod_VCost+strv0FixCost-THAmount}" rendered="{!strv0FixCost!= 0}" />

                <apex:variable var="THGap" value="{!Mod_VCost-THAmount}" rendered="{!strv0FixCost== 0}" />
                <td>Total Investment / 总金额</td>
                <td
                    style="border-bottom:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!THAmount!=null&&THAmount!=0}">
                        <apex:param value="{!THAmount}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!THAmount==null||THAmount==0}" />
                </td>
                <td
                    style="border-bottom:1px solid black;border-left:1px solid black;text-align:right;margin-left:30px;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!Mod_VCost + strv0FixCost!=0}">
                        <apex:param value="{!Mod_VCost +strv0FixCost}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!Mod_VCost + strv0FixCost == 0}" />

                </td>
                <!--<td  style=" {!IF(THGap<0,'color:#FF0000;','')} ;border:1px solid black;text-align:right;margin-left:30px;{!IF(THGap>0,'color:#33CC33;','')}"  >
                <apex:outputText value="{0,number,#,###,###}" rendered="{!THGap!=0&&THGap!=null}"><apex:param value="{!THGap}" /></apex:outputText>
            </td>-->


                <apex:outputText value="{!normalBlack_bottom}" rendered="{!THGap==null||THGap==0}" escape="false" />
                <apex:outputText value="{!negativeRed_bottom}" rendered="{!THGap<0}" escape="false" />
                <apex:outputText value="{!positiveGreen_bottom}" rendered="{!THGap>0}" escape="false" />

                <apex:variable var="" value="" rendered="{!THGap!=0&&THGap!=null && THGap > 0}">
                    <apex:outputText value="+" style="color: red;"/>
                    <apex:outputText style="color: red;" value="{0,number,#,###,###}" rendered="{!THGap!=0&&THGap!=null}">
                        <apex:param value="{!THGap}" />
                    </apex:outputText>
                </apex:variable>
                <apex:variable var="" value="" rendered="{!THGap!=0&&THGap!=null && THGap < 0}">
                    <apex:outputText value="{0,number,#,###,###}" style="color: green;" rendered="{!THGap!=0&&THGap!=null}">
                        <apex:param value="{!THGap}" />
                    </apex:outputText>
                </apex:variable>
                <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!THGap!=0&&THGap!=null}">
                    <apex:param value="{!THGap}" />
                </apex:outputText> -->
                <apex:outputText value=" - " rendered="{!THGap==0||THGap==null}" />
                <apex:outputText value="{!td_end}" escape="false" />

                <td
                    style="border-bottom:1px solid black;border-right:1px solid black;text-align:right;margin-left:30px;">
                    <apex:outputText value="+" rendered="{!ModFCAmount + ModVCAmount!=0 && ModFCAmount + ModVCAmount > 0}"/>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!ModFCAmount + ModVCAmount!=0}">
                        <apex:param value="{!ModFCAmount +ModVCAmount}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!ModFCAmount + ModVCAmount == 0}" />

                </td>

            </tr>


        </table>


        
        <!-- <div style="page-break-after: always;">
            </div> -->


        <br />

        <!-- <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">

            <thead>
                <tr>
                    <td></td>
                    <td width="85%" bgcolor="#99CCFF" colspan="3" align="center"
                        style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        Volume by subbrand (std)品牌销量(标准瓶)</td>
                </tr>
            </thead>
            <tr>
                <td width="15%"
                    style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">
                    Sub-Brands 品牌</td>
                <td align="center"
                    style="border-left: 1px solid black; border-bottom: 1px solid black;border-right: 1px solid black;">
                    Latest  total volume修改后总销量</td>
                <td align="center" style="border-right: 1px solid black;border-bottom: 1px solid black;">Contract 合同
                </td>
                <td align="center" style="border: 1px solid black;">%Latest 修改后</td>
            </tr>
            <apex:repeat value="{!subbrandList}" var="sub">
                <tr>
                    <td style="border-left: 1px solid black; border-bottom: 1px solid black;">{!sub.subString}</td>
                    <td style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.00}%"
                                         rendered="{!sub.modifyQty!=null && sub.modifyQty!=0}">
                            <apex:param value="{!sub.modifyQty}"/>
                        </apex:outputText>
                        <apex:outputText value="0%"
                        rendered="{!sub.modifyQty==null||sub.modifyQty==0}" />
                    </td>
                    <td style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.00}%"
                                         rendered="{!sub.v00Qty!=null && sub.v00Qty!=0}">
                            <apex:param value="{!sub.v00Qty}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                        rendered="{!sub.v00Qty==null||sub.v00Qty==0}" />
                    </td>
                    <td style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.00}%"
                                         rendered="{!sub.qty!=null && sub.qty!=0}">
                            <apex:param value="{!sub.qty}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                        rendered="{!sub.qty==null||sub.qty==0}" />
                    </td>
                </tr>
            </apex:repeat>
        </table> -->
        <!-- <br /> -->
        
        <!-- <table border="0" cellspacing="0" cellpadding="2" width="100%" style="font-size: 12px">

            <thead>
                <tr>
                    <td width="50%" rowspan="2" bgcolor="#99CCFF"
                        style="border-top: 1px solid black; border-left: 1px solid black; border-bottom: 1px solid black;">
                        Key Fin. Indicator / 财务指标</td>
                    <td width="50%" bgcolor="#99CCFF" colspan="3" align="center"
                        style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        Result / 结果</td>
                </tr>
                <tr>
                    <td align="center"
                        style="border-bottom: 1px solid black;border-left: 1px solid black; ">
                        Contract 合同</td>
                    <td align="center" style="border-left: 1px solid black;border-bottom: 1px solid black;">Latest 修改后
                    </td>
                    <td align="center" style="border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;">vs.</td>
                </tr>
            </thead>

            <tr
                style="{!IF(contains(groupStr,'D') || contains(groupStr,'C'),'','display:none;')}">
                <td bgcolor="#E3DFDA"
                    style="border-left: 1px solid black; border-bottom: 1px solid black;">Contract index</td>
                <td
                    style="text-align:right; border-left: 1px solid black; border-bottom: 1px solid black;"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!HistoricalContract2nd.DomesticContractIndexProForma!=null&&HistoricalContract2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!HistoricalContract2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalContract2nd.DomesticContractIndexProForma==null||HistoricalContract2nd.DomesticContractIndexProForma==0}" />
                </td>
                <td
                    style="text-align:right; border-left: 1px solid black; border-bottom: 1px solid black;"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!CurrentContract2nd.DomesticContractIndexProForma!=null&&CurrentContract2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!CurrentContract2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!CurrentContract2nd.DomesticContractIndexProForma==null||CurrentContract2nd.DomesticContractIndexProForma==0}" />
                </td>
                <td
                    style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!CurrentContract2nd.DomesticContractIndexProForma!=null&&CurrentContract2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!CurrentContract2nd.DomesticContractIndexProForma-HistoricalContract2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!CurrentContract2nd.DomesticContractIndexProForma==null||CurrentContract2nd.DomesticContractIndexProForma==0}" />
                </td>
            </tr>
            <tr
                style="{!IF(contains(groupStr,'A') || contains(groupStr,'B') || contains(groupStr,'C'),'','display:none;')}">
                <td style="border-left: 1px solid black; border-bottom: 1px solid black;" bgcolor="#E3DFDA">Regional Index</td>
                <td
                    style="text-align:right; border-left: 1px solid black; border-bottom: 1px solid black;"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!HistoricalContract2nd.RegionalTargetIndexProForma!=null&&HistoricalContract2nd.RegionalTargetIndexProForma!=0}">
                        <apex:param value="{!HistoricalContract2nd.RegionalTargetIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalContract2nd.RegionalTargetIndexProForma==null||HistoricalContract2nd.RegionalTargetIndexProForma==0}" />
                </td>
                <td
                    style="text-align:right; border-left: 1px solid black; border-bottom: 1px solid black;"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!CurrentContract2nd.RegionalTargetIndexProForma!=null&&CurrentContract2nd.RegionalTargetIndexProForma!=0}">
                        <apex:param value="{!CurrentContract2nd.RegionalTargetIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!CurrentContract2nd.RegionalTargetIndexProForma==null||CurrentContract2nd.RegionalTargetIndexProForma==0}" />
                </td>
                <td bgcolor="#E3DFDA"
                    style="text-align:right; border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!CurrentContract2nd.RegionalTargetIndexProForma!=null&&CurrentContract2nd.RegionalTargetIndexProForma!=0}">
                        <apex:param value="{!CurrentContract2nd.RegionalTargetIndexProForma-HistoricalContract2nd.RegionalTargetIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!CurrentContract2nd.RegionalTargetIndexProForma==null||CurrentContract2nd.RegionalTargetIndexProForma==0}" />
                </td>
            </tr> -->
            <!-- <tr>
            <td style="border-left: 1px solid black;">Latest Investment per CR12 Extra btl/修改后折CR12新境单瓶投入</td>
            <td style="text-align:right;border-left: 1px solid black; border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!CurrentContract2nd.InvestmentCR12!=null&&CurrentContract2nd.InvestmentCR12!=0}">
                    <apex:param value="{!CurrentContract2nd.InvestmentCR12}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!CurrentContract2nd.InvestmentCR12==null||CurrentContract2nd.InvestmentCR12==0}"/></td>
        </tr> -->
            <!--<tr>
            <td style="border-left: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;">Variance / 差异</td>
            <td style=" {!IF(InvestmentCR12Variance<0,'color:#FF0000;','')} ;border:1px solid black;text-align:right;margin-left:30px;{!IF(InvestmentCR12Variance>0,'color:#33CC33;','')}"  >
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!InvestmentCR12Variance!=0 && InvestmentCR12Variance!=null}"><apex:param value="{!InvestmentCR12Variance}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!InvestmentCR12Variance==0||InvestmentCR12Variance==null}" />
            </td>

        </tr>
        -->
            <!-- <tr>
            <td style="border-left: 1px solid black; border-bottom:1px solid black; border-top: 1px solid black;">Variance / 差异</td>

            <apex:outputText value="{!positiveGreen_Top_bottom}" rendered="{!InvestmentCR12Variance==null||InvestmentCR12Variance==0}" escape="false" />
            <apex:outputText value="{!negativeRed_Top_bottom}" rendered="{!InvestmentCR12Variance<0}" escape="false" />
            <apex:outputText value="{!positiveGreen_Top_bottom}" rendered="{!InvestmentCR12Variance>0}" escape="false" />
            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!InvestmentCR12Variance!=0 && InvestmentCR12Variance!=null}">
                <apex:param value="{!InvestmentCR12Variance}"/></apex:outputText>
            <apex:outputText value=" - " rendered="{!InvestmentCR12Variance==0||InvestmentCR12Variance==null}" /><apex:outputText value="{!td_end}" escape="false" />
        </tr>
 -->

        <!-- </table>
        <br/> -->


        <apex:variable value="v1" var="" rendered="{!ApprovalComment=='new'}">
            <br />
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                <tr>
                    <td valign="top"
                        style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="a. Backgroud & Objective" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c!=null && lstApprovalComment[0].ASI_CRM_Background_Objective__c!=''}" />
                        <apex:outputText value=" - "
                            rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c==null || lstApprovalComment[0].ASI_CRM_Background_Objective__c==''}" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="b. New Contract Analsysis" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=null  && lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=''}" />
                        <apex:outputText value=" - "
                            rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==null || lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==''}" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="c. Historical Contract Performance" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=null && lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=''}" />
                        <apex:outputText value=" - "
                            rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==null || lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==''}" />
                    </td>
                </tr>
            </table>
        </apex:variable>

        <apex:variable value="v2" var="" rendered="{!ApprovalComment=='po'}">
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                <tr>
                    <td valign="top"
                        style="font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        Finance Comments</td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black; ">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_BA_comments__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c!=null}" />
                        <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c==null}" />
                    </td>
                </tr>
            </table>
        </apex:variable>
    </body>

</apex:component>