<apex:component controller="ASI_CRM_CN_HeavyGroupProfitShuttleCtrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar"/>
    <apex:attribute name="Contractid" description="ID of Contract for PDF printout" type="id" assignto="{!PageId}"/>
    <apex:attribute name="PDF" description="Check AD identity" type="string" assignto="{!strPDF}"/>
    
    <head>
        <title>集团合同合并利润分析表</title>
    </head>
    <div class="header" style="font-family:  Arial Unicode MS;"  >
        <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr>
                <td align="center"><apex:image height="2cm" width="7cm" url="{!URLFOR($Resource.ASI_MFM_CN_Logo)}"/></td>
            </tr>
            <tr>
                <td align="center" style="font-size:17px; font-weight:bold;  " >CONSOLIDATED CONTRACT PROFITABILITY SHUTTLE<br/>FOR GROUP CONTRACT<br/>集团合同合并利润分析表</td>
            </tr>
        </table>
    </div>
    
    <body style=" font-size:10px;margin-top: -20px;font-family: Arial Unicode MS;">
        <br/>
        <table  width="50%" cellspacing="0" >
            <tr><td>KA Account</td><td>{!thisCC.ASI_CRM_NationalGroup__r.name}</td></tr>
            <tr><td>Contract Sequence</td><td>{!thisCC.Name}</td></tr>
            
        </table>
        <br/>
        <table width="70%" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td bgcolor="#99CCFF" style="border:1px solid black;" colspan="2">
                    <strong><apex:outputText value="Variable Cost Investment Methodology (变动费用投资方式)" />
                    </strong>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">New Contract </td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">BRSF(空瓶回收费)</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod1__c!=null,'','display:none;')}  ">
                <td  style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >PSF(空瓶回收服务费) - 1</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod2__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">PSF(空瓶回收服务费) - 2</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod3__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >PSF(空瓶回收服务费) - 3</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_VEC_Methodology__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >Variable Event Cost活动费用（变动）</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
        </table>
        <br/>
        
        <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr style="vertical-align: bottom;">
                <td width="20%"  align="center" style="border-right: 1px solid black;border-bottom: 1px solid black;" ></td>
                <td width="10%" style="white-space: pre; border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;"  align="center">Contract Sequence<br/>合同序号</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black; "  align="center">Start Date<br/>开始日期</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">End Date<br/>结束日期</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Nb of Months<br/>月数</td>
                <td width="15%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Covered outlet<br/>覆盖店家数</td>
                <td width="5%">&nbsp;</td>
                <td width="10%"></td>
                <td width="10%" ></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Historical Contract vfinal 历史合同实际</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.Name}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.ASI_CRM_Remarks__c}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.ASI_CRM_CN_Description__c}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!HistoricalContract.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalCoveredOutletSize}</td>
                <td>&nbsp;</td>
                <td ></td>
                <td ></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT V0.0<br/>新合同</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Name}</td>
                <!-- <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_CRM_SG_PRS_Contract_No__c}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_TH_CRM_Target_Distribution_Channel__c}</td> -->
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoStartDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoEndDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!V0CoveredOutletSize}</td>
                <td>&nbsp;</td>
                <td  align="center"></td>
                <td ></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT VFinal<br/>新合同</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Name}</td>
                <!-- <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_CRM_SG_PRS_Contract_No__c}</td> 
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_TH_CRM_Target_Distribution_Channel__c}</td>-->
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoStartDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoEndDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!VFinalCoveredOutletSize}</td>
                <td>&nbsp;</td>
                <td  align="center"></td>
                <td ></td>
            </tr>
        </table>
        
        
        <br/>
        <table width="100%" border="0" cellpadding="3" cellspacing="0">
            <tr>
                <td colspan="{!IF(ExistHistoricalData,'8','5')} " bgcolor="#99CCFF" style="border:1px solid black;">
                    <strong><apex:outputText value="P&L REVIEW (in RMB) 利润分析表 （元）" /></strong>
                </td>
            </tr>
            <tr>
                <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                <td colspan="2" style=" {!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Historical Contract<br/>历史合同</td>
                <td colspan="{!IF(ExistHistoricalData,'5','4')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">New Contract<br/>新合同</td>
            </tr>
            <tr>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">v0.0<br/>预估</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">vFinal<br/>完成</td>
                <td style=" border-right: 1px dotted gray;  border-bottom: 1px solid black;white-space: pre;" align="center">V0.0 Estimate<br/> 预估</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray; border-bottom: 1px solid black;white-space: pre;" align="center">% vFinal<br/>对比历史完成</td>
                <td style=" border-right: 1px dotted gray;  border-bottom: 1px solid black;white-space: pre;" align="center">V0.0 Contract<br/>合同</td>
                <td style=" border-right: 1px dotted gray;  border-bottom: 1px solid black;white-space: pre;" align="center">V final</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">%v0.0 Estimate<br/>对比新合同<br/>V final</td>
            </tr>
            
            
            <tr>
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract.Volumes!=0&&HistoricalV00Contract.Volumes!=null}" >
                        <apex:param value="{!HistoricalV00Contract.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.Volumes==0||HistoricalV00Contract.Volumes==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract.Volumes!=0 && HistoricalVFinalContract.Volumes!=null}" >
                        <apex:param value="{!HistoricalVFinalContract.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.Volumes==0||HistoricalVFinalContract.Volumes==null}"/>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Esitimate.Volumes!=0 && NewContractV0Esitimate.Volumes!=null}"><apex:param value="{!NewContractV0Esitimate.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.Volumes==0||NewContractV0Esitimate.Volumes==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                     <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.Volumes!=null && HistoricalVFinalContract.Volumes!=0 && NewContractV0Esitimate.Volumes!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.Volumes-HistoricalVFinalContract.Volumes)/HistoricalVFinalContract.Volumes)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.Volumes==0||HistoricalVFinalContract.Volumes==null}"/>
                    
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract.Volumes!=0 && NewContactV0Contract.Volumes!=null}"><apex:param value="{!NewContactV0Contract.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.Volumes==0 || NewContactV0Contract.Volumes==null}"/>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactVFinal.Volumes!=0 && NewContactVFinal.Volumes!=null}">
                        <apex:param value="{!NewContactVFinal.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.Volumes==0 || NewContactVFinal.Volumes==null}"/>
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.Volumes!=null && NewContractV0Esitimate.Volumes!=0 && NewContactVFinal.Volumes!=null}">
                        <apex:param value="{!((NewContactVFinal.Volumes-NewContractV0Esitimate.Volumes)/NewContractV0Esitimate.Volumes)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.Volumes==0||NewContractV0Esitimate.Volumes==null}"/>
                </td>
            </tr>
            
            
            
            
            
            
             <apex:repeat value="{!sbGroup_map}" var="sbgroup">
                 <tr>
                     <td style="border-left: 1px solid black; border-right: 1px solid black;">{!sbGroup_map[sbgroup]}</td>
                     
                     <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;" align="right">
                         <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract.SubBrandGradeMap[sbgroup]!=0&& HistoricalV00Contract.SubBrandGradeMap[sbgroup]!=null}" >
                             <apex:param value="{!HistoricalV00Contract.SubBrandGradeMap[sbgroup]}" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!HistoricalV00Contract.SubBrandGradeMap[sbgroup]==0 || HistoricalV00Contract.SubBrandGradeMap[sbgroup]==null}"/>
                     </td>
                     
                     <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;" align="right">
                         <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract.SubBrandGradeMap[sbgroup]!=0 && HistoricalVFinalContract.SubBrandGradeMap[sbgroup]!=null}" >
                             <apex:param value="{!HistoricalVFinalContract.SubBrandGradeMap[sbgroup]}" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.SubBrandGradeMap[sbgroup]==0 || HistoricalVFinalContract.SubBrandGradeMap[sbgroup]==null}"/>
                     </td>
                     
                     <td style="border-right: 1px dotted gray;"   align="right">
                         <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Esitimate.SubBrandGradeMap[sbgroup]!=0 && NewContractV0Esitimate.SubBrandGradeMap[sbgroup]!=null}">
                             <apex:param value="{!NewContractV0Esitimate.SubBrandGradeMap[sbgroup]}" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.SubBrandGradeMap[sbgroup]==0 || NewContractV0Esitimate.SubBrandGradeMap[sbgroup]==null}"/>
                     </td>
                     
                     <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;" align="right">
                         <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.SubBrandGradeMap[sbgroup]!=null && HistoricalVFinalContract.SubBrandGradeMap[sbgroup]!=0 && NewContractV0Esitimate.SubBrandGradeMap[sbgroup]!=null}">
                             <apex:param value="{!((NewContractV0Esitimate.SubBrandGradeMap[sbgroup]-HistoricalVFinalContract.SubBrandGradeMap[sbgroup])/HistoricalVFinalContract.SubBrandGradeMap[sbgroup])*100 }" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.SubBrandGradeMap[sbgroup]==0||HistoricalVFinalContract.SubBrandGradeMap[sbgroup]==null}"/>
                         
                     </td>
                     <td style="border-right: 1px dotted gray;" align="right">
                         <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract.SubBrandGradeMap[sbgroup]!=0 && NewContactV0Contract.SubBrandGradeMap[sbgroup]!=null}">
                             <apex:param value="{!NewContactV0Contract.SubBrandGradeMap[sbgroup]}" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!NewContactV0Contract.SubBrandGradeMap[sbgroup]==0 || NewContactV0Contract.SubBrandGradeMap[sbgroup]==null}"/>
                     </td> 
                     
                     <td style="border-right: 1px dotted gray;" align="right">
                         <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactVFinal.SubBrandGradeMap[sbgroup]!=0 && NewContactVFinal.SubBrandGradeMap[sbgroup]!=null}">
                             <apex:param value="{!NewContactVFinal.SubBrandGradeMap[sbgroup]}" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!NewContactVFinal.SubBrandGradeMap[sbgroup]==0 || NewContactVFinal.SubBrandGradeMap[sbgroup]==null}"/>
                     </td>
                     
                    
                     <td style="border-right: 1px solid black; " align="right">
                         <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.SubBrandGradeMap[sbgroup]!=null && NewContractV0Esitimate.SubBrandGradeMap[sbgroup]!=0 && NewContactVFinal.SubBrandGradeMap[sbgroup]!=null}">
                             <apex:param value="{!((NewContactVFinal.SubBrandGradeMap[sbgroup]-NewContractV0Esitimate.SubBrandGradeMap[sbgroup])/NewContractV0Esitimate.SubBrandGradeMap[sbgroup])*100 }" /></apex:outputText>
                         <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.SubBrandGradeMap[sbgroup]==0||NewContractV0Esitimate.SubBrandGradeMap[sbgroup]==null}"/>
                     </td>
                 </tr>
            </apex:repeat>
            
            
            
            
            
            
            
            
            
            
            
            <tr>
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalV00Contract.TradeExpenses!=null}"><apex:param value="{!HistoricalV00Contract.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.TradeExpenses==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalVFinalContract.TradeExpenses!=null}"><apex:param value="{!HistoricalVFinalContract.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.TradeExpenses==null}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0Esitimate.TradeExpenses!=null}"><apex:param value="{!NewContractV0Esitimate.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.TradeExpenses==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.TradeExpenses!=null && HistoricalVFinalContract.TradeExpenses!=0 && NewContractV0Esitimate.TradeExpenses!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.TradeExpenses-HistoricalVFinalContract.TradeExpenses)/HistoricalVFinalContract.TradeExpenses)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.TradeExpenses==0||HistoricalVFinalContract.TradeExpenses==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <strong>
                        <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract.TradeExpenses!=null}">
                            <apex:param value="{!NewContactV0Contract.TradeExpenses}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract.TradeExpenses==null}"/></strong></td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <strong>
                        <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactVFinal.TradeExpenses!=null}">
                            <apex:param value="{!NewContactVFinal.TradeExpenses}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactVFinal.TradeExpenses==null}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" bgcolor="#E3DFDA" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.TradeExpenses!=null && NewContractV0Esitimate.TradeExpenses!=0 && NewContactVFinal.TradeExpenses!=null}">
                        <apex:param value="{!((NewContactVFinal.TradeExpenses-NewContractV0Esitimate.TradeExpenses)/NewContractV0Esitimate.TradeExpenses)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.TradeExpenses==0||NewContractV0Esitimate.TradeExpenses==null}"/>
                </td>
            </tr>
            
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>       
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract.GrossSalesRate!=null&& HistoricalV00Contract.GrossSalesRate!=0}">
                        <apex:param value="{!HistoricalV00Contract.GrossSalesRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.GrossSalesRate==null || HistoricalV00Contract.GrossSalesRate==0}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract.GrossSalesRate!=null && HistoricalVFinalContract.GrossSalesRate!=0}">
                        <apex:param value="{!HistoricalVFinalContract.GrossSalesRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.GrossSalesRate==null || HistoricalVFinalContract.GrossSalesRate==0}"/>
                </td>
                
                <td style="border-right: 1px dotted gray;"  align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Esitimate.GrossSalesRate!=null&& NewContractV0Esitimate.GrossSalesRate!=0}">
                        <apex:param value="{!NewContractV0Esitimate.GrossSalesRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.GrossSalesRate==null || NewContractV0Esitimate.GrossSalesRate==0}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right"> 
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Esitimate.GrossSalesRate!=null && HistoricalVFinalContract.GrossSalesRate!=0 }">
                        <apex:param value="{!(NewContractV0Esitimate.GrossSalesRate-HistoricalVFinalContract.GrossSalesRate) }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.GrossSalesRate==null||HistoricalVFinalContract.GrossSalesRate==null}"/>
                    
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract.GrossSalesRate!=null && NewContactV0Contract.GrossSalesRate!=0}">
                        <apex:param value="{!NewContactV0Contract.GrossSalesRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.GrossSalesRate==null || NewContactV0Contract.GrossSalesRate==0}"/>
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactVFinal.GrossSalesRate!=null && NewContactVFinal.GrossSalesRate!=0}">
                        <apex:param value="{!NewContactVFinal.GrossSalesRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.GrossSalesRate==null || NewContactVFinal.GrossSalesRate==0}"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactVFinal.GrossSalesRate!=null && NewContractV0Esitimate.GrossSalesRate!=0 }">
                        <apex:param value="{!(NewContactVFinal.GrossSalesRate-NewContractV0Esitimate.GrossSalesRate) }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.GrossSalesRate==null||NewContractV0Esitimate.GrossSalesRate==null}"/>
                    
                </td>
            </tr>
            
            
            
            
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 eq btl  折CR12单瓶投入</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract.InvestmentCR12!=null && HistoricalV00Contract.InvestmentCR12!=0}">
                        <apex:param value="{!HistoricalV00Contract.InvestmentCR12}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.InvestmentCR12==null || HistoricalV00Contract.InvestmentCR12==0}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract.InvestmentCR12!=null && HistoricalVFinalContract.InvestmentCR12!=0}">
                        <apex:param value="{!HistoricalVFinalContract.InvestmentCR12}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.InvestmentCR12==null || HistoricalVFinalContract.InvestmentCR12==0}"/>
                </td>
                
                <td style="border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Esitimate.InvestmentCR12!=null && NewContractV0Esitimate.InvestmentCR12!=0}">
                        <apex:param value="{!NewContractV0Esitimate.InvestmentCR12}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.InvestmentCR12==null || NewContractV0Esitimate.InvestmentCR12==0}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.InvestmentCR12!=null && HistoricalVFinalContract.InvestmentCR12!=0 && HistoricalVFinalContract.InvestmentCR12!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.InvestmentCR12-HistoricalVFinalContract.InvestmentCR12)/HistoricalVFinalContract.InvestmentCR12)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.InvestmentCR12==0||HistoricalVFinalContract.InvestmentCR12==null}"/>
                </td>
                <td style="border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract.InvestmentCR12!=null && NewContactV0Contract.InvestmentCR12!=0}">
                        <apex:param value="{!NewContactV0Contract.InvestmentCR12}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.InvestmentCR12==null || NewContactV0Contract.InvestmentCR12==0}"/>
                </td>
                <td style="border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactVFinal.InvestmentCR12!=null && NewContactVFinal.InvestmentCR12!=0}">
                        <apex:param value="{!NewContactVFinal.InvestmentCR12}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.InvestmentCR12==null || NewContactVFinal.InvestmentCR12==0}"/>
                </td>
                <td style="border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.InvestmentCR12!=null && NewContractV0Esitimate.InvestmentCR12!=0 && NewContactVFinal.InvestmentCR12!=null}">
                        <apex:param value="{!((NewContactVFinal.InvestmentCR12-NewContractV0Esitimate.InvestmentCR12)/NewContractV0Esitimate.InvestmentCR12)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.InvestmentCR12==0 ||NewContractV0Esitimate.InvestmentCR12==null}"/>
                    
                </td>
            </tr>
            
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalV00Contract.VariableExpense!=null}"><apex:param value="{!HistoricalV00Contract.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.VariableExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalVFinalContract.VariableExpense!=null}"><apex:param value="{!HistoricalVFinalContract.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.VariableExpense==null}"/>
                </td>
                
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0Esitimate.VariableExpense!=null}"><apex:param value="{!NewContractV0Esitimate.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.VariableExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.VariableExpense!=null && HistoricalVFinalContract.VariableExpense!=0 && HistoricalVFinalContract.VariableExpense!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.VariableExpense-HistoricalVFinalContract.VariableExpense)/HistoricalVFinalContract.VariableExpense)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.VariableExpense==0||HistoricalVFinalContract.VariableExpense==null}"/>
                    
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract.VariableExpense!=null}"><apex:param value="{!NewContactV0Contract.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.VariableExpense==null}"/>
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactVFinal.VariableExpense!=null}">
                        <apex:param value="{!NewContactVFinal.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.VariableExpense==null}"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.VariableExpense!=null && NewContractV0Esitimate.VariableExpense!=0 && NewContactVFinal.VariableExpense!=null}">
                        <apex:param value="{!((NewContactVFinal.VariableExpense-NewContractV0Esitimate.VariableExpense)/NewContractV0Esitimate.VariableExpense)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.VariableExpense==0 ||NewContractV0Esitimate.VariableExpense==null}"/>
                    
                </td>
            </tr>
            
            
            
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalV00Contract.FixedExpense!=null}">
                        <apex:param value="{!HistoricalV00Contract.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.FixedExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalVFinalContract.FixedExpense!=null}">
                        <apex:param value="{!HistoricalVFinalContract.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.FixedExpense==null}"/>
                </td>
                
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0Esitimate.FixedExpense!=null}"><apex:param value="{!NewContractV0Esitimate.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.FixedExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.FixedExpense!=null && HistoricalVFinalContract.FixedExpense!=0 && HistoricalVFinalContract.FixedExpense!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.FixedExpense-HistoricalVFinalContract.FixedExpense)/HistoricalVFinalContract.FixedExpense)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.FixedExpense==0||HistoricalVFinalContract.FixedExpense==null}"/>
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract.FixedExpense!=null}"><apex:param value="{!NewContactV0Contract.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.FixedExpense==null}"/>
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactVFinal.FixedExpense!=null}">
                        <apex:param value="{!NewContactVFinal.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.FixedExpense==null}"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.FixedExpense!=null && NewContractV0Esitimate.FixedExpense!=0 && NewContactVFinal.FixedExpense!=null}">
                        <apex:param value="{!((NewContactVFinal.FixedExpense-NewContractV0Esitimate.FixedExpense)/NewContractV0Esitimate.FixedExpense)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.FixedExpense==0 ||NewContractV0Esitimate.FixedExpense==null}"/>
                    
                </td>
            </tr>
            
            
            <tr>
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 % </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalV00Contract.FixedExpenseRate!=null}"><apex:param value="{!HistoricalV00Contract.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.FixedExpenseRate==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.FixedExpenseRate!=null}"><apex:param value="{!HistoricalVFinalContract.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.FixedExpenseRate==null}"/>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.FixedExpenseRate!=null}"><apex:param value="{!NewContractV0Esitimate.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.FixedExpenseRate==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Esitimate.FixedExpenseRate!=null && HistoricalVFinalContract.FixedExpenseRate!=0 }">
                        <apex:param value="{!(NewContractV0Esitimate.FixedExpenseRate-HistoricalVFinalContract.FixedExpenseRate) }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.FixedExpenseRate==null||HistoricalVFinalContract.FixedExpenseRate==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContactV0Contract.FixedExpenseRate!=null}"><apex:param value="{!NewContactV0Contract.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.FixedExpenseRate==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContactVFinal.FixedExpenseRate!=null}">
                        <apex:param value="{!NewContactVFinal.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.FixedExpenseRate==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactVFinal.FixedExpenseRate!=null && NewContractV0Esitimate.FixedExpenseRate!=0 }">
                        <apex:param value="{!(NewContactVFinal.FixedExpenseRate-NewContractV0Esitimate.FixedExpenseRate) }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.FixedExpenseRate==null||NewContractV0Esitimate.FixedExpenseRate==null}"/>
                    
                </td>
            </tr>
            
            <tr style="{!IF(AdorAbove,'','display:none;')}"  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin after A &amp;P 销售净利润</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract.MarginAfterAnP!=null&& HistoricalV00Contract.MarginAfterAnP!=0}"><apex:param value="{!HistoricalV00Contract.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.MarginAfterAnP==0||HistoricalV00Contract.MarginAfterAnP==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract.MarginAfterAnP!=null && HistoricalVFinalContract.MarginAfterAnP!=0}"><apex:param value="{!HistoricalVFinalContract.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.MarginAfterAnP==0 || HistoricalVFinalContract.MarginAfterAnP==null}"/></strong>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Esitimate.MarginAfterAnP!=null && NewContractV0Esitimate.MarginAfterAnP!=0}"><apex:param value="{!NewContractV0Esitimate.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.MarginAfterAnP==0|| NewContractV0Esitimate.MarginAfterAnP==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.MarginAfterAnP!=null && HistoricalVFinalContract.MarginAfterAnP!=0 && HistoricalVFinalContract.MarginAfterAnP!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.MarginAfterAnP-HistoricalVFinalContract.MarginAfterAnP)/HistoricalVFinalContract.MarginAfterAnP)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.MarginAfterAnP==0||HistoricalVFinalContract.MarginAfterAnP==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract.MarginAfterAnP!=null && NewContactV0Contract.MarginAfterAnP!=0}"><apex:param value="{!NewContactV0Contract.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.MarginAfterAnP==0 || NewContactV0Contract.MarginAfterAnP==null}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactVFinal.MarginAfterAnP!=null && NewContactVFinal.MarginAfterAnP!=0}">
                        <apex:param value="{!NewContactVFinal.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.MarginAfterAnP==0 || NewContactVFinal.MarginAfterAnP==null}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.MarginAfterAnP!=null && NewContractV0Esitimate.MarginAfterAnP!=0 && NewContactVFinal.MarginAfterAnP!=null}">
                        <apex:param value="{!((NewContactVFinal.MarginAfterAnP-NewContractV0Esitimate.MarginAfterAnP)/NewContractV0Esitimate.MarginAfterAnP)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.MarginAfterAnP==0 ||NewContractV0Esitimate.MarginAfterAnP==null}"/>
                    
                </td>
            </tr>
            
            
            
            <tr style="{!IF(AdorAbove,'','display:none;')}"  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin per Bottle 单瓶利润 </strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract.MarginPerBottle!=null && HistoricalV00Contract.MarginPerBottle!=0}"><apex:param value="{!HistoricalV00Contract.MarginPerBottle}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract.MarginPerBottle==0 || HistoricalV00Contract.MarginPerBottle==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract.MarginPerBottle!=null && HistoricalVFinalContract.MarginPerBottle!=0}"><apex:param value="{!HistoricalVFinalContract.MarginPerBottle}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.MarginPerBottle==0 || HistoricalVFinalContract.MarginPerBottle==null}"/></strong>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Esitimate.MarginPerBottle!=null && NewContractV0Esitimate.MarginPerBottle!=0}"><apex:param value="{!NewContractV0Esitimate.MarginPerBottle}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.MarginPerBottle==0 || NewContractV0Esitimate.MarginPerBottle==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract.MarginPerBottle!=null && HistoricalVFinalContract.MarginPerBottle!=0 && HistoricalVFinalContract.MarginPerBottle!=null}">
                        <apex:param value="{!((NewContractV0Esitimate.MarginPerBottle-HistoricalVFinalContract.MarginPerBottle)/HistoricalVFinalContract.MarginPerBottle)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.MarginPerBottle==0||HistoricalVFinalContract.MarginPerBottle==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract.MarginPerBottle!=null && NewContactV0Contract.MarginPerBottle!=0}"><apex:param value="{!NewContactV0Contract.MarginPerBottle}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.MarginPerBottle==0 || NewContactV0Contract.MarginPerBottle==null}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactVFinal.MarginPerBottle!=null && NewContactVFinal.MarginPerBottle!=0}">
                        <apex:param value="{!NewContactVFinal.MarginPerBottle}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.MarginPerBottle==0 || NewContactVFinal.MarginPerBottle==null}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Esitimate.MarginPerBottle!=null && NewContractV0Esitimate.MarginPerBottle!=0 && NewContactVFinal.MarginPerBottle!=null}">
                        <apex:param value="{!((NewContactVFinal.MarginPerBottle-NewContractV0Esitimate.MarginPerBottle)/NewContractV0Esitimate.MarginPerBottle)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.MarginPerBottle==0 ||NewContractV0Esitimate.MarginPerBottle==null}"/>
                    
                    
                </td>
            </tr>
            
            <tr style="{!IF(AdorAbove,'','display:none;')}"  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>ROI(Intake) 投资回报率</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract.ROIIntake!=null && HistoricalV00Contract.ROIIntake!=0}"><apex:param value="{!HistoricalV00Contract.ROIIntake}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract.ROIIntake==null || HistoricalV00Contract.ROIIntake==0}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract.ROIIntake!=null && HistoricalVFinalContract.ROIIntake!=0}"><apex:param value="{!HistoricalVFinalContract.ROIIntake}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.ROIIntake==null||HistoricalVFinalContract.ROIIntake==0}"/></strong>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Esitimate.ROIIntake!=null && NewContractV0Esitimate.ROIIntake!=0}"><apex:param value="{!NewContractV0Esitimate.ROIIntake}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.ROIIntake==null || NewContractV0Esitimate.ROIIntake==0}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract.ROIIntake!=null && HistoricalVFinalContract.ROIIntake!=0 && HistoricalVFinalContract.ROIIntake!=null}">
                        <apex:param value="{!(NewContractV0Esitimate.ROIIntake-HistoricalVFinalContract.ROIIntake)}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.ROIIntake==0||HistoricalVFinalContract.ROIIntake==null}"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract.ROIIntake!=null && NewContactV0Contract.ROIIntake!=0}"><apex:param value="{!NewContactV0Contract.ROIIntake}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract.ROIIntake==null || NewContactV0Contract.ROIIntake==0}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactVFinal.ROIIntake!=null && NewContactVFinal.ROIIntake!=0}">
                        <apex:param value="{!NewContactVFinal.ROIIntake}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactVFinal.ROIIntake==null || NewContactVFinal.ROIIntake==0}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"  bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Esitimate.ROIIntake!=null && NewContactVFinal.ROIIntake!=null}">
                        <apex:param value="{!(NewContactVFinal.ROIIntake-NewContractV0Esitimate.ROIIntake)}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.ROIIntake==null ||NewContactVFinal.ROIIntake==null}"/>
                    
                </td>
            </tr>
            
            <tr style="{!IF(AdorAbove,'','display:none;')}" >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong> ROI (Pro-Forma) 预设投资回报率</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract.ROIProForma!=null&&HistoricalV00Contract.ROIProForma!=0}"><apex:param value="{!HistoricalV00Contract.ROIProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract.ROIProForma==null || HistoricalV00Contract.ROIProForma==0}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract.ROIProForma!=null&&HistoricalVFinalContract.ROIProForma!=0}">
                        <apex:param value="{!HistoricalVFinalContract.ROIProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.ROIProForma==null||HistoricalVFinalContract.ROIProForma==0}"/></strong>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Esitimate.ROIProForma!=null&&NewContractV0Esitimate.ROIProForma!=0}"><apex:param value="{!NewContractV0Esitimate.ROIProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.ROIProForma==null||NewContractV0Esitimate.ROIProForma==0}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract.ROIProForma!=null && HistoricalVFinalContract.ROIProForma!=0 && HistoricalVFinalContract.ROIProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate.ROIProForma-HistoricalVFinalContract.ROIProForma) }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.ROIProForma==0||HistoricalVFinalContract.ROIProForma==null}"/>                    
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract.ROIProForma!=null&&NewContactV0Contract.ROIProForma!=0}"><apex:param value="{!NewContactV0Contract.ROIProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract.ROIProForma==null||NewContactV0Contract.ROIProForma==0}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactVFinal.ROIProForma!=null&&NewContactVFinal.ROIProForma!=0}">
                        <apex:param value="{!NewContactVFinal.ROIProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactVFinal.ROIProForma==null||NewContactVFinal.ROIProForma==0}"/></strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"  bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Esitimate.ROIProForma!=null && NewContractV0Esitimate.ROIProForma!=0 && NewContactVFinal.ROIProForma!=null}">
                        <apex:param value="{!(NewContactVFinal.ROIProForma-NewContractV0Esitimate.ROIProForma)}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.ROIProForma==0 ||NewContractV0Esitimate.ROIProForma==null}"/>
                    
                </td>
            </tr>
            
            <tr>
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>Total BC %  空瓶回收率(Martell BC%)</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                        <apex:param value="{!HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c==null || HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c==0}"/>
                   
                    
                    <apex:outputText value="(" rendered="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=null && HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=null && HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=0}">
                        <apex:param value="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=null && HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=0}"/>
                    
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalVFinalTotalBCRate!=null && HistoricalVFinalTotalBCRate!=0}">
                        <apex:param value="{!HistoricalVFinalTotalBCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalTotalBCRate==null || HistoricalVFinalTotalBCRate==0}"/>
                    
                    <apex:outputText value="(" rendered="{!Hist_VFinalTotalMarBCRate!=null && Hist_VFinalTotalMarBCRate!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!Hist_VFinalTotalMarBCRate!=null && Hist_VFinalTotalMarBCRate!=0}">
                        <apex:param value="{!Hist_VFinalTotalMarBCRate}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!Hist_VFinalTotalMarBCRate!=null && Hist_VFinalTotalMarBCRate!=0}"/>
                    
                    
                    
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==null || thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==0}"/>
                    
                    
                    <apex:outputText value="(" rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_Martell_BC_Rate__c}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}"/>
                    
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==null || thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==0}"/>
                       
                    <apex:outputText value="(" rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_Martell_BC_Rate__c}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}"/>
                    
                </td>
                
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractVFinalTotalBCRate!=null && NewContractVFinalTotalBCRate!=0}">
                        <apex:param value="{!NewContractVFinalTotalBCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractVFinalTotalBCRate==null || NewContractVFinalTotalBCRate==0}"/>
                    
                    
                    
                    
                    
                    <apex:outputText value="(" rendered="{!New_VFinalTotalMartellBCRate!=null && New_VFinalTotalMartellBCRate!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!New_VFinalTotalMartellBCRate!=null && New_VFinalTotalMartellBCRate!=0}">
                        <apex:param value="{!New_VFinalTotalMartellBCRate}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!New_VFinalTotalMartellBCRate!=null && New_VFinalTotalMartellBCRate!=0}"/>
                    
                    
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
            </tr>
            
            <tr>
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>Net BC % 净空瓶回收率(Martell BC%)</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalVFinalNetBCRate!=null && HistoricalVFinalNetBCRate!=0}">
                        <apex:param value="{!HistoricalVFinalNetBCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalNetBCRate==null || HistoricalVFinalNetBCRate==0}"/>
                    
                    
                    
                    <apex:outputText value="(" rendered="{!Hist_VFinalNetMarBCRate!=null && Hist_VFinalNetMarBCRate!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!Hist_VFinalNetMarBCRate!=null && Hist_VFinalNetMarBCRate!=0}">
                        <apex:param value="{!Hist_VFinalNetMarBCRate}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!Hist_VFinalNetMarBCRate!=null && Hist_VFinalNetMarBCRate!=0}"/>
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractVFinalNetBCRate!=null && NewContractVFinalNetBCRate!=0}">
                        <apex:param value="{!NewContractVFinalNetBCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractVFinalNetBCRate==null || NewContractVFinalNetBCRate==0}"/>
                    
                    <apex:outputText value="(" rendered="{!New_VFinalNetMartellBCRate!=null && New_VFinalNetMartellBCRate!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!New_VFinalNetMartellBCRate!=null && New_VFinalNetMartellBCRate!=0}">
                        <apex:param value="{!New_VFinalNetMartellBCRate}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!New_VFinalNetMartellBCRate!=null && New_VFinalNetMartellBCRate!=0}"/>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black" align="right">
                    
                    
                </td>
                
            </tr>
            
        </table>
        
        <br/>
        
        
        <table style="font-size:9px;" width="100%" border="0" cellpadding="3" cellspacing="0">
            <thead>
                <tr>
                    <td colspan="{!IF(ExistHistoricalData,'14','11')}" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>VARIABLE EXPENSES (in RMB) 变动支出（元）</strong></font></td>
                </tr>
                <tr>
                    <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Bottles / month<br/>瓶/月</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Fees / month<br/>单瓶费用</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Total Fees<br/>费用合计</td>
                </tr>
                <tr>
                    <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Category 类别</td>
                    <td width="18%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Sub-brands 品牌</td>
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style=" border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Vfinal 合同</td>
                    
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Vfinal 合同</td>
                    
                    
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style=" border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Vfinal 合同</td>
                </tr>
            </thead>
            <apex:variable value="{!0}" var="TotalHistoricalBottles"/>
            <apex:variable value="{!0}" var="TotalEstimateBottles"/>
            <apex:variable value="{!0}" var="TotalContractBottles"/>
            <apex:variable value="{!0}" var="TotalvFinalBottles"/>
            
            <apex:variable value="{!0}" var="TotalHistoricalFees"/>
            <apex:variable value="{!0}" var="TotalEstimateFees"/>
            <apex:variable value="{!0}" var="TotalContractFees"/>
            <apex:variable value="{!0}" var="TotalvFinalFees"/>
            
            <apex:variable value="{!0}" var="AllHistoricalTotalFees"/>
            <apex:variable value="{!0}" var="AllEstimateTotalFees"/>
            <apex:variable value="{!0}" var="AllContractTotalFees"/>
            <apex:variable value="{!0}" var="AllvFinalTotalFees"/>
            
            
            <apex:repeat value="{!SubBrandContractMap}" var="sbgrade">
                <apex:variable var="TotalHistoricalBottles" value="{!TotalHistoricalBottles+SubBrandContractMap[sbgrade].HistoricalBottles}"/>
                <apex:variable var="TotalEstimateBottles" value="{!TotalEstimateBottles+SubBrandContractMap[sbgrade].EstimateBottles}"/>
                <apex:variable var="TotalContractBottles" value="{!TotalContractBottles+SubBrandContractMap[sbgrade].ContractBottles}"/>
                <apex:variable var="TotalvFinalBottles" value="{!TotalvFinalBottles+SubBrandContractMap[sbgrade].VFinalBottles}"/>
                
                <apex:variable var="TotalHistoricalFees" value="{!TotalHistoricalFees+SubBrandContractMap[sbgrade].HistoricalFees}"/>
                <apex:variable var="TotalEstimateFees" value="{!TotalEstimateFees+SubBrandContractMap[sbgrade].EstimateFees}"/>
                <apex:variable var="TotalContractFees" value="{!TotalContractFees+SubBrandContractMap[sbgrade].ContractFees}"/>
                <apex:variable var="TotalvFinalFees" value="{!TotalvFinalFees+SubBrandContractMap[sbgrade].VFinalFees}"/>
                
                <apex:variable var="AllHistoricalTotalFees" value="{!AllHistoricalTotalFees+SubBrandContractMap[sbgrade].HistoricalTotalFees}"/>
                <apex:variable var="AllEstimateTotalFees" value="{!AllEstimateTotalFees+SubBrandContractMap[sbgrade].EstimateTotalFees}"/>
                <apex:variable var="AllContractTotalFees" value="{!AllContractTotalFees+SubBrandContractMap[sbgrade].ContractTotalFees}"/>                 
                <apex:variable var="AllvFinalTotalFees" value="{!AllvFinalTotalFees+SubBrandContractMap[sbgrade].VFinalTotalFees}"/>                 
                
                
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top" >
                         {!SubBrandContractMap[sbgrade].SubBrandGrade}</td>
                    <td align="right" valign="top" style=" border-right: 1px solid black;" >
                        <apex:outputText value="{!SubBrandContractMap[sbgrade].strSubBrand}" escape="false" />
                    </td>
                    <td align="right" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')}" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].HistoricalBottles!=0 && SubBrandContractMap[sbgrade].HistoricalBottles!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].HistoricalBottles}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].HistoricalBottles==null || SubBrandContractMap[sbgrade].HistoricalBottles==0}" />
                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].EstimateBottles!=0 && SubBrandContractMap[sbgrade].EstimateBottles!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].EstimateBottles}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].EstimateBottles==null || SubBrandContractMap[sbgrade].EstimateBottles==0}" />
                    </td>
                    
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].ContractBottles!=0 && SubBrandContractMap[sbgrade].ContractBottles!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].ContractBottles}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].ContractBottles==null || SubBrandContractMap[sbgrade].ContractBottles==0}" />
                    </td>
                    
                    <td align="right" valign="top" style="border-right:1px solid black;"   >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].VFinalBottles!=0 && SubBrandContractMap[sbgrade].VFinalBottles!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].VFinalBottles}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].VFinalBottles==null || SubBrandContractMap[sbgrade].VFinalBottles==0}" />
                    </td>
                    
                    
                    <td align="right" valign="top"  style="{!IF(ExistHistoricalData,'','display:none;')}" >
                        <apex:outputText value="{0,number,#,###,###.00}" rendered="{!SubBrandContractMap[sbgrade].HistoricalFees!=0 && SubBrandContractMap[sbgrade].HistoricalFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].HistoricalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].HistoricalFees==null || SubBrandContractMap[sbgrade].HistoricalFees==0}" />
                        
                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{!SubBrandContractMap[sbgrade].EstimateFees!=0 && SubBrandContractMap[sbgrade].EstimateFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].EstimateFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].EstimateFees==null || SubBrandContractMap[sbgrade].EstimateFees==0}" />
                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].ContractFees!=0 && SubBrandContractMap[sbgrade].ContractFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].ContractFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].ContractFees==null || SubBrandContractMap[sbgrade].ContractFees==0}" />
                    </td>
                    <td align="right" valign="top" style="border-right:1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].VFinalFees!=0 && SubBrandContractMap[sbgrade].VFinalFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].VFinalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].VFinalFees==null || SubBrandContractMap[sbgrade].VFinalFees==0}" />
                    </td>
                    
                    
                    
                    <td align="right" valign="top"  style="{!IF(ExistHistoricalData,'','display:none;')}" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].HistoricalTotalFees!=0 && SubBrandContractMap[sbgrade].HistoricalTotalFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].HistoricalTotalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].HistoricalTotalFees==null || SubBrandContractMap[sbgrade].HistoricalTotalFees==0}" />
                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].EstimateTotalFees!=0 && SubBrandContractMap[sbgrade].EstimateTotalFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].EstimateTotalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].EstimateTotalFees==null || SubBrandContractMap[sbgrade].EstimateTotalFees==0}" />
                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].ContractTotalFees!=0 && SubBrandContractMap[sbgrade].ContractTotalFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].ContractTotalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].ContractTotalFees==null || SubBrandContractMap[sbgrade].ContractTotalFees==0}" />
                    </td>
                    <td align="right" valign="top"  style="border-right:1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!SubBrandContractMap[sbgrade].VFinalTotalFees!=0 && SubBrandContractMap[sbgrade].VFinalTotalFees!=null}" >
                            <apex:param value="{!SubBrandContractMap[sbgrade].VFinalTotalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!SubBrandContractMap[sbgrade].VFinalTotalFees==null || SubBrandContractMap[sbgrade].VFinalTotalFees==0}" />
                    </td>
                    
                </tr>
            </apex:repeat>
            
            
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;">ALL PRODUCTS 品牌合计</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalBottles!=0 && TotalHistoricalBottles!=null}" >
                        <apex:param value="{!TotalHistoricalBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalHistoricalBottles==null || TotalHistoricalBottles==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}" >
                        <apex:param value="{!TotalEstimateBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}" >
                        <apex:param value="{!TotalContractBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractBottles==null || TotalContractBottles==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalvFinalBottles!=0 && TotalvFinalBottles!=null}" >
                        <apex:param value="{!TotalvFinalBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalvFinalBottles==null || TotalvFinalBottles==0}" />
                </td>
                
                
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###.00}" rendered="{!TotalHistoricalFees!=0 && TotalHistoricalFees!=null}" >
                        <apex:param value="{!TotalHistoricalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalHistoricalFees==null || TotalHistoricalFees==0}" />
                    
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateFees!=0 && TotalEstimateFees!=null}" >
                        <apex:param value="{!TotalEstimateFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateFees==null || TotalEstimateFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractFees!=0 && TotalContractFees!=null}" >
                        <apex:param value="{!TotalContractFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractFees==null || TotalContractFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalvFinalFees!=0 && TotalvFinalFees!=null}" >
                        <apex:param value="{!TotalvFinalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalvFinalFees==null || TotalvFinalFees==0}" />
                </td>
                
                
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllHistoricalTotalFees!=0 && AllHistoricalTotalFees!=null}" >
                        <apex:param value="{!AllHistoricalTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllHistoricalTotalFees==null || AllHistoricalTotalFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllEstimateTotalFees!=0 && AllEstimateTotalFees!=null}" >
                        <apex:param value="{!AllEstimateTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllEstimateTotalFees==null || AllEstimateTotalFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllContractTotalFees!=0 && AllContractTotalFees!=null}" >
                        <apex:param value="{!AllContractTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllContractTotalFees==null || AllContractTotalFees==0}" />
                </td>
                <td style="border-right: 1px solid black; border-top: 1px solid black;"  align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllvFinalTotalFees!=0 && AllvFinalTotalFees!=null}" >
                        <apex:param value="{!AllvFinalTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllvFinalTotalFees==null || AllvFinalTotalFees==0}" />
                </td>
            </tr>
            
            
            <tr style="{!IF(ShowAchievementRecognition,'','display:none;')}" >
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="8" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}  border-top: 1px solid black; border-right: 1px solid black;">Achievement Recognition 调整</td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AdjustmentRecognition.HistoricalTotalFees!=0}">
                        <apex:param value="{!AdjustmentRecognition.HistoricalTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AdjustmentRecognition.HistoricalTotalFees==0}"/>
                </td>
                <td bgcolor="#FFFFCC" style="border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AdjustmentRecognition.EstimateTotalFees!=0}">
                        <apex:param value="{!AdjustmentRecognition.EstimateTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AdjustmentRecognition.EstimateTotalFees==0}"/>
                </td>
                <td bgcolor="#FFFFCC" style="border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AdjustmentRecognition.ContractTotalFees!=0}">
                        <apex:param value="{!AdjustmentRecognition.ContractTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AdjustmentRecognition.ContractTotalFees==0}"/>
                </td>
                <td bgcolor="#FFFFCC" style="border-top: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AdjustmentRecognition.VFinalTotalFees!=0}">
                        <apex:param value="{!AdjustmentRecognition.VFinalTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AdjustmentRecognition.VFinalTotalFees==0}"/>
                </td>
            </tr>
            
            
            
            <tr>
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="8" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}   border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;">PRC - PSF &amp; Trading Term Incentives 合同奖励 </td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFDetailTotal.HistoricalTotalFees!=null && PSFDetailTotal.HistoricalTotalFees!=0}" >
                        <apex:param value="{!PSFDetailTotal.HistoricalTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PSFDetailTotal.HistoricalTotalFees==0 || PSFDetailTotal.HistoricalTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFDetailTotal.EstimateTotalFees!=null && PSFDetailTotal.EstimateTotalFees!=0}" >
                        <apex:param value="{!PSFDetailTotal.EstimateTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PSFDetailTotal.EstimateTotalFees==0 || PSFDetailTotal.EstimateTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFDetailTotal.ContractTotalFees!=null && PSFDetailTotal.ContractTotalFees!=0}" >
                        <apex:param value="{!PSFDetailTotal.ContractTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PSFDetailTotal.ContractTotalFees==0 || PSFDetailTotal.ContractTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFDetailTotal.VFinalTotalFees!=null && PSFDetailTotal.VFinalTotalFees!=0}" >
                        <apex:param value="{!PSFDetailTotal.VFinalTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PSFDetailTotal.VFinalTotalFees==0 || PSFDetailTotal.VFinalTotalFees==null}" />
                </td>
            </tr>
            
            <tr>
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="8" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}  border-right: 1px solid black;border-bottom: 1px solid black;">
                    PRC - Variable Event Cost 活动费用（变动）
                </td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!VECDetailTotal.HistoricalTotalFees!=null && VECDetailTotal.HistoricalTotalFees!=0}" >
                        <apex:param value="{!VECDetailTotal.HistoricalTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VECDetailTotal.HistoricalTotalFees==0 || VECDetailTotal.HistoricalTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!VECDetailTotal.EstimateTotalFees!=null && VECDetailTotal.EstimateTotalFees!=0}" >
                        <apex:param value="{!VECDetailTotal.EstimateTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VECDetailTotal.EstimateTotalFees==0 || VECDetailTotal.EstimateTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!VECDetailTotal.ContractTotalFees!=null && VECDetailTotal.ContractTotalFees!=0}" >
                        <apex:param value="{!VECDetailTotal.ContractTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VECDetailTotal.ContractTotalFees==0 || VECDetailTotal.ContractTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!VECDetailTotal.VFinalTotalFees!=null && VECDetailTotal.VFinalTotalFees!=0}" >
                        <apex:param value="{!VECDetailTotal.VFinalTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VECDetailTotal.VFinalTotalFees==0 || VECDetailTotal.VFinalTotalFees==null}" />
                </td>
            </tr>
            
            
            
            <tr>                
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="8" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}  border-right: 1px solid black; border-bottom: 1px solid black;">
                    TOTAL VARIABLE 变动费用总金额</td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract.VariableExpense!=null && HistoricalVFinalContract.VariableExpense!=0}" >
                        <apex:param value="{!HistoricalVFinalContract.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract.VariableExpense==0 || HistoricalVFinalContract.VariableExpense==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Esitimate.VariableExpense!=null && NewContractV0Esitimate.VariableExpense!=0}" >
                        <apex:param value="{!NewContractV0Esitimate.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate.VariableExpense==0 || NewContractV0Esitimate.VariableExpense==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract.VariableExpense!=null && NewContactV0Contract.VariableExpense!=0}" >
                        <apex:param value="{!NewContactV0Contract.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract.VariableExpense==0 || NewContactV0Contract.VariableExpense==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactVFinal.VariableExpense!=null && NewContactVFinal.VariableExpense!=0}" >
                        <apex:param value="{!NewContactVFinal.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal.VariableExpense==0 || NewContactVFinal.VariableExpense==null}" />
                </td>
            </tr>
            
        </table>
        
        
        
        
        
        <br/>
        <apex:variable value="v1" var="" rendered="{!IsLocalGroupContract}">  
            <table width="100%" border="0" cellspacing="0" cellpadding="2" >
                <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="a. Backgroud & Objective" /></td></tr> 
                <tr>
                    <td valign="top" style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c}" 
                                          rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c!=null && lstApprovalComment[0].ASI_CRM_Background_Objective__c!=''}"/>
                        <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c==null || lstApprovalComment[0].ASI_CRM_Background_Objective__c==''}"/>
                    </td>
                </tr>
                <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="b. New Contract Analysis" /></td></tr>   
                <tr>
                    <td valign="top" style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c}" 
                                          rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=null  && lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=''}"/>
                        <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==null || lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==''}"/>
                    </td>
                </tr>    
                <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="c. Historical Contract Performance" /></td></tr>
                <tr>
                    <td valign="top" style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c}" 
                                          rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=null && lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=''}"/>
                        <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==null || lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==''}"/>
                    </td>
                </tr>  
            </table>
        </apex:variable>
        
        
    </body>
</apex:component>