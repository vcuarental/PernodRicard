<apex:component controller="ASI_CRM_CN_ContractEmailCtrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar"/>
    <apex:attribute name="ContractProfitShuttle" description="Contract Profit Shuttle Form" type="ASI_TH_CRM_Contract__c" assignto="{!thisCC}"/>
    <apex:attribute name="PDF" description="Check AD identity" type="string" assignto="{!strPDF}"/>
    <apex:attribute name="TEST" description="Check AD identity" type="string" assignto="{!isTest}"/>
    <apex:attribute name="CUTOFF" description="Check AD identity" type="string" assignto="{!isTestDate}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ASI_CRM_CN_PDF_Portrait_CSS)}"/>
    <head>           
        <title>CONTRACT PROFITABILITY SHUTTLE</title>
    </head>
    <div class="header">
        <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr>
                <td colspan="10" align="center"><apex:image height="2cm" width="7cm" url="{!URLFOR($Resource.ASI_MFM_CN_Logo)}"/></td>
            </tr>
            <tr>
                <td colspan="10" align="center"><h1>CONTRACT PROFITABILITY SHUTTLE 合同利润分析表</h1></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td width="14%" style="white-space: pre;" align="center"><Strong>REGION<br/>区域</Strong></td>
                <td width="{!if(thisCC.ASI_CRM_New_FY_PO__c, '14%', '16%')}" style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_Area__r.ASI_CRM_Division__r.ASI_CRM_Region__r.Name}</td>
                <td width="{!if(thisCC.ASI_CRM_New_FY_PO__c, '2%', '0%')}"></td>
                <td width="{!if(thisCC.ASI_CRM_New_FY_PO__c, '10%', '5%')}">{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO Province', '')}<br/>{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO省份', '')}</td>
                <td style="{!if(thisCC.ASI_CRM_New_FY_PO__c, 'border-bottom: 1px solid black;', '')}" width="{!if(thisCC.ASI_CRM_New_FY_PO__c, '10%', '0%')}">{!if(thisCC.ASI_CRM_New_FY_PO__c, thisCC.ASI_CRM_PO_Province__r.Name, '')}</td>
                <td width="{!if(thisCC.ASI_CRM_New_FY_PO__c, '10%','20%')}" style="white-space: pre;" align="center"><Strong>CITY LEVEL<br/>城市级别</Strong></td>
                <td width="{!if(thisCC.ASI_CRM_New_FY_PO__c, '5%','10%')}" style="border-bottom: 1px solid black;" >{!IF(thisCC.ASI_CRM_PO_City__c != null,thisCC.ASI_CRM_PO_City__r.ASI_CRM_CN_City_Tier__c,thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.ASI_CRM_CN_City_Tier__c)}</td>
                <td width="5%"> &nbsp;</td>
                <td width="14%" style="white-space: pre;" align="center"><strong>CITY NAME<br/>城市</strong></td>
                <td width="16%" style="border-bottom: 1px solid black;" >{!IF(thisCC.ASI_CRM_PO_City__c != null,thisCC.ASI_CRM_PO_City__r.Name,thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_CCity__r.Name)}</td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="white-space: pre;" align="center"><Strong>OUTLET NAME<br/>店家名称</Strong></td>
                <td colspan="6" style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.Name}<apex:outputText value=" / {!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c}" rendered="{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != null && thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Eng_Name__c != ''}" /></td>
                <td width="5%">&nbsp;</td>
                <td style="white-space: pre;" align="center" ><Strong>OUTLET TYPE<br/>渠道类别</Strong></td>
                <td style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.Name}</td>
                <!--<td style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_TH_CRM_OutletType__c}</td>-->
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="white-space: pre;" align="center" ><Strong>INVESTMENT TYPE<br/>投资类型</Strong></td>
                <td style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_Investment_Type__c}</td>
            </tr>
        </table>
    </div>
    <body>
        <apex:outputpanel id="notAD" rendered="{!AdorAbove!=true}" >
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                <tr style="vertical-align: bottom;">
                    <td width="20%">&nbsp;</td>
                    <td width="10%" style="white-space: pre;border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;"  align="center">Start Date<br/>开始日期</td>
                    <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">End Date<br/>结束日期</td>
                    <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Nb of Months<br/>月数</td>
                    <td width="15%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Sales Rep<br/>销售</td>
                    <td width="5%">&nbsp;</td>
                    <td width="15%" style="white-space: pre;" align="center">OUTLET GRADE<br/>店家级别</td>
                    <td width="15%" style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}</td>
                </tr>
                <tr style="vertical-align: bottom;">
                    <td style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Historical Contract vfinal 历史合同实际</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!previousCCStart}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!previousCCEnd}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}"><apex:param value="{!PreviousCCNoMonths}" /></apex:outputText></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PreviousCCSalesRep}</td>
                    <td>&nbsp;</td>
                    <td style="white-space: pre;" align="center">OUTLET SEGMENT<br/>店家形象</td>
                    <td style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}</td>
                </tr>
                <tr style="vertical-align: bottom;">
                    <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT<br/>新合同</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCCStart}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCCEnd}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Owner.Name}</td>
                    <td>&nbsp;</td>
                    <td style="{!if(thisCC.ASI_CRM_New_FY_PO__c, 'white-space: pre;', '')}" align="center">{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO Channel', '')}<br/>{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO渠道', '')}</td><!--20160624 Ben @ Elufa-->
                    <td style="{!if(thisCC.ASI_CRM_New_FY_PO__c, 'border-bottom: 1px solid black;', '')}">{!if(thisCC.ASI_CRM_New_FY_PO__c, thisCC.ASI_CRM_PO_Channel__r.Name, '')}</td>
                    <!--
<td style="white-space: pre;" align="center">PRIORITY BRAND<br/>重点品牌</td>
<td><apex:outputText value="{0,number,#,###,###}%" rendered="{!PriorityBrand != null && PriorityBrand != 0}"><apex:param value="{!PriorityBrand}" /></apex:outputText></td>
-->
                </tr>
            </table>
            <br/>
            <table width="100%" border="0" cellpadding="3" cellspacing="0">
                <tr>
                    <td colspan="8" bgcolor="#99CCFF" style="border:1px solid black;" ><strong><apex:outputText value="P&L REVIEW (in RMB) 利润分析表 （元）" /></strong></td>
                </tr>
                <tr>
                    <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Historical Contract<br/>历史合同 </td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">New Contract<br/>新合同</td>
                    <td rowspan="2" style="border-left: 1px solid black;border-bottom: 1px solid black;white-space: pre; " align="center">Budget/LE<br/>预算</td>
                    <td rowspan="2" style="border-right: 1px solid black;border-bottom: 1px solid black;white-space: pre; " align="center">vs Est<br/>对比预估</td>
                </tr>
                <tr>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">v0.0<br/>预估</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">vFinal<br/>完成</td>
                    <td style="border-bottom: 1px solid black;white-space: pre;" align="center">Estimate 预估</td>
                    <td style="border-right: 1px dotted gray; border-bottom: 1px solid black;white-space: pre;" align="center">% vFinal<br/>对比历史完成</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Contract<br/>合同</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strV0!=0&&VolumeData.strV0!=null}" ><apex:param value="{!VolumeData.strV0}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strV0==0||VolumeData.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strA!=0&&VolumeData.strA!=null}" ><apex:param value="{!VolumeData.strA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strA==0||VolumeData.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strB!=0&&VolumeData.strB!=null}"><apex:param value="{!VolumeData.strB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strB==0||VolumeData.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VolumeData.strC!=0&&VolumeData.strC!=null}"><apex:param value="{!VolumeData.strC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strC==0||VolumeData.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strD!=0&&VolumeData.strD!=null}"><apex:param value="{!VolumeData.strD}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strD==0||VolumeData.strD==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strE!=0&&VolumeData.strE!=null}" ><apex:param value="{!VolumeData.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strE==0||VolumeData.strE==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strF!=0&&VolumeData.strF!=null}"><apex:param value="{!VolumeData.strF}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strF==0||VolumeData.strF==null}"/></td>
                </tr>
                <apex:repeat value="{!sbGroup_map}" var="sbgroup">
                    <tr>
                        <td style="border-left: 1px solid black; border-right: 1px solid black;">{!RIGHT(sbgroup,LEN(sbgroup)-3)}</td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strV0!=0}"><apex:param value="{!sbGroup_map[sbgroup].strV0}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strV0==0||sbGroup_map[sbgroup].strV0==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strA!=0&&sbGroup_map[sbgroup].strA!=null}" ><apex:param value="{!sbGroup_map[sbgroup].strA}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strA==0||sbGroup_map[sbgroup].strA==null}"/></td>
                        <td align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strB!=0&&sbGroup_map[sbgroup].strB!=null}"><apex:param value="{!sbGroup_map[sbgroup].strB}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strB==0||sbGroup_map[sbgroup].strB==null}"/></td>
                        <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!sbGroup_map[sbgroup].strC!=0&&sbGroup_map[sbgroup].strC!=null}" ><apex:param value="{!sbGroup_map[sbgroup].strC}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strC==0||sbGroup_map[sbgroup].strC==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strD!=0&&sbGroup_map[sbgroup].strD!=null}" ><apex:param value="{!sbGroup_map[sbgroup].strD}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strD==0||sbGroup_map[sbgroup].strD==null}"/></td>
                        <td>&nbsp;</td>
                        <td style="border-right: 1px solid black;">&nbsp;</td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strV0!=null}"><apex:param value="{!TradeExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strA!=null}"><apex:param value="{!TradeExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strB!=null}"><apex:param value="{!TradeExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!TradeExpense.strC!=null}"><apex:param value="{!TradeExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strD!=null}"><apex:param value="{!TradeExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strD==null}"/></strong></td>
                    <td bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strE!=null&&TradeExpense.strE!=0}"><apex:param value="{!TradeExpense.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strE==null||TradeExpense.strE==0}"/></strong></td>
                    <td style="border-right: 1px solid black;" bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!TradeExpense.strF!=null&&TradeExpense.strF!=0}"><apex:param value="{!TradeExpense.strF}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strF==null||TradeExpense.strF==0}"/></strong></td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strV0!=null&&GrossSales.strV0!=0}"><apex:param value="{!GrossSales.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strV0==null||GrossSales.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strA!=null&&GrossSales.strA!=0}"><apex:param value="{!GrossSales.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strA==null||GrossSales.strA==0}"/></td>
                    <td align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strB!=null&&GrossSales.strB!=0}"><apex:param value="{!GrossSales.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strB==null||GrossSales.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strC!=null&&GrossSales.strC!=0}"><apex:param value="{!GrossSales.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strC==null||GrossSales.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strD!=null&&GrossSales.strD!=0}"><apex:param value="{!GrossSales.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strD==null||GrossSales.strD==0}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 Extra eq btl  折CR12新境单瓶投入</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strV0!=null&&InvestmentCR12.strV0!=0}"><apex:param value="{!InvestmentCR12.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strV0==null||InvestmentCR12.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strA!=null&&InvestmentCR12.strA!=0}"><apex:param value="{!InvestmentCR12.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strA==null||InvestmentCR12.strA==0}"/></td>
                    <td align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strB!=null&&InvestmentCR12.strB!=0}"><apex:param value="{!InvestmentCR12.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strB==null||InvestmentCR12.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right" valign="top"><apex:outputText value="{0,number,#,###,###}%" rendered="{!InvestmentCR12.strC!=null&&InvestmentCR12.strC!=0}"><apex:param value="{!InvestmentCR12.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strC==null||InvestmentCR12.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strD!=null&&InvestmentCR12.strD!=0}"><apex:param value="{!InvestmentCR12.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strD==null||InvestmentCR12.strD==0}"/></td>
                    <td align="right" valign="top">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strV0!=null}"><apex:param value="{!VExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strA!=null}"><apex:param value="{!VExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strB!=null}"><apex:param value="{!VExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VExpense.strC!=null}"><apex:param value="{!VExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strD!=null}"><apex:param value="{!VExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strV0!=null}"><apex:param value="{!FExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strA!=null}"><apex:param value="{!FExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strB!=null}"><apex:param value="{!FExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpense.strC!=null}"><apex:param value="{!FExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strD!=null}"><apex:param value="{!FExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 %</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strV0!=null}"><apex:param value="{!FExpenseRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strA!=null}"><apex:param value="{!FExpenseRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strB!=null}"><apex:param value="{!FExpenseRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strC!=null}"><apex:param value="{!FExpenseRate.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strD!=null}"><apex:param value="{!FExpenseRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strD==null}"/></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!BCRate.strName}空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strV0!=null&&BCRate.strV0!=0}"><apex:param value="{!BCRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strV0==null||BCRate.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strA!=null&&BCRate.strA!=0}"><apex:param value="{!BCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strA==null||BCRate.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strB!=null&&BCRate.strB!=0}"><apex:param value="{!BCRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strB==null||BCRate.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strD!=null&&BCRate.strD!=0}"><apex:param value="{!BCRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strD==null||BCRate.strD==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                 <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!NetBCRate.strName}净空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                     </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!NetBCRate.strA!=null&&NetBCRate.strA!=0}">
                        <apex:param value="{!NetBCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NetBCRate.strA==null||NetBCRate.strA==0}"/></strong>
                     </td>
                    <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
            </table>
        </apex:outputpanel>
        <apex:outputpanel id="ROI" rendered="{!AdorAbove}" >
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                <tr>
                    <td width="20%">&nbsp;</td>
                    <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Start Date<br/>开始日期</td>
                    <td width="10%" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">End Date<br/>结束日期</td>
                    <td width="10%" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Nb of Months<br/>月数</td>
                    <td width="15%" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Sales Rep<br/>销售</td>
                    <td width="5%">&nbsp;</td>
                    <td width="15%" style="white-space: pre;" align="center">OUTLET GRADE<br/>店家级别</td>
                    <td width="15%" style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}</td>
                </tr>
                <tr>
                    <td style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">Historical Contract vfinal<br/>历史合同实际</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!previousCCStart}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!previousCCEnd}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}"><apex:param value="{!PreviousCCNoMonths}" /></apex:outputText></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PreviousCCSalesRep}</td>
                    <td>&nbsp;</td>
                    <td style="white-space: pre;" align="center">OUTLET SEGMENT<br/>店家形象</td>
                    <td style="border-bottom: 1px solid black;">{!thisCC.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT<br/>新合同</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCCStart}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCCEnd}</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Owner.Name}</td>
                    <td>&nbsp;</td>
                    <td style="{!if(thisCC.ASI_CRM_New_FY_PO__c, 'white-space: pre;', '')}" align="center">{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO Channel', '')}<br/>{!if(thisCC.ASI_CRM_New_FY_PO__c, 'PO渠道', '')}</td><!--20160624 Ben @ Elufa-->
                    <td style="{!if(thisCC.ASI_CRM_New_FY_PO__c, 'border-bottom: 1px solid black;', '')}">{!if(thisCC.ASI_CRM_New_FY_PO__c, thisCC.ASI_CRM_PO_Channel__r.Name, '')}</td>
                    <!--
<td style="white-space: pre;" align="center">PRIORITY BRAND<br/>重点品牌</td>
<td><apex:outputText value="{0,number,#,###,###}%" rendered="{!PriorityBrand != null && PriorityBrand != 0}"><apex:param value="{!PriorityBrand}" /></apex:outputText></td>
-->
                </tr>
            </table>
            <br/>
            <table width="100%" border="0" cellpadding="3" cellspacing="0">
                <tr>
                    <td colspan="8" bgcolor="#99CCFF" style="border:1px solid black;"><strong><apex:outputText value="P&L REVIEW (in RMB) 利润分析表 （元）" /></strong></td>
                </tr>
                <tr>
                    <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Historical Contract<br/>历史合同 </td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">New Contract<br/>新合同</td>
                    <td rowspan="2" style="border-left: 1px solid black;border-bottom: 1px solid black;white-space: pre; " align="center">Budget/LE<br/>预算</td>
                    <td rowspan="2" style="border-right: 1px solid black;border-bottom: 1px solid black;white-space: pre; " align="center">vs Est<br/>对比预估</td>
                </tr>
                <tr>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">v0.0<br/>预估</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">vFinal<br/>完成</td>
                    <td style="border-bottom: 1px solid black;white-space: pre;" align="center">Estimate 预估</td>
                    <td style="border-right: 1px dotted gray; border-bottom: 1px solid black;white-space: pre;" align="center">% vFinal<br/>对比历史完成</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Contract<br/>合同</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strV0!=0&&VolumeData.strV0!=null}" ><apex:param value="{!VolumeData.strV0}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strV0==0||VolumeData.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strA!=0&&VolumeData.strA!=null}" ><apex:param value="{!VolumeData.strA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strA==0||VolumeData.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strB!=0&&VolumeData.strB!=null}"><apex:param value="{!VolumeData.strB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strB==0||VolumeData.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VolumeData.strC!=0&&VolumeData.strC!=null}"><apex:param value="{!VolumeData.strC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strC==0||VolumeData.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strD!=0&&VolumeData.strD!=null}"><apex:param value="{!VolumeData.strD}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strD==0||VolumeData.strD==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strE!=0&&VolumeData.strE!=null}" ><apex:param value="{!VolumeData.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strE==0||VolumeData.strE==null}"/></td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VolumeData.strF!=0&&VolumeData.strF!=null}"><apex:param value="{!VolumeData.strF}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeData.strF==0||VolumeData.strF==null}"/></td>
                </tr>
                <apex:repeat value="{!sbGroup_map}" var="sbgroup">
                    <tr>
                        <td style="border-left: 1px solid black; border-right: 1px solid black;">{!RIGHT(sbgroup,LEN(sbgroup)-3)}</td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strV0!=0}"><apex:param value="{!sbGroup_map[sbgroup].strV0}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strV0==0||sbGroup_map[sbgroup].strV0==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strA!=0&&sbGroup_map[sbgroup].strA!=null}" ><apex:param value="{!sbGroup_map[sbgroup].strA}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strA==0||sbGroup_map[sbgroup].strA==null}"/></td>
                        <td align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strB!=0&&sbGroup_map[sbgroup].strB!=null}"><apex:param value="{!sbGroup_map[sbgroup].strB}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strB==0||sbGroup_map[sbgroup].strB==null}"/></td>
                        <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!sbGroup_map[sbgroup].strC!=0&&sbGroup_map[sbgroup].strC!=null}" ><apex:param value="{!sbGroup_map[sbgroup].strC}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strC==0||sbGroup_map[sbgroup].strC==null}"/></td>
                        <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbGroup_map[sbgroup].strD!=0&&sbGroup_map[sbgroup].strD!=null}" ><apex:param value="{!sbGroup_map[sbgroup].strD}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbGroup_map[sbgroup].strD==0||sbGroup_map[sbgroup].strD==null}"/></td>
                        <td>&nbsp;</td>
                        <td style="border-right: 1px solid black;">&nbsp;</td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strV0!=null}"><apex:param value="{!TradeExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strA!=null}"><apex:param value="{!TradeExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strB!=null}"><apex:param value="{!TradeExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!TradeExpense.strC!=null}"><apex:param value="{!TradeExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strD!=null}"><apex:param value="{!TradeExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strD==null}"/></strong></td>
                    <td bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="({0,number,#,###,###})" rendered="{!TradeExpense.strE!=null&&TradeExpense.strE!=0}"><apex:param value="{!TradeExpense.strE}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strE==null||TradeExpense.strE==0}"/></strong></td>
                    <td style="border-right: 1px solid black;" bgcolor="#E3DFDA" align="right"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!TradeExpense.strF!=null&&TradeExpense.strF!=0}"><apex:param value="{!TradeExpense.strF}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TradeExpense.strF==null||TradeExpense.strF==0}"/></strong></td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>       
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strV0!=null&&GrossSales.strV0!=0}"><apex:param value="{!GrossSales.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strV0==null||GrossSales.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strA!=null&&GrossSales.strA!=0}"><apex:param value="{!GrossSales.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strA==null||GrossSales.strA==0}"/></td>
                    <td align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strB!=null&&GrossSales.strB!=0}"><apex:param value="{!GrossSales.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strB==null||GrossSales.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strC!=null&&GrossSales.strC!=0}"><apex:param value="{!GrossSales.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strC==null||GrossSales.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.strD!=null&&GrossSales.strD!=0}"><apex:param value="{!GrossSales.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!GrossSales.strD==null||GrossSales.strD==0}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 Extra eq btl  折CR12新境单瓶投入</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strV0!=null&&InvestmentCR12.strV0!=0}"><apex:param value="{!InvestmentCR12.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strV0==null||InvestmentCR12.strV0==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strA!=null&&InvestmentCR12.strA!=0}"><apex:param value="{!InvestmentCR12.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strA==null||InvestmentCR12.strA==0}"/></td>
                    <td align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strB!=null&&InvestmentCR12.strB!=0}"><apex:param value="{!InvestmentCR12.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strB==null||InvestmentCR12.strB==0}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right" valign="top"><apex:outputText value="{0,number,#,###,###}%" rendered="{!InvestmentCR12.strC!=null&&InvestmentCR12.strC!=0}"><apex:param value="{!InvestmentCR12.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strC==null||InvestmentCR12.strC==0}"/></td>
                    <td style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!InvestmentCR12.strD!=null&&InvestmentCR12.strD!=0}"><apex:param value="{!InvestmentCR12.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!InvestmentCR12.strD==null||InvestmentCR12.strD==0}"/></td>
                    <td align="right" valign="top">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right" valign="top">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strV0!=null}"><apex:param value="{!VExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strA!=null}"><apex:param value="{!VExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strB!=null}"><apex:param value="{!VExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!VExpense.strC!=null}"><apex:param value="{!VExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!VExpense.strD!=null}"><apex:param value="{!VExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strV0!=null}"><apex:param value="{!FExpense.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strV0==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strA!=null}"><apex:param value="{!FExpense.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strA==null}"/></td>
                    <td align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strB!=null}"><apex:param value="{!FExpense.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strB==null}"/></td>
                    <td style="border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpense.strC!=null}"><apex:param value="{!FExpense.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strC==null}"/></td>
                    <td style="border-right: 1px solid black;" align="right"><apex:outputText value="({0,number,#,###,###})" rendered="{!FExpense.strD!=null}"><apex:param value="{!FExpense.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpense.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 % </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strV0!=null}"><apex:param value="{!FExpenseRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strV0==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strA!=null}"><apex:param value="{!FExpenseRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strA==null}"/></td>
                    <td style="border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strB!=null}"><apex:param value="{!FExpenseRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strB==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strC!=null}"><apex:param value="{!FExpenseRate.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strC==null}"/></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}%" rendered="{!FExpenseRate.strD!=null}"><apex:param value="{!FExpenseRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FExpenseRate.strD==null}"/></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>{!MarginAP.strName}</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strV0!=null&&MarginAP.strV0!=0}"><apex:param value="{!MarginAP.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strV0==0||MarginAP.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strA!=null&&MarginAP.strA!=0}"><apex:param value="{!MarginAP.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strA==0||MarginAP.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strB!=null&&MarginAP.strB!=0}"><apex:param value="{!MarginAP.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strB==0||MarginAP.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!MarginAP.strC!=null&&MarginAP.strC!=0}"><apex:param value="{!MarginAP.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strC==0||MarginAP.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginAP.strD!=null&&MarginAP.strD!=0}"><apex:param value="{!MarginAP.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginAP.strD==0||MarginAP.strD==null}"/></strong></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>{!MarginperBottle.strName}</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strV0!=null&&MarginperBottle.strV0!=0}"><apex:param value="{!MarginperBottle.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strV0==0||MarginperBottle.strV0==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strA!=null&&MarginperBottle.strA!=0}"><apex:param value="{!MarginperBottle.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strA==0||MarginperBottle.strA==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strB!=null&&MarginperBottle.strB!=0}"><apex:param value="{!MarginperBottle.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strB==0||MarginperBottle.strB==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!MarginperBottle.strC!=null&&MarginperBottle.strC!=0}"><apex:param value="{!MarginperBottle.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strC==0||MarginperBottle.strC==null}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99"><strong><apex:outputText value="{0,number,#,###,###}" rendered="{!MarginperBottle.strD!=null&&MarginperBottle.strD!=0}"><apex:param value="{!MarginperBottle.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!MarginperBottle.strD==0||MarginperBottle.strD==null}"/></strong></td>
                    <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>{!ROI.strName} 投资回报率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strV0!=null&&ROI.strV0!=0}"><apex:param value="{!ROI.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strV0==null||ROI.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strA!=null&&ROI.strA!=0}"><apex:param value="{!ROI.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strA==null||ROI.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strB!=null&&ROI.strB!=0}"><apex:param value="{!ROI.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strB==null||ROI.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!ROI.strC!=null&&ROI.strC!=0}"><apex:param value="{!ROI.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strC==null||ROI.strC==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ROI.strD!=null&&ROI.strD!=0}"><apex:param value="{!ROI.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ROI.strD==null||ROI.strD==0}"/></strong></td>
                    <td style="" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <!-- added by Alan Wong (Elufa) 20150618 -->
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>{!ProForma_ROI.strName} 预设投资回报率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strV0!=null&&ProForma_ROI.strV0!=0}"><apex:param value="{!ProForma_ROI.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strV0==null||ProForma_ROI.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strA!=null&&ProForma_ROI.strA!=0}"><apex:param value="{!ProForma_ROI.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strA==null||ProForma_ROI.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strB!=null&&ProForma_ROI.strB!=0}"><apex:param value="{!ProForma_ROI.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strB==null||ProForma_ROI.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,###}%" rendered="{!ProForma_ROI.strC!=null&&ProForma_ROI.strC!=0}"><apex:param value="{!ProForma_ROI.strC}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strC==null||ProForma_ROI.strC==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999"><strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ProForma_ROI.strD!=null&&ProForma_ROI.strD!=0}"><apex:param value="{!ProForma_ROI.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!ProForma_ROI.strD==null||ProForma_ROI.strD==0}"/></strong></td>
                    <td style="" align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                <!-- End -->
                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!BCRate.strName}空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strV0!=null&&BCRate.strV0!=0}"><apex:param value="{!BCRate.strV0}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strV0==null||BCRate.strV0==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strA!=null&&BCRate.strA!=0}"><apex:param value="{!BCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strA==null||BCRate.strA==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strB!=null&&BCRate.strB!=0}"><apex:param value="{!BCRate.strB}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strB==null||BCRate.strB==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!BCRate.strD!=null&&BCRate.strD!=0}"><apex:param value="{!BCRate.strD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!BCRate.strD==null||BCRate.strD==0}"/></strong></td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                 <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>{!NetBCRate.strName}净空瓶回收率</strong></td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                     </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"><strong><apex:outputText value="{0,number,#,###,##0}%" rendered="{!NetBCRate.strA!=null&&NetBCRate.strA!=0}">
                        <apex:param value="{!NetBCRate.strA}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NetBCRate.strA==null||NetBCRate.strA==0}"/></strong>
                     </td>
                    <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
            </table>
        </apex:outputpanel>
        <br/>
        <table width="100%" border="0" cellpadding="3" cellspacing="0">
            <thead>
                <tr>
                    <td colspan="11" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>VARIABLE EXPENSES (in RMB) 变动支出（元）</strong></font></td>
                </tr>
                <tr>
                    <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Bottles / month<br/>瓶/月</td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Fees / month<br/>单瓶费用</td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Total Fees<br/>费用合计</td>
                </tr>
                <tr>
                    <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Category 类别</td>
                    <td width="18%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Sub-brands 品牌</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                </tr>
            </thead>
            <apex:repeat value="{!sbVarExp}" var="sbgrade">
                <apex:repeat value="{!sbVarExp[sbgrade]}" var="subbrand">
                    <tr>
                        <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top" >{!RIGHT(sbgrade, LEN(sbgrade)-5)}</td>
                        <apex:outputText value="{!td_prefix}" escape="false" />{!sbVarExp[sbgrade][subbrand].strSubBrand}<apex:outputText value="{!td_end}" escape="false" />
                        <td align="right" valign="top"><apex:outputText value="{!sbVarExp[sbgrade][subbrand].strA}" rendered="{!sbVarExp[sbgrade][subbrand].strA!=0&&sbVarExp[sbgrade][subbrand].strA!=null}" ></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strA==null||sbVarExp[sbgrade][subbrand].strA==0}" /></td>
                        <td align="right" valign="top"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbVarExp[sbgrade][subbrand].strB!=0&&sbVarExp[sbgrade][subbrand].strB!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strB}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strB==null||sbVarExp[sbgrade][subbrand].strB==0}" /></td>
                        <td align="right" valign="top" style="border-right:1px solid black;" ><apex:outputText value="{0,number,#,###,###}" rendered="{!sbVarExp[sbgrade][subbrand].strC!=0&&sbVarExp[sbgrade][subbrand].strC!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strC}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strC==null||sbVarExp[sbgrade][subbrand].strC==0}" /></td>
                        <td align="right" valign="top"><apex:outputText value="{0,number,#,###,###.00}" rendered="{!sbVarExp[sbgrade][subbrand].strD!=0&&sbVarExp[sbgrade][subbrand].strD!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strD}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strD==null||sbVarExp[sbgrade][subbrand].strD==0}" /></td>
                        <td align="right" valign="top"><apex:outputText value="{0,number,#,###,###.00}" rendered="{!sbVarExp[sbgrade][subbrand].strE!=0&&sbVarExp[sbgrade][subbrand].strE!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strE}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strE==null||sbVarExp[sbgrade][subbrand].strE==0}" /></td>
                        <td align="right" valign="top" style="border-right:1px solid black;" ><apex:outputText value="{0,number,#,###,###.00}" rendered="{!sbVarExp[sbgrade][subbrand].strF!=0&&sbVarExp[sbgrade][subbrand].strF!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strF}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strF==null||sbVarExp[sbgrade][subbrand].strF==0}" /></td>
                        <td align="right" valign="top"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbVarExp[sbgrade][subbrand].strTotalA!=0&&sbVarExp[sbgrade][subbrand].strTotalA!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strTotalA}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strTotalA==null||sbVarExp[sbgrade][subbrand].strTotalA==0}" /></td>
                        <td align="right" valign="top"><apex:outputText value="{0,number,#,###,###}" rendered="{!sbVarExp[sbgrade][subbrand].strTotalB!=0&&sbVarExp[sbgrade][subbrand].strTotalB!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strTotalB}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strTotalB==null||sbVarExp[sbgrade][subbrand].strTotalB==0}" /></td>
                        <td align="right" valign="top" style="border-right:1px solid black;" ><apex:outputText value="{0,number,#,###,###}" rendered="{!sbVarExp[sbgrade][subbrand].strTotalC!=0&&sbVarExp[sbgrade][subbrand].strTotalC!=null}" ><apex:param value="{!sbVarExp[sbgrade][subbrand].strTotalC}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!sbVarExp[sbgrade][subbrand].strTotalC==null||sbVarExp[sbgrade][subbrand].strTotalC==0}" /></td>
                    </tr>
                </apex:repeat>
            </apex:repeat>
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;">{!VarExp_AllProducts.strName} 品牌合计</td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{!VarExp_AllProducts.strA}" rendered="{!VarExp_AllProducts.strA!=0}" ></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strA==0}" /></td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_AllProducts.strB!=0}" ><apex:param value="{!VarExp_AllProducts.strB}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strB==0}" /></td>
                <td style="border-right: 1px solid black; border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_AllProducts.strC!=0}" ><apex:param value="{!VarExp_AllProducts.strC}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strC==0}" /></td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###.00}" rendered="{!VarExp_AllProducts.strD!=0}" ><apex:param value="{!VarExp_AllProducts.strD}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strD==0}" /></td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###.00}" rendered="{!VarExp_AllProducts.strE!=0}" ><apex:param value="{!VarExp_AllProducts.strE}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strE==0}" /></td>
                <td style="border-right: 1px solid black; border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###.00}" rendered="{!VarExp_AllProducts.strF!=0}" ><apex:param value="{!VarExp_AllProducts.strF}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strF==0}" /></td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_AllProducts.strTotalA!=0}" ><apex:param value="{!VarExp_AllProducts.strTotalA}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strTotalA==0}" /></td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_AllProducts.strTotalB!=0}" ><apex:param value="{!VarExp_AllProducts.strTotalB}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strTotalB==0}" /></td>
                <td style="border-right: 1px solid black; border-top: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_AllProducts.strTotalC!=0}" ><apex:param value="{!VarExp_AllProducts.strTotalC}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VarExp_AllProducts.strTotalC==0}" /></td>
            </tr>
            <apex:variable var="v1" value="" rendered="{!checkNotEmpty_VarExp}">
                <tr>
                    <td colspan="2" style="border-right: 1px solid black;" align="right">&nbsp;</td>
                    <td bgcolor="#FFFFCC" colspan="6" style="border-top: 1px solid black; border-right: 1px solid black;">Achievement Recognition 调整</td>
                    <td bgcolor="#FFFFCC" style="border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_Total.strA!=0}"><apex:param value="{!VarExp_Total.strA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VarExp_Total.strA==0}"/></td>
                    <td bgcolor="#FFFFCC" style="border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_Total.strB!=0}"><apex:param value="{!VarExp_Total.strB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VarExp_Total.strB==0}"/></td>
                    <td bgcolor="#FFFFCC" style="border-top: 1px solid black; border-right: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_Total.strC!=0}"><apex:param value="{!VarExp_Total.strC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VarExp_Total.strC==0}"/></td>
                </tr>
            </apex:variable>
            <apex:repeat value="{!VarExpense_Map}" var="varitem">
                <apex:variable var="v2" value="" rendered="{!VarExpense_Map[varitem].boolCheckEmpty}">
                    <tr>
                        <td colspan="2" style="border-right: 1px solid black;" align="right">&nbsp;</td>
                        <td bgcolor="#FFFFCC" colspan="6" style="border-top: 1px solid black; border-right: 1px solid black;">{!varitem}</td>
                        <td bgcolor="#FFFFCC" style="border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExpense_Map[varitem].strA!=0}"><apex:param value="{!VarExpense_Map[varitem].strA}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExpense_Map[varitem].strA==0}"/></td>
                        <td bgcolor="#FFFFCC" style="border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExpense_Map[varitem].strB!=0}"><apex:param value="{!VarExpense_Map[varitem].strB}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExpense_Map[varitem].strB==0}"/></td>
                        <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExpense_Map[varitem].strC!=0}"><apex:param value="{!VarExpense_Map[varitem].strC}" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExpense_Map[varitem].strC==0}"/></td>
                    </tr>
                </apex:variable>
            </apex:repeat>
            <apex:variable var="v3" value="" rendered="{!checkNotEmpty_VarExp_Total}">
                <tr>
                    <td colspan="2" style="border-right: 1px solid black;" align="right">&nbsp;</td>
                    <td bgcolor="#FFFFCC" colspan="6" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;">TOTAL VARIABLE 变动费用总金额</td>
                    <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_Total.strTotalA!=null&&VarExp_Total.strTotalA!=0}" ><apex:param value="{!VarExp_Total.strTotalA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VarExp_Total.strTotalA==0||VarExp_Total.strTotalA==null}" /></td>
                    <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_Total.strTotalB!=null&&VarExp_Total.strTotalB!=0}" ><apex:param value="{!VarExp_Total.strTotalB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VarExp_Total.strTotalB==0||VarExp_Total.strTotalB==null}" /></td>
                    <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!VarExp_Total.strTotalC!=null&&VarExp_Total.strTotalC!=0}" ><apex:param value="{!VarExp_Total.strTotalC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!VarExp_Total.strTotalC==0||VarExp_Total.strTotalC==null}" /></td>
                </tr>
            </apex:variable>
            <tr>
                <td colspan="11">&nbsp;</td>
            </tr>
            <!--20160615 Ben @ Elufa
            <apex:variable var="v4" value="" rendered="{!thisCC.ASI_CRM_New_FY_PO__c}">
                <tr>
                    <td colspan="11" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>FESTIVAL SEASON TRADE EXPENSE SUMMARY (in RMB) 节日费用汇总 （元）</strong></font></td>
                </tr>
                <tr>
                    <td colspan="3" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">A/C CODE</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">CNY 春节(预估)</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">MAF 中秋(预估)</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">OTHERS 其他(预估)</td>
                    <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">TOTAL 总金额</td>
                </tr>
                <apex:repeat value="{!mapSeasonExpense_Var}" var="varitem">
                    <apex:variable var="v2" value="" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != 0}">
                        <tr>
                            <td colspan="3" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="left">{!varitem}</td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c==0||mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c==null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c==0||mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c==null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c==0||mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c==null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c == 0 || mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c == null}"/></td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
            </apex:variable>
            <!--20160615 End-->
            <tr>
                <td colspan="11">&nbsp;</td>
            </tr>
        </table>
        <table width="100%" border="0" cellpadding="3" cellspacing="0">
            <apex:variable var="v3" value="" rendered="{!checkNotEmpty_FixExp_Total}">
                <thead>
                    <tr>
                        <td colspan="11" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>FIXED EXPENSES (in RMB) 固定支出（元）</strong></font></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                        <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical 历史</td>
                        <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                        <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    </tr>
                </thead>
                <apex:repeat value="{!FixExpense_Map}" var="itm">
                    <apex:variable var="v4" value="" rendered="{!FixExpense_Map[itm].boolCheckEmpty}">
                        <tr>
                            <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; " valign="top">{!itm}</td>
                            <td colspan="3" style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,###}" rendered="{!FixExpense_Map[itm].strA!=0}"><apex:param value="{!FixExpense_Map[itm].strA}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!FixExpense_Map[itm].strA==0}"/></td>
                            <td colspan="3" style="border-right: 1px solid black;" align="right" valign="top"><apex:outputText value="{0,number,#,###,###}" rendered="{!FixExpense_Map[itm].strB!=0}"><apex:param value="{!FixExpense_Map[itm].strB}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!FixExpense_Map[itm].strB==0}"/></td>
                            <td colspan="3" style="border-right: 1px solid black; " align="right" valign="top"><apex:outputText value="{0,number,#,###,###}" rendered="{!FixExpense_Map[itm].strC!=0}"><apex:param value="{!FixExpense_Map[itm].strC}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!FixExpense_Map[itm].strC==0}"/></td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
                <tr>
                    <td colspan="2" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Total Fixed 固定费用总金额</td>
                    <td colspan="3" style="border-bottom: 1px solid black; border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!FixExp_Total.strA!=0}"><apex:param value="{!FixExp_Total.strA}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FixExp_Total.strA==0}"/></td>
                    <td colspan="3" style="border-bottom: 1px solid black; border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!FixExp_Total.strB!=0}"><apex:param value="{!FixExp_Total.strB}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FixExp_Total.strB==0}"/></td>
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black; " align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!FixExp_Total.strC!=0}"><apex:param value="{!FixExp_Total.strC}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FixExp_Total.strC==0}"/></td>
                </tr>
            </apex:variable>
            <tr>
                <td colspan="11">&nbsp;</td>
            </tr>
        </table>
        <table width="100%" border="0" cellpadding="3" cellspacing="0">
            <!--20160615 Ben @ Elufa-->
            <apex:variable var="v5" value="" rendered="{!thisCC.ASI_CRM_New_FY_PO__c && (mapSeasonExpense_subTotal[0] != 0 || mapSeasonExpense_subTotal[1] != 0 || mapSeasonExpense_subTotal[2] != 0)}">
                <thead>
                    <tr>
                        <td colspan="11" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>FESTIVAL SEASON TRADE EXPENSE SUMMARY (in RMB) 节日费用汇总 （元）</strong></font></td>
                    </tr>
                    <tr>
                        <td colspan="3" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">A/C CODE</td>
                        <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">CNY 春节(预估)</td>
                        <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">MAF 中秋(预估)</td>
                        <!--<td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">CNY&amp;MAF TOTAL</td>-->
                        <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">OTHERS 其他(预估)</td>
                        <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">Estimate Total 预计总金额</td>
                    </tr>
                </thead>
                <apex:repeat value="{!mapSeasonExpense_Fix}" var="varitem">
                    <apex:variable var="v2" value="" rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c != null && mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c != 0}">
                        <tr>
                            <td colspan="3" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="left">{!varitem}</td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CNY_Est__c != null && mapSeasonExpense_Fix[varitem].ASI_CRM_CNY_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CNY_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CNY_Est__c==0||mapSeasonExpense_Fix[varitem].ASI_CRM_CNY_Est__c==null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_MAF_Est__c != null && mapSeasonExpense_Fix[varitem].ASI_CRM_MAF_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Fix[varitem].ASI_CRM_MAF_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_MAF_Est__c==0 || mapSeasonExpense_Fix[varitem].ASI_CRM_MAF_Est__c==null}"/></td>
                            
                            <!--<td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_subTotal[varitem] != 0}"><apex:param value="{!mapSeasonExpense_subTotal[varitem]}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_subTotal[varitem]==0}"/></td>-->
                            
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_Other_Est__c != null && mapSeasonExpense_Fix[varitem].ASI_CRM_Other_Est__c != 0}" style="{!if(mapSeasonExpense_Fix[varitem].ASI_CRM_Other_Est__c < 0, 'color:red;','')}"><apex:param value="{!mapSeasonExpense_Fix[varitem].ASI_CRM_Other_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_Other_Est__c==0 || mapSeasonExpense_Fix[varitem].ASI_CRM_Other_Est__c == null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c != null && mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c != 0}"><apex:param value="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c == 0 || mapSeasonExpense_Fix[varitem].ASI_CRM_CN_Estimate_Amount__c == null}"/></td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
                <apex:repeat value="{!mapSeasonExpense_Var}" var="varitem">
                    <apex:variable var="v2" value="" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != 0}">
                        <tr>
                            <td colspan="3" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="left">{!varitem}</td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c==0||mapSeasonExpense_Var[varitem].ASI_CRM_CNY_Est__c==null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c==0||mapSeasonExpense_Var[varitem].ASI_CRM_MAF_Est__c==null}"/></td>
                            
                            <!--<td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_subTotal[varitem] != 0}"><apex:param value="{!mapSeasonExpense_subTotal[varitem]}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_subTotal[varitem]==0}"/></td>-->
                            
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c != 0}" style="{!if(mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c < 0, 'color:red;','')}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c==0||mapSeasonExpense_Var[varitem].ASI_CRM_Other_Est__c==null}"/></td>
                            <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != null && mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c != 0}"><apex:param value="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c}" /></apex:outputText>
                                <apex:outputText value=" - " rendered="{!mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c == 0 || mapSeasonExpense_Var[varitem].ASI_CRM_CN_Estimate_Amount__c == null}"/></td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
                <tr>
                    <td colspan="3" bgcolor="#FFFFCC" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="left">Total</td>
                    <td colspan="2" bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_subTotal[0] != 0}"><apex:param value="{!mapSeasonExpense_subTotal[0]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!mapSeasonExpense_subTotal[0]==0}"/>
                    </td>
                    <td colspan="2" bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_subTotal[1] != 0}"><apex:param value="{!mapSeasonExpense_subTotal[1]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!mapSeasonExpense_subTotal[1]==0}"/>
                    </td>
                    <td colspan="2" bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_subTotal[2] != 0}"><apex:param value="{!mapSeasonExpense_subTotal[2]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!mapSeasonExpense_subTotal[2]==0}"/>
                    </td>
                    <td colspan="2" bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!mapSeasonExpense_subTotal[3] != 0}"><apex:param value="{!mapSeasonExpense_subTotal[3]}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!mapSeasonExpense_subTotal[3]==0}"/>
                    </td>
                </tr>
            </apex:variable>
            <!--20160615 End-->
        </table>
    </body>
</apex:component>