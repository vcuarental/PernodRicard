<apex:component controller="ASI_CRM_CN_OffProfitShuttleCtrl" access="global">
    <apex:variable var="dummyV" value="{! dummyVar}" id="dummyVar"/>
    <apex:attribute name="Contractid" description="ID of Contract for PDF printout" type="id" assignto="{! PageId }"/>
    <apex:attribute name="PDF" description="Check AD identity" type="string" assignto="{! strPDF }"/>
    <apex:attribute name="EmailStr" type="String" description="Is for Email Body" assignTo="{! IsEmailStr }"/>
    <apex:stylesheet value="{! URLFOR($Resource.ASI_CRM_CN_PDF_Portrait_CSS) }"/>
    <body>
    <table  width="100%" cellspacing="0" >
        <tr>
            <td colspan="6"  bgcolor="#99CCFF" style="border-left: 1px solid black;border-right: 1px solid black;border-top: 1px solid black;" >
                Variable Cost Investment Methodology (变动费用投资方式)
            </td>
        </tr>
        <tr>
            <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" >种类</td>
            <td style="border-right: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black;" align="center" >销售折扣计算方式</td>
            <td style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="center" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}</td>
            <td style="border-right: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black; "  align="center" >{! $ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Unit__c.Label}</td>
            <td style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="center" > {! $ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Remark__c.Label}</td>
        </tr>
        <apex:variable value="{! 0}" var="PSFModuleNumber"/>
        <apex:variable value="{! 0}" var="DisplayModuleNumber"/>
        <apex:repeat value="{! PSF_Item_Map}"  var="itm" id="PSFitem"  >
            <apex:variable var="PSFModuleNumber" value="{! PSFModuleNumber+1 }"/>
            <tr>
                <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; " >PSF (合同奖励) - {! PSFModuleNumber}</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                    <apex:outputField value="{! PSF_Item_Map[itm].ASI_CRM_Methodology__r.Name} "  rendered="{! !showCN}" />
                    <apex:outputField value="{! PSF_Item_Map[itm].ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{! showCN}" />
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                    <apex:outputField value="{! PSF_Item_Map[itm].ASI_CRM_Volume_Base__c }"/>
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                    <apex:outputField value="{! PSF_Item_Map[itm].ASI_CRM_Unit__c }"/>
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                        {! PSF_Item_Map[itm].ASI_CRM_Remark_Display__c}
                    </td>
            </tr>
        </apex:repeat>
        <apex:repeat value="{! Display_Item_Map}"  var="itm" id="Displayitem"  >
            <apex:variable var="DisplayModuleNumber" value="{! DisplayModuleNumber+1 }"/>
            <tr>
                <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; " >Display (陈列费) - {! DisplayModuleNumber}</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                    <apex:outputField value="{! Display_Item_Map[itm].ASI_CRM_Methodology__r.Name} "  rendered="{! !showCN}" />
                    <apex:outputField value="{! Display_Item_Map[itm].ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{! showCN}" />
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                    <apex:outputField value="{! Display_Item_Map[itm].ASI_CRM_Volume_Base__c }"/>
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                    <apex:outputField value="{! Display_Item_Map[itm].ASI_CRM_Unit__c }"/>
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                        {! Display_Item_Map[itm].ASI_CRM_Remark_Display__c}
                    </td>
            </tr>
        </apex:repeat>
    </table>

    <br/>

    <table width="100%" border="0" cellspacing="0" cellpadding="2">
        <tr>
            <td width="20%" style="border-left: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center" >PO No.:{! thisCC.ASI_CRM_CN_PO_No__c}</td>
            <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;"  align="center">Start Date<br/>开始日期</td>
            <td width="10%" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">End Date<br/>结束日期</td>
            <td width="10%" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Nb of Months<br/>月数</td>
            <td width="15%" style="border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Sales Rep<br/>销售</td>
            <td width="5%">&nbsp;</td>
            <td width="15%"></td>
            <td width="15%" ></td>
        </tr>
        <tr style="vertical-align: bottom;">
            <td style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Historical Contract vfinal 历史合同实际</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{! previousCCStart}</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{! previousCCEnd}</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,### }">
                    <apex:param value="{! HistoricalVFinalContract.NoOfMonths}" />
                </apex:outputText>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{! PreviousCCSalesRep}</td>
            <td>&nbsp;</td>
            <td></td>
            <td></td>
        </tr>
        <tr style="vertical-align: bottom;">
            <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid #000000;">NEW CONTRACT新合同</td>
            <td style="border-bottom: 1px solid #000000; border-right: 1px solid black;">{! thisCCStart}</td>
            <td style="border-bottom: 1px solid #000000; border-right: 1px solid black;">{! thisCCEnd}</td>
            <td style="border-bottom: 1px solid #000000; border-right: 1px solid black;">{! thisCC.ASI_CRM_CN_No_of_Months__c}</td>
            <td style="border-bottom: 1px solid #000000; border-right: 1px solid black;">{! thisCC.Owner.Name}</td>
            <td>&nbsp;</td>
            <td  align="center"></td>
            <td></td>
        </tr>
    </table>

    <br/>

    <table width="100%" border="0" cellpadding="3" cellspacing="0">
        <tr>
            <apex:outputText value="{! MainTableHeader1}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{! MainTableHeader2}" rendered="{! !ExistHistoricalData}" escape="false"  />
        </tr>
        <tr>
            <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
            <apex:outputText value="{! ExistHistoricalData1}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{! ExistHistoricalData2}" rendered="{! !ExistHistoricalData}" escape="false"  />
            <td rowspan="2" style="border-bottom: 1px solid black;" align="center">Budget/LE<br/>预算</td>
            <td rowspan="2" style="border-right: 1px solid black;border-bottom: 1px solid black;" align="center">vs Est<br/>对比预估</td>
        </tr>
        <tr>
            <apex:outputText value="{! MainTableHeader3}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="v0.0<br/>预估</td>" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{! MainTableHeader3}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="vFinal<br/>完成</td>" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{! MainTableHeader3}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="% v0.0<br/>对比预估</td>" rendered="{! ExistHistoricalData}" escape="false"  />
            <td style="border-bottom: 1px solid black;" align="center">Estimate 预估</td>
            <apex:outputText value="{! MainTableHeaderdotted}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="% vFinal<br/>对比历史完成" rendered="{! ExistHistoricalData}" escape="false"  />
            <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract<br/>合同</td>
        </tr>
        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalV00Contract.Volumes  !=  0 && HistoricalV00Contract.Volumes != null}" >
                        <apex:param value="{! HistoricalV00Contract.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.Volumes == 0 || HistoricalV00Contract.Volumes == null }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalVFinalContract.Volumes != 0 && HistoricalVFinalContract.Volumes != null}" >
                        <apex:param value="{! HistoricalVFinalContract.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.Volumes == 0 || HistoricalVFinalContract.Volumes == null }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"  rendered="{! HistoricalV00Contract.Volumes != 0 && HistoricalV00Contract.Volumes != null }" >
                        <apex:param value="{! ((HistoricalVFinalContract.Volumes - HistoricalV00Contract.Volumes) / HistoricalV00Contract.Volumes )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.Volumes == 0 || HistoricalV00Contract.Volumes == null }"/>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContractV0Estimate.Volumes != 0 && NewContractV0Estimate.Volumes != null }">
                    <apex:param value="{! NewContractV0Estimate.Volumes}" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.Volumes == 0 || NewContractV0Estimate.Volumes == null }"/>
            </td>
            <apex:outputText value="{! ExistHisDataTD_dotted}" rendered="{! ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HVfinalComparedContract.Volumes != 0 && ExistHistoricalData }">
                <apex:param value="{! HVfinalComparedContract.Volumes }" />
            </apex:outputText>
            <apex:outputText value=" - " rendered="{! HVfinalComparedContract.Volumes == 0 && ExistHistoricalData }"/>
            <apex:outputText value="{! td_end}" rendered="{! ExistHistoricalData}" escape="false" />
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContactV0Contract.Volumes != 0 && NewContactV0Contract.Volumes != null }">
                    <apex:param value="{! NewContactV0Contract.Volumes}" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.Volumes == 0 || NewContactV0Contract.Volumes == null }"/>
            </td>
            <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{! thisCC.ASI_CRM_CN_Vol_Budget_LE__c != 0 && thisCC.ASI_CRM_CN_Vol_Budget_LE__c != null }">
                    <apex:param value="{! thisCC.ASI_CRM_CN_Vol_Budget_LE__c}" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! thisCC.ASI_CRM_CN_Vol_Budget_LE__c == 0 || thisCC.ASI_CRM_CN_Vol_Budget_LE__c == null }"/>
            </td>
            <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}" rendered="{! thisCC.ASI_CRM_CN_Vol_Budget_LE__c != null && NewContractV0Estimate.Volumes != null }">
                    <apex:param value="{! (thisCC.ASI_CRM_CN_Vol_Budget_LE__c - NewContractV0Estimate.Volumes) }" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! thisCC.ASI_CRM_CN_Vol_Budget_LE__c == null || NewContractV0Estimate.Volumes == null }"/>
            </td>
        </tr>
        <apex:repeat value="{! categoriesDisplayMap}" var="item" id="categoriesItem">
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">{! item}</td>
                <!-- Historical V0.0 -->
                <apex:outputText value="{! ExistHisDataTD_noBottom}" rendered="{! ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] != 0 && ExistHistoricalData}" >
                    <apex:param value="{! HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] }" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] == 0 && ExistHistoricalData }"/>
                <apex:outputText value="{! td_end}" rendered="{! ExistHistoricalData}" escape="false" />
                <!-- Historical VFinal -->
                <apex:outputText value="{! ExistHisDataTD_noBottom}" rendered="{! ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] != 0 && ExistHistoricalData}" >
                    <apex:param value="{! HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] }" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] == 0 && ExistHistoricalData }"/>
                <apex:outputText value="{! td_end}" rendered="{! ExistHistoricalData}" escape="false" />
                <!-- Historical %v0.0 -->
                <apex:outputText value="{! ExistHisDataTD_noBottom}" rendered="{! ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,##0.0}%"  rendered="{! HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] != 0 && ExistHistoricalData }">
                    <apex:param value="{! ((HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] - HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] )/ HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] * 100) }" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! (HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] == 0 || HistoricalV00Contract.CategoryVolumeMap[categoriesDisplayMap[item]] == null) && ExistHistoricalData }"/>
                <apex:outputText value="{! td_end}" rendered="{! ExistHistoricalData}" escape="false" />
                <!-- New Contract Estimate -->
                <td align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContractV0Estimate.CategoryVolumeMap[categoriesDisplayMap[item]] != 0 }">
                        <apex:param value="{! NewContractV0Estimate.CategoryVolumeMap[categoriesDisplayMap[item]]}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.CategoryVolumeMap[categoriesDisplayMap[item]] == 0 || NewContractV0Estimate.CategoryVolumeMap[categoriesDisplayMap[item]] == null }"/>
                </td>
                <!-- New Contract % vFinal -->
                <apex:outputText value="{! ExistHisDataTD_dottednoBottom}" rendered="{! ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.CategoryVolumeMap[categoriesDisplayMap[item]] != null && HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] != 0 && HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] != null && ExistHistoricalData }">
                    <apex:param value="{! ((NewContractV0Estimate.CategoryVolumeMap[categoriesDisplayMap[item]]-HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]])/HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]])*100 }" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! (HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] == 0 || HistoricalVFinalContract.CategoryVolumeMap[categoriesDisplayMap[item]] == null) && ExistHistoricalData }"/>
                <apex:outputText value="{! td_end}" rendered="{! ExistHistoricalData}" escape="false" />
                <!-- New Contract Volume -->
                <apex:outputText value="{! ExistHisDataTD_noBottom}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContactV0Contract.CategoryVolumeMap[categoriesDisplayMap[item]] != 0 }">
                    <apex:param value="{! NewContactV0Contract.CategoryVolumeMap[categoriesDisplayMap[item]]}" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.CategoryVolumeMap[categoriesDisplayMap[item]] == 0 || NewContactV0Contract.CategoryVolumeMap[categoriesDisplayMap[item]] == null }"/>
                <apex:outputText value="{! td_end}" escape="false" />
                <td align="right">&nbsp;</td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
            </tr>
        </apex:repeat>
        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA">Trade expenses 销售费用</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <strong>
                        <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalV00Contract.TradeExpenses != null && HistoricalV00Contract.TradeExpenses != 0 }">
                            <apex:param value="{! HistoricalV00Contract.TradeExpenses }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.TradeExpenses == null || HistoricalV00Contract.TradeExpenses == 0 }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <strong>
                        <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalVFinalContract.TradeExpenses != null && HistoricalVFinalContract.TradeExpenses != 0 }">
                            <apex:param value="{! HistoricalVFinalContract.TradeExpenses }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.TradeExpenses == null || HistoricalVFinalContract.TradeExpenses == 0 }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"  bgcolor="#E3DFDA" >
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.TradeExpenses != 0 && HistoricalV00Contract.TradeExpenses != null }">
                        <apex:param value="{! ((HistoricalVFinalContract.TradeExpenses - HistoricalV00Contract.TradeExpenses )/ HistoricalV00Contract.TradeExpenses )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.TradeExpenses == 0 || HistoricalV00Contract.TradeExpenses == null }"/>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContractV0Estimate.TradeExpenses != null && NewContractV0Estimate.TradeExpenses != 0 }">
                        <apex:param value="{! NewContractV0Estimate.TradeExpenses }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.TradeExpenses == null || NewContractV0Estimate.TradeExpenses == 0 }"/>
                </strong>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.TradeExpenses != null && HistoricalVFinalContract.TradeExpenses != 0 && NewContractV0Estimate.TradeExpenses != null }">
                        <apex:param value="{! (( NewContractV0Estimate.TradeExpenses - HistoricalVFinalContract.TradeExpenses )/ HistoricalVFinalContract.TradeExpenses )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.TradeExpenses == 0 || HistoricalVFinalContract.TradeExpenses == null }"/>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContactV0Contract.TradeExpenses != null && NewContactV0Contract.TradeExpenses != 0 }">
                        <apex:param value="{! NewContactV0Contract.TradeExpenses }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContactV0Contract.TradeExpenses == null || NewContactV0Contract.TradeExpenses == 0 }"/>
                </strong>
            </td>
            <td style="border-bottom: 1px solid black;" bgcolor="#E3DFDA" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{! thisCC.ASI_CRM_CN_Budget_LE__c != 0 && thisCC.ASI_CRM_CN_Budget_LE__c != null }">
                    <apex:param value="{! thisCC.ASI_CRM_CN_Budget_LE__c}" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! thisCC.ASI_CRM_CN_Budget_LE__c == 0 || thisCC.ASI_CRM_CN_Budget_LE__c == null }"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA" align="right" valign="middle">
                <apex:outputText value="{0,number,#,###,##0}" rendered="{! thisCC.ASI_CRM_CN_Budget_LE__c != null && NewContractV0Estimate.TradeExpenses != null }">
                    <apex:param value="{! (thisCC.ASI_CRM_CN_Budget_LE__c-NewContractV0Estimate.TradeExpenses) }" />
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! thisCC.ASI_CRM_CN_Budget_LE__c == null || NewContractV0Estimate.TradeExpenses == null }"/>
            </td>
        </tr>

        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Gross Sales 营业额</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalV00Contract.GrossSalesTotal != null && HistoricalV00Contract.GrossSalesTotal != 0 }">
                        <apex:param value="{! HistoricalV00Contract.GrossSalesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.GrossSalesTotal == null || HistoricalV00Contract.GrossSalesTotal == 0 }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalVFinalContract.GrossSalesTotal != null && HistoricalVFinalContract.GrossSalesTotal != 0 }">
                        <apex:param value="{! HistoricalVFinalContract.GrossSalesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.GrossSalesTotal == null || HistoricalVFinalContract.GrossSalesTotal == 0 }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.GrossSalesTotal != null && HistoricalV00Contract.GrossSalesTotal != 0 }">
                        <apex:param value="{! (( HistoricalVFinalContract.GrossSalesTotal - HistoricalV00Contract.GrossSalesTotal )/ HistoricalV00Contract.GrossSalesTotal ) *100 }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.GrossSalesTotal == null || HistoricalV00Contract.GrossSalesTotal == 0 }"/>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContractV0Estimate.GrossSalesTotal != null && NewContractV0Estimate.GrossSalesTotal != 0 }">
                    <apex:param value="{! NewContractV0Estimate.GrossSalesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.GrossSalesTotal == null || NewContractV0Estimate.GrossSalesTotal == 0 }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.GrossSalesTotal != null && HistoricalVFinalContract.GrossSalesTotal != 0 }">
                        <apex:param value="{! ((NewContractV0Estimate.GrossSalesTotal - HistoricalVFinalContract.GrossSalesTotal )/ HistoricalVFinalContract.GrossSalesTotal )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.GrossSalesTotal == null ||  HistoricalVFinalContract.GrossSalesTotal == 0 }"/>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContactV0Contract.GrossSalesTotal != null && NewContactV0Contract.GrossSalesTotal != 0 }">
                    <apex:param value="{! NewContactV0Contract.GrossSalesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.GrossSalesTotal == null || NewContactV0Contract.GrossSalesTotal == 0 }"/>
            </td>
            <td style="border-bottom: 1px solid black; " align="right">&nbsp;</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>

        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.GrossSalesRate != null && HistoricalV00Contract.GrossSalesRate != 0 }">
                        <apex:param value="{! HistoricalV00Contract.GrossSalesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.GrossSalesRate == null || HistoricalV00Contract.GrossSalesRate == 0 }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.GrossSalesRate != null && HistoricalVFinalContract.GrossSalesRate != 0 }">
                        <apex:param value="{! HistoricalVFinalContract.GrossSalesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.GrossSalesRate == null || HistoricalVFinalContract.GrossSalesRate == 0 }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.GrossSalesRate != null && HistoricalV00Contract.GrossSalesRate != null }">
                        <apex:param value="{! HistoricalVFinalContract.GrossSalesRate - HistoricalV00Contract.GrossSalesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.GrossSalesRate == null || HistoricalV00Contract.GrossSalesRate == null }"/>
                </td>
            </apex:outputPanel>

            <td align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.GrossSalesRate != null && NewContractV0Estimate.GrossSalesRate != 0 }">
                    <apex:param value="{! NewContractV0Estimate.GrossSalesRate }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.GrossSalesRate == null || NewContractV0Estimate.GrossSalesRate == 0 }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.GrossSalesRate != null && HistoricalVFinalContract.GrossSalesRate != 0 }">
                        <apex:param value="{! (NewContractV0Estimate.GrossSalesRate-HistoricalVFinalContract.GrossSalesRate) }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.GrossSalesRate == null || HistoricalVFinalContract.GrossSalesRate == null ||  HistoricalVFinalContract.GrossSalesRate == 0 }"/>
                </td>
            </apex:outputPanel>

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContactV0Contract.GrossSalesRate != null && NewContactV0Contract.GrossSalesRate != 0 }">
                    <apex:param value="{! NewContactV0Contract.GrossSalesRate }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.GrossSalesRate == null || NewContactV0Contract.GrossSalesRate == 0 }"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 Extra eq btl  折CR12新境单瓶投入</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! HistoricalV00Contract.InvestmentCR12 != null && HistoricalV00Contract.InvestmentCR12 != 0 }">
                        <apex:param value="{! HistoricalV00Contract.InvestmentCR12 }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.InvestmentCR12 == null || HistoricalV00Contract.InvestmentCR12 == 0 }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! HistoricalVFinalContract.InvestmentCR12 != null && HistoricalVFinalContract.InvestmentCR12 != 0 }">
                        <apex:param value="{! HistoricalVFinalContract.InvestmentCR12 }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.InvestmentCR12 == null || HistoricalVFinalContract.InvestmentCR12 == 0 }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalContractCompared.InvestmentCR12 != null && HistoricalContractCompared.InvestmentCR12 != 0 }">
                        <apex:param value="{! HistoricalContractCompared.InvestmentCR12 }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalContractCompared.InvestmentCR12 == null || HistoricalContractCompared.InvestmentCR12 == 0 }"/>
                </td>

            </apex:outputPanel>

            <td align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! NewContractV0Estimate.InvestmentCR12 != null && NewContractV0Estimate.InvestmentCR12 != 0 }">
                    <apex:param value="{! NewContractV0Estimate.InvestmentCR12 }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.InvestmentCR12 == null || NewContractV0Estimate.InvestmentCR12 == 0 }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.InvestmentCR12 != null && HistoricalVFinalContract.InvestmentCR12 != 0 && HistoricalVFinalContract.InvestmentCR12 != null }">
                        <apex:param value="{! ((NewContractV0Estimate.InvestmentCR12-HistoricalVFinalContract.InvestmentCR12)/HistoricalVFinalContract.InvestmentCR12)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.InvestmentCR12 == 0 || HistoricalVFinalContract.InvestmentCR12 == null }"/>
                </td>

            </apex:outputPanel>

            <td style="border-right: 1px solid black;" align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! NewContactV0Contract.InvestmentCR12 != null && NewContactV0Contract.InvestmentCR12 != 0 }">
                    <apex:param value="{! NewContactV0Contract.InvestmentCR12 }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.InvestmentCR12 == null || NewContactV0Contract.InvestmentCR12 == 0 }"/>
            </td>
            <td align="right" valign="top">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right" valign="top">&nbsp;</td>
        </tr>
        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">PSF 合同奖励</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalV00Contract.PSFExpensesTotal != null }">
                        <apex:param value="{! HistoricalV00Contract.PSFExpensesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.PSFExpensesTotal == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalVFinalContract.PSFExpensesTotal != null }">
                        <apex:param value="{! HistoricalVFinalContract.PSFExpensesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.PSFExpensesTotal == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.PSFExpensesTotal != 0 && HistoricalV00Contract.PSFExpensesTotal != null }">
                        <apex:param value="{! ((HistoricalVFinalContract.PSFExpensesTotal - HistoricalV00Contract.PSFExpensesTotal )/ HistoricalV00Contract.PSFExpensesTotal )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.PSFExpensesTotal == 0 || HistoricalV00Contract.PSFExpensesTotal == null }"/>
                </td>
            </apex:outputPanel>

            <td align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContractV0Estimate.PSFExpensesTotal != null }">
                    <apex:param value="{! NewContractV0Estimate.PSFExpensesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.PSFExpensesTotal == null }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.PSFExpensesTotal != null && HistoricalVFinalContract.PSFExpensesTotal != 0 && HistoricalVFinalContract.PSFExpensesTotal != null }">
                        <apex:param value="{! ((NewContractV0Estimate.PSFExpensesTotal-HistoricalVFinalContract.PSFExpensesTotal)/HistoricalVFinalContract.PSFExpensesTotal)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.PSFExpensesTotal == 0 || HistoricalVFinalContract.PSFExpensesTotal == null }"/>
                </td>
            </apex:outputPanel>

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContactV0Contract.PSFExpensesTotal != null }">
                    <apex:param value="{! NewContactV0Contract.PSFExpensesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.PSFExpensesTotal == null }"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr style="{!IF(!showDisplay,'display: none;','')}">
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Display 陈列费</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalV00Contract.DisplayExpensesTotal != null }">
                        <apex:param value="{! HistoricalV00Contract.DisplayExpensesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.DisplayExpensesTotal == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalVFinalContract.DisplayExpensesTotal != null }">
                        <apex:param value="{! HistoricalVFinalContract.DisplayExpensesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.DisplayExpensesTotal == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.DisplayExpensesTotal != 0 && HistoricalV00Contract.DisplayExpensesTotal != null }">
                        <apex:param value="{! ((HistoricalVFinalContract.DisplayExpensesTotal - HistoricalV00Contract.DisplayExpensesTotal )/ HistoricalV00Contract.DisplayExpensesTotal )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.DisplayExpensesTotal == 0 || HistoricalV00Contract.DisplayExpensesTotal == null }"/>
                </td>

            </apex:outputPanel>

            <td align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContractV0Estimate.DisplayExpensesTotal != null }">
                    <apex:param value="{! NewContractV0Estimate.DisplayExpensesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.DisplayExpensesTotal == null }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.DisplayExpensesTotal != null && HistoricalVFinalContract.DisplayExpensesTotal != 0 && HistoricalVFinalContract.DisplayExpensesTotal != null }">
                        <apex:param value="{! ((NewContractV0Estimate.DisplayExpensesTotal-HistoricalVFinalContract.DisplayExpensesTotal)/HistoricalVFinalContract.DisplayExpensesTotal)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.DisplayExpensesTotal == 0 || HistoricalVFinalContract.DisplayExpensesTotal == null }"/>
                </td>
            </apex:outputPanel>

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContactV0Contract.DisplayExpensesTotal != null }">
                    <apex:param value="{! NewContactV0Contract.DisplayExpensesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.DisplayExpensesTotal == null }"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Other 其他费用</td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalV00Contract.OtherExpensesTotal != null }">
                        <apex:param value="{! HistoricalV00Contract.OtherExpensesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.OtherExpensesTotal == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{! HistoricalVFinalContract.OtherExpensesTotal != null }">
                        <apex:param value="{! HistoricalVFinalContract.OtherExpensesTotal }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.OtherExpensesTotal == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.OtherExpensesTotal != 0 && HistoricalV00Contract.OtherExpensesTotal != null }">
                        <apex:param value="{! ((HistoricalVFinalContract.OtherExpensesTotal - HistoricalV00Contract.OtherExpensesTotal )/ HistoricalV00Contract.OtherExpensesTotal )*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.OtherExpensesTotal == 0 || HistoricalV00Contract.OtherExpensesTotal == null }"/>
                </td>
            </apex:outputPanel>

            <td align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContractV0Estimate.OtherExpensesTotal != null }">
                    <apex:param value="{! NewContractV0Estimate.OtherExpensesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.OtherExpensesTotal == null }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.OtherExpensesTotal != null && HistoricalVFinalContract.OtherExpensesTotal != 0 && NewContractV0Estimate.OtherExpensesTotal != 0 && HistoricalVFinalContract.OtherExpensesTotal != null }">
                        <apex:param value="{! ((NewContractV0Estimate.OtherExpensesTotal-HistoricalVFinalContract.OtherExpensesTotal)/HistoricalVFinalContract.OtherExpensesTotal)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" 0% " rendered="{! HistoricalVFinalContract.OtherExpensesTotal == 0 || HistoricalVFinalContract.OtherExpensesTotal == null || NewContractV0Estimate.OtherExpensesTotal == 0 }"/>
                </td>
            </apex:outputPanel>

            <td style="border-right: 1px solid black;"  align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{! NewContactV0Contract.OtherExpensesTotal != null }">
                    <apex:param value="{! NewContactV0Contract.OtherExpensesTotal }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.OtherExpensesTotal == null }"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr style="{!IF(!showDisplay,'display: none;','')}">
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Display expense % 陈列费比例 %  </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.DisplayExpensesRate != null }">
                        <apex:param value="{! HistoricalV00Contract.DisplayExpensesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.DisplayExpensesRate == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.DisplayExpensesRate != null }">
                        <apex:param value="{! HistoricalVFinalContract.DisplayExpensesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.DisplayExpensesRate == null }"/>
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##.##}%" rendered="{! HistoricalVFinalContract.DisplayExpensesRate != null && HistoricalV00Contract.DisplayExpensesRate != null }">
                        <apex:param value="{! HistoricalVFinalContract.DisplayExpensesRate - HistoricalV00Contract.DisplayExpensesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.DisplayExpensesRate == null || HistoricalV00Contract.DisplayExpensesRate == null }"/>
                </td>
            </apex:outputPanel>

            <td align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.DisplayExpensesRate != null }">
                    <apex:param value="{! NewContractV0Estimate.DisplayExpensesRate }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.DisplayExpensesRate == null }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##.##}%" rendered="{! NewContractV0Estimate.DisplayExpensesRate != null && HistoricalVFinalContract.DisplayExpensesRate != 0 && NewContractV0Estimate.DisplayExpensesRate != 0 }">
                        <apex:param value="{! (NewContractV0Estimate.DisplayExpensesRate-HistoricalVFinalContract.DisplayExpensesRate) }" />
                    </apex:outputText>
                    <apex:outputText value=" 0% " rendered="{! NewContractV0Estimate.DisplayExpensesRate == null || HistoricalVFinalContract.DisplayExpensesRate == null || NewContractV0Estimate.DisplayExpensesRate == 0 || HistoricalVFinalContract.DisplayExpensesRate == 0 }"/>
                </td>
            </apex:outputPanel>

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContactV0Contract.DisplayExpensesRate != null }">
                    <apex:param value="{! NewContactV0Contract.DisplayExpensesRate }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.DisplayExpensesRate == null }"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr>
            <td style="border-bottom: 1px solid #000000; border-left: 1px solid black; border-right: 1px solid black;">Other Cost % 其他费用比例 % </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.OtherExpensesRate != null }">
                        <apex:param value="{! HistoricalV00Contract.OtherExpensesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalV00Contract.OtherExpensesRate == null }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.OtherExpensesRate != null }">
                        <apex:param value="{! HistoricalVFinalContract.OtherExpensesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.OtherExpensesRate == null }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##.##}%" rendered="{! HistoricalVFinalContract.OtherExpensesRate != null && HistoricalV00Contract.OtherExpensesRate != null }">
                        <apex:param value="{! HistoricalVFinalContract.OtherExpensesRate - HistoricalV00Contract.OtherExpensesRate }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.OtherExpensesRate == null || HistoricalV00Contract.OtherExpensesRate == null }"/>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.OtherExpensesRate != null }">
                    <apex:param value="{! NewContractV0Estimate.OtherExpensesRate }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContractV0Estimate.OtherExpensesRate == null }"/>
            </td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##.##}%" rendered="{! NewContractV0Estimate.OtherExpensesRate != null && HistoricalVFinalContract.OtherExpensesRate != 0 && NewContractV0Estimate.OtherExpensesRate != 0 }">
                        <apex:param value="{! (NewContractV0Estimate.OtherExpensesRate-HistoricalVFinalContract.OtherExpensesRate) }" />
                    </apex:outputText>
                    <apex:outputText value=" 0% " rendered="{! NewContractV0Estimate.OtherExpensesRate == null || HistoricalVFinalContract.OtherExpensesRate == null || NewContractV0Estimate.OtherExpensesRate == 0 || HistoricalVFinalContract.OtherExpensesRate == 0 }"/>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContactV0Contract.OtherExpensesRate != null }">
                    <apex:param value="{! NewContactV0Contract.OtherExpensesRate }"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{! NewContactV0Contract.OtherExpensesRate == null }"/>
            </td>
            <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <!--<apex:outputPanel rendered="{!AdorAbove}" layout="none">-->

        <tr style="{! IF(AdorAbove,'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin after A&amp;P 销售净利润</strong></td>
            <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <strong>
                        <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalV00Contract.MarginAfterAnP != null && HistoricalV00Contract.MarginAfterAnP != 0 }">
                            <apex:param value="{! HistoricalV00Contract.MarginAfterAnP }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.MarginAfterAnP == 0 || HistoricalV00Contract.MarginAfterAnP == null }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <strong>
                        <apex:outputText value="{0,number,#,###,###}" rendered="{! HistoricalVFinalContract.MarginAfterAnP != null && HistoricalVFinalContract.MarginAfterAnP != 0 }">
                            <apex:param value="{! HistoricalVFinalContract.MarginAfterAnP }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.MarginAfterAnP == 0 || HistoricalVFinalContract.MarginAfterAnP == null }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalContractCompared.MarginAfterAnP != null && HistoricalContractCompared.MarginAfterAnP != 0 }">
                            <apex:param value="{! HistoricalContractCompared.MarginAfterAnP }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalContractCompared.MarginAfterAnP == 0 || HistoricalContractCompared.MarginAfterAnP == null }"/>
                    </strong>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99">
                <strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContractV0Estimate.MarginAfterAnP != null && NewContractV0Estimate.MarginAfterAnP != 0 }">
                        <apex:param value="{! NewContractV0Estimate.MarginAfterAnP }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.MarginAfterAnP == 0 || NewContractV0Estimate.MarginAfterAnP == null }"/>
                </strong>
            </td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.MarginAfterAnP != null && HistoricalVFinalContract.MarginAfterAnP != 0 && HistoricalVFinalContract.MarginAfterAnP != null }">
                        <apex:param value="{! ((NewContractV0Estimate.MarginAfterAnP-HistoricalVFinalContract.MarginAfterAnP)/HistoricalVFinalContract.MarginAfterAnP)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.MarginAfterAnP == 0 || HistoricalVFinalContract.MarginAfterAnP == null }"/>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                <strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! NewContactV0Contract.MarginAfterAnP != null && NewContactV0Contract.MarginAfterAnP != 0 }">
                        <apex:param value="{! NewContactV0Contract.MarginAfterAnP }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContactV0Contract.MarginAfterAnP == 0 || NewContactV0Contract.MarginAfterAnP == null }"/>
                </strong>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr style="{! IF(AdorAbove,'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin per Bottle 单瓶利润 </strong></td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! HistoricalV00Contract.MarginPerBottle != null && HistoricalV00Contract.MarginPerBottle != 0 }">
                            <apex:param value="{! HistoricalV00Contract.MarginPerBottle }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.MarginPerBottle == 0 || HistoricalV00Contract.MarginPerBottle == null }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! HistoricalVFinalContract.MarginPerBottle != null && HistoricalVFinalContract.MarginPerBottle != 0 }">
                            <apex:param value="{! HistoricalVFinalContract.MarginPerBottle }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.MarginPerBottle == 0 || HistoricalVFinalContract.MarginPerBottle == null }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalV00Contract.MarginPerBottle != null && HistoricalV00Contract.MarginPerBottle != 0 }">
                            <apex:param value="{! ((HistoricalVFinalContract.MarginPerBottle - HistoricalV00Contract.MarginPerBottle )/ HistoricalV00Contract.MarginPerBottle )*100 }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.MarginPerBottle == 0 || HistoricalV00Contract.MarginPerBottle == null }"/>
                    </strong>
                </td>
            </apex:outputPanel>
            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99">
                <strong>
                    <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! NewContractV0Estimate.MarginPerBottle != null && NewContractV0Estimate.MarginPerBottle != 0 }">
                        <apex:param value="{! NewContractV0Estimate.MarginPerBottle }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.MarginPerBottle == 0 || NewContractV0Estimate.MarginPerBottle == null }"/>
                </strong>
            </td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalVFinalContract.MarginPerBottle != null && HistoricalVFinalContract.MarginPerBottle != 0 && HistoricalVFinalContract.MarginPerBottle != null }">
                        <apex:param value="{! ((NewContractV0Estimate.MarginPerBottle-HistoricalVFinalContract.MarginPerBottle)/HistoricalVFinalContract.MarginPerBottle)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.MarginPerBottle == 0 || HistoricalVFinalContract.MarginPerBottle == null }"/>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                <strong>
                    <apex:outputText value="{0,number,#,###,##0.0}" rendered="{! NewContactV0Contract.MarginPerBottle != null && NewContactV0Contract.MarginPerBottle != 0 }">
                        <apex:param value="{! NewContactV0Contract.MarginPerBottle }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContactV0Contract.MarginPerBottle == 0 || NewContactV0Contract.MarginPerBottle == null }"/>
                </strong>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr style="{! IF(AdorAbove,'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>ROI(Intake) 投资回报率</strong></td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! HistoricalV00Contract.ROIIntake != null && HistoricalV00Contract.ROIIntake != 0 }">
                            <apex:param value="{! HistoricalV00Contract.ROIIntake }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.ROIIntake == null || HistoricalV00Contract.ROIIntake == 0 }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! HistoricalVFinalContract.ROIIntake != null && HistoricalVFinalContract.ROIIntake != 0 }">
                            <apex:param value="{! HistoricalVFinalContract.ROIIntake }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.ROIIntake == null || HistoricalVFinalContract.ROIIntake == 0 }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! HistoricalContractCompared.ROIIntake != null && HistoricalContractCompared.ROIIntake != 0 }">
                            <apex:param value="{! HistoricalContractCompared.ROIIntake }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalContractCompared.ROIIntake == null || HistoricalContractCompared.ROIIntake == 0 }"/>
                    </strong>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong>
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! NewContractV0Estimate.ROIIntake != null && NewContractV0Estimate.ROIIntake != 0 }">
                        <apex:param value="{! NewContractV0Estimate.ROIIntake }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.ROIIntake == null || NewContractV0Estimate.ROIIntake == 0 }"/>
                </strong>
            </td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! NewContractV0Estimate.ROIIntake != 0 || HistoricalVFinalContract.ROIIntake != 0 }">
                        <apex:param value="{! (NewContractV0Estimate.ROIIntake-HistoricalVFinalContract.ROIIntake) }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.ROIIntake == 0 && HistoricalVFinalContract.ROIIntake == 0 }"/>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong>
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! NewContactV0Contract.ROIIntake != null && NewContactV0Contract.ROIIntake != 0 }">
                        <apex:param value="{! NewContactV0Contract.ROIIntake }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContactV0Contract.ROIIntake == null || NewContactV0Contract.ROIIntake == 0 }"/>
                </strong>
            </td>
            <td style="" align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <tr style="{! IF(AdorAbove,'','display:none;')}" >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong> ROI (Pro-Forma) 预设投资回报率</strong></td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! HistoricalV00Contract.ROIProForma != null && HistoricalV00Contract.ROIProForma != 0 }">
                            <apex:param value="{! HistoricalV00Contract.ROIProForma }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.ROIProForma == null || HistoricalV00Contract.ROIProForma == 0 }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! HistoricalVFinalContract.ROIProForma != null && HistoricalVFinalContract.ROIProForma != 0 }">
                            <apex:param value="{! HistoricalVFinalContract.ROIProForma }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.ROIProForma == null || HistoricalVFinalContract.ROIProForma == 0 }"/>
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"  rendered="{! HistoricalContractCompared.ROIProForma != null && HistoricalContractCompared.ROIProForma != 0 }">
                            <apex:param value="{! HistoricalContractCompared.ROIProForma }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalContractCompared.ROIProForma == null || HistoricalContractCompared.ROIProForma == 0 }"/>
                    </strong>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong>
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! NewContractV0Estimate.ROIProForma != null && NewContractV0Estimate.ROIProForma != 0 }">
                        <apex:param value="{! NewContractV0Estimate.ROIProForma }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.ROIProForma == null || NewContractV0Estimate.ROIProForma == 0 }"/>
                </strong>
            </td>
            <apex:outputPanel layout="none" rendered="{!ExistHistoricalData}">
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! HistoricalVFinalContract.ROIProForma != 0 ||  NewContractV0Estimate.ROIProForma != 0 }">
                        <apex:param value="{! (NewContractV0Estimate.ROIProForma-HistoricalVFinalContract.ROIProForma) }" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! HistoricalVFinalContract.ROIProForma == 0 && NewContractV0Estimate.ROIProForma == 0 }"/>
                </td>
            </apex:outputPanel>

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong>
                    <apex:outputText value="{0,number,#,###,##0.00}" rendered="{! NewContactV0Contract.ROIProForma != null && NewContactV0Contract.ROIProForma != 0 }">
                        <apex:param value="{! NewContactV0Contract.ROIProForma }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContactV0Contract.ROIProForma == null || NewContactV0Contract.ROIProForma == 0 }"/>
                </strong>
            </td>
            <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>
        <!--</apex:outputPanel>-->
    </table>

    <div>
        <br/>
        <table width="100%" border="0" cellpadding="3" cellspacing="0">
            <thead>
            <tr>
                <td colspan="{!IF(ExistHistoricalData, 7, 4)}" bgcolor="#99CCFF" style="border:1px solid black;">Investment by category</td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                    <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                        Historical V0.0 <br/>
                        历史合同 V0.0
                    </td>
                </apex:outputPanel>

                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                    New Contract V0.0<br/>
                    新合同 V0.0
                </td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Category</td>
                <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">GS 营业额</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">A&amp;P  销售费用</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">GS% 营业额%</td>
                </apex:outputPanel>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">GS 营业额</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">A&amp;P  销售费用</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">GS% 营业额%</td>
            </tr>
            </thead>
            <apex:variable var="HistoricalGS" value="{! 0 }"/>
            <apex:variable var="ContractGS" value="{! 0 }"/>
            <apex:repeat value="{! categoriesDisplayMap}" var="item">
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="left">{! item}</td>
                    <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                        <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:variable var="HistoricalGS" value="{! HistoricalGS + HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] }"/>
                            <apex:outputText value="{0,number,#,###,##0}" rendered="{! HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] != 0 && HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] != null}">
                                <apex:param value="{! HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]]}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{! HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] == 0 || HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] == null }"/>
                        </td>
                        <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}" rendered="{! HistoricalAAndP_Map[categoriesDisplayMap[item]] != 0 }">
                                <apex:param value="{! HistoricalAAndP_Map[categoriesDisplayMap[item]]}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{! HistoricalAAndP_Map[categoriesDisplayMap[item]] == 0 }"/>
                        </td>
                        <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalAAndP_Map[categoriesDisplayMap[item]] != 0 && HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] != 0 && HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] != null}">
                                <apex:param value="{! HistoricalAAndP_Map[categoriesDisplayMap[item]] / HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] * 100}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{! HistoricalAAndP_Map[categoriesDisplayMap[item]] == 0 || HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] == 0 || HistoricalV00Contract.CategoryGSMap[categoriesDisplayMap[item]] == null}"/>
                        </td>
                    </apex:outputPanel>

                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:variable var="ContractGS" value="{! ContractGS + NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]] }"/>
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{! NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]] != 0 }">
                            <apex:param value="{! NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]]}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]] == 0 }"/>
                    </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{! ContractAAndP_Map[categoriesDisplayMap[item]] != 0 }">
                            <apex:param value="{! ContractAAndP_Map[categoriesDisplayMap[item]]}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! ContractAAndP_Map[categoriesDisplayMap[item]] == 0 }"/>
                    </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]] != 0 }">
                            <apex:param value="{! ContractAAndP_Map[categoriesDisplayMap[item]]/NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]] * 100}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! NewContractV0Estimate.CategoryGSMap[categoriesDisplayMap[item]] == 0 }"/>
                    </td>
                </tr>
            </apex:repeat>
            <!-- Total Gross Sales & A&P-->
            <tr>
                <td style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="right">Total</td>
                <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{! HistoricalGS > 0 }">
                            <apex:param value="{! HistoricalGS }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalGS == 0 }"/>
                    </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{! HistoricalV00Contract.TradeExpenses != null }">
                            <apex:param value="{! HistoricalV00Contract.TradeExpenses }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalV00Contract.TradeExpenses == null }"/>
                    </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! HistoricalGS > 0 && HistoricalV00Contract.TradeExpenses > 0}">
                            <apex:param value="{! HistoricalV00Contract.TradeExpenses / HistoricalGS * 100 }"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! HistoricalGS == 0 || HistoricalV00Contract.TradeExpenses == 0 }"/>
                    </td>
                </apex:outputPanel>

                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}" rendered="{! ContractGS > 0 }">
                        <apex:param value="{! ContractGS }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! ContractGS == 0 }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}" rendered="{! NewContractV0Estimate.TradeExpenses != null }">
                        <apex:param value="{! NewContractV0Estimate.TradeExpenses }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.TradeExpenses == null }"/>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! NewContractV0Estimate.TradeExpenses != null && ContractGS > 0 }">
                        <apex:param value="{! NewContractV0Estimate.TradeExpenses / ContractGS *100 }"/>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! NewContractV0Estimate.TradeExpenses == null || ContractGS == 0 }"/>
                </td>
            </tr>
        </table>

        <br/>

            <table width="100%" cellspacing="0" border="0" cellpadding="2" style="{! IF(ShowGroupShuttle && GroupContract != null && thisCC.ASI_CRM_CN_Group_Contract__c != null,'','display:none;')} border-collapse:collapse;">
                <thead>
                <tr>
                    <td colspan="2" bgcolor="#99CCFF" style="border:1px solid black;">
                        Accumulated P&amp;L Review
                    </td>
                </tr>
                </thead>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;"> Volumes 销量 (in 9L cs) </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,###}">
			      			<apex:param value="{! GroupContract.Volumes }" />
			            </apex:outputText>
			        </td>
			  	</tr>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;"> Trade expenses 销售费用 </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,##0.0}">
			      			<apex:param value="{! GroupContract.TradeExpenses }" />
			            </apex:outputText>
			        </td>
			  	</tr>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;"> Gross Sales 营业额 </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,##0.0}">
			      			<apex:param value="{! GroupContract.GrossSalesTotal }" />
			            </apex:outputText>
			      	</td>
			  	</tr>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;">% Gross Sales ％ 营业额 </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,##0.0}%" rendered="{! GroupContract.GrossSalesTotal != 0 && GroupContract.GrossSalesTotal != null }">
			      			<apex:param value="{! GroupContract.GrossSalesRate }" />
			            </apex:outputText>
			            <apex:outputText value=" - " rendered="{! GroupContract.GrossSalesTotal == 0 || GroupContract.GrossSalesTotal == null }"/>
			      	</td>
			  	</tr>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;">Cont. Margin after A&amp;P 销售净利润 </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,##0.0}">
			      			<apex:param value="{! GroupContract.MarginAfterAnP }" />
			            </apex:outputText>
			      	</td>
			  	</tr>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;"> Cont. Margin per Bottle 单瓶利润 </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,##0.0}" rendered="{! GroupContract.IntakeSTD != 0 && GroupContract.IntakeSTD != null }">
			      			<apex:param value="{! GroupContract.MarginPerBottle }" />
			            </apex:outputText>
			            <apex:outputText value=" - " rendered="{! GroupContract.IntakeSTD == 0 || GroupContract.IntakeSTD == null }"/>
			      	</td>
			  	</tr>
			  	<tr>
			      	<td width="25%" valign="top" bgcolor="#99CCFF" style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;"> ROI (Actual) 投资回报率 </td>
			      	<td width="75%" align="right" style="border-bottom:1px solid black;border-right:1px solid black;">
			      		<apex:outputText value="{0,number,#,###,##0.0}" rendered="{! GroupContract.TradeExpenses != 0 && GroupContract.TradeExpenses != null }">
			      			<apex:param value="{! GroupContract.ROIActual }" />
			            </apex:outputText>
			            <apex:outputText value=" - " rendered="{! GroupContract.TradeExpenses == 0 || GroupContract.TradeExpenses == null }"/>
			      	</td>
			  	</tr>
            </table>

        <br/>

        <table width="100%" border="0" cellpadding="3" cellspacing="0"  style="{! IF(ShowFixCostable,'','display:none;')}" >
            <thead>
            <tr>
                <td colspan="{!IF(ExistHistoricalData, 9, 8)}" bgcolor="#99CCFF" style="border:1px solid black;">Other Cost (in RMB) 其他成本（元）</td>
            </tr>
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical 历史</td>
                </apex:outputPanel>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
            </tr>
            </thead>
            <apex:variable value="{! 0}" var="TotalHistoricalFees"/>
            <apex:variable value="{! 0}" var="TotalEstimateFees"/>
            <apex:variable value="{! 0}" var="TotalContractFees"/>
            <apex:repeat value="{! FixExpense_Map}" var="itm">
                <apex:variable var="TotalHistoricalFees" value="{! TotalHistoricalFees+FixExpense_Map[itm].HistoricalFees }"/>
                <apex:variable var="TotalEstimateFees" value="{! TotalEstimateFees+FixExpense_Map[itm].EstimateFees }"/>
                <apex:variable var="TotalContractFees" value="{! TotalContractFees+FixExpense_Map[itm].ContractFees }"/>
                <tr>
                    <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; " valign="top">{! itm}</td>
                    <!-- Outlook sucks! -->
                    <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                        <td style="border-right: 1px solid black;" align="right" valign="top">
                            <apex:outputText value="{0,number,#,###,###}" rendered="{! FixExpense_Map[itm].HistoricalFees != 0 }">
                                <apex:param value="{! FixExpense_Map[itm].HistoricalFees}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{! FixExpense_Map[itm].HistoricalFees == 0 }"/>
                        </td>
                    </apex:outputPanel>
                    <td colspan="3" style="border-right: 1px solid black;" align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{! FixExpense_Map[itm].EstimateFees != 0 }">
                            <apex:param value="{! FixExpense_Map[itm].EstimateFees}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! FixExpense_Map[itm].EstimateFees == 0 }"/>
                    </td>
                    <td colspan="3" style="border-right: 1px solid black; " align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{! FixExpense_Map[itm].ContractFees != 0 }">
                            <apex:param value="{! FixExpense_Map[itm].ContractFees}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! FixExpense_Map[itm].ContractFees == 0 }"/>
                    </td>
                </tr>
            </apex:repeat>
            <tr>
                <td colspan="2" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Total Other Cost 其他成本总金额</td>
                <apex:outputPanel rendered="{!ExistHistoricalData}" layout="none">
                    <td style="border-bottom: 1px solid black; border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{! TotalHistoricalFees != 0 }">
                            <apex:param value="{! TotalHistoricalFees}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{! TotalHistoricalFees == 0 }"/>
                    </td>
                </apex:outputPanel>

                <td colspan="3" style="border-bottom: 1px solid black; border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! TotalEstimateFees != 0 }">
                        <apex:param value="{! TotalEstimateFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! TotalEstimateFees == 0 }"/>
                </td>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black; " align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{! TotalContractFees != 0 }">
                        <apex:param value="{! TotalContractFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{! TotalContractFees == 0 }"/>
                </td>
            </tr>
        </table>
    </div>

    <br/>

    <apex:variable value="v1" var="" rendered="{! ApprovalComment == 'new' }">
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
            <tr>
                <td valign="top" style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText value="a. Backgroud & Objective" />
                </td>
            </tr>
            <tr>
                <td valign="top" style="font-size: 12px;line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{! lstApprovalComment[0].ASI_CRM_Background_Objective__c}"
                                      rendered="{! lstApprovalComment[0].ASI_CRM_Background_Objective__c != null && lstApprovalComment[0].ASI_CRM_Background_Objective__c != '' }"/>
                    <apex:outputText value=" - " rendered="{! lstApprovalComment[0].ASI_CRM_Background_Objective__c == null || lstApprovalComment[0].ASI_CRM_Background_Objective__c == '' }"/>
                </td>
            </tr>
            <tr>
                <td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText value="b. New Contract Analysis" />
                </td>
            </tr>
            <tr>
                <td valign="top" style="font-size: 12px;line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{! lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c}"
                                      rendered="{! lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c != null  && lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c != '' }"/>
                    <apex:outputText value=" - " rendered="{! lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c == null || lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c == '' }"/>
                </td>
            </tr>
            <tr style="{!IF(ExistHistoricalData, '', 'display:none')}">
                <td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText value="c. Historical Contract Performance" />
                </td>
            </tr>
            <tr style="{!IF(ExistHistoricalData, '', 'display:none')}">
                <td valign="top" style="font-size: 12px;line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{! lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c}" rendered="{! lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c != null && lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c != '' }"/>
                    <apex:outputText value=" - " rendered="{! lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c == null || lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c == '' }"/>
                </td>
            </tr>
        </table>
    </apex:variable>
    <apex:variable value="v2" var="" rendered="{! ApprovalComment == 'po' }">
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
            <tr>
                <td valign="top" style="font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Finance Comments</td>
            </tr>
            <tr>
                <td valign="top" style="font-size: 12px;line-height: 15px; border: 1px solid #000000;border-bottom: 1px solid #000000;">
                    <apex:outputField value="{! lstApprovalComment[0].ASI_CRM_BA_comments__c}" rendered="{! lstApprovalComment[0].ASI_CRM_BA_comments__c != null }"/>
                    <apex:outputText value=" - " rendered="{! lstApprovalComment[0].ASI_CRM_BA_comments__c == null }"/>
                </td>
            </tr>
        </table>
    </apex:variable>
    </body>
</apex:component>