<!--
  @File Name          : ASI_CRM_CN_HeavyContractProfitShuttle2nd.component
  @Description        : 
  @Author             : pengchen@bluelinksys.com
  @Group              : 
  @Last Modified By   : pengchen@bluelinksys.com
  @Last Modified On   : 4/15/2020, 1:58:41 PM
  @Modification Log   : 
  Ver       Date            Author      		    Modification
  1.0    4/13/2020   pengchen@bluelinksys.com     Initial Version
-->
<apex:component controller="ASI_CRM_CN_HeavyProfitShuttleCtrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar"/>
    <apex:attribute name="Contractid" description="ID of Contract for PDF printout" type="id" assignto="{!PageId}"/>
    <apex:attribute name="PDF" description="Check AD identity" type="string" assignto="{!strPDF}"/>
    <apex:attribute name="EmailStr" type="String" description="Is for Email Body" assignTo="{!IsEmailStr}"/>

    <apex:stylesheet value="{!URLFOR($Resource.ASI_CRM_CN_PDF_Portrait_CSS)}"/>



    <body >
    


    <!-- <br/> -->
    <table width="100%" border="0" cellspacing="0" cellpadding="2">
        <tr style="vertical-align: bottom;">
            <td width="20%" style="white-space: pre;border-right: 1px solid black;border-left: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center" >PO No.:<strong><span style="font-size: 12.5px;">{!thisCC.ASI_CRM_CN_PO_No__c}</span></strong></td>
            <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;"  align="center">Start Date<br/>开始日期</td>
            <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">End Date<br/>结束日期</td>
            <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">No of Months<br/>月数</td>
            <td width="15%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Sales Rep<br/>销售</td>
            <td width="5%">&nbsp;</td>
            <td width="15%"></td>
            <td width="15%" ></td>
        </tr>
        <tr style="vertical-align: bottom;">
            <td style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Historical Contract vfinal 历史合同实际</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!previousCCStart}</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!previousCCEnd}</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}"><apex:param value="{!HistoricalVFinalContract2nd.NoOfMonths}" /></apex:outputText>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PreviousCCSalesRep}</td>
            <td>&nbsp;</td>
            <td ></td>
            <td ></td>
        </tr>
        <tr style="vertical-align: bottom;">
            <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT新合同</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCCStart}</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCCEnd}</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Owner.Name}</td>
            <td>&nbsp;</td>
            <td  align="center"></td>
            <td ></td>

        </tr>
    </table>
    <br/>



    <table width="100%" border="0" cellpadding="3" cellspacing="0">
        <tr>
            <apex:outputText value="{!MainTableHeader1}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{!MainTableHeader2}" rendered="{!!ExistHistoricalData}" escape="false"  />
        </tr>
        <tr>
            <td rowspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
            <apex:outputText value="{!ExistHistoricalData1}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{!ExistHistoricalData2}" rendered="{!!ExistHistoricalData}" escape="false"  />

            <!-- <td rowspan="2" style="border-bottom: 1px solid black;white-space: pre; " align="center">Budget/LE<br/>预算</td>
            <td rowspan="2" style="border-right: 1px solid black;border-bottom: 1px solid black;white-space: pre; " align="center">vs Est<br/>对比预估</td> -->
        </tr>
        <tr>
            <apex:outputText value="{!MainTableHeader3}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="v0.0<br/>预估</td>" rendered="{!ExistHistoricalData}" escape="false"  />

            <apex:outputText value="{!MainTableHeader3}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="vFinal<br/>完成</td>" rendered="{!ExistHistoricalData}" escape="false"  />


            <apex:outputText value="{!MainTableHeader3}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="% v0.0<br/>对比预估</td>" rendered="{!ExistHistoricalData}" escape="false"  />

            <td style="border-bottom: 1px solid black;white-space: pre;" align="center">Estimate 预估</td>
            <apex:outputText value="{!MainTableHeaderdotted}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="% vFinal<br/>对比历史完成" rendered="{!ExistHistoricalData}" escape="false"  />
            <td style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Contract<br/>合同</td>
        </tr>
        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Volumes 销量 (in 9L cs)</td>
            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.Volumes!=0&&HistoricalV00Contract2nd.Volumes!=null}" >
                        <apex:param value="{!HistoricalV00Contract2nd.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.Volumes==0||HistoricalV00Contract2nd.Volumes==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.Volumes!=0 && HistoricalVFinalContract2nd.Volumes!=null}" >
                        <apex:param value="{!HistoricalVFinalContract2nd.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.Volumes==0||HistoricalVFinalContract2nd.Volumes==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%"  rendered="{!HistoricalContractCompared2nd.Volumes!=0 && HistoricalContractCompared2nd.Volumes!=null }" >
                        <apex:param value="{!HistoricalContractCompared2nd.Volumes}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.Volumes==0 || HistoricalContractCompared2nd.Volumes==null}"/>
                </td>
            </apex:variable>
            

            <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.Volumes!=0 && NewContractV0Estimate2nd.Volumes!=null}"><apex:param value="{!NewContractV0Estimate2nd.Volumes}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.Volumes==0||NewContractV0Estimate2nd.Volumes==null}"/>
            </td>

            <apex:outputText value="{!ExistHisDataTD_dotted}" rendered="{!ExistHistoricalData}" escape="false"  />
            <apex:outputText value="{0,number,#,###,###}%" rendered="{!HVfinalComparedContract2nd.Volumes!=0 && ExistHistoricalData}">
                <apex:param value="{!HVfinalComparedContract2nd.Volumes}" /></apex:outputText>
            <apex:outputText value=" - " rendered="{!HVfinalComparedContract2nd.Volumes==0 && ExistHistoricalData}"/>
            <apex:outputText value="{!td_end}" rendered="{!ExistHistoricalData}" escape="false" />

            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.Volumes!=0 && NewContactV0Contract2nd.Volumes!=null}"><apex:param value="{!NewContactV0Contract2nd.Volumes}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.Volumes==0 || NewContactV0Contract2nd.Volumes==null}"/>
            </td>

            <!-- <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!thisCC.ASI_CRM_CN_Vol_Budget_LE__c!=0 && thisCC.ASI_CRM_CN_Vol_Budget_LE__c!=null}">
                    <apex:param value="{!thisCC.ASI_CRM_CN_Vol_Budget_LE__c}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Vol_Budget_LE__c==0 || thisCC.ASI_CRM_CN_Vol_Budget_LE__c==null}"/>
            </td>
            <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}" rendered="{!thisCC.ASI_CRM_CN_Vol_Budget_LE__c!=null && NewContractV0Estimate2nd.Volumes!=null }">
                    <apex:param value="{!(thisCC.ASI_CRM_CN_Vol_Budget_LE__c-NewContractV0Estimate2nd.Volumes) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Vol_Budget_LE__c==null||NewContractV0Estimate2nd.Volumes==null}"/>

            </td> -->
        </tr>
        <apex:repeat value="{!nameList}" var="sbgroup">
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">{!sbgroup.CEnName}</td>

                <apex:outputText value="{!ExistHisDataTD_noBottom}" rendered="{!ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.CategoryMap[sbgroup.Cname]!=0 && ExistHistoricalData}" >
                    <apex:param value="{!HistoricalV00Contract2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.CategoryMap[sbgroup.Cname]==0 && ExistHistoricalData}"/>
                <apex:outputText value="{!td_end}" rendered="{!ExistHistoricalData}" escape="false" />


                <apex:outputText value="{!ExistHisDataTD_noBottom}" rendered="{!ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]!=0 && ExistHistoricalData}" >
                    <apex:param value="{!HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]==0 && ExistHistoricalData}"/>
                <apex:outputText value="{!td_end}" rendered="{!ExistHistoricalData}" escape="false" />


                <apex:outputText value="{!ExistHisDataTD_noBottom}" rendered="{!ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}%"  rendered="{!HistoricalContractCompared2nd.CategoryMap[sbgroup.Cname]!=0 && ExistHistoricalData}">
                    <apex:param value="{!HistoricalContractCompared2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!(HistoricalContractCompared2nd.CategoryMap[sbgroup.Cname]==0||HistoricalContractCompared2nd.CategoryMap[sbgroup.Cname]==null)&& ExistHistoricalData}"/>
                <apex:outputText value="{!td_end}" rendered="{!ExistHistoricalData}" escape="false" />



                <td align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!NewContractV0Estimate2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.CategoryMap[sbgroup.Cname]==0||NewContractV0Estimate2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>

                <apex:outputText value="{!ExistHisDataTD_dottednoBottom}" rendered="{!ExistHistoricalData}" escape="false"  />
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Estimate2nd.CategoryMap[sbgroup.Cname]!=null && HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]!=0&&HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]!=null && ExistHistoricalData}">
                    <apex:param value="{!((NewContractV0Estimate2nd.CategoryMap[sbgroup.Cname]-HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname])/HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname])*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!(HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]==0||HistoricalVFinalContract2nd.CategoryMap[sbgroup.Cname]==null) && ExistHistoricalData}"/>
                <apex:outputText value="{!td_end}" rendered="{!ExistHistoricalData}" escape="false" />

                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]!=0}"><apex:param value="{!NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]==0||NewContactV0Contract2nd.CategoryMap[sbgroup.Cname]==null}"/>

                </td>
                <!-- <td>&nbsp;</td>
                <td style="border-right: 1px solid black;">&nbsp;</td> -->
            </tr>
        </apex:repeat>
        <apex:variable rendered="false" value="" var="">
            <tr style="{!IF(contains(groupStr,'C'),'','display:none;')}">
                <td style="border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Gross Sales 营业额</td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-top: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.GrossSalesTotal!=null}"><apex:param value="{!HistoricalV00Contract2nd.GrossSalesTotal}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.GrossSalesTotal==null}"/>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-top: 1px solid black;border-top: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal!=null}"><apex:param value="{!HistoricalVFinalContract2nd.GrossSalesTotal}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal==null}"/>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-top: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.GrossSalesTotal!=null}">
                            <apex:param value="{!HistoricalContractCompared2nd.GrossSalesTotal}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.GrossSalesTotal==null}"/>
                    </td>
                </apex:variable>
                

                <td align="right" style="border-top: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.GrossSalesTotal!=null}"><apex:param value="{!NewContractV0Estimate2nd.GrossSalesTotal}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesTotal==null}"/>
                </td>
                

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                   <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;border-top: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal!=null && HistoricalVFinalContract2nd.GrossSalesTotal!=0 && HistoricalVFinalContract2nd.GrossSalesTotal!=null}">
                            <apex:param value="{!((NewContractV0Estimate2nd.GrossSalesTotal-HistoricalVFinalContract2nd.GrossSalesTotal)/HistoricalVFinalContract2nd.GrossSalesTotal)*100 }" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal==0||HistoricalVFinalContract2nd.GrossSalesTotal==null}"/>
                    </td>
                </apex:variable>
                

                <td style="border-right: 1px solid black;border-top: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.GrossSalesTotal!=null}"><apex:param value="{!NewContactV0Contract2nd.GrossSalesTotal}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesTotal==null}"/>
                </td>
                <!-- <td align="right">&nbsp;</td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
            </tr>
        </apex:variable>

        <!-- <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">CM before spending利润</td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.CMTotal!=null}"><apex:param value="{!HistoricalV00Contract2nd.CMTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.CMTotal==null}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.CMTotal!=null}"><apex:param value="{!HistoricalVFinalContract2nd.CMTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CMTotal==null}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.CMTotal!=null}">
                    <apex:param value="{!HistoricalContractCompared2nd.CMTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.CMTotal==null}"/>
            </td>

            <td align="right" style="border-bottom: 1px solid black;">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.CMTotal!=null}"><apex:param value="{!NewContractV0Estimate2nd.CMTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.CMTotal==null}"/>
            </td>

            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.CMTotal!=null && HistoricalVFinalContract2nd.CMTotal!=0 && HistoricalVFinalContract2nd.CMTotal!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.CMTotal-HistoricalVFinalContract2nd.CMTotal)/HistoricalVFinalContract2nd.CMTotal)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CMTotal==0||HistoricalVFinalContract2nd.CMTotal==null}"/>
            </td>

            <td style="border-right: 1px solid black;border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.CMTotal!=null}"><apex:param value="{!NewContactV0Contract2nd.CMTotal}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CMTotal==null}"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->
        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Trade expenses 销售费用</strong></td>
            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalV00Contract2nd.TradeExpenses!=null}"><apex:param value="{!HistoricalV00Contract2nd.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.TradeExpenses==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalVFinalContract2nd.TradeExpenses!=null}"><apex:param value="{!HistoricalVFinalContract2nd.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.TradeExpenses==null}"/></strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right"  bgcolor="#E3DFDA" >
                    <apex:outputText value="{0,number,#,###,###}%"  rendered="{!HistoricalContractCompared2nd.TradeExpenses!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.TradeExpenses}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.TradeExpenses==0||HistoricalContractCompared2nd.TradeExpenses==null}"/>
                </td>
            </apex:variable>
            




            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0Estimate2nd.TradeExpenses!=null}"><apex:param value="{!NewContractV0Estimate2nd.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.TradeExpenses==null}"/></strong>
            </td>

            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.TradeExpenses!=null && HistoricalVFinalContract2nd.TradeExpenses!=0 && HistoricalVFinalContract2nd.TradeExpenses!=null}">
                        <apex:param value="{!((NewContractV0Estimate2nd.TradeExpenses-HistoricalVFinalContract2nd.TradeExpenses)/HistoricalVFinalContract2nd.TradeExpenses)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.TradeExpenses==0||HistoricalVFinalContract2nd.TradeExpenses==null}"/>
                </td>
            </apex:variable>
            


            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract2nd.TradeExpenses!=null}"><apex:param value="{!NewContactV0Contract2nd.TradeExpenses}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.TradeExpenses==null}"/></strong></td>
            <!-- <td bgcolor="#E3DFDA" align="right">
                <apex:outputText value="{0,number,#,###,###}" rendered="{!thisCC.ASI_CRM_CN_Budget_LE__c!=0 && thisCC.ASI_CRM_CN_Budget_LE__c!=null}">
                    <apex:param value="{!thisCC.ASI_CRM_CN_Budget_LE__c}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Budget_LE__c==0 || thisCC.ASI_CRM_CN_Budget_LE__c==null}"/>
            </td>
            <td style="border-right: 1px solid black;" bgcolor="#E3DFDA" align="right">
                <apex:outputText value="{0,number,#,###,##0}" rendered="{!thisCC.ASI_CRM_CN_Budget_LE__c!=null && NewContractV0Estimate2nd.TradeExpenses!=null }">
                    <apex:param value="{!(thisCC.ASI_CRM_CN_Budget_LE__c-NewContractV0Estimate2nd.TradeExpenses) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!thisCC.ASI_CRM_CN_Budget_LE__c==null||NewContractV0Estimate2nd.TradeExpenses==null}"/>

            </td> -->
        </tr>

        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>

            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalV00Contract2nd.VariableExpense!=null}"><apex:param value="{!HistoricalV00Contract2nd.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.VariableExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalVFinalContract2nd.VariableExpense!=null}"><apex:param value="{!HistoricalVFinalContract2nd.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VariableExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.VariableExpense!=null}">
                        <apex:param value="{!HistoricalContractCompared2nd.VariableExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.VariableExpense==null}"/>
                </td>
            </apex:variable>
            
            

            <td align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0Estimate2nd.VariableExpense!=null}"><apex:param value="{!NewContractV0Estimate2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.VariableExpense==null}"/>
            </td>
            

            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.VariableExpense!=null && HistoricalVFinalContract2nd.VariableExpense!=0 && HistoricalVFinalContract2nd.VariableExpense!=null}">
                        <apex:param value="{!((NewContractV0Estimate2nd.VariableExpense-HistoricalVFinalContract2nd.VariableExpense)/HistoricalVFinalContract2nd.VariableExpense)*100 }" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VariableExpense==0||HistoricalVFinalContract2nd.VariableExpense==null}"/>
                </td>
            </apex:variable>
            

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract2nd.VariableExpense!=null}"><apex:param value="{!NewContactV0Contract2nd.VariableExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==null}"/>
            </td>
            <!-- <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
        </tr>

        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>

            
            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalV00Contract2nd.FixedExpense!=null}"><apex:param value="{!HistoricalV00Contract2nd.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.FixedExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!HistoricalVFinalContract2nd.FixedExpense!=null}"><apex:param value="{!HistoricalVFinalContract2nd.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.FixedExpense==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.FixedExpense!=null}">
                        <apex:param value="{!HistoricalContractCompared2nd.FixedExpense}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.FixedExpense==null}"/>
                </td>
            </apex:variable>
            

            <td align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContractV0Estimate2nd.FixedExpense!=null}"><apex:param value="{!NewContractV0Estimate2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.FixedExpense==null}"/>
            </td>

            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.FixedExpense!=null && HistoricalVFinalContract2nd.FixedExpense!=0 && NewContractV0Estimate2nd.FixedExpense!=0 && HistoricalVFinalContract2nd.FixedExpense!=null}">
                        <apex:param value="{!((NewContractV0Estimate2nd.FixedExpense-HistoricalVFinalContract2nd.FixedExpense)/HistoricalVFinalContract2nd.FixedExpense)*100 }" /></apex:outputText>
                    <apex:outputText value=" 0% " rendered="{!HistoricalVFinalContract2nd.FixedExpense==0||HistoricalVFinalContract2nd.FixedExpense==null || NewContractV0Estimate2nd.FixedExpense==0}"/>
                </td>
            </apex:variable>
            
            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactV0Contract2nd.FixedExpense!=null}"><apex:param value="{!NewContactV0Contract2nd.FixedExpense}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpense==null}"/></td>
            <!-- <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
        </tr>

        <tr>
            <td style=" border-left: 1px solid black; border-right: 1px solid black;">Fixed expense % 固定费用比例 % </td>

            
            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract2nd.FixedExpenseRate!=null}"><apex:param value="{!HistoricalV00Contract2nd.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.FixedExpenseRate==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate!=null}"><apex:param value="{!HistoricalVFinalContract2nd.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate==null}"/>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.FixedExpenseRate!=null && HistoricalContractCompared2nd.FixedExpenseRate!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.FixedExpenseRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.FixedExpenseRate==null || HistoricalContractCompared2nd.FixedExpenseRate==0}"/>
                </td>
            </apex:variable>
            

            <td style="" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.FixedExpenseRate!=null}"><apex:param value="{!NewContractV0Estimate2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.FixedExpenseRate==null}"/>
            </td>

            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
               <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.FixedExpenseRate!=null && HistoricalVFinalContract2nd.FixedExpenseRate!=0 && NewContractV0Estimate2nd.FixedExpenseRate!=0}">
                        <apex:param value="{!(NewContractV0Estimate2nd.FixedExpenseRate-HistoricalVFinalContract2nd.FixedExpenseRate) }" /></apex:outputText>
                    <apex:outputText value=" 0% " rendered="{!NewContractV0Estimate2nd.FixedExpenseRate==null||HistoricalVFinalContract2nd.FixedExpenseRate==null || NewContractV0Estimate2nd.FixedExpenseRate==0 || HistoricalVFinalContract2nd.FixedExpenseRate==0 }"/>
                </td>
            </apex:variable>
            

            <td style=" border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=null}"><apex:param value="{!NewContactV0Contract2nd.FixedExpenseRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpenseRate==null}"/></td>
            <!-- <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
        </tr>

       <!--  <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract2nd.GrossSalesRate!=null&& HistoricalV00Contract2nd.GrossSalesRate!=0}">
                    <apex:param value="{!HistoricalV00Contract2nd.GrossSalesRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.GrossSalesRate==null || HistoricalV00Contract2nd.GrossSalesRate==0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.GrossSalesRate!=null && HistoricalVFinalContract2nd.GrossSalesRate!=0}">
                    <apex:param value="{!HistoricalVFinalContract2nd.GrossSalesRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.GrossSalesRate==null || HistoricalVFinalContract2nd.GrossSalesRate==0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.GrossSalesRate!=null && HistoricalContractCompared2nd.GrossSalesRate!=0}">
                    <apex:param value="{!HistoricalContractCompared2nd.GrossSalesRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.GrossSalesRate==null || HistoricalContractCompared2nd.GrossSalesRate==0}"/>
            </td>


            <td align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.GrossSalesRate!=null&& NewContractV0Estimate2nd.GrossSalesRate!=0}">
                    <apex:param value="{!NewContractV0Estimate2nd.GrossSalesRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesRate==null || NewContractV0Estimate2nd.GrossSalesRate==0}"/>
            </td>

            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.GrossSalesRate!=null && HistoricalVFinalContract2nd.GrossSalesRate!=0 }">
                    <apex:param value="{!(NewContractV0Estimate2nd.GrossSalesRate-HistoricalVFinalContract2nd.GrossSalesRate) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesRate==null||HistoricalVFinalContract2nd.GrossSalesRate==null ||  HistoricalVFinalContract2nd.GrossSalesRate==0}"/>

            </td>

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.GrossSalesRate!=null && NewContactV0Contract2nd.GrossSalesRate!=0}">
                    <apex:param value="{!NewContactV0Contract2nd.GrossSalesRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRate==null || NewContactV0Contract2nd.GrossSalesRate==0}"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->
        <apex:variable rendered="{!(contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'A'))}" value="" var="">
            <tr style="{!IF(contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'A'),'','display:none;')}">
                <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                   <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract2nd.GrossSalesRateProForma!=null&& HistoricalV00Contract2nd.GrossSalesRateProForma!=0}">
                            <apex:param value="{!HistoricalV00Contract2nd.GrossSalesRateProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.GrossSalesRateProForma==null || HistoricalV00Contract2nd.GrossSalesRateProForma==0}"/>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0}">
                            <apex:param value="{!HistoricalVFinalContract2nd.GrossSalesRateProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==null || HistoricalVFinalContract2nd.GrossSalesRateProForma==0}"/>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.GrossSalesRateProForma!=null && HistoricalContractCompared2nd.GrossSalesRateProForma!=0}">
                            <apex:param value="{!HistoricalContractCompared2nd.GrossSalesRateProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.GrossSalesRateProForma==null || HistoricalContractCompared2nd.GrossSalesRateProForma==0}"/>
                    </td>
                </apex:variable>
                


                <td align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.GrossSalesRateProForma!=null&& NewContractV0Estimate2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContractV0Estimate2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesRateProForma==null || NewContractV0Estimate2nd.GrossSalesRateProForma==0}"/>
                </td>
                

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                   <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0 }">
                            <apex:param value="{!(NewContractV0Estimate2nd.GrossSalesRateProForma-HistoricalVFinalContract2nd.GrossSalesRateProForma) }" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesRateProForma==null||HistoricalVFinalContract2nd.GrossSalesRateProForma==null ||  HistoricalVFinalContract2nd.GrossSalesRateProForma==0}"/>

                    </td>
                </apex:variable>
                

                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=null && NewContactV0Contract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.GrossSalesRateProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma==null || NewContactV0Contract2nd.GrossSalesRateProForma==0}"/>
                </td>
                <!-- <td align="right">&nbsp;</td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
            </tr>
        </apex:variable>
        
<!-- 
        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales ％ 营业额 <br/> (excl Premium brands/剔除高档品牌)**</td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract2nd.GrossSalesRateExcl!=null&& HistoricalV00Contract2nd.GrossSalesRateExcl!=0}">
                    <apex:param value="{!HistoricalV00Contract2nd.GrossSalesRateExcl}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.GrossSalesRateExcl==null || HistoricalV00Contract2nd.GrossSalesRateExcl==0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.GrossSalesRateExcl!=null && HistoricalVFinalContract2nd.GrossSalesRateExcl!=0}">
                    <apex:param value="{!HistoricalVFinalContract2nd.GrossSalesRateExcl}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.GrossSalesRateExcl==null || HistoricalVFinalContract2nd.GrossSalesRateExcl==0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.GrossSalesRateExcl!=null && HistoricalContractCompared2nd.GrossSalesRateExcl!=0}">
                    <apex:param value="{!HistoricalContractCompared2nd.GrossSalesRateExcl}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.GrossSalesRateExcl==null || HistoricalContractCompared2nd.GrossSalesRateExcl==0}"/>
            </td>


            <td align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.GrossSalesRateExcl!=null&& NewContractV0Estimate2nd.GrossSalesRateExcl!=0}">
                    <apex:param value="{!NewContractV0Estimate2nd.GrossSalesRateExcl}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesRateExcl==null || NewContractV0Estimate2nd.GrossSalesRateExcl==0}"/>
            </td>

            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.GrossSalesRateExcl!=null && HistoricalVFinalContract2nd.GrossSalesRateExcl!=0 }">
                    <apex:param value="{!(NewContractV0Estimate2nd.GrossSalesRateExcl-HistoricalVFinalContract2nd.GrossSalesRateExcl) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.GrossSalesRateExcl==null||HistoricalVFinalContract2nd.GrossSalesRateExcl==null ||  HistoricalVFinalContract2nd.GrossSalesRateExcl==0}"/>

            </td>

            <td style="border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.GrossSalesRateExcl!=null && NewContactV0Contract2nd.GrossSalesRateExcl!=0}">
                    <apex:param value="{!NewContactV0Contract2nd.GrossSalesRateExcl}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRateExcl==null || NewContactV0Contract2nd.GrossSalesRateExcl==0}"/>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->

        <!-- <tr style="{!IF(contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin after A &amp;P 销售净利润</strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.MarginAfterAnP!=null&& HistoricalV00Contract2nd.MarginAfterAnP!=0}"><apex:param value="{!HistoricalV00Contract2nd.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.MarginAfterAnP==0||HistoricalV00Contract2nd.MarginAfterAnP==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP!=null && HistoricalVFinalContract2nd.MarginAfterAnP!=0}"><apex:param value="{!HistoricalVFinalContract2nd.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP==0 || HistoricalVFinalContract2nd.MarginAfterAnP==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.MarginAfterAnP!=null && HistoricalContractCompared2nd.MarginAfterAnP!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.MarginAfterAnP==0 || HistoricalContractCompared2nd.MarginAfterAnP==null}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.MarginAfterAnP!=null && NewContractV0Estimate2nd.MarginAfterAnP!=0}"><apex:param value="{!NewContractV0Estimate2nd.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.MarginAfterAnP==0|| NewContractV0Estimate2nd.MarginAfterAnP==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black;border-top: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP!=null && HistoricalVFinalContract2nd.MarginAfterAnP!=0 && HistoricalVFinalContract2nd.MarginAfterAnP!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.MarginAfterAnP-HistoricalVFinalContract2nd.MarginAfterAnP)/HistoricalVFinalContract2nd.MarginAfterAnP)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP==0||HistoricalVFinalContract2nd.MarginAfterAnP==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.MarginAfterAnP!=null && NewContactV0Contract2nd.MarginAfterAnP!=0}"><apex:param value="{!NewContactV0Contract2nd.MarginAfterAnP}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginAfterAnP==0 || NewContactV0Contract2nd.MarginAfterAnP==null}"/></strong>
            </td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->



        <!-- <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per CR12 Extra eq btl  折CR12新境单瓶投入</td>

            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract2nd.InvestmentCR12!=null && HistoricalV00Contract2nd.InvestmentCR12!=0}">
                    <apex:param value="{!HistoricalV00Contract2nd.InvestmentCR12}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.InvestmentCR12==null || HistoricalV00Contract2nd.InvestmentCR12==0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.InvestmentCR12!=null && HistoricalVFinalContract2nd.InvestmentCR12!=0}">
                    <apex:param value="{!HistoricalVFinalContract2nd.InvestmentCR12}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.InvestmentCR12==null || HistoricalVFinalContract2nd.InvestmentCR12==0}"/>
            </td>

            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.InvestmentCR12!=null && HistoricalContractCompared2nd.InvestmentCR12!=0}">
                    <apex:param value="{!HistoricalContractCompared2nd.InvestmentCR12}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.InvestmentCR12==null || HistoricalContractCompared2nd.InvestmentCR12==0}"/>
            </td>



            <td align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.InvestmentCR12!=null && NewContractV0Estimate2nd.InvestmentCR12!=0}">
                    <apex:param value="{!NewContractV0Estimate2nd.InvestmentCR12}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.InvestmentCR12==null || NewContractV0Estimate2nd.InvestmentCR12==0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right" valign="top">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.InvestmentCR12!=null && HistoricalVFinalContract2nd.InvestmentCR12!=0 && HistoricalVFinalContract2nd.InvestmentCR12!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.InvestmentCR12-HistoricalVFinalContract2nd.InvestmentCR12)/HistoricalVFinalContract2nd.InvestmentCR12)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.InvestmentCR12==0||HistoricalVFinalContract2nd.InvestmentCR12==null}"/>
            </td>

            <td style="border-right: 1px solid black;" align="right" valign="top">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract2nd.InvestmentCR12!=null && NewContactV0Contract2nd.InvestmentCR12!=0}">
                    <apex:param value="{!NewContactV0Contract2nd.InvestmentCR12}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.InvestmentCR12==null || NewContactV0Contract2nd.InvestmentCR12==0}"/>
            </td>
            <td align="right" valign="top">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right" valign="top">&nbsp;</td>
        </tr> -->

        



        


        


        <apex:variable rendered="{!(contains(groupStr,'C') || contains(groupStr,'D'))}" value="" var="">
            <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
                    <td style="border-left: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" bgcolor="#FFFF99"><strong>Cont. Margin per Case 单箱净利润</strong></td>

                    <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                       <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.MarginPerCase!=null && HistoricalV00Contract2nd.MarginPerCase!=0}"><apex:param value="{!HistoricalV00Contract2nd.MarginPerCase}"/></apex:outputText>
                                <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.MarginPerCase==0 || HistoricalV00Contract2nd.MarginPerCase==null}"/></strong>
                        </td>
                        <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                                <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.MarginPerCase!=null && HistoricalVFinalContract2nd.MarginPerCase!=0}"><apex:param value="{!HistoricalVFinalContract2nd.MarginPerCase}"/></apex:outputText>
                                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.MarginPerCase==0 || HistoricalVFinalContract2nd.MarginPerCase==null}"/></strong>
                        </td>
                        <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.MarginPerCase!=null && HistoricalContractCompared2nd.MarginPerCase!=0}">
                                    <apex:param value="{!HistoricalContractCompared2nd.MarginPerCase}"/></apex:outputText>
                                <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.MarginPerCase==0 || HistoricalContractCompared2nd.MarginPerCase==null}"/></strong>
                        </td>
                    </apex:variable>
                    


                    <td style="border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.MarginPerCase!=null && NewContractV0Estimate2nd.MarginPerCase!=0}"><apex:param value="{!NewContractV0Estimate2nd.MarginPerCase}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.MarginPerCase==0 || NewContractV0Estimate2nd.MarginPerCase==null}"/></strong>
                    </td>

                    <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                       <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.MarginPerCase!=null && HistoricalVFinalContract2nd.MarginPerCase!=0 && HistoricalVFinalContract2nd.MarginPerCase!=null}">
                                <apex:param value="{!((NewContractV0Estimate2nd.MarginPerCase-HistoricalVFinalContract2nd.MarginPerCase)/HistoricalVFinalContract2nd.MarginPerCase)*100 }" /></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.MarginPerCase==0||HistoricalVFinalContract2nd.MarginPerCase==null}"/>
                        </td>
                    </apex:variable>
                    
                    <td style="border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.MarginPerCase!=null && NewContactV0Contract2nd.MarginPerCase!=0}"><apex:param value="{!NewContactV0Contract2nd.MarginPerCase}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginPerCase==0 || NewContactV0Contract2nd.MarginPerCase==null}"/></strong></td>
                    <!-- <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
                </tr>
            </apex:variable>



        <!-- <tr style="{!IF(contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" bgcolor="#FFFF99"><strong>CM/NS% 净销售利润率 </strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract2nd.CMNSRate!=null && HistoricalV00Contract2nd.CMNSRate!=0}"><apex:param value="{!HistoricalV00Contract2nd.CMNSRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.CMNSRate==0 || HistoricalV00Contract2nd.CMNSRate==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.CMNSRate!=null && HistoricalVFinalContract2nd.CMNSRate!=0}"><apex:param value="{!HistoricalVFinalContract2nd.CMNSRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CMNSRate==0 || HistoricalVFinalContract2nd.CMNSRate==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.CMNSRate!=null && HistoricalContractCompared2nd.CMNSRate!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.CMNSRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.CMNSRate==0 || HistoricalContractCompared2nd.CMNSRate==null}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.CMNSRate!=null && NewContractV0Estimate2nd.CMNSRate!=0}"><apex:param value="{!NewContractV0Estimate2nd.CMNSRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.CMNSRate==0 || NewContractV0Estimate2nd.CMNSRate==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.CMNSRate!=null && HistoricalVFinalContract2nd.CMNSRate!=0 && HistoricalVFinalContract2nd.CMNSRate!=null}">
                    <apex:param value="{!NewContractV0Estimate2nd.CMNSRate-HistoricalVFinalContract2nd.CMNSRate}" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CMNSRate==0||HistoricalVFinalContract2nd.CMNSRate==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.CMNSRate!=null && NewContactV0Contract2nd.CMNSRate!=0}"><apex:param value="{!NewContactV0Contract2nd.CMNSRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CMNSRate==0 || NewContactV0Contract2nd.CMNSRate==null}"/></strong></td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->
        <apex:variable rendered="{!(contains(groupStr,'C') || contains(groupStr,'D'))}" value="" var="">
            <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" bgcolor="#FFFF99"><strong>CM/NS% 净销售利润率</strong></td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalV00Contract2nd.CMNSRateProForma!=null && HistoricalV00Contract2nd.CMNSRateProForma!=0}"><apex:param value="{!HistoricalV00Contract2nd.CMNSRateProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.CMNSRateProForma==0 || HistoricalV00Contract2nd.CMNSRateProForma==null}"/></strong>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma!=null && HistoricalVFinalContract2nd.CMNSRateProForma!=0}"><apex:param value="{!HistoricalVFinalContract2nd.CMNSRateProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma==0 || HistoricalVFinalContract2nd.CMNSRateProForma==null}"/></strong>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalContractCompared2nd.CMNSRateProForma!=null && HistoricalContractCompared2nd.CMNSRateProForma!=0}">
                                <apex:param value="{!HistoricalContractCompared2nd.CMNSRateProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.CMNSRateProForma==0 || HistoricalContractCompared2nd.CMNSRateProForma==null}"/></strong>
                    </td>
                </apex:variable>
                


                <td style="border-bottom: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Estimate2nd.CMNSRateProForma!=null && NewContractV0Estimate2nd.CMNSRateProForma!=0}"><apex:param value="{!NewContractV0Estimate2nd.CMNSRateProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.CMNSRateProForma==0 || NewContractV0Estimate2nd.CMNSRateProForma==null}"/></strong>
                </td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;border-top: 1px solid black;" align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma!=null && HistoricalVFinalContract2nd.CMNSRateProForma!=0 && HistoricalVFinalContract2nd.CMNSRateProForma!=null}">
                            <apex:param value="{!NewContractV0Estimate2nd.CMNSRateProForma-HistoricalVFinalContract2nd.CMNSRateProForma}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma==0||HistoricalVFinalContract2nd.CMNSRateProForma==null}"/>
                    </td>
                </apex:variable>
                
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;border-top: 1px solid black;" align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.CMNSRateProForma!=null && NewContactV0Contract2nd.CMNSRateProForma!=0}"><apex:param value="{!NewContactV0Contract2nd.CMNSRateProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CMNSRateProForma==0 || NewContactV0Contract2nd.CMNSRateProForma==null}"/></strong></td>
                <!-- <td align="right">&nbsp;</td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
            </tr>
        </apex:variable>


        <!-- <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Contract Index - Domestic </strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.DomesticContractIndex!=null && HistoricalV00Contract2nd.DomesticContractIndex!=0}"><apex:param value="{!HistoricalV00Contract2nd.DomesticContractIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.DomesticContractIndex==0 || HistoricalV00Contract2nd.DomesticContractIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex!=null && HistoricalVFinalContract2nd.DomesticContractIndex!=0}"><apex:param value="{!HistoricalVFinalContract2nd.DomesticContractIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex==0 || HistoricalVFinalContract2nd.DomesticContractIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.DomesticContractIndex!=null && HistoricalContractCompared2nd.DomesticContractIndex!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.DomesticContractIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.DomesticContractIndex==0 || HistoricalContractCompared2nd.DomesticContractIndex==null}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.DomesticContractIndex!=null && NewContractV0Estimate2nd.DomesticContractIndex!=0}"><apex:param value="{!NewContractV0Estimate2nd.DomesticContractIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.DomesticContractIndex==0 || NewContractV0Estimate2nd.DomesticContractIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex!=null && HistoricalVFinalContract2nd.DomesticContractIndex!=0 && HistoricalVFinalContract2nd.DomesticContractIndex!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.DomesticContractIndex-HistoricalVFinalContract2nd.DomesticContractIndex)/HistoricalVFinalContract2nd.DomesticContractIndex)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex==0||HistoricalVFinalContract2nd.DomesticContractIndex==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.DomesticContractIndex!=null && NewContactV0Contract2nd.DomesticContractIndex!=0}"><apex:param value="{!NewContactV0Contract2nd.DomesticContractIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.DomesticContractIndex==0 || NewContactV0Contract2nd.DomesticContractIndex==null}"/></strong></td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->
        
        <!-- <apex:variable rendered="{!(contains(groupStr,'C') || contains(groupStr,'D'))}" value="" var=""> -->
            <tr style="">
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Contract index</strong></td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.DomesticContractIndexProForma!=null && HistoricalV00Contract2nd.DomesticContractIndexProForma!=0}"><apex:param value="{!HistoricalV00Contract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.DomesticContractIndexProForma==0 || HistoricalV00Contract2nd.DomesticContractIndexProForma==null}"/></strong>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma!=null && HistoricalVFinalContract2nd.DomesticContractIndexProForma!=0}"><apex:param value="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma==0 || HistoricalVFinalContract2nd.DomesticContractIndexProForma==null}"/></strong>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.DomesticContractIndexProForma!=null && HistoricalContractCompared2nd.DomesticContractIndexProForma!=0}">
                                <apex:param value="{!HistoricalContractCompared2nd.DomesticContractIndexProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.DomesticContractIndexProForma==0 || HistoricalContractCompared2nd.DomesticContractIndexProForma==null}"/></strong>
                    </td>
                </apex:variable>
                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.DomesticContractIndexProForma!=null && NewContractV0Estimate2nd.DomesticContractIndexProForma!=0}"><apex:param value="{!NewContractV0Estimate2nd.DomesticContractIndexProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.DomesticContractIndexProForma==0 || NewContractV0Estimate2nd.DomesticContractIndexProForma==null}"/></strong>
                </td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma!=null && HistoricalVFinalContract2nd.DomesticContractIndexProForma!=0 && HistoricalVFinalContract2nd.DomesticContractIndexProForma!=null}">
                            <apex:param value="{!((NewContractV0Estimate2nd.DomesticContractIndexProForma-HistoricalVFinalContract2nd.DomesticContractIndexProForma)/HistoricalVFinalContract2nd.DomesticContractIndexProForma)*100 }" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma==0||HistoricalVFinalContract2nd.DomesticContractIndexProForma==null}"/>
                    </td>
                </apex:variable>
                
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma!=null && NewContactV0Contract2nd.DomesticContractIndexProForma!=0}"><apex:param value="{!NewContactV0Contract2nd.DomesticContractIndexProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma==0 || NewContactV0Contract2nd.DomesticContractIndexProForma==null}"/></strong></td>
                    <!-- <td align="right">&nbsp;</td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
            </tr>
        <!-- </apex:variable> -->

        <!-- <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>vs. Regional Average Index </strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.VsRegionalAverageIndex!=null && HistoricalV00Contract2nd.VsRegionalAverageIndex!=0}"><apex:param value="{!HistoricalV00Contract2nd.VsRegionalAverageIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.VsRegionalAverageIndex==0 || HistoricalV00Contract2nd.VsRegionalAverageIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndex!=null && HistoricalVFinalContract2nd.VsRegionalAverageIndex!=0}"><apex:param value="{!HistoricalVFinalContract2nd.VsRegionalAverageIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndex==0 || HistoricalVFinalContract2nd.VsRegionalAverageIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.VsRegionalAverageIndex!=null && HistoricalContractCompared2nd.VsRegionalAverageIndex!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.VsRegionalAverageIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.VsRegionalAverageIndex==0 || HistoricalContractCompared2nd.VsRegionalAverageIndex==null}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.VsRegionalAverageIndex!=null && NewContractV0Estimate2nd.VsRegionalAverageIndex!=0}"><apex:param value="{!NewContractV0Estimate2nd.VsRegionalAverageIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.VsRegionalAverageIndex==0 || NewContractV0Estimate2nd.VsRegionalAverageIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndex!=null && HistoricalVFinalContract2nd.VsRegionalAverageIndex!=0 && HistoricalVFinalContract2nd.VsRegionalAverageIndex!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.VsRegionalAverageIndex-HistoricalVFinalContract2nd.VsRegionalAverageIndex)/HistoricalVFinalContract2nd.VsRegionalAverageIndex)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndex==0||HistoricalVFinalContract2nd.VsRegionalAverageIndex==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndex!=null && NewContactV0Contract2nd.VsRegionalAverageIndex!=0}"><apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndex==0 || NewContactV0Contract2nd.VsRegionalAverageIndex==null}"/></strong></td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->

        <!-- <tr style="{!IF(contains(groupStr,'C') || contains(groupStr,'D'),'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>vs. Regional Average Index(Pro-Forma) </strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.VsRegionalAverageIndexProForma!=null && HistoricalV00Contract2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!HistoricalV00Contract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.VsRegionalAverageIndexProForma==0 || HistoricalV00Contract2nd.VsRegionalAverageIndexProForma==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=null && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==0 || HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.VsRegionalAverageIndexProForma!=null && HistoricalContractCompared2nd.VsRegionalAverageIndexProForma!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.VsRegionalAverageIndexProForma==0 || HistoricalContractCompared2nd.VsRegionalAverageIndexProForma==null}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma!=null && NewContractV0Estimate2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma==0 || NewContractV0Estimate2nd.VsRegionalAverageIndexProForma==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=null && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=0 && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.VsRegionalAverageIndexProForma-HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma)/HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==0||HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=null && NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma==0 || NewContactV0Contract2nd.VsRegionalAverageIndexProForma==null}"/></strong></td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->
        <!-- <tr style="{!IF(contains(groupStr,'A') || contains(groupStr,'B') ||contains(groupStr,'C'),'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>Regional Target Index </strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.RegionalTargetIndex!=null && HistoricalV00Contract2nd.RegionalTargetIndex!=0}"><apex:param value="{!HistoricalV00Contract2nd.RegionalTargetIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.RegionalTargetIndex==0 || HistoricalV00Contract2nd.RegionalTargetIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.RegionalTargetIndex!=null && HistoricalVFinalContract2nd.RegionalTargetIndex!=0}"><apex:param value="{!HistoricalVFinalContract2nd.RegionalTargetIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.RegionalTargetIndex==0 || HistoricalVFinalContract2nd.RegionalTargetIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalContractCompared2nd.RegionalTargetIndex!=null && HistoricalContractCompared2nd.RegionalTargetIndex!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.RegionalTargetIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.RegionalTargetIndex==0 || HistoricalContractCompared2nd.RegionalTargetIndex==null}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.RegionalTargetIndex!=null && NewContractV0Estimate2nd.RegionalTargetIndex!=0}"><apex:param value="{!NewContractV0Estimate2nd.RegionalTargetIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.RegionalTargetIndex==0 || NewContractV0Estimate2nd.RegionalTargetIndex==null}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,###}%" rendered="{!HistoricalVFinalContract2nd.RegionalTargetIndex!=null && HistoricalVFinalContract2nd.RegionalTargetIndex!=0 && HistoricalVFinalContract2nd.RegionalTargetIndex!=null}">
                    <apex:param value="{!((NewContractV0Estimate2nd.RegionalTargetIndex-HistoricalVFinalContract2nd.RegionalTargetIndex)/HistoricalVFinalContract2nd.RegionalTargetIndex)*100 }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.RegionalTargetIndex==0||HistoricalVFinalContract2nd.RegionalTargetIndex==null}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.RegionalTargetIndex!=null && NewContactV0Contract2nd.RegionalTargetIndex!=0}"><apex:param value="{!NewContactV0Contract2nd.RegionalTargetIndex}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.RegionalTargetIndex==0 || NewContactV0Contract2nd.RegionalTargetIndex==null}"/></strong></td>
            <td align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->

        <!-- <apex:variable rendered="{!(contains(groupStr,'A') || contains(groupStr,'B') ||contains(groupStr,'C'))}" value="" var="">
 -->        <tr style=""  >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>vs . Regional Average Index</strong></td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                        <apex:outputText style="{!IF(HistoricalV00Contract2nd.VsRegionalAverageIndexProForma != null && HistoricalV00Contract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!HistoricalV00Contract2nd.VsRegionalAverageIndexProForma!=null && HistoricalV00Contract2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!HistoricalV00Contract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.VsRegionalAverageIndexProForma==0 || HistoricalV00Contract2nd.VsRegionalAverageIndexProForma==null}"/></strong>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                            <apex:outputText style="{!IF(HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma != null && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=null && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==0 || HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==null}"/></strong>
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                            <apex:outputText style="{!IF(HistoricalContractCompared2nd.VsRegionalAverageIndexProForma != null && HistoricalContractCompared2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!HistoricalContractCompared2nd.VsRegionalAverageIndexProForma!=null && HistoricalContractCompared2nd.VsRegionalAverageIndexProForma!=0}">
                                <apex:param value="{!HistoricalContractCompared2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.VsRegionalAverageIndexProForma==0 || HistoricalContractCompared2nd.VsRegionalAverageIndexProForma==null}"/></strong>
                    </td>
                </apex:variable>
                


                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                        <apex:outputText style="{!IF(NewContractV0Estimate2nd.VsRegionalAverageIndexProForma != null && NewContractV0Estimate2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma!=null && NewContractV0Estimate2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma==0 || NewContractV0Estimate2nd.VsRegionalAverageIndexProForma==null}"/></strong>
                </td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                        <apex:outputText style="{!IF(HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma != null && NewContractV0Estimate2nd.VsRegionalAverageIndexProForma-HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=null && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=0 && HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma!=null}">
                            <apex:param value="{!NewContractV0Estimate2nd.VsRegionalAverageIndexProForma-HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==0||HistoricalVFinalContract2nd.VsRegionalAverageIndexProForma==null}"/>
                    </td>
                </apex:variable>
                
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA"><strong>
                        <apex:outputText style="{!IF(NewContactV0Contract2nd.VsRegionalAverageIndexProForma != null && NewContactV0Contract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=null && NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=0}"><apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma==0 || NewContactV0Contract2nd.VsRegionalAverageIndexProForma==null}"/></strong></td>
                <!-- <td align="right">&nbsp;</td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;</td> -->
            </tr>
        <!-- </apex:variable> -->
        


        <!-- <tr style="{!IF(AdorAbove,'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong>ROI(Intake) 投资回报率</strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract2nd.ROIIntake!=null && HistoricalV00Contract2nd.ROIIntake!=0}"><apex:param value="{!HistoricalV00Contract2nd.ROIIntake}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.ROIIntake==null || HistoricalV00Contract2nd.ROIIntake==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.ROIIntake!=null && HistoricalVFinalContract2nd.ROIIntake!=0}"><apex:param value="{!HistoricalVFinalContract2nd.ROIIntake}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.ROIIntake==null||HistoricalVFinalContract2nd.ROIIntake==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalContractCompared2nd.ROIIntake!=null && HistoricalContractCompared2nd.ROIIntake!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.ROIIntake}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.ROIIntake==null||HistoricalContractCompared2nd.ROIIntake==0}"/></strong>
            </td>

            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.ROIIntake!=null && NewContractV0Estimate2nd.ROIIntake!=0}"><apex:param value="{!NewContractV0Estimate2nd.ROIIntake}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.ROIIntake==null || NewContractV0Estimate2nd.ROIIntake==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.ROIIntake!=0 || HistoricalVFinalContract2nd.ROIIntake!=0}">
                    <apex:param value="{!(NewContractV0Estimate2nd.ROIIntake-HistoricalVFinalContract2nd.ROIIntake) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.ROIIntake==0 && HistoricalVFinalContract2nd.ROIIntake==0}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract2nd.ROIIntake!=null && NewContactV0Contract2nd.ROIIntake!=0}"><apex:param value="{!NewContactV0Contract2nd.ROIIntake}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIIntake==null || NewContactV0Contract2nd.ROIIntake==0}"/></strong></td>
            <td style="" align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>

        <tr style="{!IF(AdorAbove,'','display:none;')}"  >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong>ROI(Intake) 投资回报率 <br/> (excl Premium brands/剔除高档品牌)**</strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract2nd.ROIIntakeExcl!=null && HistoricalV00Contract2nd.ROIIntakeExcl!=0}"><apex:param value="{!HistoricalV00Contract2nd.ROIIntakeExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.ROIIntakeExcl==null || HistoricalV00Contract2nd.ROIIntakeExcl==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.ROIIntakeExcl!=null && HistoricalVFinalContract2nd.ROIIntakeExcl!=0}"><apex:param value="{!HistoricalVFinalContract2nd.ROIIntakeExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.ROIIntakeExcl==null||HistoricalVFinalContract2nd.ROIIntakeExcl==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalContractCompared2nd.ROIIntakeExcl!=null && HistoricalContractCompared2nd.ROIIntakeExcl!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.ROIIntakeExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.ROIIntakeExcl==null||HistoricalContractCompared2nd.ROIIntakeExcl==0}"/></strong>
            </td>

            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.ROIIntakeExcl!=null && NewContractV0Estimate2nd.ROIIntakeExcl!=0}"><apex:param value="{!NewContractV0Estimate2nd.ROIIntakeExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.ROIIntakeExcl==null || NewContractV0Estimate2nd.ROIIntakeExcl==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.ROIIntakeExcl!=0 || HistoricalVFinalContract2nd.ROIIntakeExcl!=0}">
                    <apex:param value="{!(NewContractV0Estimate2nd.ROIIntakeExcl-HistoricalVFinalContract2nd.ROIIntakeExcl) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.ROIIntakeExcl==0 && HistoricalVFinalContract2nd.ROIIntakeExcl==0}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract2nd.ROIIntakeExcl!=null && NewContactV0Contract2nd.ROIIntakeExcl!=0}"><apex:param value="{!NewContactV0Contract2nd.ROIIntakeExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIIntakeExcl==null || NewContactV0Contract2nd.ROIIntakeExcl==0}"/></strong></td>
            <td style="" align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->

        <!-- <tr style="{!IF(AdorAbove,'','display:none;')}" >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FF9999"><strong> ROI (Pro-Forma) 预设投资回报率</strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract2nd.ROIProForma!=null&&HistoricalV00Contract2nd.ROIProForma!=0}"><apex:param value="{!HistoricalV00Contract2nd.ROIProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.ROIProForma==null || HistoricalV00Contract2nd.ROIProForma==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.ROIProForma!=null&&HistoricalVFinalContract2nd.ROIProForma!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.ROIProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.ROIProForma==null||HistoricalVFinalContract2nd.ROIProForma==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}"  rendered="{!HistoricalContractCompared2nd.ROIProForma!=null&&HistoricalContractCompared2nd.ROIProForma!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.ROIProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.ROIProForma==null||HistoricalContractCompared2nd.ROIProForma==0}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.ROIProForma!=null&&NewContractV0Estimate2nd.ROIProForma!=0}"><apex:param value="{!NewContractV0Estimate2nd.ROIProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.ROIProForma==null||NewContractV0Estimate2nd.ROIProForma==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#FF9999">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.ROIProForma!=0 ||  NewContractV0Estimate2nd.ROIProForma!=0}">
                    <apex:param value="{!(NewContractV0Estimate2nd.ROIProForma-HistoricalVFinalContract2nd.ROIProForma) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.ROIProForma==0 && NewContractV0Estimate2nd.ROIProForma==0}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#FF9999">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract2nd.ROIProForma!=null&&NewContactV0Contract2nd.ROIProForma!=0}"><apex:param value="{!NewContactV0Contract2nd.ROIProForma}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIProForma==null||NewContactV0Contract2nd.ROIProForma==0}"/></strong>
            </td>
            <td style="" align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr>

        <tr style="{!IF(AdorAbove,'','display:none;')}" >
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA"><strong> ROI (Pro-Forma) 预设投资回报率 <br/> (excl Premium brands/剔除高档品牌)**</strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalV00Contract2nd.ROIProFormaExcl!=null&&HistoricalV00Contract2nd.ROIProFormaExcl!=0}"><apex:param value="{!HistoricalV00Contract2nd.ROIProFormaExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.ROIProFormaExcl==null || HistoricalV00Contract2nd.ROIProFormaExcl==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.ROIProFormaExcl!=null&&HistoricalVFinalContract2nd.ROIProFormaExcl!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.ROIProFormaExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.ROIProFormaExcl==null||HistoricalVFinalContract2nd.ROIProFormaExcl==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}"  rendered="{!HistoricalContractCompared2nd.ROIProFormaExcl!=null&&HistoricalContractCompared2nd.ROIProFormaExcl!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.ROIProFormaExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.ROIProFormaExcl==null||HistoricalContractCompared2nd.ROIProFormaExcl==0}"/></strong>
            </td>


            <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContractV0Estimate2nd.ROIProFormaExcl!=null&&NewContractV0Estimate2nd.ROIProFormaExcl!=0}"><apex:param value="{!NewContractV0Estimate2nd.ROIProFormaExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.ROIProFormaExcl==null||NewContractV0Estimate2nd.ROIProFormaExcl==0}"/></strong>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!HistoricalVFinalContract2nd.ROIProFormaExcl!=0 ||  NewContractV0Estimate2nd.ROIProFormaExcl!=0}">
                    <apex:param value="{!(NewContractV0Estimate2nd.ROIProFormaExcl-HistoricalVFinalContract2nd.ROIProFormaExcl) }" /></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.ROIProFormaExcl==0 && NewContractV0Estimate2nd.ROIProFormaExcl==0}"/>
            </td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                <strong><apex:outputText value="{0,number,#,###,##0.00}" rendered="{!NewContactV0Contract2nd.ROIProFormaExcl!=null&&NewContactV0Contract2nd.ROIProFormaExcl!=0}"><apex:param value="{!NewContactV0Contract2nd.ROIProFormaExcl}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIProFormaExcl==null||NewContactV0Contract2nd.ROIProFormaExcl==0}"/></strong>
            </td>
            <td style="" align="right">&nbsp;</td>
            <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->

        <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>Total BC %  空瓶回收率(Martell BC%)</strong></td>

            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalV00Contract2nd.BCRate!=null && HistoricalV00Contract2nd.BCRate!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.BCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.BCRate==null || HistoricalV00Contract2nd.BCRate==0}"/>



                    <apex:outputText value="(" rendered="{!HistoricalV00Contract2nd.TotalMBCRate!=null && HistoricalV00Contract2nd.TotalMBCRate!=0}"/>

                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalV00Contract2nd.TotalMBCRate!=null && HistoricalV00Contract2nd.TotalMBCRate!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.TotalMBCRate}"/>
                    </apex:outputText>

                    <apex:outputText value=")" rendered="{!HistoricalV00Contract2nd.TotalMBCRate!=null && HistoricalV00Contract2nd.TotalMBCRate!=0}"/>

                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalVFinalContract2nd.BCRate!=null && HistoricalVFinalContract2nd.BCRate!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.BCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.BCRate==null || HistoricalVFinalContract2nd.BCRate==0}"/>

                    <apex:outputText value="(" rendered="{!HistoricalVFinalContract2nd.TotalMBCRate!=null && HistoricalVFinalContract2nd.TotalMBCRate!=0}"/>

                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalVFinalContract2nd.TotalMBCRate!=null && HistoricalVFinalContract2nd.TotalMBCRate!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.TotalMBCRate}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!HistoricalVFinalContract2nd.TotalMBCRate!=null && HistoricalVFinalContract2nd.TotalMBCRate!=0}"/>

                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalContractCompared2nd.BCRate!=null && HistoricalContractCompared2nd.BCRate!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.BCRate}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalContractCompared2nd.BCRate==null || HistoricalContractCompared2nd.BCRate==0}"/>


                    <apex:outputText value="(" rendered="{!HistoricalContractCompared2nd.TotalMBCRate!=null && HistoricalContractCompared2nd.TotalMBCRate!=0}"/>
                    <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalContractCompared2nd.TotalMBCRate!=null && HistoricalContractCompared2nd.TotalMBCRate!=0}">
                        <apex:param value="{!HistoricalContractCompared2nd.TotalMBCRate}"/>
                    </apex:outputText>
                    <apex:outputText value=")" rendered="{!HistoricalContractCompared2nd.TotalMBCRate!=null && HistoricalContractCompared2nd.TotalMBCRate!=0}"/>

                </td>
            </apex:variable>
            

            <td style="border-bottom: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractV0Estimate2nd.BCRate!=null && NewContractV0Estimate2nd.BCRate!=0}"><apex:param value="{!NewContractV0Estimate2nd.BCRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.BCRate==null || NewContractV0Estimate2nd.BCRate==0}"/>


                <apex:outputText value="(" rendered="{!NewContractV0Estimate2nd.TotalMBCRate!=null && NewContractV0Estimate2nd.TotalMBCRate!=0}"/>
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractV0Estimate2nd.TotalMBCRate!=null && NewContractV0Estimate2nd.TotalMBCRate!=0}">
                    <apex:param value="{!NewContractV0Estimate2nd.TotalMBCRate}"/>
                </apex:outputText>
                <apex:outputText value=")" rendered="{!NewContractV0Estimate2nd.TotalMBCRate!=null && NewContractV0Estimate2nd.TotalMBCRate!=0}"/>

            </td>
            
            <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">

                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Estimate2nd.BCRate!=null && HistoricalVFinalContract2nd.BCRate!=null}">
                        <apex:param value="{!(NewContractV0Estimate2nd.BCRate-HistoricalVFinalContract2nd.BCRate)}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.BCRate==null||HistoricalVFinalContract2nd.BCRate==null}"/>

                    <apex:outputText value="(" rendered="{!NewContractV0Estimate2nd.TotalMBCRate !=HistoricalVFinalContract2nd.TotalMBCRate}"/>
                    <strong>
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!NewContractV0Estimate2nd.TotalMBCRate!=null && HistoricalVFinalContract2nd.TotalMBCRate!=null && NewContractV0Estimate2nd.TotalMBCRate != HistoricalVFinalContract2nd.TotalMBCRate}">
                            <apex:param value="{!(NewContractV0Estimate2nd.TotalMBCRate-HistoricalVFinalContract2nd.TotalMBCRate)}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.TotalMBCRate==null||HistoricalVFinalContract2nd.TotalMBCRate==null}"/>
                    </strong>
                    <apex:outputText value=")" rendered="{!NewContractV0Estimate2nd.TotalMBCRate !=HistoricalVFinalContract2nd.TotalMBCRate }"/>

                </td>
            </apex:variable>
            
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContactV0Contract2nd.BCRate!=null && NewContactV0Contract2nd.BCRate!=0}">
                    <apex:param value="{!NewContactV0Contract2nd.BCRate}"/>
                </apex:outputText>
                <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.BCRate==null || NewContactV0Contract2nd.BCRate==0}"/>

                <apex:outputText value="(" rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}"/>
                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}">
                    <apex:param value="{!NewContactV0Contract2nd.TotalMBCRate}"/>
                </apex:outputText>
                <apex:outputText value=")" rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}"/>
            </td>

            <!-- <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td> -->
        </tr>

        <!-- <tr>
            <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><strong>Net BC % 净空瓶回收率(Martell BC%)</strong></td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!HistoricalVFinalContract2nd.NetBCRate!=null && HistoricalVFinalContract2nd.NetBCRate!=0}">
                    <apex:param value="{!HistoricalVFinalContract2nd.NetBCRate}"/></apex:outputText>
                <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.NetBCRate==null || HistoricalVFinalContract2nd.NetBCRate==0}"/>

                <apex:outputText value="(" rendered="{!HistoricalVFinalContract2nd.NetMBCRate!=null && HistoricalVFinalContract2nd.NetMBCRate!=0}"/>
                <apex:outputText value="{0,number,#,###,##0}%"
                                 rendered="{!HistoricalVFinalContract2nd.NetMBCRate!=null && HistoricalVFinalContract2nd.NetMBCRate!=0}">
                    <apex:param value="{!HistoricalVFinalContract2nd.NetMBCRate}"/>
                </apex:outputText>
                <apex:outputText value=")" rendered="{!HistoricalVFinalContract2nd.NetMBCRate!=null && HistoricalVFinalContract2nd.NetMBCRate!=0}"/>
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

            </td>

            <td style="border-bottom: 1px solid black;" align="right">
            </td>
            <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"></td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
            </td>
            <td style="border-bottom: 1px solid black" align="right">&nbsp;</td>
            <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
        </tr> -->

    </table>

    <br/>
    <div>
        
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <thead>
            <tr>
                <td colspan="{!IF(ExistHistoricalData,'7','5')}" bgcolor="#99CCFF" style="border:1px solid black;border-bottom: 1px solid black;"><font color="white"><strong>Volume (std) 销量(标准瓶)</strong></font></td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                <td colspan="{!IF(ExistHistoricalData,'3','2')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Bottles / month<br/>瓶/月</td>
                <td colspan="{!IF(ExistHistoricalData,'3','2')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">weight of volume by sub-brand 各品牌销量占比</td>
            </tr>
            <tr>
                <!-- <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Category 类别</td> -->
                <td width="28%" style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Sub-brands 品牌</td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td width="12%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                </apex:variable>
                
                <td width="12%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td width="12%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                <!-- <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td> -->
                <td width="12%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td width="12%" style="{!IF(ExistHistoricalData,'','display: none;')} border-bottom: 1px solid black;" align="center">vs %Vfinal 对比历史完成</td>
                </apex:variable>
                
                <td width="12%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">vs %Contract 对比合同</td>
            </tr>
            </thead>
            <apex:variable value="{!0}" var="TotalHistoricalBottles1"/>
            <apex:variable value="{!0}" var="TotalEstimateBottles1"/>
            <apex:variable value="{!0}" var="TotalContractBottles1"/>
            <!-- <apex:variable value="{!0}" var="TotalHistoricalFees"/>
            <apex:variable value="{!0}" var="TotalEstimateFees"/>
            <apex:variable value="{!0}" var="TotalContractFees"/>
            <apex:variable value="{!0}" var="AllHistoricalTotalFees"/>
            <apex:variable value="{!0}" var="AllEstimateTotalFees"/>
            <apex:variable value="{!0}" var="AllContractTotalFees"/>

            <apex:variable value="{!0}" var="HistoricalTotalFees"/>
            <apex:variable value="{!0}" var="EstimateTotalFees"/>
            <apex:variable value="{!0}" var="ContractTotalFees"/> -->
            <apex:repeat value="{!subbrandList}" rows="{!IF(Ishave999,'21','20')}" var="sub">
                <apex:variable var="TotalHistoricalBottles1" value="{!TotalHistoricalBottles1+investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].monthlyVolumeSTD}"/>
                <apex:variable var="TotalEstimateBottles1" value="{!TotalEstimateBottles1+investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].monthlyVolumeSTD}"/>
                <apex:variable var="TotalContractBottles1" value="{!TotalContractBottles1+investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD}"/>
                <!-- <apex:variable var="TotalHistoricalFees" value="{!TotalHistoricalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd}"/>
                <apex:variable var="TotalEstimateFees" value="{!TotalEstimateFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd}"/>
                <apex:variable var="TotalContractFees" value="{!TotalContractFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd}"/>
                <apex:variable var="AllHistoricalTotalFees" value="{!AllHistoricalTotalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense}"/>
                <apex:variable var="AllEstimateTotalFees" value="{!AllEstimateTotalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense}"/>
                <apex:variable var="AllContractTotalFees" value="{!AllContractTotalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense}"/> -->
            <apex:variable var="" value="" rendered="{!subbrandNameMap[sub.subbrandId] != '999'}">
                <tr>
                    <!-- <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top" >
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].categoryName,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].categoryName,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].categoryName))}" escape="false" /></td> -->
                    <td align="left" valign="top" style="border-left: 1px solid black; border-right: 1px solid black;" >
                        <apex:outputText value="{!subbrandNameMap[sub.subbrandId]}" escape="false" />
                    </td>
                    <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                        <td align="right" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')}" >
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].monthlyVolumeSTD!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].monthlyVolumeSTD!=null}" >
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].monthlyVolumeSTD}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].monthlyVolumeSTD==0}" />
                        </td>
                    </apex:variable>
                    
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].monthlyVolumeSTD!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].monthlyVolumeSTD!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].monthlyVolumeSTD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].monthlyVolumeSTD==0}" />
                    </td>

                    <td align="right" valign="top" style="border-right:1px solid black;"   >


                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD==0}" />
                    </td>

                    <!-- <td align="right" valign="top"  style="{!IF(ExistHistoricalData,'','display:none;')}" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd}"/></apex:outputText>

                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd==0}" />

                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd}"/></apex:outputText>

                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="right" valign="top" style="border-right:1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd}"/></apex:outputText>

                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd==0}" />
                    </td>

                    <td align="right" valign="top"  style="{!IF(ExistHistoricalData,'','display:none;')}" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense==0}" />
                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense==0}" />
                    </td>
                    <td align="right" valign="top"  style="border-right:1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense==0}" />
                    </td> -->

                <td align="center" valign="top" style="">
                    <apex:outputText value="{0,number,#,###,###}%">
                        <apex:param value="{!ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0),0)}"/>
                    </apex:outputText>
                </td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td align="center" valign="top" style="{!IF(ExistHistoricalData,'','display: none;')}">
                        <apex:variable rendered="{!IF(ExistHistoricalData,ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0),0),ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0),0)) >= 0}" value="" var="">
                            <apex:outputText style="{!IF(IF(ExistHistoricalData,ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0),0),ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0),0)) >= 0,'color: green;','display: none;')}" value="+"/>
                            <apex:outputText style="color:green;" value="{0,number,#,###,###}%">
                                <apex:param value="{!IF(ExistHistoricalData,ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0),0),ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0),0))}"/>
                            </apex:outputText>
                        </apex:variable>
                        <apex:variable rendered="{!IF(ExistHistoricalData,ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0),0),ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0),0)) < 0}" value="" var="">
                            <apex:outputText style="color:red;" value="{0,number,#,###,###}%">
                                <apex:param value="{!IF(ExistHistoricalData,ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0),0),ROUND(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0),0))}"/>
                            </apex:outputText>
                        </apex:variable>
                    </td>
                </apex:variable>
                

                <td align="center" valign="top" style="border-right: 1px solid black; ">
                    <apex:variable rendered="{!ROUND(BLANKVALUE(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal,0)*100-BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles,0)*100, 0),0) >= 0}" value="" var="">
                        <apex:outputText rendered="{!TotalContractBottles != null && TotalContractBottles!= 0}" style="color: green;" value="+"/>
                        <apex:outputText rendered="{!TotalContractBottles != null && TotalContractBottles!= 0}" style="color: green;" value="{0,number,#,###,###}%">
                            <apex:param value="{!ROUND(BLANKVALUE(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal,0)*100-BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles,0)*100, 0),0)}"/>
                        </apex:outputText>
                    </apex:variable>
                    <apex:variable rendered="{!ROUND(BLANKVALUE(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal,0)*100-BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles,0)*100, 0),0) < 0}" value="" var="">
                        <apex:outputText style="color:red;" value="{0,number,#,###,###}%">
                            <apex:param value="{!ROUND(BLANKVALUE(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal,0)*100-BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles,0)*100, 0),0)}"/>
                        </apex:outputText>
                    </apex:variable>
                    <!-- <apex:outputText rendered="{!TotalContractBottles != null && TotalContractBottles!= 0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles*100 >= 0,'color: green;','display: none;')}" value="+"/>
                    <apex:outputText rendered="{!TotalContractBottles != null && TotalContractBottles!= 0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles*100 >= 0,'color: green;','color:red;')}" value="{0,number,#,###,###}%">
                        <apex:param value="{!ROUND(BLANKVALUE(BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal,0)*100-BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].monthlyVolumeSTD/TotalContractBottles,0)*100, 0),0)}"/>
                    </apex:outputText> -->

                    <apex:outputText value=" - " rendered="{!TotalContractBottles == null || TotalContractBottles== 0}" />
                </td>

                </tr>
            </apex:variable>

            </apex:repeat>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" bgcolor="#E3DFDA">ALL PRODUCTS 品牌合计</td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalBottles!=0 && TotalHistoricalBottles!=null}" >
                            <apex:param value="{!TotalHistoricalBottles}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalHistoricalBottles==null || TotalHistoricalBottles==0}" />
                    </td>
                </apex:variable>

                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}" >
                        <apex:param value="{!TotalEstimateBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}" >
                        <apex:param value="{!TotalContractBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractBottles==null || TotalContractBottles==0}" />
                </td>

                <!-- <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalFees!=0 && TotalHistoricalFees!=null}" >
                        <apex:param value="{!TotalHistoricalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalHistoricalFees==null || TotalHistoricalFees==0}" />

                </td>
                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateFees!=0 && TotalEstimateFees!=null}" >
                        <apex:param value="{!TotalEstimateFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateFees==null || TotalEstimateFees==0}" />
                </td>
                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractFees!=0 && TotalContractFees!=null}" >
                        <apex:param value="{!TotalContractFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractFees==null || TotalContractFees==0}" />
                </td> -->
                <td style=" border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    &nbsp;
                    <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!AllHistoricalTotalFees!=0 && AllHistoricalTotalFees!=null}" >
                        <apex:param value="{!AllHistoricalTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllHistoricalTotalFees==null || AllHistoricalTotalFees==0}" /> -->
                </td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display: none;')}" align="right" bgcolor="#E3DFDA">
                    &nbsp;
                   <!--  <apex:outputText value="{0,number,#,###,###}" rendered="{!AllEstimateTotalFees!=0 && AllEstimateTotalFees!=null}" >
                        <apex:param value="{!AllEstimateTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllEstimateTotalFees==null || AllEstimateTotalFees==0}" /> -->
                    </td>
                </apex:variable>
                
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;"  align="right" bgcolor="#E3DFDA">
                    &nbsp;
                    <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!AllContractTotalFees!=0 && AllContractTotalFees!=null}" >
                        <apex:param value="{!AllContractTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllContractTotalFees==null || AllContractTotalFees==0}" /> -->
                </td>
            </tr>
        </table>
    </div>

    <br/>
    <div>
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <thead>
            <tr>
                <td colspan="{!IF(ExistHistoricalData,IF(contains(groupStr,'C'),'11',IF((contains(groupStr,'A') || contains(groupStr,'B')) && contains(groupStr,'D'),'10',IF(contains(groupStr,'B') || contains(groupStr,'D') , '9',IF(contains(groupStr,'A'),'8','7')))),IF(contains(groupStr,'C'),'8',IF(contains(groupStr,'B') && contains(groupStr,'D'),'7',IF(contains(groupStr,'D') , '7',IF(contains(groupStr,'B'),'6','5')))))}" bgcolor="#99CCFF" style="border:1px solid black;border-bottom: 1px solid black;"><font color="white"><strong>EXPENSES (in RMB) 支出（元）</strong></font></td>
            </tr>
            <tr>
                <td colspan="1" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                <td colspan="{!IF(ExistHistoricalData,'3','2')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Trade Expenses Per Bottle<br/>单瓶销售费用</td>
                <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'D'))}" value="" var="">
                    <td colspan="1" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')}border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">vs National<br/>Investment /Btl</td>
                </apex:variable>
                
                <apex:variable var="" value="" rendered="{!contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'D')}">
                    <td colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center"><br/>Contract<br/>Index by<br/>sub-brand
                    </td>
                </apex:variable>

                <apex:variable var="" value="" rendered="{!contains(groupStr,'C')}">
                    <td colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">vs Regional<br/>Investment /Btl</td>
                </apex:variable>

                <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'B') ||contains(groupStr,'A')) && ExistHistoricalData}" value="" var="">
                    <td colspan="1" style="{!if(contains(groupStr,'C') ||contains(groupStr,'B') ||contains(groupStr,'A'),'','display:none;')}border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">vs Historical<br/>investment/Btl</td>
                </apex:variable>
                
                <td colspan="{!IF(ExistHistoricalData,'3','2')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Total Fees<br/>费用合计</td>
            </tr>
            <tr>
                <!-- <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Category 类别</td> -->
                <td width="18%" style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Sub-brands 品牌</td>
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                </apex:variable>

                <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'D'))}" value="" var="">
                    <td width="8%" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')}border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                </apex:variable>
                
                <apex:variable var="" value="" rendered="{!contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'D')}">
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同
                    </td>
                </apex:variable>
                
                <apex:variable var="" value="" rendered="{!contains(groupStr,'C')}">
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                </apex:variable>
                <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'B') ||contains(groupStr,'A')) && ExistHistoricalData}" value="" var="">
                    <td width="8%" style="{!if(contains(groupStr,'C') ||contains(groupStr,'B') ||contains(groupStr,'A'),'','display:none;')}border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
                </apex:variable>
                
                <!-- <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td> -->
                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical 历史</td>
                </apex:variable>
                
                <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
            </tr>
            </thead>
            <!-- <apex:variable value="{!0}" var="TotalHistoricalBottles"/>
            <apex:variable value="{!0}" var="TotalEstimateBottles"/>
            <apex:variable value="{!0}" var="TotalContractBottles"/>
            <apex:variable value="{!0}" var="TotalHistoricalFees"/>
            <apex:variable value="{!0}" var="TotalEstimateFees"/>
            <apex:variable value="{!0}" var="TotalContractFees"/>
            <apex:variable value="{!0}" var="AllHistoricalTotalFees"/>
            <apex:variable value="{!0}" var="AllEstimateTotalFees"/>
            <apex:variable value="{!0}" var="AllContractTotalFees"/>

            <apex:variable value="{!0}" var="HistoricalTotalFees"/>
            <apex:variable value="{!0}" var="EstimateTotalFees"/>
            <apex:variable value="{!0}" var="ContractTotalFees"/> -->

            <apex:repeat value="{!subbrandList}" rows="{!IF(Ishave999,'21','20')}" var="sub">
                <!-- <apex:variable var="TotalHistoricalBottles" value="{!TotalHistoricalBottles+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].monthlyVolumeSTD}"/>
                <apex:variable var="TotalEstimateBottles" value="{!TotalEstimateBottles+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].monthlyVolumeSTD}"/>
                <apex:variable var="TotalContractBottles" value="{!TotalContractBottles+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].monthlyVolumeSTD}"/>
                <apex:variable var="TotalHistoricalFees" value="{!TotalHistoricalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd}"/>
                <apex:variable var="TotalEstimateFees" value="{!TotalEstimateFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd}"/>
                <apex:variable var="TotalContractFees" value="{!TotalContractFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd}"/>
                <apex:variable var="AllHistoricalTotalFees" value="{!AllHistoricalTotalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].totalTradeExpense}"/>
                <apex:variable var="AllEstimateTotalFees" value="{!AllEstimateTotalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].totalTradeExpense}"/>
                <apex:variable var="AllContractTotalFees" value="{!AllContractTotalFees+investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].totalTradeExpense}"/> -->

                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top" >
                        <apex:outputText value="{!subbrandNameMap[sub.subbrandId]}" escape="false" /></td>
                    <!-- <td align="left" valign="top" style=" border-right: 1px solid black;" >
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].subBrandName,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].subBrandName))}" escape="false" />
                    </td> -->
                    <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                        <td align="right" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')}" >
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd!=null}" >
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd==0}" />
                        </td>
                    </apex:variable>
                    
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].tradeExpensePerBottle2nd}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].tradeExpensePerBottle2nd==0}" />
                    </td>

                    <td align="right" valign="top" style="border-right:1px solid black;"   >


                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd==0}" />
                    </td>

                    <!-- <td align="right" valign="top"  style="{!IF(ExistHistoricalData,'','display:none;')}" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd}"/></apex:outputText>

                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd==0}" />

                    </td>
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd}"/></apex:outputText>

                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="right" valign="top" style="border-right:1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd}"/></apex:outputText>

                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd==0}" />
                    </td> -->
                    <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'D'))}" value="" var="">
                        <td align="center" valign="top" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')}border-right: 1px solid black; ">
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment >= 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}" value="" var="">
                                <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != null}" style="color: red;" value="+"/>
                                <apex:outputText value="{0,number,#,###,###}" style="color: red;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != null}">
                                    <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment, 0)}"/>
                                </apex:outputText>
                            </apex:variable>
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment < 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}" value="" var="">
                                <apex:outputText value="{0,number,#,###,###}" style="color: green;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}">
                                    <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment, 0)}"/>
                                </apex:outputText>
                                
                            </apex:variable>
                            <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticInvestment == null}" value=" - "></apex:outputText>
                        </td>

                    </apex:variable>
                    
                    <apex:variable var="" value="" rendered="{!contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'D')}">
                        <apex:variable var="minBound" value="{!-500}"/>
                        <apex:variable var="maxBound" value="{!500}"/>
                        <td align="center" valign="top" style="border-right: 1px solid black; ">
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget >= 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}" value="" var="">
                                <!-- <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != null}" style="color: green;" value="+"/> -->
                                <apex:outputText value="{0,number,#,###,###}" style="color: green;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != null && (minBound <= investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex <= maxBound)}">
                                    <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex, 0)}"/>
                                </apex:outputText>
                                <apex:outputText style="color: green;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != null && (minBound > investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex>maxBound)}" value="NA"/>
                            </apex:variable>
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget < 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}" value="" var="">
                                <apex:outputText value="{0,number,#,###,###}" style="color: red;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0 && (minBound <= investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex <= maxBound)}">
                                    <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex, 0)}"/>
                                </apex:outputText>
                                <apex:outputText style="color: red;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0 && (minBound > investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].DomesticContractIndex > maxBound)}" value="NA"/>
                                <!-- <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD == 0}" value=" - "></apex:outputText> -->
                            </apex:variable>


                            <!-- <apex:outputText style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget > 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0,'color: green;','display: none;')}" value="+"/>
                            <apex:outputText value="{0,number,#,###,###}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}">
                                <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget, 0)}"/>
                            </apex:outputText> -->
                            <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithDomesticIndexTarget == null}" value=" - "></apex:outputText>
                        </td>
                    </apex:variable>

                    <apex:variable var="" value="" rendered="{!contains(groupStr,'C')}">
                        <td align="center" valign="top" style="border-right: 1px solid black; ">
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment >= 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}" value="" var="">
                                <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}" style="color: red;" value="+"/>
                                <apex:outputText value="{0,number,#,###,###}" 
                                style="color: red;" 
                                rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}">
                                    <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment, 0)}"/>
                                </apex:outputText>
                            </apex:variable>
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment < 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}" value="" var="">
                                <apex:outputText value="{0,number,#,###,###}" 
                                style="color: green;" 
                                rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}">
                                    <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment, 0)}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd == 0}" value=" - "></apex:outputText>
                            </apex:variable>

                            <!-- <apex:outputText style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment > 0,'color: red;','display: none;')}" value="+"/>
                            <apex:outputText value="{0,number,#,###,###}" 
                            style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment > 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0,'color: red;','color:green;')}" 
                            rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd != 0}">
                                <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment, 0)}"/>
                            </apex:outputText> -->
                            <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageInvestment == null}" value=" - "></apex:outputText>
                        </td>
                    </apex:variable>
                    <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A')) && ExistHistoricalData}" value="" var="">
                        <td align="center" valign="top" style="{!if(contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A'),'','display:none;')}border-right: 1px solid black; ">
                            
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd > 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}" value="" var="">
                                <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}" style="color: red;" value="+"/>
                                <apex:outputText value="{0,number,#,###,###}" style="color:red;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}">
                                    <apex:param value="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd == null,0,investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd)}"/>
                                </apex:outputText>
                            </apex:variable>
                            <apex:variable rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd == null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd <= 0}" value="" var="">
                                <apex:outputText value="{0,number,#,###,###}" style="color:green;" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}">
                                    <apex:param value="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd == null,0,investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].tradeExpensePerBottle2nd-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].tradeExpensePerBottle2nd)}"/>
                                </apex:outputText>
                                
                            </apex:variable>

                            <!-- <apex:outputText style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageIndex != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageIndex > 0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0,'color: green;','display: none;')}" value="+"/>
                            <apex:outputText value="{0,number,#,###,###}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageIndex != null && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageIndex < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD != 0}">
                                <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageIndex, 0)}"/>
                            </apex:outputText> -->
                            <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].volumeSTD == 0 || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].GapWithRegionalAverageIndex == null}" value=" - "></apex:outputText>
                        </td>

                    </apex:variable>

                    <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                        <td align="right" valign="top"  style="{!IF(ExistHistoricalData,'','display:none;')}" >
                            <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].totalTradeExpense!=null}" >
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].totalTradeExpense}"/></apex:outputText>
                            <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].totalTradeExpense==0}" />
                        </td>

                    </apex:variable>
                    
                    <td align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].totalTradeExpense!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].totalTradeExpense}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].totalTradeExpense==0}" />
                    </td>
                    <td align="right" valign="top"  style="border-right:1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].totalTradeExpense!=null}" >
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].totalTradeExpense}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].totalTradeExpense==0}" />
                    </td>

                </tr>

            </apex:repeat>
            <tr>
                <td colspan="1" bgcolor="#E3DFDA" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">ALL PRODUCTS 品牌合计</td>

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        &nbsp;
                        <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalBottles!=0 && TotalHistoricalBottles!=null}" >
                            <apex:param value="{!TotalHistoricalBottles}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalHistoricalBottles==null || TotalHistoricalBottles==0}" /> -->
                    </td>

                </apex:variable>
                
                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    &nbsp;
                    <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}" >
                        <apex:param value="{!TotalEstimateBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" /> -->
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    &nbsp;
                    <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}" >
                        <apex:param value="{!TotalContractBottles}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractBottles==null || TotalContractBottles==0}" /> -->
                </td>

                

                <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'D'))}" value="" var="">
                    <td style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')}border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        &nbsp;
                        <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalFees!=0 && TotalHistoricalFees!=null}" >
                            <apex:param value="{!TotalHistoricalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalHistoricalFees==null || TotalHistoricalFees==0}" /> -->

                    </td>

                </apex:variable>
                
                <apex:variable var="" value="" rendered="{!contains(groupStr,'B') || contains(groupStr,'C') || contains(groupStr,'D')}">
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        &nbsp;
                        <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateFees!=0 && TotalEstimateFees!=null}" >
                            <apex:param value="{!TotalEstimateFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalEstimateFees==null || TotalEstimateFees==0}" /> -->
                    </td>
                </apex:variable>
                
                <apex:variable var="" value="" rendered="{!contains(groupStr,'C')}">
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        &nbsp;
                        <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractFees!=0 && TotalContractFees!=null}" >
                            <apex:param value="{!TotalContractFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalContractFees==null || TotalContractFees==0}" /> -->
                    </td>
                </apex:variable>

                <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A'))  && ExistHistoricalData}" value="" var="">
                    
                    <td style="{!if(contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A'),'','display:none;')}border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        &nbsp;
                        <!-- <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractFees!=0 && TotalContractFees!=null}" >
                            <apex:param value="{!TotalContractFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalContractFees==null || TotalContractFees==0}" /> -->
                    </td>

                </apex:variable>
                

                <apex:variable rendered="{!ExistHistoricalData}" value="" var="">
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!AllHistoricalTotalFees!=0 && AllHistoricalTotalFees!=null}" >
                            <apex:param value="{!AllHistoricalTotalFees}"/></apex:outputText>
                        <apex:outputText value=" - " rendered="{!AllHistoricalTotalFees==null || AllHistoricalTotalFees==0}" />
                    </td>

                </apex:variable>
                
                <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllEstimateTotalFees!=0 && AllEstimateTotalFees!=null}" >
                        <apex:param value="{!AllEstimateTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllEstimateTotalFees==null || AllEstimateTotalFees==0}" />
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;"  align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllContractTotalFees!=0 && AllContractTotalFees!=null}" >
                        <apex:param value="{!AllContractTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllContractTotalFees==null || AllContractTotalFees==0}" />
                </td>
            </tr>


            <!-- <tr style="{!IF(ShowAchievementRecognition,'','display:none;')}" >
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="6" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}  border-bottom: 1px solid black; border-right: 1px solid black;">Achievement Recognition 调整</td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVEAdjustment!=0}">
                        <apex:param value="{!HistoricalVEAdjustment}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVEAdjustment==0}"/>
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!EstimateVEAdjustment!=0}">
                        <apex:param value="{!EstimateVEAdjustment}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!EstimateVEAdjustment==0}"/>
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!ContractVEAdjustment!=0}">
                        <apex:param value="{!ContractVEAdjustment}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!ContractVEAdjustment==0}"/>
                </td>
            </tr>


            <tr style="{!IF(ShowPSF_VXTable,'','display:none;')}" >
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="6" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}   border-right: 1px solid black; border-bottom: 1px solid black;">PRC - PSF &amp; Trading Term Incentives 合同奖励 </td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalPSFEstTotal!=null && HistoricalPSFEstTotal!=0}" >
                        <apex:param value="{!HistoricalPSFEstTotal}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalPSFEstTotal==0 || HistoricalPSFEstTotal==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFDetailTotal.EstimateTotalFees!=null && PSFDetailTotal.EstimateTotalFees!=0}" >
                        <apex:param value="{!PSFDetailTotal.EstimateTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PSFDetailTotal.EstimateTotalFees==0 || PSFDetailTotal.EstimateTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFDetailTotal.ContractTotalFees!=null && PSFDetailTotal.ContractTotalFees!=0}" >
                        <apex:param value="{!PSFDetailTotal.ContractTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!PSFDetailTotal.ContractTotalFees==0 || PSFDetailTotal.ContractTotalFees==null}" />
                </td>
            </tr>

            <tr style="{!IF(ShowVEC_VXTable,'','display:none;')}">
                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="6" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}  border-right: 1px solid black; border-bottom: 1px solid black;">PRC - Variable Event Cost 活动赞助成本 </td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVECEstTotal!=null && HistoricalVECEstTotal!=0}" >
                        <apex:param value="{!HistoricalVECEstTotal}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVECEstTotal==0 || HistoricalVECEstTotal==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!VECDetailTotal.EstimateTotalFees!=null && VECDetailTotal.EstimateTotalFees!=0}" >
                        <apex:param value="{!VECDetailTotal.EstimateTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VECDetailTotal.EstimateTotalFees==0 || VECDetailTotal.EstimateTotalFees==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!VECDetailTotal.ContractTotalFees!=null && VECDetailTotal.ContractTotalFees!=0}" >
                        <apex:param value="{!VECDetailTotal.ContractTotalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!VECDetailTotal.ContractTotalFees==0 || VECDetailTotal.ContractTotalFees==null}" />
                </td>
            </tr>


            <tr>

                <td colspan="2" style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">&nbsp;</td>
                <td bgcolor="#FFFFCC" colspan="6" style="{!IF(ExistHistoricalData,'','border-left: 1px solid black;')}  border-right: 1px solid black; border-bottom: 1px solid black;">TOTAL VARIABLE 变动费用总金额</td>
                <td bgcolor="#FFFFCC" style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!HistoricalVFinalContract2nd.VariableExpense!=null && HistoricalVFinalContract2nd.VariableExpense!=0}" >
                        <apex:param value="{!HistoricalVFinalContract2nd.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VariableExpense==0 || HistoricalVFinalContract2nd.VariableExpense==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContractV0Estimate2nd.VariableExpense!=null && NewContractV0Estimate2nd.VariableExpense!=0}" >
                        <apex:param value="{!NewContractV0Estimate2nd.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Estimate2nd.VariableExpense==0 || NewContractV0Estimate2nd.VariableExpense==null}" />
                </td>
                <td bgcolor="#FFFFCC" style="border-right: 1px solid black; border-bottom: 1px solid black; " align="right">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!NewContactV0Contract2nd.VariableExpense!=null && NewContactV0Contract2nd.VariableExpense!=0}" >
                        <apex:param value="{!NewContactV0Contract2nd.VariableExpense}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==0 || NewContactV0Contract2nd.VariableExpense==null}" />
                </td>
            </tr> -->


        </table>
        


        <!-- <table width="100%" border="0" cellpadding="3" cellspacing="0"  style="{!IF(ShowFixCostable,'','display:none;')}" >
            <thead>
            <tr>
                <td colspan="11" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>FIXED EXPENSES (in RMB) 固定支出（元）</strong></font></td>
            </tr>
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical 历史</td>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
            </tr>
            </thead>
            <apex:variable value="{!0}" var="TotalHistoricalFees"/>
            <apex:variable value="{!0}" var="TotalEstimateFees"/>
            <apex:variable value="{!0}" var="TotalContractFees"/>

            <apex:repeat value="{!FixExpense_Map}" var="itm">
                <apex:variable var="TotalHistoricalFees" value="{!TotalHistoricalFees+FixExpense_Map[itm].HistoricalFees}"/>
                <apex:variable var="TotalEstimateFees" value="{!TotalEstimateFees+FixExpense_Map[itm].EstimateFees}"/>
                <apex:variable var="TotalContractFees" value="{!TotalContractFees+FixExpense_Map[itm].ContractFees}"/>
                <tr>
                    <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; " valign="top">{!itm}</td>
                    <td colspan="3" style="border-right: 1px solid black;" align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!FixExpense_Map[itm].HistoricalFees!=0}">
                            <apex:param value="{!FixExpense_Map[itm].HistoricalFees}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FixExpense_Map[itm].HistoricalFees==0}"/>
                    </td>
                    <td colspan="3" style="border-right: 1px solid black;" align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!FixExpense_Map[itm].EstimateFees!=0}">
                            <apex:param value="{!FixExpense_Map[itm].EstimateFees}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FixExpense_Map[itm].EstimateFees==0}"/>
                    </td>
                    <td colspan="3" style="border-right: 1px solid black; " align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!FixExpense_Map[itm].ContractFees!=0}">
                            <apex:param value="{!FixExpense_Map[itm].ContractFees}" /></apex:outputText>
                        <apex:outputText value=" - " rendered="{!FixExpense_Map[itm].ContractFees==0}"/>
                    </td>
                </tr>

            </apex:repeat>
            <tr>
                <td colspan="2" style="border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Total Fixed 固定费用总金额</td>
                <td colspan="3" style="border-bottom: 1px solid black; border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalFees!=0}"><apex:param value="{!TotalHistoricalFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalHistoricalFees==0}"/></td>
                <td colspan="3" style="border-bottom: 1px solid black; border-top: 1px solid black; border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateFees!=0}"><apex:param value="{!TotalEstimateFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateFees==0}"/></td>
                <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black; " align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractFees!=0}"><apex:param value="{!TotalContractFees}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractFees==0}"/></td>
            </tr>

        </table> -->


    </div>

    <!-- <br/>

    <div style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')}">
        <br/>
        <table width="100%" border="0" style="" cellspacing="0" cellpadding="2" >
            <thead>
                <tr>
                    <td rowspan="2" style="border-top: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;" align="center">
                        Sub-Brands 品牌
                    </td>
                    <td colspan="4" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                        <font color="white"><strong>Gap of Target Index - Domestic 对比全国指标差异</strong></font>
                    </td>
                    <td colspan="4" bgcolor="#99CCFF" style="border:1px solid black;border-left: none;text-align: center;">
                        <font color="white"><strong>Gap of Average Index - Regional 对比区域平均目标</strong></font>
                    </td>
                </tr>
                <tr>
                    
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="center"> 
                        National Target 全国目标
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Historical 历史 
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Estimate 预计
                    </td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                        Contract 合同
                    </td>
                    <td style="border: 1px solid black;border-top: none;border-left: none;" align="center">
                        Regional Average 区域平均目标
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Historical 历史
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Estimate 预计
                    </td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                        Contract 合同
                    </td>
                </tr>
            </thead>
            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand2nd}" var="subBrandId">
            <tr>
                <td align="left" valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].subBrandName,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].subBrandName))}" escape="false" />
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black;border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!if(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].DomesticIndexTarget != 0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].DomesticIndexTarget != null,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].DomesticIndexTarget,if(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].DomesticIndexTarget != 0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].DomesticIndexTarget != null,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].DomesticIndexTarget,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].DomesticIndexTarget))}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].volumeSTD != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithDomesticIndexTarget, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].volumeSTD == 0}" value=""></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].volumeSTD != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithDomesticIndexTarget, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].volumeSTD == 0}" value=""></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black;border-bottom: 1px solid black; ">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].volumeSTD != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithDomesticIndexTarget, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].volumeSTD == 0}" value=""></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;border-right: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!if(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].RegionalAverageIndex != 0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].RegionalAverageIndex != null,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].RegionalAverageIndex,if(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].RegionalAverageIndex != 0 && investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].RegionalAverageIndex != null,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].RegionalAverageIndex,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].RegionalAverageIndex))}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithRegionalAverageIndex < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].volumeSTD != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithRegionalAverageIndex, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].volumeSTD == 0}" value=""></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithRegionalAverageIndex < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].volumeSTD != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithRegionalAverageIndex, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].volumeSTD == 0}" value=""></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black;border-bottom: 1px solid black; ">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithRegionalAverageIndex < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].volumeSTD != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithRegionalAverageIndex, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].volumeSTD == 0}" value=""></apex:outputText>
                </td>
            </tr>
        </apex:repeat>
        </table>
    </div> -->

    <!-- <div>
    <br/>
<table width="100%" border="0" style="" cellspacing="0" cellpadding="2" >
    <thead>
    <tr>
        <td rowspan="2" style="border-top: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;" align="center">
            Sub-Brands 品牌
        </td>
        <td colspan="5" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
            <font color="white"><strong>weight of volume by sub -brand 各品牌销量占比</strong></font>
        </td>
    </tr>
    <tr>
        <td style="border-bottom: 1px solid black;" align="center">
            Historical 历史 
        </td>
        <td style="border-bottom: 1px solid black;" align="center">
            Estimate 预计
        </td>
        <td style="border-bottom: 1px solid black;" align="center">
            %Vfinal对比历史完成
        </td>
        <td style="border-bottom: 1px solid black;" align="center">
            Contract 合同
        </td>
        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
            %Est.l对比预计
        </td>
    </tr>
    </thead>
    <apex:repeat value="{!subbrandList}" rows="20" var="sub">
            <tr>
                <td align="left" valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].subBrandName,investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].subBrandName))}" escape="false" />
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText rendered="{!ExistHistoricalData}" value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!IF(ExistHistoricalData,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['historical'].propByStdTotal*100, 0),BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0))}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].propByStdTotal*100, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['contract'].propByStdTotal*100-investmentBySubBrandByContractBySubBrand2nd[sub.subbrandId]['estimate'].propByStdTotal*100, 0)}"/>
                    </apex:outputText>
                </td>
            </tr>
        </apex:repeat>
</table>
</div> -->


<!-- <div>
    <br/>
<table width="100%" border="0" style="" cellspacing="0" cellpadding="2" >
    <thead>
    <tr>
        <td rowspan="2" style="border-top: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;" align="center">
            Sub-Brands 品牌
        </td>
        <td colspan="3" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
            <font color="white"><strong>Trade Expenses Per Bottle</strong></font>
        </td>
        <td colspan="3" bgcolor="#99CCFF" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')} border:1px solid black;text-align: center;">
            <font color="white"><strong>Gap with Investment - Domestic Target</strong></font>
        </td>
        <td colspan="3" bgcolor="#99CCFF" style="border:1px solid black;border-left: none;text-align: center;">
            <font color="white"><strong>Gap with Investment - Regional Average</strong></font>
        </td>
    </tr>
    <tr>
        
        <td style="border-bottom: 1px solid black;" align="center"> 
            Historical 历史 
        </td>
        <td style="border-bottom: 1px solid black;" align="center">
            Estimate 预计
        </td>
        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
            Contract 合同
        </td>
        <td style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')} border: 1px solid black;border-top: none;border-left: none;border-right: none;" align="center">
            Historical 历史
        </td>
        <td style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')} border-bottom: 1px solid black;" align="center">
            Estimate 预计
        </td>
        <td style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')} border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
            Contract 合同
        </td>
        <td style="border: 1px solid black;border-top: none;border-left: none;border-right: none;" align="center">
            Historical 历史
        </td>
        <td style="border-bottom: 1px solid black;" align="center">
            Estimate 预计
        </td>
        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
            Contract 合同
        </td>
    </tr>
    </thead>
    <apex:repeat value="{!investmentBySubBrandByContractBySubBrand2nd}" rows="10" var="subBrandId">
            <tr>
                <td align="left" valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].subBrandName,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].subBrandName))}" escape="false" />
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'border-bottom: 1px solid black;','display:none;')}">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithDomesticInvestment > 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithDomesticInvestment, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd == 0}" value="0.0"></apex:outputText>
                </td>
                <td align="center" valign="top" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'border-bottom: 1px solid black;','display:none;')}">

                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithDomesticInvestment > 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithDomesticInvestment, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd == 0}" value="0.0"></apex:outputText>
                </td>
                <td align="center" valign="top" style="{!if(contains(groupStr,'C') ||contains(groupStr,'D'),'','display:none;')}border-right: 1px solid black; border-bottom: 1px solid black;">

                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithDomesticInvestment > 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithDomesticInvestment, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd == 0}" value="0.0"></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithRegionalAverageInvestment > 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GapWithRegionalAverageInvestment, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle2nd == 0}" value="0.0"></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">

                    <apex:outputText value="{0,number,#,###,##0.0}" style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithRegionalAverageInvestment > 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GapWithRegionalAverageInvestment, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle2nd == 0}" value="0.0"></apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">

                    <apex:outputText value="{0,number,#,###,##0.0}" 
                    style="{!IF(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithRegionalAverageInvestment > 0,'color: red;','color:green;')}" 
                    rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd != 0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GapWithRegionalAverageInvestment, 0)}"/>
                    </apex:outputText>
                    <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle2nd == 0}" value="0.0"></apex:outputText>
                </td>
            </tr>
        </apex:repeat>
</table>
</div> -->


    <!-- <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <thead>
        <tr>
            <td colspan="10" bgcolor="#99CCFF" style="border:1px solid black;">Investment by Sub-Brand 品牌投入</td>
        </tr>
        <tr>
            <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">&nbsp;</td>
            <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Trade Expenses Per Bottle<br/>单瓶销售费用</td>
            <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">% Gross Sales<br/>％ 营业额</td>
            <td colspan="3" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">ROI (Actual)<br/>投资回报率</td>
        </tr>
        <tr>
            <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Sub-Brands 品牌</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical 历史</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Estimate 预计</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical 历史</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Estimate 预计</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Historical 历史</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Estimate 预计</td>
            <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Contract 合同</td>
        </tr>
        </thead>
        <apex:variable value="{!0}" var="TotalHistoricalBottles"/>
        <apex:variable value="{!0}" var="TotalEstimateBottles"/>
        <apex:variable value="{!0}" var="TotalContractBottles"/>
        <apex:variable value="{!0}" var="TotalHistoricalFees"/>
        <apex:variable value="{!0}" var="TotalEstimateFees"/>
        <apex:variable value="{!0}" var="TotalContractFees"/>
        <apex:variable value="{!0}" var="AllHistoricalTotalFees"/>
        <apex:variable value="{!0}" var="AllEstimateTotalFees"/>
        <apex:variable value="{!0}" var="AllContractTotalFees"/>

        <apex:variable value="{!0}" var="HistoricalTotalFees"/>
        <apex:variable value="{!0}" var="EstimateTotalFees"/>
        <apex:variable value="{!0}" var="ContractTotalFees"/>

        <apex:repeat value="{!investmentBySubBrandByContractBySubBrand2nd}" rows="10" var="subBrandId">
            <tr>
                <td align="left" valign="top" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].subBrandName,investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].subBrandName))}" escape="false" />
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].tradeExpensePerBottle, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].tradeExpensePerBottle, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].tradeExpensePerBottle, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].GSPercent, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].GSPercent, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.0}%">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].GSPercent, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.00}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['historical'].ROI, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.00}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['estimate'].ROI, 0)}"/>
                    </apex:outputText>
                </td>
                <td align="center" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,##0.00}">
                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand2nd[subBrandId]['contract'].ROI, 0)}"/>
                    </apex:outputText>
                </td>
            </tr>
        </apex:repeat> -->
        <!--<tr>-->
        <!--<td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Total 合计</td>-->
        <!--<td style="{!IF(ExistHistoricalData,'','display:none;')}border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalBottles!=0 && TotalHistoricalBottles!=null}" >-->
        <!--<apex:param value="{!TotalHistoricalBottles}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!TotalHistoricalBottles==null || TotalHistoricalBottles==0}" />-->
        <!--</td>-->
        <!--<td style="border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}" >-->
        <!--<apex:param value="{!TotalEstimateBottles}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" />-->
        <!--</td>-->
        <!--<td style="border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}" >-->
        <!--<apex:param value="{!TotalContractBottles}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!TotalContractBottles==null || TotalContractBottles==0}" />-->
        <!--</td>-->

        <!--<td style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalFees!=0 && TotalHistoricalFees!=null}" >-->
        <!--<apex:param value="{!TotalHistoricalFees}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!TotalHistoricalFees==null || TotalHistoricalFees==0}" />-->

        <!--</td>-->
        <!--<td style="border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateFees!=0 && TotalEstimateFees!=null}" >-->
        <!--<apex:param value="{!TotalEstimateFees}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!TotalEstimateFees==null || TotalEstimateFees==0}" />-->
        <!--</td>-->
        <!--<td style="border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractFees!=0 && TotalContractFees!=null}" >-->
        <!--<apex:param value="{!TotalContractFees}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!TotalContractFees==null || TotalContractFees==0}" />-->
        <!--</td>-->
        <!--<td style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!AllHistoricalTotalFees!=0 && AllHistoricalTotalFees!=null}" >-->
        <!--<apex:param value="{!AllHistoricalTotalFees}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!AllHistoricalTotalFees==null || AllHistoricalTotalFees==0}" />-->
        <!--</td>-->
        <!--<td style="border-top: 1px solid black;border-bottom: 1px solid black;" align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!AllEstimateTotalFees!=0 && AllEstimateTotalFees!=null}" >-->
        <!--<apex:param value="{!AllEstimateTotalFees}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!AllEstimateTotalFees==null || AllEstimateTotalFees==0}" />-->
        <!--</td>-->
        <!--<td style="border-right: 1px solid black; border-top: 1px solid black;border-bottom: 1px solid black;"  align="center" bgcolor="#E3DFDA">-->
        <!--<apex:outputText value="{0,number,#,###,###}" rendered="{!AllContractTotalFees!=0 && AllContractTotalFees!=null}" >-->
        <!--<apex:param value="{!AllContractTotalFees}"/></apex:outputText>-->
        <!--<apex:outputText value=" - " rendered="{!AllContractTotalFees==null || AllContractTotalFees==0}" />-->
        <!--</td>-->
        <!--</tr>-->



    <!-- </table> -->
    
    
    <apex:variable value="v1" var="" rendered="{!ApprovalComment=='new'}">
    <br/>
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
            <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="a. Backgroud & Objective" /></td></tr>
            <tr>
                <td valign="top" style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c}"
                                      rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c!=null && lstApprovalComment[0].ASI_CRM_Background_Objective__c!=''}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c==null || lstApprovalComment[0].ASI_CRM_Background_Objective__c==''}"/>
                </td>
            </tr>
            <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="b. New Contract Analysis" /></td></tr>
            <tr>
                <td valign="top" style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c}"
                                      rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=null  && lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=''}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==null || lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==''}"/>
                </td>
            </tr>
            <tr><td valign="top" style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;"><apex:outputText value="c. Historical Contract Performance" /></td></tr>
            <tr>
                <td valign="top" style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c}"
                                      rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=null && lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=''}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==null || lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==''}"/>
                </td>
            </tr>
        </table>
    </apex:variable>

    <apex:variable value="v2" var="" rendered="{!ApprovalComment=='po'}">
    <br/>
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
            <tr><td valign="top" style="font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">Finance Comments</td></tr>
            <tr>
                <td valign="top" style="font-size: 12px; line-height: 15px; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black; border-top: 1px solid black; ">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_BA_comments__c}" rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c!=null}"/>
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c==null}"/>
                </td>
            </tr>
        </table>
    </apex:variable>

    
    <apex:variable rendered="{!(contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A'))}" value="" var="">
    <br/>
        <div style="{!if(contains(groupStr,'C') ||contains(groupStr,'B')||contains(groupStr,'A'),'','display:none;')}">

                <table style="" width="100%" cellspacing="0" >
                    <thead>
                    <tr>
                        <td colspan="6"  bgcolor="#99CCFF" style="border-left: 1px solid black;border-right: 1px solid black;border-top: 1px solid black;" >
                            Variable Cost Investment Methodology (变动费用投资方式) </td>
                    </tr>

                    <tr>
                        <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" >种类</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="center"  >符合PRC建议方式？ </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black;" align="center" >销售折扣计算方式</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="center" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Volume_Base__c.Label}</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;border-top: 1px solid black; "  align="center" >{!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Unit__c.Label}</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; border-top: 1px solid black;" align="center" > {!$ObjectType.ASI_CRM_Module__c.Fields.ASI_CRM_Remark__c.Label}</td>
                    </tr>
                    </thead>

                    <tr>
                        <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; " >BRSF(空瓶回收费)</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                            <apex:variable value="" var="" rendered="{!BRSFModule.ASI_CRM_Is_Default_Methodology__c}">
                                <div  style="{!IF(BRSFModule.ASI_CRM_Is_Default_Methodology__c,'','display:none;')}"   >
                                    YES
                                </div>
                            </apex:variable>
                            

                            <apex:variable value="" var="" rendered="{!!BRSFModule.ASI_CRM_Is_Default_Methodology__c}">
                                <div  style="{!IF(BRSFModule.ASI_CRM_Is_Default_Methodology__c,'display:none;','background-color: yellow;')}"   >
                                NO
                                </div>
                            </apex:variable>
                            
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                            <apex:outputField value="{!BRSFModule.ASI_CRM_Methodology__r.Name} "  rendered="{!!showCN}" />
                            <apex:outputField value="{!BRSFModule.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >{!$Label.ASI_CRM_CN_By_Sub_Brand}</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >{!$Label.ASI_CRM_CN_Std_Btl}</td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >{!BRSFModule.ASI_CRM_Remark_Display__c}</td>
                    </tr>

                    <apex:variable value="{!0}" var="PSFModuleNumber"/>
                    <apex:repeat value="{!PSF_Item_Map}"  var="itm" id="PSFitem"  >
                        <apex:variable var="PSFModuleNumber" value="{!PSFModuleNumber+1}"/>
                        <tr>
                            <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; " >PSF(空瓶回收服务费) - {!PSFModuleNumber}</td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:variable value="" var="" rendered="{!PSF_Item_Map[itm].ASI_CRM_Is_Default_Methodology__c}">
                                    <div  style="{!IF(PSF_Item_Map[itm].ASI_CRM_Is_Default_Methodology__c,'','display:none;')}"   >
                                    YES
                                    </div>
                                </apex:variable>
                                

                                <apex:variable value="" var="" rendered="{!!PSF_Item_Map[itm].ASI_CRM_Is_Default_Methodology__c}">
                                    <div  style="{!IF(PSF_Item_Map[itm].ASI_CRM_Is_Default_Methodology__c,'display:none;','background-color: yellow;')}"   >
                                        NO
                                    </div>
                                </apex:variable>
                                
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:outputField value="{!PSF_Item_Map[itm].ASI_CRM_Methodology__r.Name} "  rendered="{!!showCN}" />
                                <apex:outputField value="{!PSF_Item_Map[itm].ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:outputField value="{!PSF_Item_Map[itm].ASI_CRM_Volume_Base__c}"/>
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:outputField value="{!PSF_Item_Map[itm].ASI_CRM_Unit__c}"/>
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                    {!PSF_Item_Map[itm].ASI_CRM_Remark_Display__c}
                                </td>
                        </tr>
                    </apex:repeat>
                    
                    <apex:variable value="" var="" rendered="{!displayVEC}">
                        <tr style="{!IF(displayVEC,'','display:none;')}"    >
                            <td style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black; " >
                                Variable Event Cost <br/>活动赞助成本
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:variable value="" var="" rendered="{!VECModule.ASI_CRM_Is_Default_Methodology__c}">
                                    <div  style="{!IF(VECModule.ASI_CRM_Is_Default_Methodology__c,'','display:none;')}"   >
                                        YES
                                    </div>
                                </apex:variable>
                                

                                <apex:variable value="" var="" rendered="{!!VECModule.ASI_CRM_Is_Default_Methodology__c}">
                                    <div  style="{!IF(VECModule.ASI_CRM_Is_Default_Methodology__c,'display:none;','background-color: yellow;')}"   >
                                        NO
                                    </div>
                                </apex:variable>
                                
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:outputField value="{!VECModule.ASI_CRM_Methodology__r.Name} "  rendered="{!!showCN}" />
                                <apex:outputField value="{!VECModule.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:outputField value="{!VECModule.ASI_CRM_Volume_Base__c}"/>
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                <apex:outputField value="{!VECModule.ASI_CRM_Unit__c}"/>
                            </td>
                            <td style="border-right: 1px solid black; border-bottom: 1px solid black; " >
                                        {!VECModule.ASI_CRM_Remark_Display__c}
                            </td>
                        </tr>
                    </apex:variable>
                    
                </table>


            <!-- <br/> -->
        </div>

    </apex:variable>
    

    </body>
</apex:component>