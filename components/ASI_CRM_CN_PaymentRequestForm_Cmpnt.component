<apex:component controller="ASI_CRM_CN_PRForm_Cmpnt_Ctrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar"
                   / >
        <apex:attribute name="PRForm" description="Payment Request (New Contract On)" type="ASI_TH_CRM_PaymentRequest__c"
                        assignto="{!thisPR}"/>
        <apex:attribute name="PDF" description="is this pdf?" type="string" assignto="{!strpdf}"/>
        <apex:attribute name="TEST" description="Check AD identity" type="string" assignto="{!isTest}"/>
        <apex:attribute name="CUTOFF" description="Check AD identity" type="string" assignto="{!isTestDate}"/>
        
        <body>
            <table width="100%" cellspacing="0" border="0" cellpadding="2" style="font-size: 12px">
                <tr>
                    <td valign="top"
                        style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><b>Payment
                        Number / 付款申请号</b></td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">{!thisPR.Name}</td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>Requestor / 付款申请人</b>
                    </td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">{!thisPR.Owner.Name}</td>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"><b>Outlet/WS
                        Name / 店家/批发商</b></td>
                    <!--INC0092941 added Null check -->
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                        {!thisPR.ASI_CRM_CN_OutletWS__r.Name}
                        <apex:outputtext value=" / {!thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c}"
                                         rendered="{!thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c != null && thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c != ''}"/>
                    </td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>PO Start Date / PO
                        开始日期</b></td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                        <apex:outputText value="{0,date,dd/MM/yyyy}">
                            <apex:param value="{!thisPR.ASI_CRM_CN_PO_Start_Date__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"><b>City /
                        城市</b></td>
                    <!--INC0092941 added Null check -->
                    <td valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;">{!IF(thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__c != null,thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__r.Name,thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_CCity__r.Name)}</td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>PO End Date / PO
                        结束日期</b></td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                        <apex:outputText value="{0,date,dd/MM/yyyy}">
                            <apex:param value="{!thisPR.ASI_CRM_CN_PO_End_Date__c}"/>
                        </apex:outputText>
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>{!if(thisPR.ASI_CRM_New_FY_Payment__c, 'PO Type / PO 类别', 'Promotion type / 促销类别')}</b></td>
                    <td valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;">{!thisPR.ASI_CRM_CN_Promotion_Type__c}</td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>Outlet Type / 店家类型</b>
                    </td>
                    <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                        {!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Sub_Channel__r.Name}
                        <apex:variable var="outletType" value=""
                                       rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c!=null}">
                            &nbsp;-
                        </apex:variable>
                        {!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c}
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                        <b>Final Payment / 最后一次付款</b></td>
                    <td valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                        <apex:outputText value="Yes" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c=true}"/>
                        <apex:outputText value="No" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c!=true}"/>
                    </td>
                    <td valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;border-bottom: 1px solid black"><b>Image
                        / 形象</b></td>
                    <td valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}</td>
                </tr>
                <tr>
                    <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;"><b>National Contract
                        Payment / 全国合同付款</b></td>
                    <td colspan="{!if(thisPR.ASI_CRM_New_FY_Payment__c, '1','3')}" valign="top"
                        style="border-right: 1px solid black;"><!--20160624 Ben @ Elufa-->
                        <apex:outputText value="Yes"
                                         rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_National_Group_Contract__c}"/>
                        <apex:outputText value="No"
                                         rendered="{!NOT(thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_National_Group_Contract__c)}"/>
                    </td>
                    <!-- 20160624 Ben @ Elufa-->
                    <apex:variable var="b" value="{!thisPR.ASI_CRM_New_FY_Payment__c}"
                                   rendered="{!thisPR.ASI_CRM_New_FY_Payment__c}">
                        <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Province<br/>PO省份
                        </td>
                        <td valign="top" colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_Province__r.Name}"/>
                        </td>
                    </apex:variable>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Description / 付款说明</b></td>
                    <td colspan="{!if(thisPR.ASI_CRM_New_FY_Payment__c, '1','3')}" valign="top"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">{!thisPR.ASI_CRM_CN_Description__c}</td>
                    <!-- 20160624 Ben @ Elufa-->
                    <apex:variable var="b" value="{!thisPR.ASI_CRM_New_FY_Payment__c}"
                                   rendered="{!thisPR.ASI_CRM_New_FY_Payment__c}">
                        <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">Channel<br/>PO渠道
                        </td>
                        <td valign="top" colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_Channel__r.Name}"/>
                        </td>
                    </apex:variable>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;"><b>Investment
                        Type / 投资类型</b></td>
                    <td colspan="3" valign="top"
                        style="border-bottom:1px solid black;border-right:1px solid black;">{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_Investment_Type__c}</td>
                </tr>
            </table>
            <br/>
            <table width="100%" cellspacing="0" border="0" cellpadding="2" style="font-size: 12px">
                <tr>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"><b>Payment
                        Methods / 付款方式</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payee Name / 一级批发商</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>WS Name / 二级批发商</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Amount / 付款金额</b></td>
                </tr>
                <apex:repeat value="{!PayeeList}" var="pe">
                    <tr>
                        <td valign="top"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">{!pe.ASI_CRM_CN_Type__c}</td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{!pe.ASI_CRM_CN_Payee_Name_T1__r.Name}"/>
                            <apex:outputText value="{!pe.ASI_CRM_CN_Cash_Payee_Name_T1__r.Name}"/>
                        </td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            {!pe.ASI_CRM_CN_Payee_Name_T2_lookup__r.Name}
                            <apex:outputText value=" - " rendered="{!pe.ASI_CRM_CN_Payee_Name_T2_lookup__c==null}"/>
                        </td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!pe.ASI_CRM_CN_Amount__c!=0}">
                                <apex:param value="{!pe.ASI_CRM_CN_Amount__c}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td align="right" valign="top" colspan="3" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Total&nbsp;</b></td>
                    <td align="right" valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PayeeAmount!=0}">
                            <apex:param value="{!PayeeAmount}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PayeeAmount==null||PayeeAmount==0}"/>
                    </td>
                </tr>
            </table>
            <br/>
            <table width="100%" cellspacing="0" border="0" cellpadding="2" style="font-size: 12px">
                <tr>
                    <td colspan="4"><b>Payment Summary / 付款金额汇总</b></td>
                </tr>
                <tr>
                    <td width="25%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"></td>
                    <td width="25%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>PO Estimated Amount / 预估金额</b></td>
                    <td width="25%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>PO Remaining Amount / 剩余金额</b></td>
                    <td width="25%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Request Amount / 申请金额</b>
                    </td>
                </tr>
                <apex:repeat value="{!paymentRequestSummary}" var="ps">
                    <tr>
                        <td valign="top"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{!ps.feeName}" rendered="{!ps.feeName!=null}"/>
                            <apex:outputText value=" / {!ps.feeChiName}" rendered="{!ps.feeChiName!=null}"/>
                        </td>
                        <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}"
                                             rendered="{!ps.POEstimateAmt!=null&&ps.POEstimateAmt!=0}">
                                <apex:param value="{!ps.POEstimateAmt}"/>
                            </apex:outputText>
                            <!--INC0092941 added Null check -->
                            <apex:outputText value=" - " rendered="{!ps.POEstimateAmt==null||ps.POEstimateAmt==0}"/>
                        </td>
                        <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}"
                                             rendered="{!ps.PORemainAmt!=null&&ps.PORemainAmt!=0}">
                                <apex:param value="{!ps.PORemainAmt}"/>
                            </apex:outputText>
                            <!--INC0092941 added Null check -->
                            <apex:outputText value=" - " rendered="{!ps.PORemainAmt==null||ps.PORemainAmt==0}"/>
                        </td>
                        <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}"
                                             rendered="{!ps.PaymentRequestAmount!=null&&ps.PaymentRequestAmount!=0}">
                                <apex:param value="{!ps.PaymentRequestAmount}"/>
                            </apex:outputText>
                            <!--INC0092941 added Null check -->
                            <apex:outputText value=" - "
                                             rendered="{!ps.PaymentRequestAmount==null||ps.PaymentRequestAmount==0}"/>
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Total / 付款总额&nbsp;</b></td>
                    <td align="right" valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                        <!--INC0092941 added Null check -->
                        <apex:outputText value="{0,number,#,###,##0.00}"
                                         rendered="{!PS_TotalPOEstAmt!=null&&PS_TotalPOEstAmt!=0}">
                            <apex:param value="{!PS_TotalPOEstAmt}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PS_TotalPOEstAmt==null||PS_TotalPOEstAmt==0}"/>
                    </td>
                    <td align="right" valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                        <!--INC0092941 added Null check -->
                        <apex:outputText value="{0,number,#,###,##0.00}"
                                         rendered="{!PS_TotalPORemainAmt!=null&&PS_TotalPORemainAmt!=0}">
                            <apex:param value="{!PS_TotalPORemainAmt}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PS_TotalPORemainAmt==null||PS_TotalPORemainAmt==0}"/>
                    </td>
                    <td align="right" valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                        <!--INC0092941 added Null check -->
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PS_TotalPRAmt!=null&&PS_TotalPRAmt!=0}">
                            <apex:param value="{!PS_TotalPRAmt}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PS_TotalPRAmt==null||PS_TotalPRAmt==0}"/>
                    </td>
                </tr>
            </table>
            <!--20160816, added by Leo-->
            <apex:outputPanel rendered="{!thisPR.ASI_CRM_New_FY_Payment__c && ((mafSummary != null && mafSummary.size > 0) || (cnySummary != null && cnySummary.size > 0) || (othersSummary != null && othersSummary.size > 0))}">
                <!--20161118 Elufa  && (mafSummary.size > 0 || cnySummary.size > 0 || othersSummary.size > 0) -->
                <table width="100%" cellspacing="0" border="0" cellpadding="2" style="font-size: 12px">
                    <tr>
                        <td>&nbsp;</td>
                    </tr>
                    <apex:variable rendered="{!mafSummary.size > 0}" value="{!mafSummary}" var="maf"><!--20161118 Elufa -->
                        <tr>
                            <td colspan="4"><b>MAF Payment / 中秋付款金额</b></td>
                        </tr>
                        <tr>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>PO Estimated Amount /
                                预估金额</b></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>PO Remaining Amount /
                                剩余金额</b></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Request Amount /
                                申请金额</b></td>
                        </tr>
                        <apex:repeat value="{!mafSummary}" var="ps">
                            <tr>
                                <td valign="top"
                                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{!ps.feeName}" rendered="{!ps.feeName!=null}"/>
                                    <apex:outputText value=" / {!ps.feeChiName}" rendered="{!ps.feeChiName!=null}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.mafEst!=null&&ps.mafEst!=0}">
                                        <apex:param value="{!ps.mafEst}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.mafEst==null||ps.mafEst==0}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.mafRemaining!=null&&ps.mafRemaining!=0}">
                                        <apex:param value="{!ps.mafRemaining}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.mafRemaining==null||ps.mafRemaining==0}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.mafRequest!=null&&ps.mafRequest!=0}">
                                        <apex:param value="{!ps.mafRequest}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.mafRequest==null||ps.mafRequest==0}"/>
                                </td>
                            </tr>
                        </apex:repeat>
                        <tr>
                            <td valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                <b>Total / 付款总额&nbsp;</b></td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <!--INC0092941 added Null check -->
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalMAFEstAmt!=null&&PS_TotalMAFEstAmt!=0}">
                                    <apex:param value="{!PS_TotalMAFEstAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalMAFEstAmt==null||PS_TotalMAFEstAmt==0}"/>
                            </td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalMAFRemainAmt!=null&&PS_TotalMAFRemainAmt!=0}">
                                    <apex:param value="{!PS_TotalMAFRemainAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalMAFRemainAmt==null||PS_TotalMAFRemainAmt==0}"/>
                            </td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalMAFPRAmt!=null&&PS_TotalMAFPRAmt!=0}">
                                    <apex:param value="{!PS_TotalMAFPRAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalMAFPRAmt==null||PS_TotalMAFPRAmt==0}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                        </tr>
                    </apex:variable>
                    <apex:variable rendered="{!cnySummary.size > 0}" value="{!cnySummary}" var="cny"><!--20161118 Elufa -->
                        <tr>
                            <td colspan="4"><b>CNY Payment / 春节付款金额</b></td>
                        </tr>
                        <tr>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>PO Estimated Amount /
                                预估金额</b></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>PO Remaining Amount /
                                剩余金额</b></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Request Amount /
                                申请金额</b></td>
                        </tr>
                        <apex:repeat value="{!cnySummary}" var="ps">
                            <tr>
                                <td valign="top"
                                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{!ps.feeName}" rendered="{!ps.feeName!=null}"/>
                                    <apex:outputText value=" / {!ps.feeChiName}" rendered="{!ps.feeChiName!=null}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.cnyEst!=null&&ps.cnyEst!=0}">
                                        <apex:param value="{!ps.cnyEst}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.cnyEst==null||ps.cnyEst==0}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.cnyRemaining!=null&&ps.cnyRemaining!=0}">
                                        <apex:param value="{!ps.cnyRemaining}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.cnyRemaining==null||ps.cnyRemaining==0}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.cnyRequest!=null&&ps.cnyRequest!=0}">
                                        <apex:param value="{!ps.cnyRequest}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.cnyRequest==null||ps.cnyRequest==0}"/>
                                </td>
                            </tr>
                        </apex:repeat>
                        <tr>
                            <td valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                <b>Total / 付款总额&nbsp;</b></td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalCNYEstAmt!=null&&PS_TotalCNYEstAmt!=0}">
                                    <apex:param value="{!PS_TotalCNYEstAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalCNYEstAmt==null||PS_TotalCNYEstAmt==0}"/>
                            </td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalCNYRemainAmt!=null&&PS_TotalCNYRemainAmt!=0}">
                                    <apex:param value="{!PS_TotalCNYRemainAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalCNYRemainAmt==null||PS_TotalCNYRemainAmt==0}"/>
                            </td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalCNYPRAmt!=null&&PS_TotalCNYPRAmt!=0}">
                                    <apex:param value="{!PS_TotalCNYPRAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalCNYPRAmt==null||PS_TotalCNYPRAmt==0}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                        </tr>
                    </apex:variable>
                    <apex:variable rendered="{!othersSummary.size > 0}" value="{!othersSummary}" var="other">
                        <!--20161118 Elufa -->
                        <tr>
                            <td colspan="4"><b>Others Payment / 其他付款金额</b></td>
                        </tr>
                        <tr>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>PO Estimated Amount /
                                预估金额</b></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>PO Remaining Amount /
                                剩余金额</b></td>
                            <td width="25%" bgcolor="#99CCFF" valign="top"
                                style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Request Amount /
                                申请金额</b></td>
                        </tr>
                        <apex:repeat value="{!othersSummary}" var="ps">
                            <tr>
                                <td valign="top"
                                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{!ps.feeName}" rendered="{!ps.feeName!=null}"/>
                                    <apex:outputText value=" / {!ps.feeChiName}" rendered="{!ps.feeChiName!=null}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.othersEst!=null&&ps.othersEst!=0}">
                                        <apex:param value="{!ps.othersEst}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.othersEst==null||ps.othersEst==0}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.othersRemaining!=null&&ps.othersRemaining!=0}">
                                        <apex:param value="{!ps.othersRemaining}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.othersRemaining==null||ps.othersRemaining==0}"/>
                                </td>
                                <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                    <apex:outputText value="{0,number,#,###,##0.00}"
                                                     rendered="{!ps.othersRequest!=null&&ps.othersRequest!=0}">
                                        <apex:param value="{!ps.othersRequest}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - " rendered="{!ps.othersRequest==null||ps.othersRequest==0}"/>
                                </td>
                            </tr>
                        </apex:repeat>
                        
                        <tr>
                            <td valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                <b>Total / 付款总额&nbsp;</b></td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalOthersEstAmt!=null&&PS_TotalOthersEstAmt!=0}">
                                    <apex:param value="{!PS_TotalOthersEstAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalOthersEstAmt==null||PS_TotalOthersEstAmt==0}"/>
                            </td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalOthersRemainAmt!=null&&PS_TotalOthersRemainAmt!=0}">
                                    <apex:param value="{!PS_TotalOthersRemainAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - "
                                                 rendered="{!PS_TotalOthersRemainAmt==null||PS_TotalOthersRemainAmt==0}"/>
                            </td>
                            <td align="right" valign="top" bgcolor="#FFFFCC"
                                style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                                 rendered="{!PS_TotalOthersPRAmt!=null&&PS_TotalOthersPRAmt!=0}">
                                    <apex:param value="{!PS_TotalOthersPRAmt}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!PS_TotalOthersPRAmt==null||PS_TotalOthersPRAmt==0}"/>
                            </td>
                        </tr>
                    </apex:variable>
                </table>
            </apex:outputPanel>
            <!--20160816, added by Leo-->
            <br/>
            <apex:outputPanel id="freegoods" rendered="{!DisplayFreeGoods}">
                <table width="100%" cellspacing="0" border="0" cellpadding="2" style="font-size: 12px">
                    <thead>
                    <tr>
                        <td colspan="5"><b>促销奖励所含赠酒明细</b></td>
                    </tr>
                    <tr>
                        <td width="15%" bgcolor="#99CCFF" valign="top" style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">物流编码</td>
                        <td width="35%" bgcolor="#99CCFF" valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>赠品品类（Sub-Brand）</b></td>
                        <td width="20%" bgcolor="#99CCFF" valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>单价</b></td>
                        <td width="10%" bgcolor="#99CCFF" valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>数量</b></td>
                        <td width="20%" bgcolor="#99CCFF" valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>合同至今应付金额</b></td>
                    </tr>
                    </thead>
                    <apex:variable value="{!0}" var="QuantityTotal"/>
                    <apex:variable value="{!0}" var="FreeGoodsAmountTotal"/>
                    <tbody>
                    <apex:repeat value="{!freeGoodsList}"  var="freegoods" id="freegoodsListItem" >
                        <apex:variable var="QuantityTotal" value="{!QuantityTotal+freegoods.ASI_TH_CRM_Quantity__c}"/>
                        <apex:variable var="FreeGoodsAmountTotal" value="{!FreeGoodsAmountTotal+freegoods.ASI_CRM_CN_Total_Payable__c}"/>
                        <tr>
                            <td  valign="top" style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;" >
                                {!freegoods.ASI_CRM_CN_Item_Group__r.ASI_MFM_Item_Group_Code__c}
                            </td>
                            <td align="left" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                {!freegoods.ASI_CRM_CN_Item_Group__r.Name}
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###.00}">
                                    <apex:param value="{!freegoods.ASI_CRM_Unit_Price__c}"/>
                                </apex:outputText>
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!freegoods.ASI_TH_CRM_Quantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,##0.00}">
                                    <apex:param value="{!freegoods.ASI_CRM_CN_Total_Payable__c}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                    </apex:repeat>
                    <tr>
                        <td valign="top" bgcolor="#FFFFCC" style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                            <b>Total / 总计&nbsp;</b>
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC" style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;" >
                            
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC" style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;" >
                            
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC" style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,###,###,###,###,###}" rendered="{!QuantityTotal!=null&&QuantityTotal!=0}" >
                                <apex:param value="{!QuantityTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!QuantityTotal==null||QuantityTotal==0}" />
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC" style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;" >
                            <apex:outputText value="{0,number,###,###,###,###,##0.00}" rendered="{!FreeGoodsAmountTotal!=null&&FreeGoodsAmountTotal!=0}" >
                                <apex:param value="{!FreeGoodsAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FreeGoodsAmountTotal==null||FreeGoodsAmountTotal==0}" />
                        </td>
                    </tr>
                    </tbody>
                </table>
            <br/>
            </apex:outputPanel>
            <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
                <tr>
                    <td colspan="4"><b>Financial Indicator / 财务指标</b></td>
                </tr>
                <tr>
                    <td colspan="2" valign="top" bgcolor="#99CCFF" align="center" style="border: 1px solid black;">Contract to
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                                         rendered="{!CutOffDay != null && CutOffDay<=thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!CutOffDay}"/>
                        </apex:outputText>
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                                         rendered="{!CutOffDay != null && CutOffDay>thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}"/>
                        </apex:outputText>
                        <!-- <apex:outputText value=" Date" rendered="{!CutOffDay<thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_Start_Date__c}" />-->
                        Volume Completion % VS % Payment Speed<br/>
                        合同开始至
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                                         rendered="{!CutOffDay != null && CutOffDay<=thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!CutOffDay}"/>
                        </apex:outputText>
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                                         rendered="{!CutOffDay != null && CutOffDay>thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}"/>
                        </apex:outputText>
                        <!-- <apex:outputText value="今" rendered="{!CutOffDay<thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_Start_Date__c}" />-->
                        销售完成情况VS付款进度
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"><b>VOL
                        % / 销量完成率 (CR12)</b></td>
                    <td width="50%" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!Other_VOL_CR12!=0}">
                            <apex:param value="{!Other_VOL_CR12}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!Other_VOL_CR12==null||Other_VOL_CR12==0}"/>
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;"><b>Payment
                        Speed % / 付款进度</b></td>
                    <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!PaymentSpeed!=null&&PaymentSpeed!=0}">
                            <apex:param value="{!PaymentSpeed}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PaymentSpeed==null||PaymentSpeed==0}"/>
                    </td>
                </tr>
            </table>
            <br/>
            <apex:variable var="brsf" value=""
                           rendered="{!!(thisPR.ASI_CRM_CN_BRSF_Start_Date__c==null && thisPR.ASI_CRM_CN_BRSF_End_Date__c==null && (PaymentBCRate==null || PaymentBCRate==0) && (thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c==0 || thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c==null) && thisPR.ASI_CRM_CN_Overpayment_Reason__c==null)}">
                <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
                    <tr>
                        <td colspan="4" valign="top" style="border: 1px solid black;" bgcolor="#99CCFF"><b>BRSF / 空瓶付款</b></td>
                    </tr>
                    <tr>
                        <td width="50%" valign="top" colspan="2"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>Period of BRSF Payment / 付款期间</b></td>
                        <td width="50%" valign="top" colspan="2"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,date,dd/MM/yyyy}"
                                             rendered="{!thisPR.ASI_CRM_CN_BRSF_Start_Date__c!=null}">
                                <apex:param value="{!thisPR.ASI_CRM_CN_BRSF_Start_Date__c}"/>
                            </apex:outputText>
                            <apex:outputText value=" Not Specified " rendered="{!thisPR.ASI_CRM_CN_BRSF_Start_Date__c==null}"/>
                            <apex:outputtext value=" - "/>
                            <apex:outputText value="{0,date,dd/MM/yyyy}" rendered="{!thisPR.ASI_CRM_CN_BRSF_End_Date__c!=null}">
                                <apex:param value="{!thisPR.ASI_CRM_CN_BRSF_End_Date__c}"/>
                            </apex:outputText>
                            <apex:outputText value=" Not Specified " rendered="{!thisPR.ASI_CRM_CN_BRSF_End_Date__c==null}"/>
                        </td>
                    </tr>
                    <tr>
                        <td width="50%" valign="top" colspan="2"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>Payment BC% / 付款空瓶回收率</b></td>
                        <td width="50%" valign="top" colspan="2"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}%"
                                             rendered="{!PaymentBCRate!=null&&PaymentBCRate!=0}">
                                <apex:param value="{!PaymentBCRate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!PaymentBCRate==null||PaymentBCRate==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td width="50%" valign="top" colspan="2"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>BC % Contract / 合同签约空瓶回收率</b></td>
                        <td width="50%" align="right" valign="top"
                            style="border-bottom:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}%"
                                             rendered="{!thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c!=0&&thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c!=null}">
                                <apex:param value="{!thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c}"/>
                            </apex:outputText>
                            <apex:outputText value=" - "
                                             rendered="{!thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c=0||thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c=null}"/>
                        </td>
                    </tr>
                    <tr>
                        <td width="50%" valign="top" colspan="2"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>BRSF Over Payment Reason / 原因说明</b></td>
                        <td width="50%" valign="top" colspan="2"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;">
                            {!thisPR.ASI_CRM_CN_Overpayment_Reason__c}
                            <apex:outputtext value="({!thisPR.ASI_CRM_CN_Other_Reason__c})"
                                             rendered="{!thisPR.ASI_CRM_CN_Overpayment_Reason__c='其他－需填写具体原因'}"/>
                        </td>
                    </tr>
                    <!-- 20151204 Ben @ Elufa System -->
                    <tr>
                        <td width="50%" valign="top" colspan="2"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>Offtake vs. Intake / 促销量与进货量对比</b></td>
                        <td width="50%" valign="top" colspan="2"
                            style="border-bottom:1px solid black;border-right:1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###.00}%" rendered="{!totalOffTakeVSInTake != NULL}">
                                <apex:param value="{!totalOffTakeVSInTake}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                    <tr>
                        <td width="50%" valign="top" colspan="2"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>Offtake vs. BC / 促销量与空瓶对比</b></td>
                        <td width="50%" valign="top" colspan="2"
                            style="border-bottom:1px solid black;border-right:1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###.00}%" rendered="{!totalOffTakeVSBC != NULL}">
                                <apex:param value="{!totalOffTakeVSBC}"/>
                            </apex:outputText>
                        </td>
                    </tr>
                    <!-- End -->
                </table>
                <br/>
            </apex:variable>
            <apex:variable var="psf" value="" rendered="{!PSF_List!=null && IF(PSF_List.size>0,true,false)}">
                <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
                    <thead>
                        <tr>
                            <td colspan="4" valign="top" style="border: 1px solid black;" bgcolor="#99CCFF">
                                <b>{!if(thisPR.ASI_CRM_New_FY_Payment__c, 'PSF / 合同奖励', 'PSF / 促销服务费')}</b></td>
                        </tr><!--20160629 Ben @ Elufa-->
                        <tr>
                            <td width="25%" valign="top"
                                style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                                <b>
                                    <apex:outputText value="PSF Start & End Date / PSF 起始结束日期"/>
                                </b></td>
                            <td width="25%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"><b>Description
                                / 付款说明</b></td>
                            <td width="25%" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><b>Payment
                                Amount / 付款总额</b></td>
                            <td width="25%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"><b>PSF
                                Comments / PSF付款说明及备注</b></td>
                        </tr>
                    </thead>
                    <apex:repeat value="{!PSF_List}" var="psflist">
                        <tr>
                            <td width="25%" valign="top"
                                style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,date,dd/MM/yyyy}">
                                    <apex:param value="{!psflist.ASI_CRM_CN_Period_Start__c}"/>
                                </apex:outputText>
                                <apex:outputText value=" - {0,date,dd/MM/yyyy}">
                                    <apex:param value="{!psflist.ASI_CRM_CN_Period_End__c}"/>
                                </apex:outputText>
                            </td>
                            <td width="25%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                                <apex:outputText value="{!psflist.ASI_CRM_CN_Payment_Description__c}" escape="false"/>
                            </td>
                            <td width="25%" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,##0.00}">
                                    <apex:param value="{!psflist.ASI_TH_CRM_Amount__c}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!psflist.ASI_TH_CRM_Amount__c==0}"/>
                            </td>
                            <td width="25%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;">
                                <apex:outputText value="{!psflist.ASI_CRM_CN_Comment__c}" escape="false"/>
                            </td>
                        </tr>
                    </apex:repeat>
                </table>
                <br/>
                
                <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 12px">
                    <thead>
                        <tr>
                            <td valign="top" align="center" colspan="4"
                                style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                                {!PSFDateString} &nbsp;
                            </td>
                        </tr>
                        <tr>
                            <td width="40%" valign="top"
                                style="border-top: 1px solid black;border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                                <b>Volume (Btl) / 销量 （瓶）</b></td>
                            <td width="20%" valign="top"
                                style="border-top: 1px solid black;border-bottom: 1px solid black; border-right: 1px solid black;">
                                <b>V0.0 Estimated Volume / V0.0 预估销量</b></td>
                            <td width="20%" valign="top"
                                style="border-top: 1px solid black;border-bottom: 1px solid black; border-right: 1px solid black;">
                                <b>Actual Performance / 实际进货量</b></td>
                            <td width="20%" valign="top"
                                style="border-top: 1px solid black;border-bottom: 1px solid black; border-right: 1px solid black;">
                                <b>vs V0.0 %</b></td>
                        </tr>
                    </thead>
                    <apex:repeat value="{!PSF_map}" var="psf">
                        <apex:variable var="psf_actual" value=""
                                       rendered="{!(PSF_map[psf].target_vol!=0 && PSF_map[psf].target_vol!=null) || (PSF_map[psf].actual_vol!=0 && PSF_map[psf].actual_vol!=null) || (PSF_map[psf].achieverate!=null && PSF_map[psf].achieverate!=0)}">
                            <tr>
                                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">{!psf}</td>
                                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                                    <apex:outputText value="{0,number,#,###,###}"
                                                     rendered="{!PSF_map[psf].target_vol!=0&&PSF_map[psf].target_vol!=null}">
                                        <apex:param value="{!PSF_map[psf].target_vol}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - "
                                                     rendered="{!PSF_map[psf].target_vol==null||PSF_map[psf].target_vol==0}"/>
                                </td>
                                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                                    <apex:outputText value="{0,number,#,###,###}"
                                                     rendered="{!PSF_map[psf].actual_vol!=0&&PSF_map[psf].actual_vol!=null}">
                                        <apex:param value="{!PSF_map[psf].actual_vol}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - "
                                                     rendered="{!PSF_map[psf].actual_vol==null||PSF_map[psf].actual_vol==0}"/>
                                </td>
                                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                                    <apex:outputText value="{0,number,#,###,###}%"
                                                     rendered="{!PSF_map[psf].achieverate!=null&&PSF_map[psf].achieverate!=0}">
                                        <apex:param value="{!PSF_map[psf].achieverate}"/>
                                    </apex:outputText>
                                    <apex:outputText value=" - "
                                                     rendered="{!PSF_map[psf].achieverate==null||PSF_map[psf].achieverate==0}"/>
                                </td>
                            </tr>
                        </apex:variable>
                    </apex:repeat>
                    <tr>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>Total Volume (Std Btl) / 总销量 （标准瓶）</b></td>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!TotalVolBtl.target_vol!=null&&TotalVolBtl.target_vol!=0}">
                                <apex:param value="{!TotalVolBtl.target_vol}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!TotalVolBtl.target_vol==null||TotalVolBtl.target_vol==0}"/>
                        </td>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!TotalVolBtl.actual_vol!=null&&TotalVolBtl.actual_vol!=0}">
                                <apex:param value="{!TotalVolBtl.actual_vol}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!TotalVolBtl.actual_vol==null||TotalVolBtl.actual_vol==0}"/>
                        </td>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}%"
                                             rendered="{!TotalVolBtl.achieverate!=null&&TotalVolBtl.achieverate!=0}">
                                <apex:param value="{!TotalVolBtl.achieverate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - "
                                             rendered="{!TotalVolBtl.achieverate==null||TotalVolBtl.achieverate==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <b>Total Volume (CR12 Extra)/总销量(CR12新境折算瓶)</b></td>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!TotalVolCR12.target_vol!=0&&TotalVolCR12.target_vol!=null}">
                                <apex:param value="{!TotalVolCR12.target_vol}"/>
                            </apex:outputText>
                            <apex:outputText value=" - "
                                             rendered="{!TotalVolCR12.target_vol==null||TotalVolCR12.target_vol==0}"/>
                        </td>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                             rendered="{!TotalVolCR12.actual_vol!=null&&TotalVolCR12.actual_vol!=0}">
                                <apex:param value="{!TotalVolCR12.actual_vol}"/>
                            </apex:outputText>
                            <apex:outputText value=" - "
                                             rendered="{!TotalVolCR12.actual_vol==null||TotalVolCR12.actual_vol==0}"/>
                        </td>
                        <td bgcolor="#FFFFCC" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}%"
                                             rendered="{!TotalVolCR12.achieverate!=null&&TotalVolCR12.achieverate!=0}">
                                <apex:param value="{!TotalVolCR12.achieverate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - "
                                             rendered="{!TotalVolCR12.achieverate==null||TotalVolCR12.achieverate==0}"/>
                        </td>
                    </tr>
                </table>
            </apex:variable>
            <apex:outputPanel id="finalPayment" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c}">
                <br/>
                <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 12px">
                    <thead>
                        <tr>
                            <td colspan="6" bgcolor="#99CCFF" style="border:1px solid black;"><strong>Last Payment / 最后付款</strong>
                            </td>
                        </tr>
                        <tr>
                            <td width="25%"
                                style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                                valign="top"><b>INTAKE / 进货量</b></td>
                            <td width="15%" style="border-bottom: 1px solid black;" align="center" valign="top"><b>Contract / 合同</b>
                            </td>
                            <td width="15%" style="border-right: 1px dotted gray; border-bottom: 1px solid black;" align="center"
                                valign="top"><b>Estimate V0.0 / <br/>预估 V0.0</b></td>
                            <td width="15%" style="border-bottom: 1px solid black;border-right: 1px solid black;" align="center"
                                valign="top"><b>Actual Performance / <br/>实际销量</b></td>
                            <td width="15%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center"
                                valign="top"><b>vs Estimation % / <br/>vs 预估V0.0 %</b></td>
                            <td width="15%" style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center"
                                valign="top"><b>vs Contract %</b></td>
                            
                        </tr>
                    </thead>
                    <tr>
                        <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                            valign="top"><strong>Volume (in 9L cs)</strong></td>
                        <td style="border-bottom: 1px solid black;" align="right" valign="top">
                            <apex:outputText value="{0,number,#,###,##0}" rendered="{!VolumeData.v0_contract!=0}">
                                <apex:param value="{!VolumeData.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VolumeData.v0_contract==0}"/>
                        </td>
                        <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" valign="top">
                            <apex:outputText value="{0,number,#,###,##0}" rendered="{!VolumeData.v0_estimate!=0}">
                                <apex:param value="{!VolumeData.v0_estimate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VolumeData.v0_estimate==0}"/>
                        </td>
                        <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" valign="top">
                            <apex:outputText value="{0,number,#,###,##0}" rendered="{!VolumeData.v1_actual!=0}">
                                <apex:param value="{!VolumeData.v1_actual}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VolumeData.v1_actual==0}"/>
                        </td>
                        <td style="border-bottom: 1px solid black;" align="right" valign="top">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!VolumeData.v0_est_gap!=0}">
                                <apex:param value="{!VolumeData.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VolumeData.v0_est_gap==0}"/>
                        </td>
                        <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" valign="top">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!VolumeData.v0_con_gap!=0}">
                                <apex:param value="{!VolumeData.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VolumeData.v0_con_gap==0}"/>
                        </td>
                    </tr>
                    <apex:repeat value="{!lastpayment_sbgrade}" var="sbgroup">
                        <tr>
                            <td style="border-left: 1px solid black; border-right: 1px solid black;"
                                valign="top">{!RIGHT(sbgroup,LEN(sbgroup)-3)}</td>
                            <td align="right" valign="top">
                                <apex:outputText value="{0,number,#,###,##0}"
                                                 rendered="{!lastpayment_sbgrade[sbgroup].v0_contract!=0}">
                                    <apex:param value="{!lastpayment_sbgrade[sbgroup].v0_contract}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!lastpayment_sbgrade[sbgroup].v0_contract==0}"/>
                            </td>
                            <td style="border-right: 1px dotted gray;" align="right" valign="top">
                                <apex:outputText value="{0,number,#,###,##0}"
                                                 rendered="{!lastpayment_sbgrade[sbgroup].v0_estimate!=0}">
                                    <apex:param value="{!lastpayment_sbgrade[sbgroup].v0_estimate}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!lastpayment_sbgrade[sbgroup].v0_estimate==0}"/>
                            </td>
                            <td style="border-right: 1px solid black;" align="right" valign="top">
                                <apex:outputText value="{0,number,#,###,##0}"
                                                 rendered="{!lastpayment_sbgrade[sbgroup].v1_actual!=0}">
                                    <apex:param value="{!lastpayment_sbgrade[sbgroup].v1_actual}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!lastpayment_sbgrade[sbgroup].v1_actual==0}"/>
                            </td>
                            <td align="right" valign="top">
                                <apex:outputText value="{0,number,#,###,##0}%"
                                                 rendered="{!lastpayment_sbgrade[sbgroup].v0_est_gap!=0}">
                                    <apex:param value="{!lastpayment_sbgrade[sbgroup].v0_est_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!lastpayment_sbgrade[sbgroup].v0_est_gap==0}"/>
                            </td>
                            <td style="border-right: 1px solid black;" align="right" valign="top">
                                <apex:outputText value="{0,number,#,###,##0}%"
                                                 rendered="{!lastpayment_sbgrade[sbgroup].v0_con_gap!=0}">
                                    <apex:param value="{!lastpayment_sbgrade[sbgroup].v0_con_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!lastpayment_sbgrade[sbgroup].v0_con_gap==0}"/>
                            </td>
                        </tr>
                    </apex:repeat>
                    <tr>
                        <td valign="top"
                            style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                            bgcolor="#E3DFDA"><strong>Trade Expenses / 销售费用</strong></td>
                        <td valign="top" style="border-bottom: 1px solid black;" align="right" bgcolor="#E3DFDA">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!tradeExp.v0_contract!=0}">
                                <apex:param value="{!tradeExp.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!tradeExp.v0_contract==0}"/>
                        </td>
                        <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"
                            bgcolor="#E3DFDA">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!tradeExp.v0_estimate!=0}">
                                <apex:param value="{!tradeExp.v0_estimate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!tradeExp.v0_estimate==0}"/>
                        </td>
                        <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"
                            bgcolor="#E3DFDA">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!tradeExp.v1_actual!=0}">
                                <apex:param value="{!tradeExp.v1_actual}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!tradeExp.v1_actual==0}"/>
                        </td>
                        <td valign="top" style="border-bottom: 1px solid black;" bgcolor="#E3DFDA" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!tradeExp.v0_est_gap!=0}">
                                <apex:param value="{!tradeExp.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!tradeExp.v0_est_gap==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            bgcolor="#E3DFDA" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!tradeExp.v0_con_gap!=0}">
                                <apex:param value="{!tradeExp.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!tradeExp.v0_con_gap==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;"><strong>% Gross
                            Sales / % 营业额 </strong></td>
                        <td valign="top" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.v0_contract!=0}">
                                <apex:param value="{!GrossSales.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!GrossSales.v0_contract==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.v0_estimate!=0}">
                                <apex:param value="{!GrossSales.v0_estimate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!GrossSales.v0_estimate==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.v1_actual!=0}">
                                <apex:param value="{!GrossSales.v1_actual}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!GrossSales.v1_actual==0}"/>
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.v0_est_gap!=0}">
                                <apex:param value="{!GrossSales.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!GrossSales.v0_est_gap==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!GrossSales.v0_con_gap!=0}">
                                <apex:param value="{!GrossSales.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!GrossSales.v0_con_gap==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;" valing="top">
                            Investment per CR12 Extra eq btl/折CR12新境单瓶投入
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!Investment_CR12.v0_contract!=0}">
                                <apex:param value="{!Investment_CR12.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!Investment_CR12.v0_contract==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!Investment_CR12.v0!=0}">
                                <apex:param value="{!Investment_CR12.v0}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!Investment_CR12.v0==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!Investment_CR12.v1!=0}">
                                <apex:param value="{!Investment_CR12.v1}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!Investment_CR12.v1==0}"/>
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!Investment_CR12.v0_est_gap!=0}">
                                <apex:param value="{!Investment_CR12.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!Investment_CR12.v0_est_gap==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!Investment_CR12.v0_con_gap!=0}">
                                <apex:param value="{!Investment_CR12.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!Investment_CR12.v0_con_gap==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;">Variable Expense /
                            变动费用
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!VarExp.v0_contract!=0}">
                                <apex:param value="{!VarExp.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExp.v0_contract==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!VarExp.v0_estimate!=0}">
                                <apex:param value="{!VarExp.v0_estimate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExp.v0_estimate==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!VarExp.v1_actual!=0}">
                                <apex:param value="{!VarExp.v1_actual}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExp.v1_actual==0}"/>
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!VarExp.v0_est_gap!=0}">
                                <apex:param value="{!VarExp.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExp.v0_est_gap==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!VarExp.v0_con_gap!=0}">
                                <apex:param value="{!VarExp.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!VarExp.v0_con_gap==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense /
                            固定费用
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!FixExp.v0_contract!=0}">
                                <apex:param value="{!FixExp.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExp.v0_contract==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!FixExp.v0_estimate!=0}">
                                <apex:param value="{!FixExp.v0_estimate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExp.v0_estimate==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="({0,number,#,###,##0})" rendered="{!FixExp.v1_actual!=0}">
                                <apex:param value="{!FixExp.v1_actual}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExp.v1_actual==0}"/>
                        </td>
                        <td valign="top" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExp.v0_est_gap!=0}">
                                <apex:param value="{!FixExp.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExp.v0_est_gap==0}"/>
                        </td>
                        <td valign="top" style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExp.v0_con_gap!=0}">
                                <apex:param value="{!FixExp.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExp.v0_con_gap==0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top"
                            style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                            Fixed Expense % / 固定费用比例 %
                        </td>
                        <td valign="top" align="right" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExpRate.v0_contract!=0}">
                                <apex:param value="{!FixExpRate.v0_contract}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExpRate.v0_contract==0}"/>
                        </td>
                        <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExpRate.v0_estimate!=0}">
                                <apex:param value="{!FixExpRate.v0_estimate}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExpRate.v0_estimate==0}"/>
                        </td>
                        <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExpRate.v1_actual!=0}">
                                <apex:param value="{!FixExpRate.v1_actual}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExpRate.v1_actual==0}"/>
                        </td>
                        <td valign="top" align="right" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExpRate.v0_est_gap!=0}">
                                <apex:param value="{!FixExpRate.v0_est_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExpRate.v0_est_gap==0}"/>
                        </td>
                        <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%" rendered="{!FixExpRate.v0_con_gap!=0}">
                                <apex:param value="{!FixExpRate.v0_con_gap}"/>
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!FixExpRate.v0_con_gap==0}"/>
                        </td>
                    </tr>
                </table>

                <apex:outputPanel rendered="{!ADorAbove}">
                    <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 12px">
                        <tr>
                            <td width="25%" valign="top"
                                style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                                bgcolor="#FFFF99"><strong>
                                <apex:outputText value="Cont. Margin after A&P / 销售净利润 "/>
                                </strong></td>
                            <td width="15%" valign="top" style="border-bottom: 1px solid black;" align="right"
                                bgcolor="#FFFF99">
                                <apex:outputText value="{0,number,#,###,##0}" rendered="{!MarginAP.v0_contract!=0}">
                                    <apex:param value="{!MarginAP.v0_contract}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginAP.v0_contract==0}"/>
                            </td>
                            <td width="15%" valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                                align="right" bgcolor="#FFFF99">
                                <apex:outputText value="{0,number,#,###,##0}" rendered="{!MarginAP.v0_estimate!=0}">
                                    <apex:param value="{!MarginAP.v0_estimate}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginAP.v0_estimate==0}"/>
                            </td>
                            <td width="15%" valign="top" style="border-bottom: 1px solid black;border-right: 1px solid black;"
                                align="right" bgcolor="#FFFF99">
                                <apex:outputText value="{0,number,#,###,##0}" rendered="{!MarginAP.v1_actual!=0}">
                                    <apex:param value="{!MarginAP.v1_actual}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginAP.v1_actual==0}"/>
                            </td>
                            <td width="15%" valign="top" align="right">
                                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!MarginAP.v0_est_gap!=0}">
                                    <apex:param value="{!MarginAP.v0_est_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginAP.v0_est_gap==0}"/>
                            </td>
                            <td width="15%" valign="top" style="border-right: 1px solid black;" align="right">
                                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!MarginAP.v0_con_gap!=0}">
                                    <apex:param value="{!MarginAP.v0_con_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginAP.v0_con_gap==0}"/>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top"
                                style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                                bgcolor="#FFFF99"><strong>Cont. Margin per Bottle / 单瓶利润 </strong></td>
                            <td valign="top" style="border-bottom: 1px solid black;" align="right" bgcolor="#FFFF99">
                                <apex:outputText value="{0,number,#,###,##0}" rendered="{!MarginperBtl.v0_contract!=0}">
                                    <apex:param value="{!MarginperBtl.v0_contract}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginperBtl.v0_contract==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                                align="right" bgcolor="#FFFF99">
                                <apex:outputText value="{0,number,#,###,##0}" rendered="{!MarginperBtl.v0_estimate!=0}">
                                    <apex:param value="{!MarginperBtl.v0_estimate}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginperBtl.v0_estimate==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                                bgcolor="#FFFF99">
                                <apex:outputText value="{0,number,#,###,##0}" rendered="{!MarginperBtl.v1_actual!=0}">
                                    <apex:param value="{!MarginperBtl.v1_actual}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginperBtl.v1_actual==0}"/>
                            </td>
                            <td valign="top" align="right">
                                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!MarginperBtl.v0_est_gap!=0}">
                                    <apex:param value="{!MarginperBtl.v0_est_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginperBtl.v0_est_gap==0}"/>
                            </td>
                            <td valign="top" style="border-right: 1px solid black;" align="right">
                                <apex:outputText value="{0,number,#,###,##0}%" rendered="{!MarginperBtl.v0_con_gap!=0}">
                                    <apex:param value="{!MarginperBtl.v0_con_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!MarginperBtl.v0_con_gap==0}"/>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top"
                                style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                                bgcolor="#FF9999"><strong>ROI / 投资回报率</strong></td>
                            <td valign="top" style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!vALLROI.v0_contract!=0}">
                                    <apex:param value="{!vALLROI.v0_contract}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vALLROI.v0_contract==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                                align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!vALLROI.v0_estimate!=0}">
                                    <apex:param value="{!vALLROI.v0_estimate}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vALLROI.v0_estimate==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                                align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!vALLROI.v1!=0}">
                                    <apex:param value="{!vALLROI.v1}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vALLROI.v1==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!vALLROI.v0_est_gap!=0}">
                                    <apex:param value="{!vALLROI.v0_est_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vALLROI.v0_est_gap==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                                align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!vALLROI.v0_con_gap!=0}">
                                    <apex:param value="{!vALLROI.v0_con_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vALLROI.v0_con_gap==0}"/>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top"
                                style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                                <strong>BC % 空瓶回收率(for last payment only)</strong></td>
                            <td valign="top" style="border-bottom: 1px solid black;" align="right">
                                <apex:outputText value="{0,number,#,###,###}%"
                                                 rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c!=0&&thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c!=null}">
                                    <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c}"/>
                                </apex:outputText>
                                <apex:outputText value=" - "
                                                 rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c==0||thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c==null}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                                align="right">
                                <apex:outputText value="{0,number,#,###,###}%"
                                                 rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c!=0&&thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c!=null}">
                                    <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c}"/>
                                </apex:outputText>
                                <apex:outputText value=" - "
                                                 rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c==0||thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Bottle_Collection_Rate__c==null}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                                align="right">
                                <apex:outputText value="{0,number,#,###,###}%"
                                                 rendered="{!intActualBCRate!=0&&intActualBCRate!=null}">
                                    <apex:param value="{!intActualBCRate}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!intActualBCRate==0||intActualBCRate==null}"/>
                            </td>
                            <td style="border-bottom: 1px solid black;"></td>
                            <td style="border-bottom: 1px solid black; border-right: 1px solid black;"></td>
                            
                        </tr>
                        <tr>
                            <td valign="top"
                                style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                                bgcolor="#FF9999"><strong>ROI (Pro-Forma) / 预设投资回报率</strong></td>
                            <td valign="top" style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!vProFormaROI.v0_contract!=0}">
                                    <apex:param value="{!vProFormaROI.v0_contract}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vProFormaROI.v0_contract==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                                align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!vProFormaROI.v0_estimate!=0}">
                                    <apex:param value="{!vProFormaROI.v0_estimate}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vProFormaROI.v0_estimate==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                                align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!vProFormaROI.v1!=0}">
                                    <apex:param value="{!vProFormaROI.v1}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vProFormaROI.v1==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black;" align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!vProFormaROI.v0_est_gap!=0}">
                                    <apex:param value="{!vProFormaROI.v0_est_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vProFormaROI.v0_est_gap==0}"/>
                            </td>
                            <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                                align="right" bgcolor="#FF9999">
                                <apex:outputText value="{0,number,#,###,##0.00}%" rendered="{!vProFormaROI.v0_con_gap!=0}">
                                    <apex:param value="{!vProFormaROI.v0_con_gap}"/>
                                </apex:outputText>
                                <apex:outputText value=" - " rendered="{!vProFormaROI.v0_con_gap==0}"/>
                            </td>
                        </tr>
                    </table>
                </apex:outputPanel>
            </apex:outputPanel>
            <br/>
            <apex:outputpanel >
                <table width="100%">
                    <tr>
                        <td valign="top"
                            style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                            <apex:outputText value="Finance Comments"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top"
                            style="font-size: 12px; line-height: 15px; border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                            <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_BA_comments__c}"
                                              rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c!=null}"/>
                            <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c==null}"/>
                        </td>
                    </tr>
                </table>
            </apex:outputpanel>
        </body>
    </apex:component>