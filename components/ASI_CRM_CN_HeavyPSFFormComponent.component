<apex:component controller="ASI_CRM_CN_HeavyPSFFormController" access="global"  >
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar"/>
    <apex:attribute name="headerId" type="String" description=" " assignTo="{!PageId}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ASI_CRM_CN_PDF_Landscape_CSS)}"/>
    <head>        
        <style>
            .border{
            width: 100%;border: 1px solid #000000;          
            }
            
            .bold{
            font-weight:bold;   
            }   
            
            h1{
            font-size:20px; 
            font-family: Arial Unicode MS;    
            }
            
            h2{
            font-weight:bold;
            }
            
            table {
            -fs-table-paginate: paginate;
            }
            @page {                       
            size: Landscape;
            margin-top: 5.5cm;
            
            @PageBreak{
            page-break:always;
            page-break-inside:avoid;
            }                   
            
            @top-center {
            content: element(header);
            }
            
            @bottom-right {
            content: counter(page);
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            } 
            @bottom-left {
            content: "PSF Form";
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            }              
            }
            
            div.header {
            position: running(header);
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            }
            
            body{
            font-family: Arial Unicode MS;
            font-size: 10px;
            line-height: 11px;
            }
            
            tbody {display:table-row-group;
            }            
            .nobreak{
            page-break-inside: avoid;
            }
            @media print{
            thead{
            display:table-header-group;
            }
            }
            }           
        </style>
        <title>PSF Form</title>
    </head>
    
    
    <div class="header">
        <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr>
                <td colspan="8" align="center"><apex:image height="2cm" width="7cm" url="{!URLFOR($Resource.ASI_MFM_CN_Logo)}"/></td>
            </tr>
            <tr>
                <td colspan="8" align="center"><h1>PSF Form</h1></td>
            </tr>
            <tr>
                <td width="16%" ><Strong>店名 Outlet Name:</Strong></td>
                <td width="16%" style="border-bottom: 1px solid black;"><apex:outputText value="{!thisPR.ASI_CRM_CN_OutletWS__r.Name}" /></td>
                <td width="2%">&nbsp;</td>
                <td width="16%"><Strong>区域 Region:</Strong></td>
                <td width="16%" style="border-bottom: 1px solid black;"><apex:outputText value="{!thisPR.ASI_CRM_CN_Region__c}" /></td>
                <td width="2%">&nbsp;</td>
                <td width="16%"><strong>
                    <!----返利季度/月份 Period:-->
                    </strong></td>
                <td width="16%" >
                    <!---<apex:outputText value="{!strPeriod}" rendered="{!strPeriod!=null}" />--->
                </td>
            </tr>
            <tr>
                <td width="16%"><Strong>PO No.:</Strong></td>
                <td width="16%" style="border-bottom: 1px solid black;"><apex:outputText value="{!thisPR.ASI_CRM_CN_PO_No__c}" /></td>
                <td width="2%">&nbsp;</td>
                <td width="16%"><Strong>付款申请号:</Strong></td>
                <td width="16%" style="border-bottom: 1px solid black;"><apex:outputText value="{!thisPR.Name}" /></td>
                <td width="2%">&nbsp;</td>
                <td width="16%"><strong>空瓶回收率(马爹利空瓶回收率):</strong></td>
                <td width="16%" style="border-bottom: 1px solid black;">
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c!=null}"><apex:param value="{!thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!thisPR.ASI_CRM_CN_Bottle_Collection_Rate__c=null}" />
                    
                    (
                    <apex:outputText value="{0,number,#,###,###}%" rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_Martell_BC_Rate__c!=null}"><apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_Martell_BC_Rate__c}" /></apex:outputText>
                    <apex:outputText value=" - " rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_Martell_BC_Rate__c=null}" />
                    )
                    
                    
                </td>
            </tr>
        </table>
    </div>
    
    
    
    
    
    <body>
        <apex:variable value="{!0}" var="ModuleCoun"/>
        <apex:repeat value="{!PSFMap}" var="ModuleId">
            <apex:variable var="ModuleCoun" value="{!ModuleCoun+1}"/>
            
            <br/>
            <div style="background: #74a4f2;">
                {!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c}
            </div> 
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                <tr>
                    <td width="10%" ><Strong>付款方式 Methodology:</Strong></td>
                    <td width="20%" style="border-bottom: 1px solid black;"><apex:outputText value="{!PSFMap[ModuleId].Module.ASI_CRM_Methodology__r.Name}" /></td>
                    <td width="2%">&nbsp;</td>
                    <td width="5%"><Strong>销量方式 Volume Option:</Strong></td>
                    <td width="15%" style="border-bottom: 1px solid black;"><apex:outputText value="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c}" /></td>
                    <td width="5%"><Strong>单位 Unit:</Strong></td>
                    <td width="10%" style="border-bottom: 1px solid black;" ><apex:outputText value="{!PSFMap[ModuleId].Module.ASI_CRM_Unit__c}" /></td>
                    <td width="10%"><strong>返利季度/月份<br/>Period:</strong></td>
                    <td width="16%" style="border-bottom: 1px solid black;">
                        <apex:outputField value="{!thisPR.ASI_CRM_CN_PO_Start_Date__c}"/> - <apex:outputField value="{!PSFMap[ModuleId].Module.ASI_CRM_End_Date__c}"/>
                    </td> 
                </tr>
            </table>
            <apex:variable value="{!0}" var="TotalCTDActualVol"/>
            <apex:variable value="{!0}" var="TotalFullContractTargetAll"/>
            
            <apex:variable value="{!0}" var="TotalIncentiveTarget"/>
            <apex:variable value="{!0}" var="TotalCapCollectionVol"/>
            <apex:variable value="{!0}" var="TotalPayableVol"/>
            <apex:variable value="{!0}" var="TotalPayableAmount"/>
            
            
            <apex:variable value="{!0}" var="PSFActual_Vol"/>
            <apex:variable value="{!0}" var="PSFCap_Collection_Vol"/>
            
            
            
            <table width="100%" cellspacing="0" cellpadding="2" style="padding-top:0.5em;padding-bottom:1em ">
                
                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap}" var="DetailLineId">
                    <apex:variable value="{!0}" var="TotalFullContractTarget"/>
                    <apex:variable value="{!0}" var="TotalIncentiveTarget"/>
                    <apex:variable value="{!0}" var="CTDActualVol"/>
                    <apex:variable value="{!0}" var="CapCollectionVol"/>                    
                    <apex:variable value="{!0}" var="PayableVol"/>
                    <apex:variable value="{!0}" var="TotalPayable"/>
                    
                    
                    
                    <apex:variable value="{!0}" var="PSFActual_Vol_Pure"/>
                    <apex:variable value="{!0}" var="PSFCap_Collection_Vol_Pure"/>
                    <apex:variable value="{!0}" var="PSFActual_Vol_Martell"/>
                    <apex:variable value="{!0}" var="PSFCap_Collection_Vol_Martell"/>
                    
                    
                    
                    <apex:variable value="{!0}" var="Incentive_ExclPremium"/>
                    <apex:variable value="{!0}" var="Full_Contract_Target_ExclPremium"/>
                    <apex:variable value="{!0}" var="Intake_ExclPremium"/>
                    <apex:variable value="{!0}" var="BC_ExclPremium"/>
                    <apex:variable value="{!0}" var="Volume_ExclPremium"/>
                    <apex:variable value="{!0}" var="PayableAmount_ExclPremium"/>
                    <apex:variable value="{!0}" var="Intake_Pure_ExclPremium"/>
                    <apex:variable value="{!0}" var="BC_Pure_ExclPremium"/>
                    <apex:variable value="{!0}" var="Intake_Martell_ExclPremium"/>
                    <apex:variable value="{!0}" var="BC_Martell_ExclPremium"/>
                    
                    
                    <thead>
                        <tr >
                            <th style=" border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" align="center" >档次</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}   " 
                                align="center" width="44%">产品名称 </th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;  " align="center" width="5%">
                                <span style=" {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')} " >金额(元)</span>
                                <span style=" {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} " >合同<br/>销售折扣</span>
                            </th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="center" width="5%">合同<br/>销量目标</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="center" width="5%">合同至今<br/>进货量</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="center" width="5%">合同至今<br/>空瓶回收量</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="center" width="5%">合同至今<br/>空瓶回收率</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " align="center" width="5%">
                                合同至今<br/>应付销量</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="center" width="5%">合同至今<br/>应付金额</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="center" width="5%">完成率</th>
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" 
                                align="center" width="3%">战略品牌 </th>
                             <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} " 
                                 align="center"  width="5%" colspan="3" >
                                 Non Martell 
                            </th>
                            
                            <th style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} " 
                                align="center" width="5%"  colspan="3" > 
                                Martell </th>
                        </tr>
                    </thead>
                    <tr>
                        <th style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;" align="center">
                            <div  style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                {!RIGHT(DetailLineId,LEN(DetailLineId)-5)}
                            </div>
                        </th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " align="center">Product </th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black; " align="center">
                            <span style=" {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')} " >RMB/Bottle</span>
                            <span style=" {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} " >Incentive Target</span>
                        </th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center">V0.0 Full <br/> Contract Target</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center">CTD Actual Btl</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center">CTD <br/>Cap Collection </th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center">BC%</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " align="center">CTD Payable Vol.</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center">CTD Payable<br/>Amt.</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;" align="center">Completion<br/>Ratio.</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')} " 
                            align="center">Key Strategy Sub-brands</th>
                        
                        
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="center"> CTD Actual<br/>  (Std Btl)</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="center">  CTD Cap<br/>  Collection <br/> (Std Btl) </th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="center"> BC% </th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} "
                            align="center"> CTD Actual<br/> (Std Btl)</th>                         
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="center">  CTD Cap<br/>Collection <br/> (Std Btl)</th>
                        <th style="border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} "
                            align="center">  BC% </th>
                    </tr>
                    
                    
                    
                    <tr>
                        <td style="border-right: 1px solid black; border-left: 1px solid black;" align="center">
                            <div  style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >
                                {!PSFMap[ModuleId].DetailLineMap[DetailLineId].SBGradeCN} 
                            </div>
                            
                            <div  style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade','','display:none;')}  " >
                                
                                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                    <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                                 rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade'}" >
                                        
                                        
                                        
                                        <apex:variable var="Incentive_ExclPremium" 
                                                       value="{!Incentive_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c!=0}" />
                                        
                                        <apex:variable var="Full_Contract_Target_ExclPremium" 
                                                       value="{!Full_Contract_Target_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c!=0}" />
                                        
                                        <apex:variable var="Intake_ExclPremium" 
                                                       value="{!Intake_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c!=0}" />
                                        
                                        
                                        <apex:variable var="BC_ExclPremium" 
                                                       value="{!BC_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c!=0}" />
                                        
                                        <apex:variable var="Volume_ExclPremium" 
                                                       value="{!Volume_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c!=0}" />
                                        
                                        
                                        <apex:variable var="PayableAmount_ExclPremium" 
                                                       value="{!PayableAmount_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c!=0}" />
                                        
                                        
                                        <apex:variable var="Intake_Pure_ExclPremium" 
                                                       value="{!Intake_Pure_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=0}" />
                                        <apex:variable var="BC_Pure_ExclPremium" 
                                                       value="{!BC_Pure_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=0}" />
                                        
                                        
                                        
                                        <apex:variable var="Intake_Martell_ExclPremium" 
                                                       value="{!Intake_Martell_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=0}" />
                                        <apex:variable var="BC_Martell_ExclPremium" 
                                                       value="{!BC_Martell_ExclPremium+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c}" 
                                                       rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.ASI_CRM_CN_Sequence__c<=4 &&
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=null && 
                                                                 PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=0}" />
                                        
                                        
                                        <tr><td>
                                            <apex:outputText value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Sub_Brand_Grade__r.Name}" />
                                            </td></tr>
                                    </apex:repeat>
                                </table>                                
                            </div>
                            
                            
                            <div  style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category','','display:none;')}  " >
                                
                                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                    <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                                 rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'}" >
                                        <tr><td>
                                            <apex:outputText value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_Product_Category__r.Name}" />
                                            </td></tr>
                                    </apex:repeat>
                                </table> 
                            </div>
                            <div  style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total','','display:none;')}  " >
                                By Total
                            </div>
                        </td> 
                        
                        
                        
                        <td style="border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  ">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand'}">
                                    <tr><td><apex:outputText value="{!PaymentLine.ASI_CRM_CN_Sub_Brand__r.Name}" rendered="{!PaymentLine.ASI_CRM_CN_Sub_Brand__r.Name!=null}" /></td></tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        <td style="border-right: 1px solid black;   " align="right">
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}"  var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <tr><td style="{!if(PaymentLine.ASI_CRM_CN_Allow_Changing_Incentive__c, 'background : #C6FFC6;', '')}">
                                        <apex:variable var="TotalIncentiveTarget" value="{!TotalIncentiveTarget+PaymentLine.ASI_CRM_CN_Incentive_BT__c}"/>
                                        
                                        <apex:outputText value="{0,number,#,###,###.00}" rendered="{!PaymentLine.ASI_CRM_CN_Incentive_BT__c!=null && PaymentLine.ASI_CRM_CN_Incentive_BT__c!=0}" >
                                            <apex:param value="{!PaymentLine.ASI_CRM_CN_Incentive_BT__c}" /></apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CN_Incentive_BT__c==null || PaymentLine.ASI_CRM_CN_Incentive_BT__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <tr><td>
                                        <apex:variable var="TotalIncentiveTarget" value="{!TotalIncentiveTarget + PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c}"/>
                                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c!=0}" >
                                            <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c}" /></apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Incentive_BT__c==0}" />                                        
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                            
                        </td>
                        
                        
                        
                        <td style="border-right: 1px solid black;" align="right">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <tr>
                                        <td >
                                            <apex:variable var="TotalFullContractTarget" value="{!TotalFullContractTarget+PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                            <apex:variable var="TotalFullContractTargetAll" value="{!TotalFullContractTargetAll+PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c!=null && PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c!=0}" >
                                                <apex:param value="{!PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c}" /></apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c==null || PaymentLine.ASI_CRM_V0_0_Full_Contract_Target__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <tr><td>
                                        <apex:variable var="TotalFullContractTarget" value="{!TotalFullContractTarget+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                        <apex:variable var="TotalFullContractTargetAll" value="{!TotalFullContractTargetAll+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c}"/>
                                        <apex:outputText value="{0,number,#,###,###.00}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c!=0}" >
                                            <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c}" /></apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_V0_0_Full_Contract_Target__c==0}" />
                                        </td></tr>
                                </apex:repeat>
                            </table>
                            
                        </td>
                        
                        
                        <td style="border-right: 1px solid black;" align="right" >
                            <table width="100%" cellpadding="0" cellspacing="0" border="0"
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="CTDActualVol" value="{!CTDActualVol+PaymentLine.ASI_CRM_CTD_Actual_Vol__c}"/>
                                    <apex:variable var="TotalCTDActualVol" value="{!TotalCTDActualVol+PaymentLine.ASI_CRM_CTD_Actual_Vol__c}"/>
                                    <apex:variable var="PSFActual_Vol" value="{!PSFActual_Vol+PaymentLine.ASI_CRM_CN_Actual_Vol__c}"/>
                                    
                                    <tr><td><apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PaymentLine.ASI_CRM_CTD_Actual_Vol__c}"/></apex:outputText></td></tr>
                                </apex:repeat>
                            </table>
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <apex:variable var="CTDActualVol" value="{!CTDActualVol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c}"/>
                                    <apex:variable var="TotalCTDActualVol" value="{!TotalCTDActualVol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c}"/>
                                    <apex:variable var="PSFActual_Vol" value="{!PSFActual_Vol++PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Actual_Vol__c}"/>
                                    <tr><td>
                                        <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c!=0}" >
                                            <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c}" /></apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol__c==0}" />
                                        </td></tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        
                        
                        
                        <td style="border-right: 1px solid black;" align="right" >
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="CapCollectionVol" value="{!CapCollectionVol+PaymentLine.ASI_CRM_CTD_Cap_Collection_Vol__c}"/>
                                    <apex:variable var="TotalCapCollectionVol" value="{!TotalCapCollectionVol+PaymentLine.ASI_CRM_CTD_Cap_Collection_Vol__c}"/>
                                    <apex:variable var="PSFCap_Collection_Vol" value="{!PSFCap_Collection_Vol+PaymentLine.ASI_CRM_CN_Bottle_Collected__c}"/>
                                    
                                    <tr><td><apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PaymentLine.ASI_CRM_CTD_Cap_Collection_Vol__c}"/></apex:outputText></td></tr>
                                </apex:repeat>
                            </table>
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <apex:variable var="CapCollectionVol" value="{!CapCollectionVol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c}"/>
                                    <apex:variable var="TotalCapCollectionVol" value="{!TotalCapCollectionVol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c}"/>
                                    <apex:variable var="PSFCap_Collection_Vol" value="{!PSFCap_Collection_Vol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Bottle_Collected__c}"/>
                                    
                                    <tr><td>
                                        <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c!=0}" >
                                            <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c}" /></apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Cap_Collection_Vol__c==0}" />
                                        </td></tr>
                                </apex:repeat>
                            </table>
                            
                        </td>
                        
                        <td style="border-right: 1px solid black;" align="right" >
                            <table width="100%" cellpadding="0" cellspacing="0" border="0"
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <tr><td><apex:outputText value="{0,number,#,###,###}%" ><apex:param value="{!PaymentLine.ASI_CRM_CN_Collection_Rate__c}" /></apex:outputText></td></tr>
                                </apex:repeat>
                            </table>
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <tr><td><apex:outputText value="{0,number,#,###,###}%" ><apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Collection_Rate__c}" /></apex:outputText></td></tr>
                                </apex:repeat>
                            </table>
                            
                        </td>                     
                        
                        <td style="border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " align="right" >
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="PayableVol" value="{!PayableVol+PaymentLine.ASI_CRM_CN_Payable_Vol__c}"/>
                                    <apex:variable var="TotalPayableVol" value="{!TotalPayableVol+PaymentLine.ASI_CRM_CN_Payable_Vol__c}"/>
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0, number, ###,###,###,###}" 
                                                             style="{!IF(AND(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PaymentLine.ASI_CRM_CN_Over_Paid__c),'color: red; font-weight: bold;',' ')} "  >
                                                <apex:param value="{!PaymentLine.ASI_CRM_CN_Payable_Vol__c}"/>
                                            </apex:outputText>
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                            
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <apex:variable var="PayableVol" value="{!PayableVol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c}"/>
                                    <apex:variable var="TotalPayableVol" value="{!TotalPayableVol+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c}"/>
                                    <tr><td>
                                        <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c!=0}" >
                                            <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c}" /></apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Payable_Vol__c==0}" />
                                        </td></tr>
                                </apex:repeat>
                            </table>
                            
                        </td>
                        
                        <td style="border-right: 1px solid black; " align="right">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="TotalPayable" value="{!TotalPayable+PaymentLine.ASI_CRM_CN_Total_Payable__c}"/>
                                    <apex:variable var="TotalPayableAmount" value="{!TotalPayableAmount+PaymentLine.ASI_CRM_CN_Total_Payable__c}"/>
                                    <tr><td>
                                        <apex:outputText value="{0, number, ###,###,###,###,##0.00}"  
                                                         style="{!IF(AND(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total',PaymentLine.ASI_CRM_CN_Over_Paid__c),'color: red; font-weight: bold;',' ')} "   >
                                            <apex:param value="{!PaymentLine.ASI_CRM_CN_Total_Payable__c}"/></apex:outputText>
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                            
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <apex:variable var="TotalPayable" value="{!TotalPayable+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c}"/>
                                    <apex:variable var="TotalPayableAmount" value="{!TotalPayableAmount+PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c}"/>
                                    <tr><td>
                                        <apex:outputText value="{0,number,#,###,###}"  
                                                         style="{!IF(PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Over_Paid__c,'color: red; font-weight: bold;',' ')} " 
                                                         rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c!=0}" >
                                            <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c}" />
                                        </apex:outputText>
                                        <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Total_Payable__c==0}" />
                                        </td></tr>
                                </apex:repeat>
                            </table>                            
                            
                        </td>
                        
                        
                        <td style="border-right: 1px solid black;" align="right">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <tr><td>
                                        <apex:outputText value="{0,number,#,###,##0.0}%" >
                                            <apex:param value="{!PaymentLine.ASI_CRM_CN_Completion_Rate__c}" /></apex:outputText>
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" 
                                   style="{!IF(OR(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade',PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category'),'','display:none;')} ">
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <tr><td><apex:outputText value="{0,number,#,###,##0.0}%" >
                                        <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CN_Completion_Rate__c}" />
                                        </apex:outputText></td></tr>
                                </apex:repeat>
                            </table>
                        </td>   
                        
                        <td style="border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')} " align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine">
                                    <tr>
                                        <td  align="bottom"  > 
                                            <div style=" {!IF(PaymentLine.ASI_CRM_Key_Sub_Brand__c,'','display:none;')} " >
                                                ✓
                                            </div>
                                            <div style=" {!IF(PaymentLine.ASI_CRM_Key_Sub_Brand__c,'display:none;','')} " >
                                                &nbsp;&nbsp;&nbsp;
                                            </div>
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>   
                        
                        <!-----------Batch 2 ------------------->
                        
                        <td style="border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  "
                            align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0"  >
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                               rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }"  >
                                    <apex:variable var="PSFActual_Vol_Pure" 
                                                   value="{!PSFActual_Vol_Pure+ PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c}"
                                                   rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=0}" />
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=0}" >
                                                <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine"   rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="PSFActual_Vol_Pure" value="{!PSFActual_Vol_Pure+ PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c}"/>
                                    <tr>
                                        <td>                                            
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c!=null && PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c!=0}" >
                                                <apex:param value="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c==null || PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        <td style="border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}   "
                            align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" >
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey"  
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }"  >
                                    <apex:variable var="PSFCap_Collection_Vol_Pure" 
                                                   value="{!PSFCap_Collection_Vol_Pure+ PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c}" 
                                                   rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=0}" />
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}" 
                                                             rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=0}" >
                                                <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c==null || PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat> 
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine"   rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="PSFCap_Collection_Vol_Pure" value="{!PSFCap_Collection_Vol_Pure+ PaymentLine.ASI_CRM_CTD_BC_Pure__c}"/>
                                    <tr>
                                        <td>                                            
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PaymentLine.ASI_CRM_CTD_BC_Pure__c!=null && PaymentLine.ASI_CRM_CTD_BC_Pure__c!=0}" >
                                                <apex:param value="{!PaymentLine.ASI_CRM_CTD_BC_Pure__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CTD_BC_Pure__c==null || PaymentLine.ASI_CRM_CTD_BC_Pure__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        
                        
                        <td style="border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  "
                            align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" >
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey"  
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }"  >
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c!=0 && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c!=0 }">
                                                <apex:param value="{!(PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c/PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c)*100}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c==null || PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Pure__c==0 || PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Pure__c==0 }" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine"   rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c!=null && PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c!=0 && PaymentLine.ASI_CRM_CTD_BC_Pure__c!=0 }">
                                                <apex:param value="{!(PaymentLine.ASI_CRM_CTD_BC_Pure__c/PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c)*100}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c==null || PaymentLine.ASI_CRM_CTD_Actual_Vol_Pure__c==0 || PaymentLine.ASI_CRM_CTD_BC_Pure__c==0 }" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        <td style="border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}   "
                            align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0" >
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <apex:variable var="PSFActual_Vol_Martell"  
                                                   value="{!PSFActual_Vol_Martell+ PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c}" 
                                                   rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=0}"  />
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=0}" >
                                                <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c==null ||PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine"   rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="PSFActual_Vol_Martell" value="{!PSFActual_Vol_Martell+ PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c}"/>
                                    <tr>
                                        <td>                                            
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c!=null && PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c!=0}" >
                                                <apex:param value="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c==null || PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        <td style="border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  "
                            align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0"  >
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey"  
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <apex:variable var="PSFCap_Collection_Vol_Martell" 
                                                   value="{!PSFCap_Collection_Vol_Martell+ PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c}" 
                                                   rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=0}" />
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=0}" >
                                                <apex:param value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c==null || PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat> 
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine"   rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <apex:variable var="PSFCap_Collection_Vol_Martell" value="{!PSFCap_Collection_Vol_Martell+ PaymentLine.ASI_CRM_CTD_BC_Martell__c}"/>
                                    <tr>
                                        <td>                                            
                                            <apex:outputText value="{0,number,#,###,###}" rendered="{!PaymentLine.ASI_CRM_CTD_BC_Martell__c!=null && PaymentLine.ASI_CRM_CTD_BC_Martell__c!=0}" >
                                                <apex:param value="{!PaymentLine.ASI_CRM_CTD_BC_Martell__c}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CTD_BC_Martell__c==null || PaymentLine.ASI_CRM_CTD_BC_Martell__c==0}" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>
                        
                        
                        
                        
                        <td style="border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  "
                            align="center">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0"  >
                                <apex:repeat value="{!PSFMap[ModuleId].ContractLineMap[DetailLineId]}" var="LineKey" 
                                             rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade' || PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Category' }" >
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=null && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c!=0 && PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c!=0 }">
                                                <apex:param value="{!(PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c/PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c)*100}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c==null || PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_Actual_Vol_Martell__c==0 || PSFMap[ModuleId].ContractLineMap[DetailLineId][LineKey].PaymenDetailList[0].ASI_CRM_CTD_BC_Martell__c==0 }" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                                <apex:repeat value="{!PSFMap[ModuleId].DetailLineMap[DetailLineId].PaymenDetailList}" var="PaymentLine"   rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Total'}">
                                    <tr>
                                        <td>
                                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c!=null && PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c!=0 && PaymentLine.ASI_CRM_CTD_BC_Martell__c!=0 }">
                                                <apex:param value="{!(PaymentLine.ASI_CRM_CTD_BC_Martell__c/PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c)*100}" />
                                            </apex:outputText>
                                            <apex:outputText value=" - " rendered="{!PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c==null || PaymentLine.ASI_CRM_CTD_Actual_Vol_Martell__c==0 || PaymentLine.ASI_CRM_CTD_BC_Martell__c==0 }" />
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </table>
                        </td>                        
                        
                        
                    </tr>        
                    
                    
                    
                    
                    
                    
                    
                    
                    <tr>
                        <td colspan="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','3','1')} "  align="right" 
                            style="border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                            width="32%">
                            <strong>Total:</strong></td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none',' ')}" 
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}" ><apex:param value="{!TotalIncentiveTarget}" /></apex:outputText>
                        </td>       
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!TotalFullContractTarget}" /></apex:outputText>
                        </td>                        
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!CTDActualVol}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!CapCollectionVol}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!CTDActualVol!=0 &&  CapCollectionVol!=0}">
                                <apex:param value="{!(CapCollectionVol/CTDActualVol)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!CTDActualVol==0 || CapCollectionVol==0}"/>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!PayableVol}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}" ><apex:param value="{!TotalPayable}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!TotalFullContractTarget!=0 &&  PayableVol!=0}">
                                <apex:param value="{!(PayableVol/TotalFullContractTarget)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!TotalFullContractTarget==0 || PayableVol==0}"/>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')} " 
                            align="right" width="8%" bgcolor="#E4E7E7">
                        </td>
                        
                        
                        
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}  "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFActual_Vol_Pure}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFCap_Collection_Vol_Pure}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFActual_Vol_Pure!=0 &&  PSFCap_Collection_Vol_Pure!=0}">
                                <apex:param value="{!(PSFCap_Collection_Vol_Pure/PSFActual_Vol_Pure)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!PSFActual_Vol_Pure==0 || PSFCap_Collection_Vol_Pure==0}"/>
                        </td>
                        
                        
                                                
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFActual_Vol_Martell}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;  {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')}"
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFCap_Collection_Vol_Martell}" /></apex:outputText>
                        </td>
                        <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','display:none;','')} "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFActual_Vol_Martell!=0 &&  PSFCap_Collection_Vol_Martell!=0}">
                                <apex:param value="{!(PSFCap_Collection_Vol_Martell/PSFActual_Vol_Martell)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!PSFActual_Vol_Martell==0 || PSFCap_Collection_Vol_Martell==0}"/>
                        </td>
                        
                        
                    </tr>
                    
                    
                    
                    <tr STYLE="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Grade','','display:none;')} ">
                        <td colspan="1"  align="right" 
                            style=" border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                            width="32%">
                            <strong>Total (Excl. Premium and below) :</strong>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" 
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}" ><apex:param value="{!Incentive_ExclPremium}" /></apex:outputText>
                        </td>       
                        <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!Full_Contract_Target_ExclPremium}" /></apex:outputText>
                        </td>                        
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!Intake_ExclPremium}" /></apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!BC_ExclPremium}" /></apex:outputText>
                        </td>
                        <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!Intake_ExclPremium!=0 &&  BC_ExclPremium!=0}">
                                <apex:param value="{!(BC_ExclPremium/Intake_ExclPremium)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!Intake_ExclPremium==0 || BC_ExclPremium==0}"/>
                        </td>
                        
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0.00}" ><apex:param value="{!PayableAmount_ExclPremium}" /></apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" width="8%" bgcolor="#E4E7E7">
                            <!-----<apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Completion_Ratio__c!=0}">
                                <apex:param value="{!PSFMap[ModuleId].Module.ASI_CRM_Completion_Ratio__c}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Completion_Ratio__c==0}"/>---->
                            
                             <apex:outputText value="{0,number,#,###,###}%" rendered="{!Volume_ExclPremium!=0 &&  Full_Contract_Target_ExclPremium!=0}">
                                <apex:param value="{!(Volume_ExclPremium/Full_Contract_Target_ExclPremium)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!Volume_ExclPremium==0 || Full_Contract_Target_ExclPremium==0}"/>
                        </td>
                       
                        
                        
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;   "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!Intake_Pure_ExclPremium}" /></apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;  "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!BC_Pure_ExclPremium}" /></apex:outputText>
                        </td>
                        <td style="border-bottom: 1px solid black; border-right: 1px solid black;  "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!Intake_Pure_ExclPremium!=0 &&  BC_Pure_ExclPremium!=0}">
                                <apex:param value="{!(BC_Pure_ExclPremium/Intake_Pure_ExclPremium)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!Intake_Pure_ExclPremium==0 || BC_Pure_ExclPremium==0}"/>
                        </td>
                        
                        
                                                
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;  "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!Intake_Martell_ExclPremium}" /></apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black; "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0, number, ###,###,###,###,##0}"><apex:param value="{!PSFCap_Collection_Vol_Martell}" /></apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black; "
                            align="right" width="8%" bgcolor="#E4E7E7">
                            <apex:outputText value="{0,number,#,###,###}%" rendered="{!Intake_Martell_ExclPremium!=0 &&  BC_Martell_ExclPremium!=0}">
                                <apex:param value="{!(BC_Martell_ExclPremium/Intake_Martell_ExclPremium)*100}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!Intake_Martell_ExclPremium==0 || BC_Martell_ExclPremium==0}"/>
                        </td>
                    </tr>
                    
                    
                    
                    <tr >
                        <td colspan="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','8','7')} "  style="height :0.01em"  >&nbsp;</td>
                    </tr>
                    
                </apex:repeat>
                
                
                <tr>
                    <th style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >&nbsp;</th>
                    <th style="border-top: 1px solid black; border-left: 1px solid black;">TOTAL </th>
                    <td align="right" style="border-top: 1px solid black;">&nbsp;</td>
<!--                     <td align="right" style="border-top: 1px solid black;">&nbsp;</td>
 -->                   <td align="right" style="border-top: 1px solid black;" bgcolor="#E4E7E7">
                        <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!TotalFullContractTargetAll}" /></apex:outputText>
                    </td>
                    <td align="right" style="border-top: 1px solid black;" bgcolor="#E4E7E7">
                        <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!TotalCTDActualVol}" /></apex:outputText>
                    </td>
                    
                    <td align="right" style="border-top: 1px solid black;" bgcolor="#E4E7E7">
                        <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!TotalCapCollectionVol}" /></apex:outputText>
                    </td>
                    
                    <td align="right" style="border-top: 1px solid black;" bgcolor="#E4E7E7">
                        
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFActual_Vol!=0 &&  PSFCap_Collection_Vol!=0}">
                            <apex:param value="{!(PSFCap_Collection_Vol/PSFActual_Vol)*100}" ></apex:param></apex:outputText>
                        <apex:outputText value=" - " rendered="{!PSFActual_Vol==0 || PSFCap_Collection_Vol==0}"/>
                        
                    </td>
                    
                    
                    <td align="right" style="border-top: 1px solid black;{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')} " bgcolor="#E4E7E7">
                        <apex:outputText value="{0, number, ###,###,###,###,##0}" ><apex:param value="{!TotalPayableVol}" /></apex:outputText>
                    </td>
                    
                    <td align="right" style="border-top: 1px solid black;" bgcolor="#E4E7E7">
                        <apex:outputText value="{0, number, ###,###,###,###,##0.00}" ><apex:param value="{!TotalPayableAmount}" /></apex:outputText>
                    </td>
                    <td align="right" style="border-top: 1px solid black; border-right: 1px solid black;" bgcolor="#E4E7E7">
                           <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Completion_Ratio__c!=0}">
                                <apex:param value="{!PSFMap[ModuleId].Module.ASI_CRM_Completion_Ratio__c}" ></apex:param></apex:outputText>
                            <apex:outputText value=" - " rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Completion_Ratio__c==0}"/>
                    </td>
                </tr>
                
                <tr>
                    <th style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  ">&nbsp;</th>
                    <th  colspan="3"  style="border-left: 1px solid black;">已支付金额(Historical Paid Amount)</th>
                    <td align="right" style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td  align="right" bgcolor="#E4E7E7">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Historical_Paid_Amount__c!=null}">
                            <apex:param value="{!PSFMap[ModuleId].Module.ASI_CRM_Historical_Paid_Amount__c}" /></apex:outputText>
                        <apex:outputText value="-" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Historical_Paid_Amount__c==null}" />
                    </td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                
                <tr>
                    <th style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  ">&nbsp;</th>
                    <th  colspan="3"  style="border-left: 1px solid black;">预计支付金额 (Application payment amt.)</th>
                    <td align="right" style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" >&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right" bgcolor="#E4E7E7">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Application_Payment_Amount__c!=null}">
                            <apex:param value="{!PSFMap[ModuleId].Module.ASI_CRM_Application_Payment_Amount__c}" /></apex:outputText>
                        <apex:outputText value="-" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Application_Payment_Amount__c==null}" />
                    </td> 
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                
                <tr>
                    <th style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  ">&nbsp;</th>
                    <th style="border-left: 1px solid black;">调整 (Adjustment)</th>
                    <td align="right" style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}"  >&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right">&nbsp;</td>
                    <td align="right" bgcolor="#E4E7E7">
                        <apex:outputText value="{0,number,#,###,###}%" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Adjustment__c!=null}">
                            <apex:param value="{!PSFMap[ModuleId].Module.ASI_CRM_Adjustment__c}" /></apex:outputText>
                        <apex:outputText value="100%" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Adjustment__c==null}" />
                    </td>
                    <td style="border-right: 1px solid black;" align="right">&nbsp;</td>
                </tr>
                
                <tr>
                    <th style="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}  " >&nbsp;</th>
                    <th colspan="3" style="border-left: 1px solid black; border-bottom: 1px solid black;"  bgcolor="#E4E7E7">实际支付 (Actual Payment)</th>
                    <td style="border-bottom: 1px solid black; {!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','','display:none;')}" align="right" bgcolor="#E4E7E7">&nbsp;</td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E4E7E7">&nbsp;</td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E4E7E7">&nbsp;</td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E4E7E7">&nbsp;</td>
                    <td style="border-bottom: 1px solid black;" align="right" bgcolor="#E4E7E7">
                        <apex:outputText value="{0,number,#,###,###.00}" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Actual_Payment__c!=null}">
                            <apex:param value="{!PSFMap[ModuleId].Module.ASI_CRM_Actual_Payment__c}" /></apex:outputText>
                        <apex:outputText value="-" rendered="{!PSFMap[ModuleId].Module.ASI_CRM_Actual_Payment__c==null}" />
                    </td>
                  <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E4E7E7">&nbsp;</td>

                </tr>
                
                <tr style=" {!IF(PSFMap[ModuleId].HaveHistoricalPaymentSummary,'','display:none;')}  " >
                    <td colspan="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','8','7')} "   >
                        已支付金额汇总 Historical Paid Amt. Summary
                    </td>
                </tr>
                
                <tr style=" {!IF(PSFMap[ModuleId].HaveHistoricalPaymentSummary,'','display:none;')}  " >
                    <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black; border-left: 1px solid black;" >Payment Request No.</td>
                    <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;"   >PSF Start Date</td>
                    <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;"  >PSF End Date</td>
                    <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;"  >PSF Actual Paid Amt.</td>
                    <td style="border-top: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;" >Status</td>
                    <td colspan="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','3','2')} " ></td>
                    
                </tr>
                
                <apex:repeat value="{!PSFMap[ModuleId].HistoricalModuleList}" var="HistoricalModule">
                    <tr style=" {!IF(PSFMap[ModuleId].HaveHistoricalPaymentSummary,'','display:none;')}  "  >
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;border-left: 1px solid black;" >{!HistoricalModule.ASI_CRM_Payment_Request__r.Name}</td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" >
                            
                            <apex:outputText value="{0,date,yyyy/MM/dd}">
                                <apex:param value="{!HistoricalModule.ASI_CRM_Payment_Request__r.ASI_CRM_CN_PO_Start_Date__c}" />
                            </apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" >
                            <apex:outputText value="{0,date,yyyy/MM/dd}">
                                <apex:param value="{!HistoricalModule.ASI_CRM_End_Date__c}" />
                            </apex:outputText>
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" align="right" >
                            <apex:outputText value="{0,number,#,###,###.00}" rendered="{!HistoricalModule.ASI_CRM_Actual_Payment__c!=null}">
                                <apex:param value="{!HistoricalModule.ASI_CRM_Actual_Payment__c}" />
                            </apex:outputText>
                            <apex:outputText value="-" rendered="{!HistoricalModule.ASI_CRM_Actual_Payment__c==null}" />
                        </td>
                        <td style=" border-bottom: 1px solid black; border-right: 1px solid black;" >{!HistoricalModule.ASI_CRM_Payment_Request__r.ASI_TH_CRM_Status__c }</td>
                        <td colspan="{!IF(PSFMap[ModuleId].Module.ASI_CRM_Volume_Base__c=='By Sub-Brand','3','2')} "  ></td>
                        
                    </tr>
                    
                </apex:repeat>                
            </table>
            
            <div style=" {!IF(ModuleCoun==ModuleNumber,'','page-break-after:always;')}  "/>
        </apex:repeat>
    </body>
    
    
</apex:component>