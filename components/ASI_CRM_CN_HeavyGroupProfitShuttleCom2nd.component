<!--
  @File Name          : ASI_CRM_CN_HeavyGroupProfitShuttleCom2nd.component
  @Description        : 
  @Author             : pengchen@bluelinksys.com
  @Group              : 
  @Last Modified By   : pengchen@bluelinksys.com
  @Last Modified On   : 5/8/2020, 4:09:11 PM
  @Modification Log   : 
  Ver       Date            Author                  Modification
  1.0    4/3/2020   pengchen@bluelinksys.com     Initial Version
-->
<apex:component controller="ASI_CRM_CN_HeavyGroupProfitShuttleCtrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar" />
    <apex:attribute name="Contractid" description="ID of Contract for PDF printout" type="id" assignto="{!PageId}" />
    <apex:attribute name="PDF" description="Check AD identity" type="string" assignto="{!strPDF}" />

    <head>
        <!-- <title>集团合同合并利润分析表</title> -->
    </head>
    <div class="header" style="font-family:  Arial Unicode MS;">
        <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr>
                <td align="center">
                    <apex:image height="2cm" width="7cm" url="{!URLFOR($Resource.ASI_MFM_CN_Logo)}" />
                </td>
            </tr>
            <tr>
                <td align="center" style="font-size:17px; font-weight:bold;  ">CONSOLIDATED CONTRACT PROFITABILITY
                    SHUTTLE FOR GROUP CONTRACT</td>
            </tr>
            <tr>
                <td align="center" style="font-size:17px; font-weight:bold;  ">集团合同合并利润分析表</td>
            </tr>
        </table>
    </div>

    <body style=" font-size:10px;margin-top: -20px;font-family: Arial Unicode MS;">
        <br />
        <table width="50%" cellspacing="0">
            <tr>
                <td>KA Account</td>
                <td>{!thisCC.ASI_CRM_NationalGroup__r.name}</td>
            </tr>
            <tr>
                <td>Contract Sequence</td>
                <td>{!thisCC.Name}</td>
            </tr>

        </table>
        <br />
        <!-- <table width="70%" border="0" cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <td bgcolor="#99CCFF" style="border:1px solid black;" colspan="6">
                        <strong>
                            <apex:outputText value="Variable Cost Investment Methodology (变动费用投资方式)" />
                        </strong>
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        New Contract
                    </td>
                    <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                        符合PRC建议方式？
                    </td>
                    <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                        销售折扣计算方式
                    </td>
                    <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                        销量计算基础销量
                    </td>
                    <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                        单位
                    </td>
                    <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                        备注
                    </td>
                </tr>
            </thead>

            <tr>
                <td
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    BRSF(空瓶回收费)
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    Yes
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.Name}" rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.ASI_CRM_Chinese_Name__c} "
                        rendered="{!showCN}" />
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Volume_Base__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Unit__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    备注
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod1__c!=null,'','display:none;')}  ">
                <td
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    PSF(空瓶回收服务费) - 1
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    符合PRC建议方式？
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.Name}" rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.ASI_CRM_Chinese_Name__c} "
                        rendered="{!showCN}" />
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Volume_Base_Mod1__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Unit_Mod1__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    备注
                </td>
            </tr>

            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod2__c!=null,'','display:none;')}  ">
                <td
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    PSF(空瓶回收服务费) - 2
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    符合PRC建议方式？
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.Name}" rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.ASI_CRM_Chinese_Name__c} "
                        rendered="{!showCN}" />
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Volume_Base_Mod2__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Unit_Mod2__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    备注
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod3__c!=null,'','display:none;')}  ">
                <td
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    PSF(空瓶回收服务费) - 3
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    符合PRC建议方式？
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.Name}" rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.ASI_CRM_Chinese_Name__c} "
                        rendered="{!showCN}" />
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Volume_Base_Mod3__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Unit_Mod3__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    备注
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_VEC_Methodology__c!=null,'','display:none;')}  ">
                <td
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    Variable Event Cost活动费用（变动）</td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    符合PRC建议方式？
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.Name}" rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.ASI_CRM_Chinese_Name__c} "
                        rendered="{!showCN}" />
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Volume_Base__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Unit__c}"/>
                </td>
                <td style=" border-right: 1px solid black; border-bottom: 1px solid black;">
                    备注
                </td>
            </tr>
        </table> -->
        <!-- <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td bgcolor="#99CCFF" style="border:1px solid black;" colspan="2">
                    <strong><apex:outputText value="Variable Cost Investment Methodology (变动费用投资方式)" />
                    </strong>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">New Contract </td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">BRSF(空瓶回收费)</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod1__c!=null,'','display:none;')}  ">
                <td  style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >PSF(空瓶回收服务费) - 1</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod2__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">PSF(空瓶回收服务费) - 2</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod3__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >PSF(空瓶回收服务费) - 3</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_VEC_Methodology__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >Variable Event Cost活动费用（变动）</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
        </table> -->
        <br />

         <table width="100%" border="0" cellspacing="0" cellpadding="2">
            <tr style="vertical-align: bottom;">
                <td width="20%"  align="center" style="border-right: 1px solid black;border-bottom: 1px solid black;border-top: 1px solid black;border-left: 1px solid black;" ></td>
                <td width="10%" style="white-space: pre; border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;"  align="center">Contract Sequence<br/>合同序号</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black; "  align="center">Start Date<br/>开始日期</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">End Date<br/>结束日期</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Nb of Months<br/>月数</td>
                <td width="15%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Covered outlet<br/>覆盖店家数</td>
                <td width="10%" style="white-space: pre;border-right: 1px solid black; border-top: 1px solid black; border-bottom: 1px solid black;" align="center">Sales Rep 销售</td>
                <td width="15%"></td>
                <td width="10%" ></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style=" border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Historical Contract vfinal 历史合同实际</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.Name}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.ASI_CRM_Remarks__c}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.ASI_CRM_CN_Description__c}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!HistoricalContract.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalCoveredOutletSize}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!HistoricalContract.Owner.Name}</td>
                <td ></td>
                <td ></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT V0.0<br/>新合同</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Name}</td>
                <!-- <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_CRM_SG_PRS_Contract_No__c}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_TH_CRM_Target_Distribution_Channel__c}</td> -->
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoStartDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoEndDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!V0CoveredOutletSize}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">
                    {!thisCC.Owner.Name}
                </td>
                <td  align="center"></td>
                <td ></td>
            </tr>
            <tr style="vertical-align: bottom;">
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;">NEW CONTRACT VFinal<br/>新合同</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.Name}</td>
                <!-- <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_CRM_SG_PRS_Contract_No__c}</td> 
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!thisCC.ASI_TH_CRM_Target_Distribution_Channel__c}</td>-->
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoStartDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!PoEndDateStr}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;"><apex:outputText value="{0,number,#,###,###}" ><apex:param value="{!thisCC.ASI_CRM_CN_No_of_Months__c}" /></apex:outputText></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">{!VFinalCoveredOutletSize}</td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;">
                    {!thisCC.Owner.Name}
                </td>
                <td  align="center"></td>
                <td ></td>
            </tr>
        </table>
        <br/>

        <table width="100%" border="0" cellpadding="3" cellspacing="0">
            <thead>
            <tr>
                <td colspan="{!IF(ExistHistoricalData,'10','7')} " bgcolor="#99CCFF" style="border:1px solid black;">
                    <strong>
                        <apex:outputText value="P&L REVIEW (in RMB) 利润分析表 （元）" /></strong>
                </td>
            </tr>

            <tr>
                <td rowspan="2"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    &nbsp;
                </td>
                <td colspan="3"
                    style=" {!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black; border-bottom: 1px solid black;"
                    align="center">Historical Contract<br />历史合同
                </td>
                <td colspan="{!IF(ExistHistoricalData,'3','2')}"
                    style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">New
                    Contract<br />新合同
                </td>
                <td colspan="2" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                    &nbsp;
                </td>
            </tr>

            <tr>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray; border-bottom: 1px solid black;"
                    align="center">v0.0<br />预估
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray; border-bottom: 1px solid black;"
                    align="center">vFinal<br />完成
                </td>
                <td style=" border-right: 1px solid black;  border-bottom: 1px solid black; {!IF(ExistHistoricalData,'','display:none;')}"
                    align="center">
                    % v0.0<br /> 对比预估
                </td>
                <td style="border-right: 1px dotted gray; border-bottom: 1px solid black;" align="center">
                    Estimated<br />预估
                </td>
                <td style=" border-right: 1px dotted gray;  border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')}"
                    align="center">
                    %Vfinal<br />对比历史完成
                </td>
                <td style=" border-right: 1px solid black;  border-bottom: 1px solid black;" align="center">
                    Contract<br />合同
                </td>
                <td style="border-right: 1px dotted gray; border-bottom: 1px solid black;" align="center">
                    Vfinal
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                    %v0.0 Estimate
                    <br /> 对比新合同 V final
                </td>
            </tr>
            </thead>
            <tr>
                <td
                    style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    Volumes 销量 (in 9L cs)
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!HistoricalV00Contract2nd.Volumes!=0&&HistoricalV00Contract2nd.Volumes!=null}">
                        <apex:param value="{!HistoricalV00Contract2nd.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.Volumes==0||HistoricalV00Contract2nd.Volumes==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!HistoricalVFinalContract2nd.Volumes!=0 && HistoricalVFinalContract2nd.Volumes!=null}">
                        <apex:param value="{!HistoricalVFinalContract2nd.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.Volumes==0||HistoricalVFinalContract2nd.Volumes==null}" />
                </td>
                
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.Volumes!=null && HistoricalV00Contract2nd.Volumes!=0 && HistoricalVFinalContract2nd.Volumes!=null}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.Volumes/HistoricalV00Contract2nd.Volumes)-1)*100}"/>
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.Volumes==0||HistoricalV00Contract2nd.Volumes==null}" />
                </td>
                
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!NewContractV0Esitimate2nd.Volumes!=0 && NewContractV0Esitimate2nd.Volumes!=null}">
                        <apex:param value="{!NewContractV0Esitimate2nd.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.Volumes==0||NewContractV0Esitimate2nd.Volumes==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.Volumes!=null && HistoricalVFinalContract2nd.Volumes!=0 && HistoricalV00Contract2nd.Volumes!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.Volumes/HistoricalVFinalContract2nd.Volumes)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.Volumes==0||HistoricalVFinalContract2nd.Volumes==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!NewContactV0Contract2nd.Volumes!=0 && NewContactV0Contract2nd.Volumes!=null}">
                        <apex:param value="{!NewContactV0Contract2nd.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.Volumes==0 || NewContactV0Contract2nd.Volumes==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!NewContactVFinal2nd.Volumes!=0 && NewContactVFinal2nd.Volumes!=null}">
                        <apex:param value="{!NewContactVFinal2nd.Volumes}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.Volumes==0 || NewContactVFinal2nd.Volumes==null}" />
                </td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.Volumes!=null && NewContactV0Contract2nd.Volumes!=0 && NewContractV0Esitimate2nd.Volumes!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.Volumes/NewContactV0Contract2nd.Volumes)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.Volumes==0||NewContractV0Esitimate2nd.Volumes==null}" />
                </td>
            </tr>

            <apex:repeat value="{!byCategoryMap}" var="sbgroup">
                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">
                        {!byCategoryMap[sbgroup]}
                    </td>

                    <td style="{!IF(ExistHistoricalData,'','display:none;')}; border-right: 1px dotted gray;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!HistoricalV00Contract2nd.CategoryMap[sbgroup]!=0 && HistoricalV00Contract2nd.CategoryMap[sbgroup]!=null}">
                            <apex:param value="{!HistoricalV00Contract2nd.CategoryMap[sbgroup]}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalV00Contract2nd.CategoryMap[sbgroup]==0 || HistoricalV00Contract2nd.CategoryMap[sbgroup]==null}" />
                    </td>

                    <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!HistoricalVFinalContract2nd.CategoryMap[sbgroup]!=0 && HistoricalVFinalContract2nd.CategoryMap[sbgroup]!=null}">
                            <apex:param value="{!HistoricalVFinalContract2nd.CategoryMap[sbgroup]}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalVFinalContract2nd.CategoryMap[sbgroup]==0 || HistoricalVFinalContract2nd.CategoryMap[sbgroup]==null}" />
                    </td>

                    <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!(HistoricalVFinalContract2nd.CategoryMap[sbgroup]!=null && HistoricalVFinalContract2nd.CategoryMap[sbgroup]!=0) && (HistoricalV00Contract2nd.CategoryMap[sbgroup]!=null && HistoricalV00Contract2nd.CategoryMap[sbgroup]!=0)}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.CategoryMap[sbgroup]/HistoricalV00Contract2nd.CategoryMap[sbgroup])-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!(HistoricalV00Contract2nd.CategoryMap[sbgroup]==0 || HistoricalV00Contract2nd.CategoryMap[sbgroup]==null) 
                                        || (HistoricalVFinalContract2nd.CategoryMap[sbgroup]==0 || HistoricalVFinalContract2nd.CategoryMap[sbgroup]==null)}" />
                    </td>
                    <td style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.CategoryMap[sbgroup]!=0 && NewContractV0Esitimate2nd.CategoryMap[sbgroup]!=null}">
                            <apex:param value="{!NewContractV0Esitimate2nd.CategoryMap[sbgroup]}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.CategoryMap[sbgroup]==0 || NewContractV0Esitimate2nd.CategoryMap[sbgroup]==null}" />
                    </td>
                    <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;"
                    align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!(HistoricalVFinalContract2nd.CategoryMap[sbgroup]!=null && HistoricalVFinalContract2nd.CategoryMap[sbgroup]!=0) && (NewContractV0Esitimate2nd.CategoryMap[sbgroup]!=null && NewContractV0Esitimate2nd.CategoryMap[sbgroup]!=0)}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.CategoryMap[sbgroup]/HistoricalVFinalContract2nd.CategoryMap[sbgroup])-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!(NewContractV0Esitimate2nd.CategoryMap[sbgroup]==0 || NewContractV0Esitimate2nd.CategoryMap[sbgroup]==null) 
                                        || (HistoricalVFinalContract2nd.CategoryMap[sbgroup]==0 || HistoricalVFinalContract2nd.CategoryMap[sbgroup]==null)}" />
                    </td>
                    <td style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.CategoryMap[sbgroup]!=0 && NewContactV0Contract2nd.CategoryMap[sbgroup]!=null}">
                            <apex:param value="{!NewContactV0Contract2nd.CategoryMap[sbgroup]}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.CategoryMap[sbgroup]==0 || NewContactV0Contract2nd.CategoryMap[sbgroup]==null}" />
                    </td>

                    <td style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactVFinal2nd.CategoryMap[sbgroup]!=0 && NewContactVFinal2nd.CategoryMap[sbgroup]!=null}">
                            <apex:param value="{!NewContactVFinal2nd.CategoryMap[sbgroup]}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactVFinal2nd.CategoryMap[sbgroup]==0 || NewContactVFinal2nd.CategoryMap[sbgroup]==null}" />
                    </td>
                    <td style="border-right: 1px solid black; " align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!(NewContractV0Esitimate2nd.CategoryMap[sbgroup]!=null && NewContractV0Esitimate2nd.CategoryMap[sbgroup]!=0) && (NewContactV0Contract2nd.CategoryMap[sbgroup]!=null && NewContactV0Contract2nd.CategoryMap[sbgroup]!=0)}">
                            <apex:param value="{!((NewContractV0Esitimate2nd.CategoryMap[sbgroup]/NewContactV0Contract2nd.CategoryMap[sbgroup])-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!(NewContractV0Esitimate2nd.CategoryMap[sbgroup]==null || NewContractV0Esitimate2nd.CategoryMap[sbgroup]==0) || (NewContactV0Contract2nd.CategoryMap[sbgroup]==null || NewContactV0Contract2nd.CategoryMap[sbgroup]==0)}" />
                    </td>
                </tr>
            </apex:repeat>

            <!-- Gross Sales 营业额 -->
            <apex:variable rendered="{!contains(groupStr,'C')}" value="" var="">
            <tr>
                <td style="border-top: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">
                    Gross Sales 营业额</td>
                <td style="border-top: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!HistoricalV00Contract2nd.GrossSalesTotal!=null&& HistoricalV00Contract2nd.GrossSalesTotal!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.GrossSalesTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.GrossSalesTotal==null || HistoricalV00Contract2nd.GrossSalesTotal==0}" />
                </td>
                <td style="border-top: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal!=null && HistoricalVFinalContract2nd.GrossSalesTotal!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.GrossSalesTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal==null || HistoricalVFinalContract2nd.GrossSalesTotal==0}" />
                </td>

                <td style="border-top: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalV00Contract2nd.GrossSalesTotal!=null && HistoricalV00Contract2nd.GrossSalesTotal!=0 && HistoricalVFinalContract2nd.GrossSalesTotal!=null}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.GrossSalesTotal/HistoricalV00Contract2nd.GrossSalesTotal)-1)*100}"/>
                    </apex:outputText>
                    <apex:outputText value=" - "
                            rendered="{!HistoricalV00Contract2nd.GrossSalesTotal==0||HistoricalV00Contract2nd.GrossSalesTotal==null}" />
                </td>
                <td style="border-top: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesTotal!=null&& NewContractV0Esitimate2nd.GrossSalesTotal!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesTotal==null || NewContractV0Esitimate2nd.GrossSalesTotal==0}" />
                </td>
                <td style="border-top: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal!=null && HistoricalVFinalContract2nd.GrossSalesTotal!=0 && NewContractV0Esitimate2nd.GrossSalesTotal!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.GrossSalesTotal/HistoricalVFinalContract2nd.GrossSalesTotal)-1)*100}"/>
                    </apex:outputText>
                    <apex:outputText value=" - "
                            rendered="{!HistoricalVFinalContract2nd.GrossSalesTotal==0||HistoricalVFinalContract2nd.GrossSalesTotal==null}" />
                </td>
                <td style="border-top: 1px solid black;border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!NewContactV0Contract2nd.GrossSalesTotal!=null && NewContactV0Contract2nd.GrossSalesTotal!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.GrossSalesTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.GrossSalesTotal==null || NewContactV0Contract2nd.GrossSalesTotal==0}" />
                </td>
                <td style="border-top: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,###}"
                        rendered="{!NewContactVFinal2nd.GrossSalesTotal!=null && NewContactVFinal2nd.GrossSalesTotal!=0}">
                        <apex:param value="{!NewContactVFinal2nd.GrossSalesTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.GrossSalesTotal==null || NewContactVFinal2nd.GrossSalesTotal==0}" />
                </td>
                <td style="border-top: 1px solid black;border-right: 1px solid black;" align="right">&nbsp;
                    <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!NewContactV0Contract2nd.GrossSalesTotal!=null && NewContactV0Contract2nd.GrossSalesTotal!=0 && NewContractV0Esitimate2nd.GrossSalesTotal!=null}">
                            <apex:param value="{!((NewContractV0Esitimate2nd.GrossSalesTotal/NewContactV0Contract2nd.GrossSalesTotal)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesTotal==0||NewContractV0Esitimate2nd.GrossSalesTotal==null}" />
                </td>
            </tr>
            </apex:variable>
            <!-- CM before spending利润 -->
            <!-- <tr>
                <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">
                    CM before spending利润</td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!HistoricalV00Contract2nd.CMTotal!=null&& HistoricalV00Contract2nd.CMTotal!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.CMTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.CMTotal==null || HistoricalV00Contract2nd.CMTotal==0}" />
                </td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!HistoricalVFinalContract2nd.CMTotal!=null && HistoricalVFinalContract2nd.CMTotal!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.CMTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMTotal==null || HistoricalVFinalContract2nd.CMTotal==0}" />
                </td>

                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.CMTotal!=null && HistoricalV00Contract2nd.CMTotal!=0 }">
                        <apex:param value="{!((HistoricalVFinalContract2nd.CMTotal/HistoricalV00Contract2nd.CMTotal)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMTotal==null||HistoricalVFinalContract2nd.CMTotal==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContractV0Esitimate2nd.CMTotal!=null&& NewContractV0Esitimate2nd.CMTotal!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.CMTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMTotal==null || NewContractV0Esitimate2nd.CMTotal==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.CMTotal!=null && HistoricalVFinalContract2nd.CMTotal!=0 && HistoricalV00Contract2nd.CMTotal!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.CMTotal/HistoricalVFinalContract2nd.CMTotal)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMTotal==0||HistoricalVFinalContract2nd.CMTotal==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContactV0Contract2nd.CMTotal!=null && NewContactV0Contract2nd.CMTotal!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.CMTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.CMTotal==null || NewContactV0Contract2nd.CMTotal==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContactVFinal2nd.CMTotal!=null && NewContactVFinal2nd.CMTotal!=0}">
                        <apex:param value="{!NewContactVFinal2nd.CMTotal}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.CMTotal==null || NewContactVFinal2nd.CMTotal==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.CMTotal!=null && NewContactV0Contract2nd.CMTotal!=0 && NewContractV0Esitimate2nd.CMTotal!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.CMTotal/NewContactV0Contract2nd.CMTotal-1) *100) }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMTotal==null||NewContractV0Esitimate2nd.CMTotal==null}" />
                </td>
            </tr> -->

            <!-- Trade expenses 销售费用 -->
            <tr>
                <td style=" border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA">
                    <strong>Trade expenses 销售费用</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;" align="right"
                    bgcolor="#E3DFDA"><strong>
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!HistoricalV00Contract2nd.TradeExpenses!=null}">
                            <apex:param value="{!HistoricalV00Contract2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.TradeExpenses==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;" align="right"
                    bgcolor="#E3DFDA"><strong>
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!HistoricalVFinalContract2nd.TradeExpenses!=null}">
                            <apex:param value="{!HistoricalVFinalContract2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.TradeExpenses==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px solid black;" align="right"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalV00Contract2nd.TradeExpenses!=null && HistoricalV00Contract2nd.TradeExpenses!=0 }">
                        <apex:param value="{!((HistoricalVFinalContract2nd.TradeExpenses/HistoricalV00Contract2nd.TradeExpenses)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.TradeExpenses==null||HistoricalVFinalContract2nd.TradeExpenses==null}" />
                </td>
                <td style="border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA"><strong>
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContractV0Esitimate2nd.TradeExpenses!=null}">
                            <apex:param value="{!NewContractV0Esitimate2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.TradeExpenses==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;" bgcolor="#E3DFDA"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalVFinalContract2nd.TradeExpenses!=null && HistoricalVFinalContract2nd.TradeExpenses!=0 && HistoricalV00Contract2nd.TradeExpenses!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.TradeExpenses/HistoricalVFinalContract2nd.TradeExpenses)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.TradeExpenses==0||HistoricalVFinalContract2nd.TradeExpenses==null}" />
                </td>
                <td style=" border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <strong>
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContactV0Contract2nd.TradeExpenses!=null}">
                            <apex:param value="{!NewContactV0Contract2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.TradeExpenses==null}" />
                    </strong></td>
                <td style=" border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <strong>
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContactVFinal2nd.TradeExpenses!=null}">
                            <apex:param value="{!NewContactVFinal2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactVFinal2nd.TradeExpenses==null}" />
                    </strong>
                </td>
                <td style="border-right: 1px solid black;" bgcolor="#E3DFDA" align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!NewContactV0Contract2nd.TradeExpenses!=null && NewContactV0Contract2nd.TradeExpenses!=0 && NewContractV0Esitimate2nd.TradeExpenses!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.TradeExpenses/NewContactV0Contract2nd.TradeExpenses)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.TradeExpenses==0||NewContractV0Esitimate2nd.TradeExpenses==null}" />
                </td>
            </tr>

            <!-- Investment per  CR12 eq btl 折CR12单瓶投入 -->
            <!-- <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;" valign="top">Investment per
                    CR12 eq btl 折CR12单瓶投入</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right"
                    valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!HistoricalV00Contract2nd.InvestmentCR12!=null && HistoricalV00Contract2nd.InvestmentCR12!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.InvestmentCR12}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.InvestmentCR12==null || HistoricalV00Contract2nd.InvestmentCR12==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right"
                    valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!HistoricalVFinalContract2nd.InvestmentCR12!=null && HistoricalVFinalContract2nd.InvestmentCR12!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.InvestmentCR12}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.InvestmentCR12==null || HistoricalVFinalContract2nd.InvestmentCR12==0}" />
                </td>

                <td style="border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!NewContractV0Esitimate2nd.InvestmentCR12!=null && NewContractV0Esitimate2nd.InvestmentCR12!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.InvestmentCR12}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.InvestmentCR12==null || NewContractV0Esitimate2nd.InvestmentCR12==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right"
                    valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.InvestmentCR12!=null && HistoricalVFinalContract2nd.InvestmentCR12!=0 && HistoricalVFinalContract2nd.InvestmentCR12!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.InvestmentCR12-HistoricalVFinalContract2nd.InvestmentCR12)/HistoricalVFinalContract2nd.InvestmentCR12)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.InvestmentCR12==0||HistoricalVFinalContract2nd.InvestmentCR12==null}" />
                </td>
                <td style="border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!NewContactV0Contract2nd.InvestmentCR12!=null && NewContactV0Contract2nd.InvestmentCR12!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.InvestmentCR12}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.InvestmentCR12==null || NewContactV0Contract2nd.InvestmentCR12==0}" />
                </td>
                <td style="border-right: 1px dotted gray;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!NewContactVFinal2nd.InvestmentCR12!=null && NewContactVFinal2nd.InvestmentCR12!=0}">
                        <apex:param value="{!NewContactVFinal2nd.InvestmentCR12}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.InvestmentCR12==null || NewContactVFinal2nd.InvestmentCR12==0}" />
                </td>
                <td style="border-right: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContractV0Esitimate2nd.InvestmentCR12!=null && NewContractV0Esitimate2nd.InvestmentCR12!=0 && NewContactVFinal2nd.InvestmentCR12!=null}">
                        <apex:param value="{!((NewContactVFinal2nd.InvestmentCR12-NewContractV0Esitimate2nd.InvestmentCR12)/NewContractV0Esitimate2nd.InvestmentCR12)*100 }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.InvestmentCR12==0 ||NewContractV0Esitimate2nd.InvestmentCR12==null}" />

                </td>
            </tr> -->

            <!-- Variable expense 变动费用 -->
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">Variable expense 变动费用</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!HistoricalV00Contract2nd.VariableExpense!=null}">
                        <apex:param value="{!HistoricalV00Contract2nd.VariableExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.VariableExpense==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!HistoricalVFinalContract2nd.VariableExpense!=null}">
                        <apex:param value="{!HistoricalVFinalContract2nd.VariableExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.VariableExpense==null}" />
                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalV00Contract2nd.VariableExpense!=null && HistoricalV00Contract2nd.VariableExpense!=0 }">
                        <apex:param value="{!((HistoricalVFinalContract2nd.VariableExpense/HistoricalV00Contract2nd.VariableExpense)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.VariableExpense==null||HistoricalVFinalContract2nd.VariableExpense==null}" />

                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!NewContractV0Esitimate2nd.VariableExpense!=null}">
                        <apex:param value="{!NewContractV0Esitimate2nd.VariableExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.VariableExpense==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalVFinalContract2nd.VariableExpense!=null && HistoricalVFinalContract2nd.VariableExpense!=0 && HistoricalV00Contract2nd.VariableExpense!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.VariableExpense/HistoricalVFinalContract2nd.VariableExpense)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.VariableExpense==0||HistoricalVFinalContract2nd.VariableExpense==null}" />
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!NewContactV0Contract2nd.VariableExpense!=null}">
                        <apex:param value="{!NewContactV0Contract2nd.VariableExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==null}" />
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!NewContactVFinal2nd.VariableExpense!=null}">
                        <apex:param value="{!NewContactVFinal2nd.VariableExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal2nd.VariableExpense==null}" />
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!NewContactV0Contract2nd.VariableExpense!=null && NewContactV0Contract2nd.VariableExpense!=0 && NewContractV0Esitimate2nd.VariableExpense!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.VariableExpense/NewContactV0Contract2nd.VariableExpense)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.VariableExpense==0||NewContractV0Esitimate2nd.VariableExpense==null}" />
                </td>
            </tr>

            <!-- Fixed Expense 固定费用 -->
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense 固定费用</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!HistoricalV00Contract2nd.FixedExpense!=null}">
                        <apex:param value="{!HistoricalV00Contract2nd.FixedExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.FixedExpense==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!HistoricalVFinalContract2nd.FixedExpense!=null}">
                        <apex:param value="{!HistoricalVFinalContract2nd.FixedExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.FixedExpense==null}" />
                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalV00Contract2nd.FixedExpense!=null && HistoricalV00Contract2nd.FixedExpense!=0 }">
                        <apex:param value="{!((HistoricalVFinalContract2nd.FixedExpense/HistoricalV00Contract2nd.FixedExpense)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.FixedExpense==null||HistoricalVFinalContract2nd.FixedExpense==null}" />
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!NewContractV0Esitimate2nd.FixedExpense!=null}">
                        <apex:param value="{!NewContractV0Esitimate2nd.FixedExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpense==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalVFinalContract2nd.FixedExpense!=null && HistoricalVFinalContract2nd.FixedExpense!=0 && HistoricalV00Contract2nd.FixedExpense!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.FixedExpense/HistoricalVFinalContract2nd.FixedExpense)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.FixedExpense==0||HistoricalVFinalContract2nd.FixedExpense==null}" />
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="({0,number,#,###,###})"
                        rendered="{!NewContactV0Contract2nd.FixedExpense!=null}">
                        <apex:param value="{!NewContactV0Contract2nd.FixedExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpense==null}" />
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="({0,number,#,###,###})" rendered="{!NewContactVFinal2nd.FixedExpense!=null}">
                        <apex:param value="{!NewContactVFinal2nd.FixedExpense}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal2nd.FixedExpense==null}" />
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!NewContactV0Contract2nd.FixedExpense!=null && NewContactV0Contract2nd.FixedExpense!=0 && NewContractV0Esitimate2nd.FixedExpense!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.FixedExpense/NewContactV0Contract2nd.FixedExpense)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.FixedExpense==0||NewContractV0Esitimate2nd.FixedExpense==null}" />
                </td>
            </tr>

            <!-- Fixed expense % 固定费用比例 % -->
            <tr>
                <td
                    style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    Fixed expense % 固定费用比例 % </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!HistoricalV00Contract2nd.FixedExpenseRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalV00Contract2nd.FixedExpenseRate==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!HistoricalVFinalContract2nd.FixedExpenseRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate==null}" />
                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate!=null && HistoricalVFinalContract2nd.FixedExpenseRate!=0 }">
                        <apex:param value="{!(HistoricalVFinalContract2nd.FixedExpenseRate-HistoricalV00Contract2nd.FixedExpenseRate) }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate==null||HistoricalV00Contract2nd.FixedExpenseRate==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!NewContractV0Esitimate2nd.FixedExpenseRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate==null}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate!=null && HistoricalVFinalContract2nd.FixedExpenseRate!=0 && HistoricalV00Contract2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.FixedExpenseRate-HistoricalVFinalContract2nd.FixedExpenseRate)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.FixedExpenseRate==0||HistoricalVFinalContract2nd.FixedExpenseRate==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!NewContactV0Contract2nd.FixedExpenseRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpenseRate==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactVFinal2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!NewContactVFinal2nd.FixedExpenseRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!NewContactVFinal2nd.FixedExpenseRate==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                                        <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=null && NewContactV0Contract2nd.FixedExpenseRate!=0 && NewContractV0Esitimate2nd.FixedExpenseRate!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.FixedExpenseRate-NewContactV0Contract2nd.FixedExpenseRate)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate==0||NewContractV0Esitimate2nd.FixedExpenseRate==null}" />
                </td>
            </tr>

            <!-- % Gross Sales % 营业额 -->
            <apex:variable rendered="{!contains(groupStr,'C')}" value="" var="">
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.GrossSalesRateProForma!=null&& HistoricalV00Contract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.GrossSalesRateProForma==null || HistoricalV00Contract2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==null || HistoricalVFinalContract2nd.GrossSalesRateProForma==0}" />
                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0 }">
                        <apex:param value="{!(HistoricalVFinalContract2nd.GrossSalesRateProForma-HistoricalV00Contract2nd.GrossSalesRateProForma) }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==null||HistoricalV00Contract2nd.GrossSalesRateProForma==null}" />

                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma!=null&& NewContractV0Esitimate2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma==null || NewContractV0Esitimate2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0 && HistoricalV00Contract2nd.GrossSalesRateProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.GrossSalesRateProForma-HistoricalVFinalContract2nd.GrossSalesRateProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==0||HistoricalVFinalContract2nd.GrossSalesRateProForma==null}" />
                </td>
                <td style="border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=null && NewContactV0Contract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma==null || NewContactV0Contract2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactVFinal2nd.GrossSalesRateProForma!=null && NewContactVFinal2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContactVFinal2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.GrossSalesRateProForma==null || NewContactVFinal2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="border-right: 1px solid black;" align="right">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=null && NewContactV0Contract2nd.GrossSalesRateProForma!=0 && NewContractV0Esitimate2nd.GrossSalesRateProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.GrossSalesRateProForma-NewContactV0Contract2nd.GrossSalesRateProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma==0||NewContractV0Esitimate2nd.GrossSalesRateProForma==null}" />
                </td>
            </tr>
            </apex:variable>

            <!--Gross Sales 营业额(Pro-forma) -->
            <!-- <tr>
                <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales % 营业额 (Pro-forma)</td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.GrossSalesRateProForma!=null&& HistoricalV00Contract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.GrossSalesRateProForma==null || HistoricalV00Contract2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==null || HistoricalVFinalContract2nd.GrossSalesRateProForma==0}" />
                </td>

                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0 }">
                        <apex:param value="{!(HistoricalVFinalContract2nd.GrossSalesRateProForma-HistoricalV00Contract2nd.GrossSalesRateProForma) }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==null||HistoricalV00Contract2nd.GrossSalesRateProForma==null}" />

                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma!=null&& NewContractV0Esitimate2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma==null || NewContractV0Esitimate2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma!=null && HistoricalVFinalContract2nd.GrossSalesRateProForma!=0 && HistoricalV00Contract2nd.GrossSalesRateProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.GrossSalesRateProForma-HistoricalVFinalContract2nd.GrossSalesRateProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.GrossSalesRateProForma==0||HistoricalVFinalContract2nd.GrossSalesRateProForma==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=null && NewContactV0Contract2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma==null || NewContactV0Contract2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactVFinal2nd.GrossSalesRateProForma!=null && NewContactVFinal2nd.GrossSalesRateProForma!=0}">
                        <apex:param value="{!NewContactVFinal2nd.GrossSalesRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.GrossSalesRateProForma==null || NewContactVFinal2nd.GrossSalesRateProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=null && NewContactV0Contract2nd.GrossSalesRateProForma!=0 && NewContractV0Esitimate2nd.GrossSalesRateProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.GrossSalesRateProForma-NewContactV0Contract2nd.GrossSalesRateProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma==0||NewContractV0Esitimate2nd.GrossSalesRateProForma==null}" />
                </td>
            </tr> -->

            <!-- <tr style="{!IF(AdorAbove,'','display:none;')}">
                <apex:outputText value="{!MarginafterTableHeader}" escape="false" />
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!HistoricalV00Contract2nd.MarginAfterAnP!=null&& HistoricalV00Contract2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!HistoricalV00Contract2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalV00Contract2nd.MarginAfterAnP==0||HistoricalV00Contract2nd.MarginAfterAnP==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP!=null && HistoricalVFinalContract2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!HistoricalVFinalContract2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP==0 || HistoricalVFinalContract2nd.MarginAfterAnP==null}" />
                    </strong>
                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.MarginAfterAnP!=null && HistoricalV00Contract2nd.MarginAfterAnP!=0 && HistoricalVFinalContract2nd.MarginAfterAnP!=null}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.MarginAfterAnP/HistoricalV00Contract2nd.MarginAfterAnP)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP==0||HistoricalVFinalContract2nd.MarginAfterAnP==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                    bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP!=null && NewContractV0Esitimate2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP==0|| NewContractV0Esitimate2nd.MarginAfterAnP==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right"
                    bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.MarginAfterAnP!=null && HistoricalVFinalContract2nd.MarginAfterAnP!=0 && HistoricalV00Contract2nd.MarginAfterAnP!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.MarginAfterAnP/HistoricalVFinalContract2nd.MarginAfterAnP)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.Volumes==0||HistoricalVFinalContract2nd.Volumes==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"
                    bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!NewContactV0Contract2nd.MarginAfterAnP!=null && NewContactV0Contract2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.MarginAfterAnP==0 || NewContactV0Contract2nd.MarginAfterAnP==null}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"
                    bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!NewContactVFinal2nd.MarginAfterAnP!=null && NewContactVFinal2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContactVFinal2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactVFinal2nd.MarginAfterAnP==0 || NewContactVFinal2nd.MarginAfterAnP==null}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                    bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.MarginAfterAnP!=null && NewContactV0Contract2nd.MarginAfterAnP!=0 && NewContractV0Esitimate2nd.MarginAfterAnP!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.MarginAfterAnP/NewContactV0Contract2nd.MarginAfterAnP)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP==0||NewContractV0Esitimate2nd.MarginAfterAnP==null}" />
                </td>
            </tr> -->

            <!-- Cont. Margin per Bottle 单瓶利润 -->
            <!-- <tr style="{!IF(AdorAbove,'','display:none;')}"> -->
            <tr >
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                    bgcolor="#FFFF99"><strong>Cont. Margin per Case 单箱净利润</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!HistoricalV00Contract2nd.MarginPerCase!=null && HistoricalV00Contract2nd.MarginPerCase!=0}">
                            <apex:param value="{!HistoricalV00Contract2nd.MarginPerCase}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalV00Contract2nd.MarginPerCase==0 || HistoricalV00Contract2nd.MarginPerCase==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!HistoricalVFinalContract2nd.MarginPerCase!=null && HistoricalVFinalContract2nd.MarginPerCase!=0}">
                            <apex:param value="{!HistoricalVFinalContract2nd.MarginPerCase}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalVFinalContract2nd.MarginPerCase==0 || HistoricalVFinalContract2nd.MarginPerCase==null}" />
                    </strong>
                </td>

                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalV00Contract2nd.MarginPerCase!=null && HistoricalV00Contract2nd.MarginPerCase!=0 && HistoricalVFinalContract2nd.MarginPerCase!=null}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.MarginPerCase/HistoricalV00Contract2nd.MarginPerCase)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.MarginPerCase==0||HistoricalVFinalContract2nd.MarginPerCase==null}" />
                </td>

                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                    bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.MarginPerCase!=null && NewContractV0Esitimate2nd.MarginPerCase!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.MarginPerCase}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.MarginPerCase==0 || NewContractV0Esitimate2nd.MarginPerCase==null}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right"
                    bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!HistoricalVFinalContract2nd.MarginPerCase!=null && HistoricalVFinalContract2nd.MarginPerCase!=0 && HistoricalV00Contract2nd.MarginPerCase!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.MarginPerCase/HistoricalVFinalContract2nd.MarginPerCase)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.MarginPerCase==0||HistoricalVFinalContract2nd.MarginPerCase==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"
                    bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.MarginPerCase!=null && NewContactV0Contract2nd.MarginPerCase!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.MarginPerCase}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.MarginPerCase==0 || NewContactV0Contract2nd.MarginPerCase==null}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"
                    bgcolor="#FFFF99"><strong>
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactVFinal2nd.MarginPerCase!=null && NewContactVFinal2nd.MarginPerCase!=0}">
                            <apex:param value="{!NewContactVFinal2nd.MarginPerCase}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactVFinal2nd.MarginPerCase==0 || NewContactVFinal2nd.MarginPerCase==null}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                    bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,###}%"
                        rendered="{!NewContactV0Contract2nd.MarginPerCase!=null && NewContactV0Contract2nd.MarginPerCase!=0 && NewContractV0Esitimate2nd.MarginPerCase!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.MarginPerCase/NewContactV0Contract2nd.MarginPerCase)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.MarginPerCase==0||NewContractV0Esitimate2nd.MarginPerCase==null}" />
                </td>
            </tr>
            <!-- CM/NS% 净销售利润率 -->
            <!-- <tr>
                <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">CM/NS% 净销售利润率</td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.CMNSRate!=null&& HistoricalV00Contract2nd.CMNSRate!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.CMNSRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.CMNSRate==null || HistoricalV00Contract2nd.CMNSRate==0}" />
                </td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.CMNSRate!=null && HistoricalVFinalContract2nd.CMNSRate!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.CMNSRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMNSRate==null || HistoricalVFinalContract2nd.CMNSRate==0}" />
                </td>

                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.CMNSRate!=null && HistoricalV00Contract2nd.CMNSRate!=0 && HistoricalVFinalContract2nd.CMNSRate!=null}">
                        <apex:param value="{!(HistoricalVFinalContract2nd.CMNSRate-HistoricalV00Contract2nd.CMNSRate)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMNSRate==0||HistoricalVFinalContract2nd.CMNSRate==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContractV0Esitimate2nd.CMNSRate!=null&& NewContractV0Esitimate2nd.CMNSRate!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.CMNSRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMNSRate==null || NewContractV0Esitimate2nd.CMNSRate==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.CMNSRate!=null && HistoricalVFinalContract2nd.CMNSRate!=0 && NewContractV0Esitimate2nd.CMNSRate!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.CMNSRate/HistoricalVFinalContract2nd.CMNSRate)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMNSRate==0||NewContractV0Esitimate2nd.CMNSRate==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.CMNSRate!=null && NewContactV0Contract2nd.CMNSRate!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.CMNSRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.CMNSRate==null || NewContactV0Contract2nd.CMNSRate==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactVFinal2nd.CMNSRate!=null && NewContactVFinal2nd.CMNSRate!=0}">
                        <apex:param value="{!NewContactVFinal2nd.CMNSRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.CMNSRate==null || NewContactVFinal2nd.CMNSRate==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.CMNSRate!=null && NewContactV0Contract2nd.CMNSRate!=0 }">
                        <apex:param value="{!(NewContractV0Esitimate2nd.CMNSRate/NewContactV0Contract2nd.CMNSRate)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMNSRate==null||NewContractV0Esitimate2nd.CMNSRate==null}" />
                </td>
            </tr> -->

            <!-- CM/NS% 净销售利润率 -->
            <tr>
                <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#FFFF99">CM/NS% 净销售利润率</td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.CMNSRateProForma!=null&& HistoricalV00Contract2nd.CMNSRateProForma!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.CMNSRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.CMNSRateProForma==null || HistoricalV00Contract2nd.CMNSRateProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma!=null && HistoricalVFinalContract2nd.CMNSRateProForma!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.CMNSRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma==null || HistoricalVFinalContract2nd.CMNSRateProForma==0}" />
                </td>

                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.CMNSRateProForma!=null && HistoricalV00Contract2nd.CMNSRateProForma!=0 && HistoricalVFinalContract2nd.CMNSRateProForma!=null}">
                        <apex:param value="{!(HistoricalVFinalContract2nd.CMNSRateProForma/HistoricalV00Contract2nd.CMNSRateProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma==0||HistoricalVFinalContract2nd.CMNSRateProForma==null}" />

                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContractV0Esitimate2nd.CMNSRateProForma!=null&& NewContractV0Esitimate2nd.CMNSRateProForma!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.CMNSRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMNSRateProForma==null || NewContractV0Esitimate2nd.CMNSRateProForma==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.CMNSRateProForma!=null && HistoricalVFinalContract2nd.CMNSRateProForma!=0 && NewContractV0Esitimate2nd.CMNSRateProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.CMNSRateProForma/HistoricalVFinalContract2nd.CMNSRateProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMNSRateProForma==0||NewContractV0Esitimate2nd.CMNSRateProForma==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.CMNSRateProForma!=null && NewContactV0Contract2nd.CMNSRateProForma!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.CMNSRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.CMNSRateProForma==null || NewContactV0Contract2nd.CMNSRateProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#FFFF99">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactVFinal2nd.CMNSRateProForma!=null && NewContactVFinal2nd.CMNSRateProForma!=0}">
                        <apex:param value="{!NewContactVFinal2nd.CMNSRateProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.CMNSRateProForma==null || NewContactVFinal2nd.CMNSRateProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#FFFF99">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.CMNSRateProForma!=null && NewContactV0Contract2nd.CMNSRateProForma!=0 && NewContractV0Esitimate2nd.CMNSRateProForma!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.CMNSRateProForma/NewContactV0Contract2nd.CMNSRateProForma)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.CMNSRateProForma==0||NewContractV0Esitimate2nd.CMNSRateProForma==null}" />

                </td>
            </tr>

            <!-- Contract Index - Domestic -->
            <!-- <tr>
                <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">Contract Index - Domestic</td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!HistoricalV00Contract2nd.DomesticContractIndex!=null&& HistoricalV00Contract2nd.DomesticContractIndex!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.DomesticContractIndex}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.DomesticContractIndex==null || HistoricalV00Contract2nd.DomesticContractIndex==0}" />
                </td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex!=null && HistoricalVFinalContract2nd.DomesticContractIndex!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.DomesticContractIndex}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex==null || HistoricalVFinalContract2nd.DomesticContractIndex==0}" />
                </td>

                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.DomesticContractIndex!=null && HistoricalV00Contract2nd.DomesticContractIndex!=0 && HistoricalVFinalContract2nd.DomesticContractIndex!=null}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.DomesticContractIndex/HistoricalV00Contract2nd.DomesticContractIndex)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex==0||HistoricalVFinalContract2nd.DomesticContractIndex==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndex!=null&& NewContractV0Esitimate2nd.DomesticContractIndex!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.DomesticContractIndex}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndex==null || NewContractV0Esitimate2nd.DomesticContractIndex==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndex!=null && HistoricalVFinalContract2nd.DomesticContractIndex!=0 && NewContractV0Esitimate2nd.DomesticContractIndex!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.DomesticContractIndex/HistoricalVFinalContract2nd.DomesticContractIndex)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndex==0||NewContractV0Esitimate2nd.DomesticContractIndex==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContactV0Contract2nd.DomesticContractIndex!=null && NewContactV0Contract2nd.DomesticContractIndex!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.DomesticContractIndex}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.DomesticContractIndex==null || NewContactV0Contract2nd.DomesticContractIndex==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContactVFinal2nd.DomesticContractIndex!=null && NewContactVFinal2nd.DomesticContractIndex!=0}">
                        <apex:param value="{!NewContactVFinal2nd.DomesticContractIndex}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.DomesticContractIndex==null || NewContactVFinal2nd.DomesticContractIndex==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.DomesticContractIndex!=null && NewContactV0Contract2nd.DomesticContractIndex!=0 && NewContractV0Esitimate2nd.DomesticContractIndex!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.DomesticContractIndex/NewContactV0Contract2nd.DomesticContractIndex)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndex==0||NewContractV0Esitimate2nd.DomesticContractIndex==null}" />
                </td>
            </tr> -->

            <!-- Contract Index - Domestic(Pro-Forma) -->
            <tr>
                <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA">Contract index</td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!HistoricalV00Contract2nd.DomesticContractIndexProForma!=null&& HistoricalV00Contract2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!HistoricalV00Contract2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalV00Contract2nd.DomesticContractIndexProForma==null || HistoricalV00Contract2nd.DomesticContractIndexProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma!=null && HistoricalVFinalContract2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma==null || HistoricalVFinalContract2nd.DomesticContractIndexProForma==0}" />
                </td>

                <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')} border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalV00Contract2nd.DomesticContractIndexProForma!=null && HistoricalV00Contract2nd.DomesticContractIndexProForma!=0 && HistoricalVFinalContract2nd.DomesticContractIndexProForma!=null}">
                        <apex:param value="{!((HistoricalVFinalContract2nd.DomesticContractIndexProForma/HistoricalV00Contract2nd.DomesticContractIndexProForma)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma==0||HistoricalVFinalContract2nd.DomesticContractIndexProForma==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma!=null&& NewContractV0Esitimate2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma==null || NewContractV0Esitimate2nd.DomesticContractIndexProForma==0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!HistoricalVFinalContract2nd.DomesticContractIndexProForma!=null && HistoricalVFinalContract2nd.DomesticContractIndexProForma!=0 && NewContractV0Esitimate2nd.DomesticContractIndexProForma!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.DomesticContractIndexProForma/HistoricalVFinalContract2nd.DomesticContractIndexProForma)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma==0||NewContractV0Esitimate2nd.DomesticContractIndexProForma==null}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma!=null && NewContactV0Contract2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!NewContactV0Contract2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma==null || NewContactV0Contract2nd.DomesticContractIndexProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!NewContactVFinal2nd.DomesticContractIndexProForma!=null && NewContactVFinal2nd.DomesticContractIndexProForma!=0}">
                        <apex:param value="{!NewContactVFinal2nd.DomesticContractIndexProForma}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContactVFinal2nd.DomesticContractIndexProForma==null || NewContactVFinal2nd.DomesticContractIndexProForma==0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right" bgcolor="#E3DFDA">&nbsp;
                    <apex:outputText value="{0,number,#,###,##0.0}%"
                        rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma!=null && NewContactV0Contract2nd.DomesticContractIndexProForma!=0 && NewContractV0Esitimate2nd.DomesticContractIndexProForma!=null}">
                        <apex:param value="{!((NewContractV0Esitimate2nd.DomesticContractIndexProForma/NewContactV0Contract2nd.DomesticContractIndexProForma)-1)*100}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma==0||NewContractV0Esitimate2nd.DomesticContractIndexProForma==null}" />
                </td>
            </tr>


            <!-- ROI(Intake) 投资回报率 -->
            <!-- <tr style="{!IF(AdorAbove,'','display:none;')}">
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                    bgcolor="#FF9999"><strong>ROI(Intake) 投资回报率</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!HistoricalV00Contract2nd.ROIIntake!=null && HistoricalV00Contract2nd.ROIIntake!=0}">
                            <apex:param value="{!HistoricalV00Contract2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalV00Contract2nd.ROIIntake==null || HistoricalV00Contract2nd.ROIIntake==0}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!HistoricalVFinalContract2nd.ROIIntake!=null && HistoricalVFinalContract2nd.ROIIntake!=0}">
                            <apex:param value="{!HistoricalVFinalContract2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalVFinalContract2nd.ROIIntake==null||HistoricalVFinalContract2nd.ROIIntake==0}" />
                    </strong>
                </td>

                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                    bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIIntake!=null && NewContractV0Esitimate2nd.ROIIntake!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.ROIIntake==null || NewContractV0Esitimate2nd.ROIIntake==0}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!HistoricalVFinalContract2nd.ROIIntake!=null && HistoricalVFinalContract2nd.ROIIntake!=0 && HistoricalVFinalContract2nd.ROIIntake!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.ROIIntake-HistoricalVFinalContract2nd.ROIIntake)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.ROIIntake==0||HistoricalVFinalContract2nd.ROIIntake==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"
                    bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIIntake!=null && NewContactV0Contract2nd.ROIIntake!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.ROIIntake==null || NewContactV0Contract2nd.ROIIntake==0}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"
                    bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactVFinal2nd.ROIIntake!=null && NewContactVFinal2nd.ROIIntake!=0}">
                            <apex:param value="{!NewContactVFinal2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactVFinal2nd.ROIIntake==null || NewContactVFinal2nd.ROIIntake==0}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                    bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!NewContractV0Esitimate2nd.ROIIntake!=null && NewContactVFinal2nd.ROIIntake!=null}">
                        <apex:param value="{!(NewContactVFinal2nd.ROIIntake-NewContractV0Esitimate2nd.ROIIntake)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.ROIIntake==null ||NewContactVFinal2nd.ROIIntake==null}" />

                </td>
            </tr> -->

            <!-- ROI (Pro-Forma) 预设投资回报率 -->
            <!-- <tr style="{!IF(AdorAbove,'','display:none;')}">
                <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                    bgcolor="#FF9999"><strong> ROI (Pro-Forma) 预设投资回报率</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!HistoricalV00Contract2nd.ROIProForma!=null&&HistoricalV00Contract2nd.ROIProForma!=0}">
                            <apex:param value="{!HistoricalV00Contract2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalV00Contract2nd.ROIProForma==null || HistoricalV00Contract2nd.ROIProForma==0}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right" bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!HistoricalVFinalContract2nd.ROIProForma!=null&&HistoricalVFinalContract2nd.ROIProForma!=0}">
                            <apex:param value="{!HistoricalVFinalContract2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!HistoricalVFinalContract2nd.ROIProForma==null||HistoricalVFinalContract2nd.ROIProForma==0}" />
                    </strong>
                </td>

                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                    bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIProForma!=null&&NewContractV0Esitimate2nd.ROIProForma!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.ROIProForma==null||NewContractV0Esitimate2nd.ROIProForma==0}" />
                    </strong>
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right" bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!HistoricalVFinalContract2nd.ROIProForma!=null && HistoricalVFinalContract2nd.ROIProForma!=0 && HistoricalVFinalContract2nd.ROIProForma!=null}">
                        <apex:param value="{!(NewContractV0Esitimate2nd.ROIProForma-HistoricalVFinalContract2nd.ROIProForma) }" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalContract2nd.ROIProForma==0||HistoricalVFinalContract2nd.ROIProForma==null}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"
                    bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIProForma!=null&&NewContactV0Contract2nd.ROIProForma!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.ROIProForma==null||NewContactV0Contract2nd.ROIProForma==0}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right"
                    bgcolor="#FF9999">
                    <strong>
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactVFinal2nd.ROIProForma!=null&&NewContactVFinal2nd.ROIProForma!=0}">
                            <apex:param value="{!NewContactVFinal2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactVFinal2nd.ROIProForma==null||NewContactVFinal2nd.ROIProForma==0}" />
                    </strong>
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                    bgcolor="#FF9999">
                    <apex:outputText value="{0,number,#,###,##0.00}"
                        rendered="{!NewContractV0Esitimate2nd.ROIProForma!=null && NewContractV0Esitimate2nd.ROIProForma!=0 && NewContactVFinal2nd.ROIProForma!=null}">
                        <apex:param value="{!(NewContactVFinal2nd.ROIProForma-NewContractV0Esitimate2nd.ROIProForma)}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractV0Esitimate2nd.ROIProForma==0 ||NewContractV0Esitimate2nd.ROIProForma==null}" />

                </td>
            </tr> -->

            <!-- Total BC % 空瓶回收率(Martell BC%) -->
            <tr>
                <td
                    style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <strong>Total BC % 空瓶回收率(Martell BC%)</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                        <apex:param value="{!HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c==null || HistoricalContract.ASI_CRM_CN_Bottle_Collection_Rate__c==0}" />


                    <apex:outputText value="("
                        rendered="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=null && HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=null && HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=0}">
                        <apex:param value="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=null && HistoricalContract.ASI_CRM_Martell_BC_Rate__c!=0}" />

                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">

                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!HistoricalVFinalTotalBCRate!=null && HistoricalVFinalTotalBCRate!=0}">
                        <apex:param value="{!HistoricalVFinalTotalBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalTotalBCRate==null || HistoricalVFinalTotalBCRate==0}" />

                    <apex:outputText value="("
                        rendered="{!Hist_VFinalTotalMarBCRate!=null && Hist_VFinalTotalMarBCRate!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!Hist_VFinalTotalMarBCRate!=null && Hist_VFinalTotalMarBCRate!=0}">
                        <apex:param value="{!Hist_VFinalTotalMarBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!Hist_VFinalTotalMarBCRate!=null && Hist_VFinalTotalMarBCRate!=0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right"></td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==null || thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==0}" />


                    <apex:outputText value="("
                        rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_Martell_BC_Rate__c}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right"></td>

                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==null || thisCC.ASI_CRM_CN_Bottle_Collection_Rate__c==0}" />

                    <apex:outputText value="("
                        rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}">
                        <apex:param value="{!thisCC.ASI_CRM_Martell_BC_Rate__c}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!thisCC.ASI_CRM_Martell_BC_Rate__c!=null && thisCC.ASI_CRM_Martell_BC_Rate__c!=0}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px dotted gray;" align="right">
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!NewContractVFinalTotalBCRate!=null && NewContractVFinalTotalBCRate!=0}">
                        <apex:param value="{!NewContractVFinalTotalBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractVFinalTotalBCRate==null || NewContractVFinalTotalBCRate==0}" />
                    <apex:outputText value="("
                        rendered="{!New_VFinalTotalMartellBCRate!=null && New_VFinalTotalMartellBCRate!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!New_VFinalTotalMartellBCRate!=null && New_VFinalTotalMartellBCRate!=0}">
                        <apex:param value="{!New_VFinalTotalMartellBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!New_VFinalTotalMartellBCRate!=null && New_VFinalTotalMartellBCRate!=0}" />
                </td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">&nbsp;</td>
            </tr>

            <!-- Net BC % 净空瓶回收率(Martell BC%) -->
            <!-- <tr>
                <td
                    style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <strong>Net BC % 净空瓶回收率(Martell BC%)</strong></td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">

                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right">

                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!HistoricalVFinalNetBCRate!=null && HistoricalVFinalNetBCRate!=0}">
                        <apex:param value="{!HistoricalVFinalNetBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!HistoricalVFinalNetBCRate==null || HistoricalVFinalNetBCRate==0}" />



                    <apex:outputText value="("
                        rendered="{!Hist_VFinalNetMarBCRate!=null && Hist_VFinalNetMarBCRate!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!Hist_VFinalNetMarBCRate!=null && Hist_VFinalNetMarBCRate!=0}">
                        <apex:param value="{!Hist_VFinalNetMarBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!Hist_VFinalNetMarBCRate!=null && Hist_VFinalNetMarBCRate!=0}" />
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-bottom: 1px solid black; border-right: 1px solid black;"
                    align="right"></td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">
                </td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}  border-bottom: 1px solid black; border-right: 1px dotted gray;"
                    align="right"></td>
                <td style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right"></td>
                <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right">

                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!NewContractVFinalNetBCRate!=null && NewContractVFinalNetBCRate!=0}">
                        <apex:param value="{!NewContractVFinalNetBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!NewContractVFinalNetBCRate==null || NewContractVFinalNetBCRate==0}" />

                    <apex:outputText value="("
                        rendered="{!New_VFinalNetMartellBCRate!=null && New_VFinalNetMartellBCRate!=0}" />
                    <apex:outputText value="{0,number,#,###,##0}%"
                        rendered="{!New_VFinalNetMartellBCRate!=null && New_VFinalNetMartellBCRate!=0}">
                        <apex:param value="{!New_VFinalNetMartellBCRate}" />
                    </apex:outputText>
                    <apex:outputText value=")"
                        rendered="{!New_VFinalNetMartellBCRate!=null && New_VFinalNetMartellBCRate!=0}" />
                </td>
                <td style="border-bottom: 1px solid black;border-right: 1px solid black" align="right">
                </td>
            </tr> -->

        </table>

        <br />

        <!-- <table style="font-size:9px;" width="100%" border="0" cellpadding="3" cellspacing="0">
            <tr>
                <td width="70%" style="">
                    Domestic Target - CM/Btl
                </td>
                <td width="10%" style="border-bottom: 1px solid black;" align="center">
                </td>
                <td  width="10%">
                    &nbsp;
                </td>
                <td width="10%" style="border-bottom: 1px solid black;" align="center">
                </td>
            </tr>
            <tr>
                <td width="70%" style="">
                    Region Average - CM/Btl
                </td>
                <td width="10%" style="border-bottom: 1px solid black;" align="center">
                </td>
                <td  width="10%">
                    &nbsp;
                </td>
                <td width="10%" style="border-bottom: 1px solid black;" align="center">
                </td>
            </tr>
        </table>

        <br/> -->

        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <thead>
            <tr>
                <td colspan="{!IF(ExistHistoricalData,'11','9')}" bgcolor="#99CCFF" style="border:1px solid black;"><font color="white"><strong>Volume (std) 销量(标准瓶)</strong></font></td>
            </tr>
            <tr>
                <td width= "10%" rowspan="2" align="center" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">Sub-brands <br/>品牌</td>
                <td colspan="{!IF(ExistHistoricalData,'4','3')}" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Bottles / month<br/>瓶/月</td>
                <td colspan="{!IF(ExistHistoricalData,'6','5')};" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">weight of volume by sub-brand <br/>各品牌销量占比</td>
            </tr>
            <tr>
                <!-- <td width="10%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Category 类别</td> -->
                <!-- <td width="10%" style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;" align="center"></td> -->
                <td width="9%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;" align="center">Historical <br/>历史</td>
                <td width="9%" style="border-bottom: 1px solid black;" align="center">Estimate <br/>预计</td>
                <td width="9%" style="border-bottom: 1px solid black;" align="center">Contract <br/>合同</td>
                <td width="9%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Vfinal</td>

                <td width="9%" style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="center">Estimate <br/>预计</td>
                <td width="9%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;border-right: 1px dotted gray;" align="center">vs %Vfinal <br/>对比历史完成</td>
                <td width="9%" style="border-right: 1px dotted gray; border-bottom: 1px solid black;" align="center">Contract <br/>合同 </td>
                <td width="9%" style="border-right: 1px dotted gray; border-bottom: 1px solid black;" align="center">%Est.l<br/>对比预计</td>
                <td width="9%" style="border-right: 1px dotted gray; border-bottom: 1px solid black;" align="center">Vfinal</td>
                <td width="9%" style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">%Est.l<br/>对比预计</td>
            </tr>
            </thead>
            <apex:variable value="{!0}" var="TotalHistoricalBottles1"/>
            <apex:variable value="{!0}" var="TotalEstimateBottles1"/>
            <apex:variable value="{!0}" var="TotalContractBottles1"/>
            <apex:variable value="{!0}" var="TotalVfinalBottles1"/>
            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                <apex:variable var="TotalHistoricalBottles1"
                                value="{!TotalHistoricalBottles1+investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD}" />
                <apex:variable var="TotalEstimateBottles1"
                                value="{!TotalEstimateBottles1+investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD}" />
                <apex:variable var="TotalContractBottles1"
                                value="{!TotalContractBottles1+investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD}" />
                <apex:variable var="TotalVfinalBottles1"
                                value="{!TotalVfinalBottles1+investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD}" />
            </apex:repeat>

            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade" rows="20">
                <tr>
                    <!-- <td align="left" valign="top" style=" border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].subBrandName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].subBrandName)))}" escape="false" />
                    </td> -->
                    <td align="left"  style=" border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!subEnNameMap[sbgrade]}" escape="false" />
                    </td>
                    <td align="center"  style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="center"  style="border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="center"  style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="{!IF(ExistHistoricalData,'','display:none;')};border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{!IF((investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100) >=0,'+{0,number,#,###,###}%','{0,number,#,###,###}%')}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100!=null}"
                            style="{!IF((investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100) >=0,'color:green;','color: red;')}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100}" />
                        </apex:outputText>
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{!IF((investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100) >=0,'+{0,number,#,###,###}%','{0,number,#,###,###}%')}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100!=null}"
                            style="{!IF((investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100) >=0,'color:green;','color: red;')}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100}"/>
                        </apex:outputText>
                 
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style=" border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!IF((investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100) >=0,'+{0,number,#,###,###}%','{0,number,#,###,###}%')}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100!=null}"
                            style="{!IF((investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100) >=0,'color:green;','color: red;')}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100}" />
                        </apex:outputText>
                    </td>
                </tr>
            </apex:repeat>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" bgcolor="#E3DFDA">ALL PRODUCTS 品牌合计</td>
                <td align="center" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalHistoricalBottles1!=0 && TotalHistoricalBottles1!=null}" >
                        <apex:param value="{!TotalHistoricalBottles1}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalHistoricalBottles1==null || TotalHistoricalBottles1==0}" />
                </td>
                <td align="center"  style="border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalEstimateBottles1!=0 && TotalEstimateBottles1!=null}" >
                        <apex:param value="{!TotalEstimateBottles1}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateBottles1==null || TotalEstimateBottles1==0}" />
                </td>
                <td align="center"  style="border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalContractBottles1!=0 && TotalContractBottles1!=null}" >
                        <apex:param value="{!TotalContractBottles1}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractBottles1==null || TotalContractBottles1==0}" />
                </td>
                <td align="center"  style="border-right: 1px solid black;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!TotalVfinalBottles1!=0 && TotalVfinalBottles1!=null}" >
                        <apex:param value="{!TotalVfinalBottles1}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalVfinalBottles1==null || TotalVfinalBottles1==0}" />
                </td>
                <td align="center"  style="border-right: 1px dotted gray;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center" style="{!IF(ExistHistoricalData,'','display:none;')};border-right: 1px dotted gray;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center" style=" border-right: 1px solid black;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
            </tr>
        </table>
        <br/>

        <table style="font-size:9px;" width="100%" border="0" cellpadding="3" cellspacing="0">
            <thead>
                <tr>
                    <td colspan="{!IF(ExistHistoricalData,'11','9')}" bgcolor="#99CCFF"
                        style="border:1px solid black;">
                        <font color="white"><strong>EXPENSES (in RMB) 支出（元）</strong></font>
                    </td>
                </tr>
                <tr>
                    <td rowspan="2" width="11%" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        Sub-brands<br/>品牌</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Trade Expenses Per Bottle<br/>单瓶销售费用</td>
                    <!-- <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Trade Expenses Per Bottle<br />单瓶销售费用
                    </td> -->
                    <td colspan="1" style=" border-bottom: 1px solid black;white-space: pre;" align="center">vs Domestic<br/>Investment /Btl</td>
                    <td colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;white-space: pre;" align="center">Domestic<br/>Index by<br/>sub-brand</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Total
                        Fees<br/>费用合计</td>
                </tr>
                <tr>
                    <!-- <td width="10%"
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Category 类别</td> -->
                    <!-- <td width="18%" style="border-right: 1px solid black; border-bottom: 1px solid black;border-left: 1px solid black;"
                        align="center">Sub-brands 品牌</td> -->
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;"
                        align="center">Historical <br/>历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate <br/>预计</td>
                    <td width="8%" style=" border-bottom: 1px solid black;" align="center">Contract <br/>合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Vfinal</td>

                    <td width="8%" style="border-bottom: 1px solid black;"
                        align="center">Contract <br/>合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Contract <br/>合同</td>


                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;"
                        align="center">Historical <br/>历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate<br/> 预计</td>
                    <td width="8%" style=" border-bottom: 1px solid black;" align="center">Contract <br/>合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Vfinal</td>
                </tr>
            </thead>

            <apex:variable value="{!0}" var="AllHistoricalTotalFees" />
            <apex:variable value="{!0}" var="AllEstimateTotalFees" />
            <apex:variable value="{!0}" var="AllContractTotalFees" />
            <apex:variable value="{!0}" var="AllvFinalTotalFees" />

            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                <apex:variable var="AllHistoricalTotalFees"
                    value="{!AllHistoricalTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount}" />
                <apex:variable var="AllEstimateTotalFees"
                    value="{!AllEstimateTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount}" />
                <apex:variable var="AllContractTotalFees"
                    value="{!AllContractTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount}" />
                <apex:variable var="AllvFinalTotalFees"
                    value="{!AllvFinalTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount}" />
            </apex:repeat>

             <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                 <tr>
                    <!-- <td align="left"  style=" border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].subBrandName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].subBrandName)))}" escape="false" />
                    </td> -->
                    <td align="left"  style=" border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!subEnNameMap[sbgrade]}" escape="false" />
                    </td>
                    <td align="center"  style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="center"  style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd==0}" />
                    </td>

                    <td align="center"  style="border-bottom: 1px solid black; ">
                        <apex:outputText style="{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment != null && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment > 0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd != 0,'color: red;','display: none;')}" value="+"/>
                        <apex:outputText value="{0,number,#,###,###}" style="{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment != null && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment > 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd != 0}">
                            <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment, 0)}"/>
                        </apex:outputText>
                        <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd == 0}" value=" - "></apex:outputText>
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black; border-right: 1px solid black;">
                        <!-- <apex:outputText style="{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget > 0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].volumeSTD != 0,'color: green;','display: none;')}" value="+"/>
                        <apex:outputText value="{0,number,#,###,###}" style="{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}" rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].volumeSTD != 0}">
                            <apex:param value="{!BLANKVALUE(CEILING(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget), 0)}"/>
                        </apex:outputText>
                        <apex:outputText rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].volumeSTD == 0}" value=" - "></apex:outputText> -->
                        <apex:outputText value="{0,number,#,###,###}" style="{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}" >
                            <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].DomesticContractIndex, 0)}"/>
                        </apex:outputText>
                    </td>

                    <td align="center"  style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount==0}" />
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount==0}" />
                    </td>
                    <td align="center"  style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount==0}" />
                    </td>
                    <td align="center"  style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount!=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount==0}" />
                    </td>
                </tr>
             </apex:repeat>
             <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" bgcolor="#E3DFDA">ALL PRODUCTS 品牌合计</td>
                <td align="center"  style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center"  style="border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center"  style="border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center"  style="border-right:1px solid black;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>

                <td align="center"  style="border-bottom: 1px solid black; " bgcolor="#E3DFDA">
                    &nbsp;
                </td>
                <td align="center"  style="border-bottom: 1px solid black; border-right: 1px solid black;" bgcolor="#E3DFDA">
                    &nbsp;
                </td>

                <td align="center"  style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllHistoricalTotalFees!=0 && AllHistoricalTotalFees!=null}" >
                        <apex:param value="{!AllHistoricalTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllHistoricalTotalFees==null || AllHistoricalTotalFees==0}" />
                </td>
                <td align="center"  style="border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllEstimateTotalFees!=0 && AllEstimateTotalFees!=null}" >
                        <apex:param value="{!AllEstimateTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllEstimateTotalFees==null || AllEstimateTotalFees==0}" />
                </td>
                <td align="center"  style="border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllContractTotalFees!=0 && AllContractTotalFees!=null}" >
                        <apex:param value="{!AllContractTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllContractTotalFees==null || AllContractTotalFees==0}" />
                </td>
                <td align="center"  style="border-right:1px solid black;border-bottom: 1px solid black;" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###}" rendered="{!AllvFinalTotalFees!=0 && AllvFinalTotalFees!=null}" >
                        <apex:param value="{!AllvFinalTotalFees}"/></apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllvFinalTotalFees==null || AllvFinalTotalFees==0}" />
                </td>
            </tr>
        </table>

        <!-- <table style="font-size:9px;" width="100%" border="0" cellpadding="3" cellspacing="0">
            <thead>
                <tr>
                    <td colspan="{!IF(ExistHistoricalData,'14','11')}" bgcolor="#99CCFF"
                        style="border:1px solid black;">
                        <font color="white"><strong>EXPENSES (in RMB) 支出（元）</strong></font>
                    </td>
                </tr>
                <tr>
                    <td colspan="2"
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        &nbsp;</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Bottles /
                        month<br />瓶/月</td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Trade Expenses Per Bottle<br />单瓶销售费用
                    </td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">Total
                        Fees<br />费用合计</td>
                </tr>
                <tr>
                    <td width="10%"
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Category 类别</td>
                    <td width="18%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Sub-brands 品牌</td>
                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;"
                        align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style=" border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Vfinal</td>

                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;"
                        align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Vfinal</td>


                    <td width="8%" style="{!IF(ExistHistoricalData,'','display:none;')}border-bottom: 1px solid black;"
                        align="center">Historical 历史</td>
                    <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate 预计</td>
                    <td width="8%" style=" border-bottom: 1px solid black;" align="center">Contract 合同</td>
                    <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="center">Vfinal</td>
                </tr>
            </thead>
            <apex:variable value="{!0}" var="TotalHistoricalBottles" />
            <apex:variable value="{!0}" var="TotalEstimateBottles" />
            <apex:variable value="{!0}" var="TotalContractBottles" />
            <apex:variable value="{!0}" var="TotalvFinalBottles" />

            <apex:variable value="{!0}" var="TotalHistoricalFees" />
            <apex:variable value="{!0}" var="TotalEstimateFees" />
            <apex:variable value="{!0}" var="TotalContractFees" />
            <apex:variable value="{!0}" var="TotalvFinalFees" />

            <apex:variable value="{!0}" var="AllHistoricalTotalFees" />
            <apex:variable value="{!0}" var="AllEstimateTotalFees" />
            <apex:variable value="{!0}" var="AllContractTotalFees" />
            <apex:variable value="{!0}" var="AllvFinalTotalFees" />


            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                <apex:variable var="TotalHistoricalBottles"
                    value="{!TotalHistoricalBottles+investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD}" />
                <apex:variable var="TotalEstimateBottles"
                    value="{!TotalEstimateBottles+investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD}" />
                <apex:variable var="TotalContractBottles"
                    value="{!TotalContractBottles+investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD}" />
                <apex:variable var="TotalvFinalBottles"
                    value="{!TotalvFinalBottles+investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD}" />

                <apex:variable var="TotalHistoricalFees"
                    value="{!TotalHistoricalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd}" />
                <apex:variable var="TotalEstimateFees"
                    value="{!TotalEstimateFees+investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd}" />
                <apex:variable var="TotalContractFees"
                    value="{!TotalContractFees+investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd}" />
                <apex:variable var="TotalvFinalFees"
                    value="{!TotalvFinalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd}" />

                <apex:variable var="AllHistoricalTotalFees"
                    value="{!AllHistoricalTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount}" />
                <apex:variable var="AllEstimateTotalFees"
                    value="{!AllEstimateTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount}" />
                <apex:variable var="AllContractTotalFees"
                    value="{!AllContractTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount}" />
                <apex:variable var="AllvFinalTotalFees"
                    value="{!AllvFinalTotalFees+investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount}" />


                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;"  align="left">
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].categoryName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].categoryName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].categoryName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].categoryName)))}" escape="false" />
                    </td>
                    <td align="left" valign="top" style=" border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].subBrandName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].subBrandName)))}" escape="false" />
                    </td>
                    <td align="right" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="right" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="right" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].monthlyVolumeSTD==0}" />
                    </td>
                    <td align="right" valign="top" style="border-right:1px solid rgb(230, 204, 204);border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].monthlyVolumeSTD==0}" />
                    </td>


                    <td align="right" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="right" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="right" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="right" valign="top" style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd==0}" />
                    </td>


                    <td align="right" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].BRSFAmount==0}" />
                    </td>
                    <td align="right" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].BRSFAmount==0}" />
                    </td>
                    <td align="right" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].BRSFAmount==0}" />
                    </td>
                    <td align="right" valign="top" style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount!=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].BRSFAmount==0}" />
                    </td>
                </tr>
            </apex:repeat>


            <tr>
                <td colspan="2"
                    style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                    ALL PRODUCTS 品牌合计</td>
                <td style="{!IF(ExistHistoricalData,'','display:none;')}border-top: 1px solid black;" align="right"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalHistoricalBottles!=0 && TotalHistoricalBottles!=null}">
                        <apex:param value="{!TotalHistoricalBottles}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!TotalHistoricalBottles==null || TotalHistoricalBottles==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}">
                        <apex:param value="{!TotalEstimateBottles}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}">
                        <apex:param value="{!TotalContractBottles}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractBottles==null || TotalContractBottles==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalvFinalBottles!=0 && TotalvFinalBottles!=null}">
                        <apex:param value="{!TotalvFinalBottles}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalvFinalBottles==null || TotalvFinalBottles==0}" />
                </td>


                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;" align="right"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,###.00}"
                        rendered="{!TotalHistoricalFees!=0 && TotalHistoricalFees!=null}">
                        <apex:param value="{!TotalHistoricalFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalHistoricalFees==null || TotalHistoricalFees==0}" />

                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalEstimateFees!=0 && TotalEstimateFees!=null}">
                        <apex:param value="{!TotalEstimateFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalEstimateFees==null || TotalEstimateFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalContractFees!=0 && TotalContractFees!=null}">
                        <apex:param value="{!TotalContractFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalContractFees==null || TotalContractFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!TotalvFinalFees!=0 && TotalvFinalFees!=null}">
                        <apex:param value="{!TotalvFinalFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalvFinalFees==null || TotalvFinalFees==0}" />
                </td>


                <td style="{!IF(ExistHistoricalData,'','display:none;')} border-top: 1px solid black;" align="right"
                    bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!AllHistoricalTotalFees!=0 && AllHistoricalTotalFees!=null}">
                        <apex:param value="{!AllHistoricalTotalFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - "
                        rendered="{!AllHistoricalTotalFees==null || AllHistoricalTotalFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!AllEstimateTotalFees!=0 && AllEstimateTotalFees!=null}">
                        <apex:param value="{!AllEstimateTotalFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllEstimateTotalFees==null || AllEstimateTotalFees==0}" />
                </td>
                <td style="border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!AllContractTotalFees!=0 && AllContractTotalFees!=null}">
                        <apex:param value="{!AllContractTotalFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllContractTotalFees==null || AllContractTotalFees==0}" />
                </td>
                <td style="border-right: 1px solid black; border-top: 1px solid black;" align="right" bgcolor="#E3DFDA">
                    <apex:outputText value="{0,number,#,###,##0.0}"
                        rendered="{!AllvFinalTotalFees!=0 && AllvFinalTotalFees!=null}">
                        <apex:param value="{!AllvFinalTotalFees}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!AllvFinalTotalFees==null || AllvFinalTotalFees==0}" />
                </td>
            </tr>
        </table> -->

        <!-- <br />
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <td rowspan="2"
                        style="border-top: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;"
                        align="center" width="10%">
                        Sub-Brands 品牌
                    </td>
                    <td colspan = "{!IF(ExistHistoricalData,'5','4')};"
                        bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                        <font color="white"><strong>Gap of Target Index - Domestic 对比全国指标差异</strong></font>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="center">
                        National Target 全国目标
                    </td>
                    <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')}" align="center">
                        Historical 历史
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Estimate 预计
                    </td>
                    <td style=" border-bottom: 1px solid black;" align="center">
                        Contract 合同
                    </td>
                    <td style="border-right: 1px solid black;border-top: none;border-bottom: 1px solid black;" align="center">
                        Vfinal
                    </td>
                </tr>
            </thead>
            
            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                <tr>
                    <td align="left" style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">
                            <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].subBrandName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].subBrandName)))}" escape="false">
                            </apex:outputText>
                    </td>
                    <td align="center" style="border-bottom: 1px solid black;border-right: 1px solid black;">

                        <apex:outputText value="{!IndexTargetMap[sbgrade]}" 
                                         escape="false"
                                         rendered="{!IndexTargetMap[sbgrade] != ''}"
                                         >
                        </apex:outputText>
                        <apex:outputText value=" "
                            rendered="{!IndexTargetMap[sbgrade] == ''}" />
                    </td>

                    <td align="center" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticIndexTarget< 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticIndexTarget!=null &&
                                investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticIndexTarget!=0
                                }">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticIndexTarget}" />
                        </apex:outputText>
                        <apex:outputText value="  "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticIndexTarget==0}" />
                    </td>
                    <td align="center" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticIndexTarget < 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticIndexTarget!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticIndexTarget}" />
                        </apex:outputText>
                        <apex:outputText value="  "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticIndexTarget==0}" />
                    </td>
                    <td align="center" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget < 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget}" />
                        </apex:outputText>
                        <apex:outputText value="  "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticIndexTarget==0}" />
                    </td>

                    <td align="center" style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticIndexTarget < 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticIndexTarget!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticIndexTarget}" />
                        </apex:outputText>
                        <apex:outputText value="  "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticIndexTarget==0}" />
                    </td>
                </tr>
            </apex:repeat>
        </table> -->

        <!-- <br />
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <td rowspan="2"
                        style="border-top: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;"
                        align="center" width="10%">
                        Sub-Brands 品牌
                    </td>
                    <td colspan="7" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                        <font color="white"><strong>weight of volume by sub -brand 各品牌销量占比</strong></font>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;{!IF(ExistHistoricalData,'','display:none;')}" align="center">
                        Historical 历史
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="center">
                        Estimate 预计
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px dotted gray;{!IF(ExistHistoricalData,'','display:none;')}" align="center">
                        %Vfinal对比历史完成
                    </td>
                    <td style=" border-bottom: 1px solid black;border-right: 1px dotted gray;" align="center">
                        Contract 合同
                    </td>
                    <td style=" border-bottom: 1px solid black;border-right: 1px dotted gray;" align="center">
                        %Est.l对比预计
                    </td>
                    <td style=" border-bottom: 1px solid black;border-right: 1px dotted gray;" align="center">
                        Vfinal
                    </td>
                    <td style="border-right: 1px solid black;border-top: none;border-bottom: 1px solid black;" align="center">
                        %Est.l对比预计
                    </td>
                </tr>
            </thead>
            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                <tr>
                    <td align="left" style="border-left: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;">
                            <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].subBrandName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].subBrandName)))}" escape="false">
                            </apex:outputText>
                    </td>

                    <td align="center" style="{!IF(ExistHistoricalData,'','display:none;')};border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="{!IF(ExistHistoricalData,'','display:none;')};border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['History'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style="border-right: 1px dotted gray;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100==0}" />
                    </td>
                    <td align="center" style=" border-right: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,#0.0}%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100 !=0 && investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].propByStdTotal * 100 - investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].propByStdTotal * 100==0}" />
                    </td>
                </tr>
            </apex:repeat>
        </table> -->

        <!-- <br />
        <table width="100%" border="0" style="" cellspacing="0" cellpadding="0">
            <thead>
                <tr>
                    <td rowspan="2"
                        style="border-top: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;"
                        align="center" width="10%">
                        Sub-Brands 品牌
                    </td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}"
                        bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                        <font color="white"><strong>Trade Expenses Per Bottle</strong></font>
                    </td>
                    <td colspan="{!IF(ExistHistoricalData,'4','3')}" 
                        bgcolor="#99CCFF"
                        style="border:1px solid black;text-align: center;">
                        <font color="white"><strong>Gap with Investment - Domestic Target</strong>
                        </font>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')}" align="center">
                        Historical 历史 
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Estimate 预计
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Contract 合同
                    </td>
                    <td style="border-right: 1px solid black;border-bottom: 1px solid black;" align="center">
                        Vfinal
                    </td>
                    <td style="border-bottom: 1px solid black;{!IF(ExistHistoricalData,'','display:none;')}" align="center">
                        Historical 历史 
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Estimate 预计
                    </td>
                    <td style="border-bottom: 1px solid black;" align="center">
                        Contract 合同 
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="center">
                        Vfinal
                    </td>
                </tr>
            </thead>
            <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="sbgrade">
                <tr>
                    <td align="left" valign="top" style=" border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].subBrandName,
                                                  BLANKVALUE(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].subBrandName,investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].subBrandName)))}" escape="false" />
                    </td>
                    <td align="center" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="center" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="center" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].tradeExpensePerBottle2nd==0}" />
                    </td>
                    <td align="center" valign="top" style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].tradeExpensePerBottle2nd==0}" />
                    </td>


                    <td align="center" valign="top" style="{!IF(ExistHistoricalData,'','display:none;')};border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticInvestment!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticInvestment!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticInvestment}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[sbgrade]['History'].GapWithDomesticInvestment==0}" />
                    </td>
                    <td align="center" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticInvestment!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticInvestment!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticInvestment}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Esitimate'].GapWithDomesticInvestment==0}" />
                    </td>
                    <td align="center" valign="top" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[sbgrade]['Contract'].GapWithDomesticInvestment==0}" />
                    </td>
                    <td align="center" valign="top" style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}"
                            style="color:{!IF(investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticInvestment!=0 && 
                                        investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticInvestment!=null}">
                            <apex:param value="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticInvestment}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[sbgrade]['vfina'].GapWithDomesticInvestment==0}" />
                    </td>
                </tr>
            </apex:repeat>
        </table> -->

        <br />

        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td bgcolor="#99CCFF" style="border:1px solid black;" colspan="2">
                    <strong><apex:outputText value="Variable Cost Investment Methodology (变动费用投资方式)" />
                    </strong>
                </td>
            </tr>
            <tr>
                <td colspan="2" style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">New Contract </td>
            </tr>
            <tr>
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">BRSF(空瓶回收费)</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_BRSF_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod1__c!=null,'','display:none;')}  ">
                <td  style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >PSF(空瓶回收服务费) - 1</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod1__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod2__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">PSF(空瓶回收服务费) - 2</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;">
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod2__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_PSF_Meth_Mod3__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >PSF(空瓶回收服务费) - 3</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_PSF_Meth_Mod3__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
            <tr style="{!IF(KAAccount.ASI_CRM_VEC_Methodology__c!=null,'','display:none;')}  " >
                <td style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;" >Variable Event Cost活动费用（变动）</td>
                <td style="border-right: 1px solid black; border-bottom: 1px solid black;" >
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.Name}"  rendered="{!!showCN}" />
                    <apex:outputField value="{!KAAccount.ASI_CRM_VEC_Methodology__r.ASI_CRM_Chinese_Name__c} "  rendered="{!showCN}" />
                </td>
            </tr>
        </table>
        <br/>

        <apex:variable value="v1" var="" rendered="{!IsLocalGroupContract}">
            <table width="100%" border="0" cellspacing="0" cellpadding="2">
                <tr>
                    <td valign="top"
                        style="font-weight: bold; font-size: 12px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="a. Backgroud & Objective" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c!=null && lstApprovalComment[0].ASI_CRM_Background_Objective__c!=''}" />
                        <apex:outputText value=" - "
                            rendered="{!lstApprovalComment[0].ASI_CRM_Background_Objective__c==null || lstApprovalComment[0].ASI_CRM_Background_Objective__c==''}" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="b. New Contract Analysis" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=null  && lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c!=''}" />
                        <apex:outputText value=" - "
                            rendered="{!lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==null || lstApprovalComment[0].ASI_CRM_New_contract_Analsysis__c==''}" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-weight: bold; font-size: 12px; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputText value="c. Historical Contract Performance" />
                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="font-size: 12px; line-height: 15px; border-top: 1px solid black; border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c}"
                            rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=null && lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c!=''}" />
                        <apex:outputText value=" - "
                            rendered="{!lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==null || lstApprovalComment[0].ASI_CRM_Historical_Contract_Performance__c==''}" />
                    </td>
                </tr>
            </table>
        </apex:variable>
    </body>
</apex:component>