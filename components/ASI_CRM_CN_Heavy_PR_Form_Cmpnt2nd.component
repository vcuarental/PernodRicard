<!--
  @File Name          : ASI_CRM_CN_Heavy_PR_Form_Cmpnt2nd.component
  @Description        : 
  @Author             : pengchen@bluelinksys.com
  @Group              : 
  @Last Modified By   : pengchen@bluelinksys.com
  @Last Modified On   : 5/9/2020, 6:42:38 PM
  @Modification Log   : 
  Ver       Date            Author      		    Modification
  1.0    4/1/2020   pengchen@bluelinksys.com     Initial Version
-->
<apex:component controller="ASI_CRM_CN_Heavy_PRForm_Cmpnt_Ctrl" access="global">
    <apex:variable var="dummyV" value="{!dummyVar}" id="dummyVar" />
    <apex:attribute name="Header_id" description="ID of Contract" type="id" assignto="{!HeaderId}" />
    <apex:attribute name="PDF" description="is this pdf?" type="string" assignto="{!strPDF}" />

    <head>
        <!-- <style>
            .border{
                width: 100%;border: 1px solid #000000;
            }

            .bold{
                font-weight:bold;
            }

            h1{
                font-size:20px;
                font-family: Arial Unicode MS;
            }

            h2{
                font-weight:bold;
            }

            table {
                -fs-table-paginate: paginate;
            }
            @page {
                size: Portrait;
                margin-top: 5cm;

                @PageBreak{
                    page-break:always;
                    page-break-inside:avoid;
                }

                @top-center {
                    content: element(header);
                }

                @bottom-right {
                    content: counter(page);
                    font-family: Arial Unicode MS;
                    font-size: 10px;
                    line-height: 11px;
                }
                @bottom-left {
                    font-family: Arial Unicode MS;
                    font-size: 10px;
                    line-height: 11px;
                }
            }

            div.header {
                position: running(header);
                font-family: Arial Unicode MS;
                font-size: 10px;
                line-height: 11px;
            }

            body{
                font-family: Arial Unicode MS;
                font-size: 10px;
                line-height: 13px;
            }

            tbody {display:table-row-group;
            }
            .nobreak{
                page-break-inside: avoid;
            }
            }
        </style> -->
    </head>

    <body >
        <table width="100%" cellspacing="0" border="0" cellpadding="2" >
            <tr>
                <td valign="top"
                    style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                    <b>Payment Number / 付款申请号</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">{!thisPR.Name}</td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>Requestor /
                        付款申请人</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">{!thisPR.Owner.Name}
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                    <b>Outlet/WS Name / 店家/批发商</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                    {!thisPR.ASI_CRM_CN_OutletWS__r.Name}
                    <apex:outputtext value=" / {!thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c}"
                        rendered="{!thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c != null && thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_Eng_Name__c != ''}" />
                </td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>PO Start Date / PO
                        开始日期</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                    <apex:outputText value="{0,date,dd/MM/yyyy}">
                        <apex:param value="{!thisPR.ASI_CRM_CN_PO_Start_Date__c}" />
                    </apex:outputText>
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;"><b>City
                        / 城市</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                    {!IF(thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__c !=
                    null,thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_City__r.Name,thisPR.ASI_CRM_CN_OutletWS__r.ASI_CRM_CN_CCity__r.Name)}
                </td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>PO End Date / PO
                        结束日期</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                    <apex:outputText value="{0,date,dd/MM/yyyy}">
                        <apex:param value="{!thisPR.ASI_CRM_CN_PO_End_Date__c}" />
                    </apex:outputText>
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                    <b>{!if(thisPR.ASI_CRM_New_FY_Payment__c, 'PO Type / PO 类别', 'Promotion type / 促销类别')}</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                    {!thisPR.ASI_CRM_CN_Promotion_Type__c}</td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;"><b>Final Payment / 最后一次付款</b></td>
                <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                    <!-- {!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_NewChannel__r.Name}
                    <apex:variable var="outletType" value=""
                        rendered="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c!=null}">
                        &nbsp;-</apex:variable>
                    {!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Grade__c} -->
                    <apex:outputText value="Yes" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c=true}" />
                    <apex:outputText value="No" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c!=true}" />
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                    <b>Image / 形象</b></td>
                <td valign="top"
                    style="border-top:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                    {!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Outlet_WS__r.ASI_CRM_CN_Image__c}
                </td>
                <td valign="top"
                    style="border-top:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                    <b>Group Contract Payment / 全国合同付款</b> </td>
                <td valign="top"
                    style="border-top:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                    {!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_Group_Contract__r.Name}
                </td>
            </tr>

            <tr>
                <apex:variable var="b" value="{!thisPR.ASI_CRM_New_FY_Payment__c}"
                    rendered="{!thisPR.ASI_CRM_New_FY_Payment__c}">
                    <td valign="top"
                        style="border-left: 1px solid black;border-right: 1px solid black; border-bottom: 1px solid black;"><b>
                        Channel / PO渠道</b></td>
                    <td valign="top" colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_Channel__r.Name}" />
                    </td>
                </apex:variable>

                <apex:variable var="b" value="{!thisPR.ASI_CRM_New_FY_Payment__c}"
                    rendered="{!thisPR.ASI_CRM_New_FY_Payment__c}">
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"><b>
                        Province / PO省份</b></td>
                    <td valign="top" colspan="1" style="border-right: 1px solid black; border-bottom: 1px solid black;">
                        <apex:outputText value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_PO_Province__r.Name}" />
                    </td>
                </apex:variable>
            </tr>
            <tr>
                <td valign="top"
                    style="border-left:1px solid black;border-right:1px solid black;border-bottom: 1px solid black">
                    <b>合同编号 / Contract NO.</b></td>
                <td valign="top" style="border-right:1px solid black;border-bottom: 1px solid black">
                    <!-- <apex:outputText value="Yes" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c=true}" />
                    <apex:outputText value="No" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c!=true}" /> -->
                    {!thisPR.ASI_TH_CRM_Contract__r.Name}
                </td>
                <td valign="top" style="border-right:1px solid black;border-bottom: 1px solid black">
                </td>
                <td valign="top" style="border-right:1px solid black;border-bottom: 1px solid black">
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="border-bottom:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                    <b>Description / 付款说明</b></td>
                <td valign="top" style="border-bottom:1px solid black;border-right:1px solid black;">
                    <apex:outputField value="{!thisPR.ASI_CRM_CN_Description__c}" />
                </td>
                <td valign="top" style="border-bottom:1px solid black;border-right:1px solid black;"><!--< b>Investment type
                        / 投资类型</b> --></td>
                <td valign="top" style="border-bottom:1px solid black;border-right:1px solid black;">
                    <!-- <apex:outputField value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_Investment_Type__c}" /> -->
                </td>
            </tr>
        </table>

        <br />

        <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'A') || contains(BelongGroup,'B') }" value="" var="">
            <table width="100%" cellspacing="0" border="0" cellpadding="2" >
                <tr>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Payment Methods / 付款方式</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payee Name / 一级批发商</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>WS Name / 二级批发商</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Amount / 付款金额</b></td>
                </tr>
                <apex:variable value="{!0}" var="TotalPayeeAmount" />
                <apex:repeat value="{!PayeeList}" var="pe">
                    <apex:variable var="TotalPayeeAmount" value="{!TotalPayeeAmount+pe.ASI_CRM_CN_Amount__c}"
                        rendered="{!pe.ASI_CRM_CN_Amount__c!=null}" />
                    <tr>
                        <td valign="top"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                            {!pe.ASI_CRM_CN_Type__c}</td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{!pe.ASI_CRM_CN_Payee_Name_T1__r.Name}" />
                            <apex:outputText value="{!pe.ASI_CRM_CN_Cash_Payee_Name_T1__r.Name}" />
                        </td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            {!pe.ASI_CRM_CN_Payee_Name_T2_lookup__r.Name}
                            <apex:outputText value=" - " rendered="{!pe.ASI_CRM_CN_Payee_Name_T2_lookup__c==null}" />
                        </td>
                        <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!pe.ASI_CRM_CN_Amount__c!=0}">
                                <apex:param value="{!pe.ASI_CRM_CN_Amount__c}" />
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td align="right" valign="top" colspan="3" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Total&nbsp;</b></td>
                    <td align="right" valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!TotalPayeeAmount!=0}">
                            <apex:param value="{!TotalPayeeAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalPayeeAmount==null||TotalPayeeAmount==0}" />
                    </td>
                </tr>
            </table>

            <br />

            <table width="100%" cellspacing="0" border="0" cellpadding="2" >
                <thead>
                    <tr>
                        <td colspan="4"><b>Payment Summary / 付款金额汇总</b></td>
                    </tr>
                    <tr>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        </td>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-right:1px solid black;"><b>PO Estimated Amount /
                                预估金额</b></td>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-right:1px solid black;"><b>PO Remaining Amount /
                                剩余金额</b></td>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Request Amount /
                                申请金额</b></td>
                    </tr>
                </thead>
                <apex:variable value="{!0}" var="POEstimatedAmountTotal" />
                <apex:variable value="{!0}" var="PORemainingAmountTotal" />
                <apex:variable value="{!0}" var="PaymentRequestAmountTotal" />
                <tbody>
                    <apex:repeat value="{!PaymentSummaryList}" var="PaymentSummary" id="PaymentSummaryListItem">
                        <apex:variable var="POEstimatedAmountTotal"
                            value="{!POEstimatedAmountTotal+PaymentSummary.POEstimatedAmount}" />
                        <apex:variable var="PORemainingAmountTotal"
                            value="{!PORemainingAmountTotal+PaymentSummary.POEstimatedAmount - PaymentSummary.PaidAmount}" />
                        <apex:variable var="PaymentRequestAmountTotal"
                            value="{!PaymentRequestAmountTotal+PaymentSummary.PaymentRequestAmount}" />
                        <tr>
                            <td valign="top"
                                style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                {!PaymentSummary.Name}
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!PaymentSummary.POEstimatedAmount}" />
                                </apex:outputText>
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!PaymentSummary.POEstimatedAmount - PaymentSummary.PaidAmount}" />
                                </apex:outputText>
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!PaymentSummary.PaymentRequestAmount}" />
                                </apex:outputText>
                            </td>
                        </tr>
                    </apex:repeat>
                    <tr>
                        <td valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                            <b>Total / 付款总额&nbsp;</b>
                        </td>

                        <td align="right" valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!POEstimatedAmountTotal!=null&&POEstimatedAmountTotal!=0}">
                                <apex:param value="{!POEstimatedAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!POEstimatedAmountTotal==null||POEstimatedAmountTotal==0}" />
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!PORemainingAmountTotal!=null&&PORemainingAmountTotal!=0}">
                                <apex:param value="{!PORemainingAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!PORemainingAmountTotal==null||PORemainingAmountTotal==0}" />
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!PaymentRequestAmountTotal!=null&&PaymentRequestAmountTotal!=0}">
                                <apex:param value="{!PaymentRequestAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!PaymentRequestAmountTotal==null||PaymentRequestAmountTotal==0}" />
                        </td>

                    </tr>
                </tbody>
            </table>



            <table width="100%" cellspacing="0" cellpadding="2" >
                <tr>
                    <td colspan="4"><b>Financial Indicator / 财务指标</b></td>
                </tr>
                <tr>
                    <td colspan="2" valign="top" bgcolor="#99CCFF" align="center" style="border: 1px solid black;">
                        Contract to
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay<=thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!CutOffDay}" />
                        </apex:outputText>
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay>thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}" />
                        </apex:outputText>
                        Volume Completion % VS % Payment Speed<br />合同开始至
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay<=thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!CutOffDay}" />
                        </apex:outputText>
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay>thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}" />
                        </apex:outputText>
                        销售完成情况VS付款进度
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        <b>VOL % / 销量完成率 (CR12)</b></td>
                    <td width="50%" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!Other_VOL_CR12!=0}">
                            <apex:param value="{!Other_VOL_CR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!Other_VOL_CR12==null||Other_VOL_CR12==0}" />
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        <b>Payment Speed % / 付款进度</b></td>
                    <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!PaymentSpeed!=null&&PaymentSpeed!=0}">
                            <apex:param value="{!PaymentSpeed}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PaymentSpeed==null||PaymentSpeed==0}" />
                    </td>
                </tr>
                <!-- <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        <b>Payment Speed excl. Fixed Cost% /<br /> 付款进度(除固定费用）</b>
                    </td>
                    <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!PaymentSpeedexcFixCost!=null&&PaymentSpeedexcFixCost!=0}">
                            <apex:param value="{!PaymentSpeedexcFixCost}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!PaymentSpeedexcFixCost==null||PaymentSpeedexcFixCost==0}" />
                    </td>
                </tr> -->
            </table>
            <br />
        </apex:variable>

        <!-- <br />
        <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 11px">
            <tr>
                <td style="border-left: 1px solid black;border-bottom: 1px solid black;border-top: 1px solid black;">By
                    Category / 按类别</td>
                <td style="border-left: 1px solid black;border-bottom: 1px solid black;border-top: 1px solid black;">
                    V0.0 Full Contract<br />Target/合同销量目标</td>
                <td style="border-left: 1px solid black;border-bottom: 1px solid black;border-top: 1px solid black;">
                    Actual Performance<br />/实际进货量</td>
                <td
                    style="border-left: 1px solid black;border-bottom: 1px solid black;border-top: 1px solid black;border-right: 1px solid black;">
                    Completion%<br />/完成率%</td>
            </tr>
            <apex:variable value="{!0}" var="TotalFullContractTarget" />
            <apex:variable value="{!0}" var="TotalCTDActualVol" />

            <apex:repeat value="{!VolumeByCategoryMap}" var="Volitm" id="VolumeMapId">
                <apex:variable var="TotalFullContractTarget"
                    value="{!TotalFullContractTarget+VolumeByCategoryMap[Volitm].FullContractTarget}" />
                <apex:variable var="TotalCTDActualVol" value="{!TotalCTDActualVol+VolumeByCategoryMap[Volitm].CTDActualVol}" />

                <tr>
                    <td style="border-left: 1px solid black; border-bottom: 1px solid black;">
                        {!VolumeByCategoryMap[Volitm].CategoryName}
                    </td>
                    <td style="border-left: 1px solid black;border-bottom: 1px solid black;" align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,##0}"
                            rendered="{!VolumeByCategoryMap[Volitm].FullContractTarget!=0}">
                            <apex:param value="{!VolumeByCategoryMap[Volitm].FullContractTarget}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeByCategoryMap[Volitm].FullContractTarget==0}" />
                    </td>
                    <td style="border-left: 1px solid black;border-bottom: 1px solid black;" align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{!VolumeByCategoryMap[Volitm].CTDActualVol!=0}">
                            <apex:param value="{!VolumeByCategoryMap[Volitm].CTDActualVol}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeByCategoryMap[Volitm].CTDActualVol==0}" />
                    </td>
                    <td style="border-left: 1px solid black;border-bottom: 1px solid black;border-right: 1px solid black;"
                        align="right" valign="top">

                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!VolumeByCategoryMap[Volitm].FullContractTarget!=0}">
                            <apex:param value="{!(VolumeByCategoryMap[Volitm].CTDActualVol/VolumeByCategoryMap[Volitm].FullContractTarget)*100}">
                            </apex:param>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!VolumeByCategoryMap[Volitm].FullContractTarget==0}" />
                    </td>
                </tr>

            </apex:repeat>

            <tr>
                <td style="border-left: 1px solid black; border-bottom: 1px solid black;">Total Volume (Std Btl) / 总销量
                    （标准瓶）
                </td>
                <td style="border-left: 1px solid black;border-bottom: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0}" rendered="{!TotalFullContractTarget!=0}">
                        <apex:param value="{!TotalFullContractTarget}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalFullContractTarget==0}" />
                </td>
                <td style="border-left: 1px solid black;border-bottom: 1px solid black;" align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0}" rendered="{!TotalCTDActualVol!=0}">
                        <apex:param value="{!TotalCTDActualVol}" />
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalCTDActualVol==0}" />
                </td>
                <td style="border-left: 1px solid black;border-bottom: 1px solid black;border-right: 1px solid black;"
                    align="right" valign="top">
                    <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!TotalFullContractTarget!=0}">
                        <apex:param value="{!(TotalCTDActualVol/TotalFullContractTarget)*100}"></apex:param>
                    </apex:outputText>
                    <apex:outputText value=" - " rendered="{!TotalFullContractTarget==0}" />
                </td>
            </tr>
        </table> -->

        
        <apex:outputpanel id="BRSFPart"
            rendered="{!IF(AND(DisplayBRSFPart == true,thisPR.ASI_CRM_CN_Last_Payment__c == false), true, false)}">
            <apex:variable rendered="{!contains(BelongGroup,'B') || contains(BelongGroup,'C') || contains(BelongGroup,'A')}" value="" var="">
                <table width="100%" cellspacing="0" cellpadding="2"
                    style="font-size: 11px;{!IF(contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C'),'','display:none;')}">

                    <tr>
                        <td colspan="2" valign="top" bgcolor="#99CCFF" align="left" style="border: 1px solid black;">
                            BRSF / 空瓶付款
                        </td>
                    </tr>
                    <tr>
                        <td width="50%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            BRSF Methodology / 空瓶回收费付款方式
                        </td>
                        <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                            align="left">
                            {!BRSFItemMap.Module.ASI_CRM_Methodology__r.Name}<br />
                            {!BRSFItemMap.Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c}
                        </td>
                    </tr>

                    <tr>
                        <td width="50%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            CTD BRSF Payment Period
                        </td>
                        <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                            align="left">
                            <apex:outputText value="{0,date,MM/dd/yy}">
                                <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c}" />
                            </apex:outputText>
                            -<apex:outputText value="{0,date,MM/dd/yy}">
                                <apex:param value="{!BRSFItemMap.Module.ASI_CRM_End_Date__c}" />
                            </apex:outputText>
                            [{!BRSFmonthsBetween} month(s)]
                        </td>
                    </tr>


                    <tr>
                        <td width="50%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            CTD BC% / 合同销量至今空瓶回收率
                        </td>
                        <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                            align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!BRSFItemMap.BCRate!=null && BRSFItemMap.BCRate!=0}">
                                <apex:param value="{!BRSFItemMap.BCRate}" />
                            </apex:outputText>
                            <apex:outputText value="0%" rendered="{!BRSFItemMap.BCRate=null || BRSFItemMap.BCRate=0}" />

                        </td>
                    </tr>


                    <tr>
                        <td width="50%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            BC % Contract / 合同签约空瓶回收率
                        </td>
                        <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                            align="right">

                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                                <apex:param value="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c}" />
                            </apex:outputText>
                            <apex:outputText value="0%"
                                rendered="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c=null || ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c=0}" />

                        </td>
                    </tr>

                    <tr>
                        <td width="50%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            BRSF Over Payment Reason / 原因说明
                        </td>
                        <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                            align="left">
                            {!BRSFItemMap.Module.ASI_CRM_Overpayment_Reason__c}
                        </td>
                    </tr>

                </table>
                <br />
            </apex:variable>

        </apex:outputpanel>

        
        <apex:outputpanel id="PSFPart"
            rendered="{!IF(AND(DisplayPSFPart == true,thisPR.ASI_CRM_CN_Last_Payment__c == false), true, false)}">
            <apex:variable rendered="{!contains(BelongGroup,'B') || contains(BelongGroup,'C') || contains(BelongGroup,'A')}" value="" var="">
                <table width="100%" cellspacing="0" cellpadding="2" style="font-size: 11px">

                    <tr>
                        <td colspan="3" valign="top" bgcolor="#99CCFF" align="left" style="border: 1px solid black;">
                            PSF / 合同奖励
                        </td>
                    </tr>
                    <apex:variable value="{!0}" var="i" />
                    <apex:repeat value="{!PSF_Item_Map}" var="itm" id="PSFitem">
                        <apex:variable var="i" value="{!i+1}" />
                        <tr>
                            <td colspan="3" valign="top" bgcolor="#FFFFCC" align="left" style="border: 1px solid black;">
                                PSF Module {!i}
                            </td>
                        </tr>
                        <tr>
                            <td width="30%" valign="top"
                                style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                                PSF Methodology / 空瓶回收服务费付款方式
                            </td>
                            <td colspan="2" width="50%" valign="top"
                                style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                                {!PSF_Item_Map[itm].Module.ASI_CRM_Methodology__r.Name}<br />
                                {!PSF_Item_Map[itm].Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c}
                            </td>
                        </tr>

                        <tr>
                            <td width="30%" valign="top"
                                style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                                Volume Option &amp; Unit/ 销量方式 &amp; 单位
                            </td>
                            <td colspan="2" width="50%" valign="top"
                                style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                                <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c}" />
                                (
                                <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}" />)
                            </td>
                        </tr>

                        <tr>
                            <td width="30%" valign="top"
                                style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                                PSF Payment Period
                            </td>
                            <td width="33.33%" valign="top"
                                style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                                Payment Amount / 付款总额
                            </td>

                            <td width="33.33%" valign="top"
                                style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                                Description / 付款说明
                            </td>

                        </tr>
                        <tr>
                            <td width="30%" valign="top"
                                style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                                <apex:outputText value="{0,date,MM/dd/yy}">
                                    <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c}" />
                                </apex:outputText>
                                -<apex:outputText value="{0,date,MM/dd/yy}">
                                    <apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_End_Date__c}" />
                                </apex:outputText>
                            </td>
                            <td width="33.33%" valign="top"
                                style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                                <apex:outputText value="{0,number,#,###,##0.00}"
                                    rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c!=null&& PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c!=0}">
                                    <apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c}" />
                                </apex:outputText>
                                <apex:outputText value="0"
                                    rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c=null||PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c=0}" />
                            </td>

                            <td width="33.33%" valign="top"
                                style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                                {!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Remark__c}
                            </td>

                        </tr>

                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </apex:repeat>

                </table>
                <br />
            </apex:variable>
            
        </apex:outputpanel>

        


        <!-- <apex:outputpanel id="LastPaymentPart" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c}">
            <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 11px">
                <thead>
                    <tr>
                        <td colspan="6" bgcolor="#99CCFF" style="border:1px solid black;"><strong>Last Payment /
                                最后付款</strong></td>
                    </tr>
                    <tr>
                        <td width="25%"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                            valign="top"><b>INTAKE / 进货量</b></td>
                        <td width="15%" style="border-right: 1px dotted gray;border-bottom: 1px solid black;"
                            align="center" valign="top"><b>Contract / 合同</b></td>
                        <td width="15%" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                            align="center" valign="top"><b>Estimate V0.0 / <br />预估 V0.0</b></td>
                        <td width="15%" style="border-bottom: 1px solid black;border-right: 1px solid black;"
                            align="center" valign="top"><b>Actual Performance / <br />实际销量</b></td>
                        <td width="15%" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                            align="center" valign="top"><b>vs Estimation % / <br />vs 预估V0.0 %</b></td>
                        <td width="15%" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                            align="center" valign="top"><b>vs Contract %</b></td>

                    </tr>
                </thead>


                <tr>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        valign="top"><strong>Volume (in 9L cs)</strong></td>
                    <td style="border-right: 1px dotted gray;border-bottom: 1px solid black;" align="right"
                        valign="top">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{!NewContactV0Contract2nd.Volumes!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.Volumes==0}" />
                    </td>
                    <td style="border-right: 1px dotted gray;border-bottom: 1px solid black;border-right: 1px dotted gray;"
                        align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{!NewContractV0Esitimate2nd.Volumes!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.Volumes==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        valign="top">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{!ActualPerformance2nd.Volumes!=0}">
                            <apex:param value="{!ActualPerformance2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.Volumes==0}" />
                    </td>
                    <td style="border-right: 1px dotted gray;border-bottom: 1px solid black;" align="right"
                        valign="top">
                        <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContractV0Esitimate2nd.Volumes!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.Volumes-NewContractV0Esitimate2nd.Volumes)*100/NewContractV0Esitimate2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.Volumes==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;border-right: 1px solid black;"
                        align="right" valign="top">
                        <apex:outputText value="{0,number,#,###,##0}%" rendered="{!NewContactV0Contract2nd.Volumes!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.Volumes-NewContactV0Contract2nd.Volumes)*100/NewContactV0Contract2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.Volumes==0}" />
                    </td>
                </tr>

                <apex:repeat value="{!sbGroup_map}" var="sbgroup">
                    <tr>
                        <td style="border-left: 1px solid black; border-right: 1px solid black;">{!sbGroup_map[sbgroup]}
                        </td>

                        <td style="border-right: 1px dotted gray; " align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]!=0}">
                                <apex:param value="{!NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]==0||NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]==null}" />
                        </td>

                        <td style="border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]!=0}">
                                <apex:param value="{!NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]==0||NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]==null}" />
                        </td>

                        <td style="border-right: 1px solid black; " align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!ActualPerformance2nd.SubBrandGradeMap[sbgroup]!=0}">
                                <apex:param value="{!ActualPerformance2nd.SubBrandGradeMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!ActualPerformance2nd.SubBrandGradeMap[sbgroup]==0||ActualPerformance2nd.SubBrandGradeMap[sbgroup]==null}" />
                        </td>


                        <td style="border-right: 1px dotted gray;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]!=0}">
                                <apex:param
                                    value="{!(ActualPerformance2nd.SubBrandGradeMap[sbgroup]-NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup])*100/NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!NewContractV0Esitimate2nd.SubBrandGradeMap[sbgroup]==0}" />
                        </td>
                        <td style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]!=0}">
                                <apex:param
                                    value="{!(ActualPerformance2nd.SubBrandGradeMap[sbgroup]-NewContactV0Contract2nd.SubBrandGradeMap[sbgroup])*100/NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!NewContactV0Contract2nd.SubBrandGradeMap[sbgroup]==0}" />
                        </td>

                    </tr>
                </apex:repeat>

                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#E3DFDA"><strong>Trade Expenses / 销售费用</strong></td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!NewContactV0Contract2nd.TradeExpenses!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.TradeExpenses==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!NewContractV0Esitimate2nd.TradeExpenses!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.TradeExpenses==0}" />
                    </td>
                    <td valign="top" style=" border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!ActualPerformance2nd.TradeExpenses!=0}">
                            <apex:param value="{!ActualPerformance2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.TradeExpenses==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        bgcolor="#E3DFDA" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.TradeExpenses!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.TradeExpenses-NewContractV0Esitimate2nd.TradeExpenses)*100/NewContractV0Esitimate2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.TradeExpenses==0}" />

                    </td>
                    <td valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        bgcolor="#E3DFDA" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.TradeExpenses!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.TradeExpenses-NewContactV0Contract2nd.TradeExpenses)*100/NewContactV0Contract2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.TradeExpenses==0}" />

                    </td>
                </tr>

                <tr>
                    <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;"><strong>%
                            Gross Sales / % 营业额 </strong></td>
                    <td style="border-right: 1px dotted gray;" valign="top" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContactV0Contract2nd.GrossSalesRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRate==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.GrossSalesRate==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.GrossSalesRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.GrossSalesRate==0}" />
                    </td>
                    <td style="border-right: 1px dotted gray;" valign="top" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRate!=0 || ActualPerformance2nd.GrossSalesRate!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.GrossSalesRate-NewContractV0Esitimate2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRate==0 && ActualPerformance2nd.GrossSalesRate==0}" />

                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContactV0Contract2nd.GrossSalesRate!=0 || ActualPerformance2nd.GrossSalesRate!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.GrossSalesRate-NewContactV0Contract2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.GrossSalesRate==0 && ActualPerformance2nd.GrossSalesRate==0}" />

                    </td>
                </tr>

                <tr>
                    <td style="border-left: 1px solid black; border-right: 1px solid black;">% Gross Sales ％ 营业额 <br />
                        (excl Premium brands/剔除高档品牌)**</td>
                    <td style="border-right: 1px dotted black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContactV0Contract2nd.GrossSalesRateExcl!=null&& NewContactV0Contract2nd.GrossSalesRateExcl!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.GrossSalesRateExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.GrossSalesRateExcl==null || NewContactV0Contract2nd.GrossSalesRateExcl==0}" />
                    </td>
                    <td style="border-right: 1px dotted black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRateExcl!=null && NewContractV0Esitimate2nd.GrossSalesRateExcl!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesRateExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRateExcl==null || NewContractV0Esitimate2nd.GrossSalesRateExcl==0}" />
                    </td>
                    <td style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.GrossSalesRateExcl!=null && ActualPerformance2nd.GrossSalesRateExcl!=0}">
                            <apex:param value="{!ActualPerformance2nd.GrossSalesRateExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.GrossSalesRateExcl==null || ActualPerformance2nd.GrossSalesRateExcl==0}" />
                    </td>
                    <td style="border-right: 1px dotted gray;" valign="top" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRateExcl!=0 || ActualPerformance2nd.GrossSalesRateExcl!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.GrossSalesRateExcl-NewContractV0Esitimate2nd.GrossSalesRateExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRateExcl==0 && ActualPerformance2nd.GrossSalesRateExcl==0}" />

                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContactV0Contract2nd.GrossSalesRateExcl!=0 || ActualPerformance2nd.GrossSalesRateExcl!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.GrossSalesRateExcl-NewContactV0Contract2nd.GrossSalesRateExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.GrossSalesRateExcl==0 && ActualPerformance2nd.GrossSalesRateExcl==0}" />

                    </td>
                </tr>


                <tr>
                    <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;" valing="top">
                        Investment per CR12 Extra eq btl/折CR12新境单瓶投入</td>
                    <td style="border-right: 1px dotted gray;" valign="top" align="right">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.InvestmentCR12!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.InvestmentCR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.InvestmentCR12==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.InvestmentCR12!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.InvestmentCR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.InvestmentCR12==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!ActualPerformance2nd.InvestmentCR12!=0}">
                            <apex:param value="{!ActualPerformance2nd.InvestmentCR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.InvestmentCR12==0}" />
                    </td>
                    <td valign="top" align="right" style="border-right: 1px dotted gray;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.InvestmentCR12!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.InvestmentCR12-NewContractV0Esitimate2nd.InvestmentCR12)*100/NewContractV0Esitimate2nd.InvestmentCR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.InvestmentCR12==0}" />

                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.InvestmentCR12!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.InvestmentCR12-NewContactV0Contract2nd.InvestmentCR12)*100/NewContactV0Contract2nd.InvestmentCR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.InvestmentCR12==0}" />
                    </td>
                </tr>

                <tr>
                    <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;">Variable
                        Expense / 变动费用 </td>
                    <td valign="top" align="right" style="border-right: 1px dotted gray;">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!NewContactV0Contract2nd.VariableExpense!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!NewContractV0Esitimate2nd.VariableExpense!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.VariableExpense==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!ActualPerformance2nd.VariableExpense!=0}">
                            <apex:param value="{!ActualPerformance2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.VariableExpense==0}" />
                    </td>
                    <td valign="top" align="right" style="border-right: 1px dotted gray;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.VariableExpense!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.VariableExpense-NewContractV0Esitimate2nd.VariableExpense)*100/NewContractV0Esitimate2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.VariableExpense==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.VariableExpense!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.VariableExpense-NewContactV0Contract2nd.VariableExpense)*100/NewContactV0Contract2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==0}" />
                    </td>
                </tr>
                <tr>
                    <td valign="top" style="border-left: 1px solid black; border-right: 1px solid black;">Fixed Expense
                        / 固定费用 </td>
                    <td valign="top" align="right" style="border-right: 1px dotted gray;">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!NewContactV0Contract2nd.FixedExpense!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.FixedExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpense==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="({0,number,#,###,##0})"
                            rendered="{!NewContractV0Esitimate2nd.FixedExpense!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.FixedExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpense==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="({0,number,#,###,##0})" rendered="{!ActualPerformance2nd.FixedExpense!=0}">
                            <apex:param value="{!ActualPerformance2nd.FixedExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.FixedExpense==0}" />
                    </td>
                    <td valign="top" align="right" style="border-right: 1px dotted gray;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.FixedExpense!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.FixedExpense-NewContractV0Esitimate2nd.FixedExpense)}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpense==0}" />

                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.FixedExpense!=0}">
                            <apex:param value="{!(ActualPerformance2nd.FixedExpense-NewContactV0Contract2nd.FixedExpense)}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpense==0}" />
                    </td>
                </tr>

                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        Fixed Expense % / 固定费用比例 % </td>
                    <td valign="top" align="right"
                        style="border-bottom: 1px solid black;border-right: 1px dotted gray;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpenseRate==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.FixedExpenseRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.FixedExpenseRate==0}" />
                    </td>
                    <td valign="top" align="right"
                        style="border-bottom: 1px solid black;border-right: 1px dotted gray;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate!=0 || ActualPerformance2nd.FixedExpenseRate!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.FixedExpenseRate-NewContractV0Esitimate2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate==0 && ActualPerformance2nd.FixedExpenseRate==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=0 || ActualPerformance2nd.FixedExpenseRate!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.FixedExpenseRate-NewContactV0Contract2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.FixedExpenseRate==0 && ActualPerformance2nd.FixedExpenseRate==0}" />
                    </td>
                </tr>



            </table>


        </apex:outputpanel>


        <apex:outputpanel rendered="{!AdorAbove && thisPR.ASI_CRM_CN_Last_Payment__c}">
            <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 11px">
                <tr>
                    <td width="25%" valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#FFFF99"><strong>
                            <apex:outputText value="Cont. Margin after A&P / 销售净利润 " /></strong>
                    </td>
                    <td width="15%" valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}"
                            rendered="{!NewContactV0Contract2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginAfterAnP==0}" />
                    </td>
                    <td width="15%" valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}"
                            rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP==0}" />
                    </td>
                    <td width="15%" valign="top" style="border-bottom: 1px solid black;border-right: 1px solid black;"
                        align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}" rendered="{!ActualPerformance2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!ActualPerformance2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.MarginAfterAnP==0}" />
                    </td>
                    <td width="15%" valign="top" align="right"
                        style="border-right: 1px dotted gray; border-bottom: 1px solid black;" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.MarginAfterAnP-NewContractV0Esitimate2nd.MarginAfterAnP)*100/NewContractV0Esitimate2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP==0}" />
                    </td>
                    <td width="15%" valign="top" style="border-right: 1px solid black;border-bottom: 1px solid black;"
                        align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.MarginAfterAnP!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.MarginAfterAnP-NewContactV0Contract2nd.MarginAfterAnP)*100/NewContactV0Contract2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginAfterAnP==0}" />

                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#FFFF99"><strong>Cont. Margin per Bottle / 单瓶利润 </strong></td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}"
                            rendered="{!NewContactV0Contract2nd.MarginPerBottle!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.MarginPerBottle}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginPerBottle==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right" bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}"
                            rendered="{!NewContractV0Esitimate2nd.MarginPerBottle!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.MarginPerBottle}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.MarginPerBottle==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}"
                            rendered="{!ActualPerformance2nd.MarginPerBottle!=0}">
                            <apex:param value="{!ActualPerformance2nd.MarginPerBottle}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.MarginPerBottle==0}" />
                    </td>
                    <td valign="top" align="right" bgcolor="#FFFF99"
                        style="border-right: 1px dotted gray; border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.MarginPerBottle!=0}">
                            <apex:param
                                value="{!(ActualPerformance2nd.MarginPerBottle-NewContractV0Esitimate2nd.MarginPerBottle)*100/NewContractV0Esitimate2nd.MarginPerBottle}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.MarginPerBottle==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px solid black;border-bottom: 1px solid black;" align="right"
                        bgcolor="#FFFF99">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.MarginPerBottle!=0}">
                            <apex:param
                                value="{!(NewContactV0Contract2nd.MarginPerBottle-NewContactV0Contract2nd.MarginPerBottle)*100/NewContactV0Contract2nd.MarginPerBottle}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginPerBottle==0}" />

                    </td>
                </tr>
                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#FF9999"><strong>ROI / 投资回报率</strong></td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIIntake!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIIntake==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIIntake!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.ROIIntake==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ActualPerformance2nd.ROIIntake!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.ROIIntake==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIIntake!=0 || ActualPerformance2nd.ROIIntake!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIIntake-NewContractV0Esitimate2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.ROIIntake==0 && ActualPerformance2nd.ROIIntake==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIIntake!=0 || ActualPerformance2nd.ROIIntake!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIIntake-NewContactV0Contract2nd.ROIIntake}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.ROIIntake==0 && ActualPerformance2nd.ROIIntake==0}" />

                    </td>
                </tr>

                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#E3DFDA"><strong>ROI / 投资回报率<br /> (excl Premium brands/剔除高档品牌)**</strong></td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIIntakeExcl!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.ROIIntakeExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIIntakeExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIIntakeExcl!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.ROIIntakeExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.ROIIntakeExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!ActualPerformance2nd.ROIIntakeExcl!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIIntakeExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.ROIIntakeExcl==0}" />
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray; border-bottom: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIIntakeExcl!=0 || ActualPerformance2nd.ROIIntakeExcl!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.ROIIntakeExcl-NewContractV0Esitimate2nd.ROIIntakeExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.ROIIntakeExcl==0 && ActualPerformance2nd.ROIIntakeExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIIntakeExcl!=0 || ActualPerformance2nd.ROIIntakeExcl!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIIntakeExcl-NewContactV0Contract2nd.ROIIntakeExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.ROIIntakeExcl==0 && ActualPerformance2nd.ROIIntakeExcl==0}" />

                    </td>
                </tr>

                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#FF9999"><strong>ROI (Pro-Forma) / 预设投资回报率</strong></td>
                    <td valign="top" style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                        bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIProForma!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIProForma==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIProForma!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.ROIProForma==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!ActualPerformance2nd.ROIProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.ROIProForma==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                        bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIProForma!=0 || ActualPerformance2nd.ROIProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIProForma-NewContractV0Esitimate2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.ROIProForma==0 && ActualPerformance2nd.ROIProForma==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#FF9999">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIProForma!=0 || ActualPerformance2nd.ROIProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIProForma-NewContactV0Contract2nd.ROIProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.ROIProForma==0 && ActualPerformance2nd.ROIProForma==0}" />

                    </td>
                </tr>

                <tr>
                    <td valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;"
                        bgcolor="#E3DFDA"><strong>ROI (Pro-Forma) / 预设投资回报率 <br /> (excl Premium
                            brands/剔除高档品牌)**</strong></td>
                    <td valign="top" style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIProFormaExcl!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.ROIProFormaExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.ROIProFormaExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIProFormaExcl!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.ROIProFormaExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.ROIProFormaExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!ActualPerformance2nd.ROIProFormaExcl!=0}">
                            <apex:param value="{!ActualPerformance2nd.ROIProFormaExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.ROIProFormaExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black;border-right: 1px dotted gray;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContractV0Esitimate2nd.ROIProFormaExcl!=0 || ActualPerformance2nd.ROIProFormaExcl!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.ROIProFormaExcl-NewContractV0Esitimate2nd.ROIProFormaExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.ROIProFormaExcl==0 && ActualPerformance2nd.ROIProFormaExcl==0}" />
                    </td>
                    <td valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,##0.00}"
                            rendered="{!NewContactV0Contract2nd.ROIProFormaExcl!=0 || ActualPerformance2nd.ROIProFormaExcl!=0}">
                            <apex:param
                                value="{!ActualPerformance2nd.ROIProFormaExcl-NewContactV0Contract2nd.ROIProFormaExcl}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.ROIProFormaExcl==0 && ActualPerformance2nd.ROIProFormaExcl==0}" />

                    </td>
                </tr>


            </table>
        </apex:outputpanel>




        <apex:outputpanel id="LastPaymentPart2" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c}">
            <table width="100%" border="0" cellpadding="3" cellspacing="0" style="font-size: 11px">
                <tr>
                    <td valign="top" style=" border-left: 1px solid black; border-right: 1px solid black;">
                        <strong>Total BC % <br />空瓶回收率(Martell BC%)</strong>
                    </td>
                    <td valign="top" style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ContractBCRate!=0&&ContractBCRate!=null}">
                            <apex:param value="{!ContractBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ContractBCRate==0||ContractBCRate==null}" />

                        <apex:outputText value="(" rendered="{!MartellBCRate!=null && MartellBCRate!=0}" />
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!MartellBCRate!=null && MartellBCRate!=0}">
                            <apex:param value="{!MartellBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=")" rendered="{!MartellBCRate!=null && MartellBCRate!=0}" />

                    </td>
                    <td valign="top" style="border-right: 1px dotted gray;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ContractBCRate!=0&&ContractBCRate!=null}">
                            <apex:param value="{!ContractBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ContractBCRate==0||ContractBCRate==null}" />

                        <apex:outputText value="(" rendered="{!MartellBCRate!=null && MartellBCRate!=0}" />
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!MartellBCRate!=null && MartellBCRate!=0}">
                            <apex:param value="{!MartellBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=")" rendered="{!MartellBCRate!=null && MartellBCRate!=0}" />

                    </td>
                    <td valign="top" style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.BCRate!=0&&ActualPerformance2nd.BCRate!=null}">
                            <apex:param value="{!ActualPerformance2nd.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.BCRate==0||ActualPerformance2nd.BCRate==null}" />

                        <apex:outputText value="("
                            rendered="{!ActualPerformance2nd.TotalMBCRate!=null && ActualPerformance2nd.TotalMBCRate!=0}" />
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.TotalMBCRate!=null && ActualPerformance2nd.TotalMBCRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.TotalMBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=")"
                            rendered="{!ActualPerformance2nd.TotalMBCRate!=null && ActualPerformance2nd.TotalMBCRate!=0}" />

                    </td>
                    <td style=" border-right: 1px dotted gray; "></td>
                    <td style=" border-right: 1px solid black;"></td>

                </tr>



                <tr>
                    <td width="25%" valign="top"
                        style="border-bottom: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                        <strong>Net BC % 净空瓶回收率(Martell BC%)</strong></td>
                    <td width="15%" valign="top" style="border-bottom: 1px solid black;border-right: 1px dotted gray;"
                        align="right">


                    </td>
                    <td width="15%" valign="top" style="border-bottom: 1px solid black; border-right: 1px dotted gray;"
                        align="right">

                    </td>
                    <td width="15%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.NetBCRate!=0&&ActualPerformance2nd.NetBCRate!=null}">
                            <apex:param value="{!ActualPerformance2nd.NetBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.NetBCRate==0 || ActualPerformance2nd.NetBCRate==null}" />


                        <apex:outputText value="("
                            rendered="{!ActualPerformance2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=0}" />
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.NetMBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=")"
                            rendered="{!ActualPerformance2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=0}" />

                    </td>
                    <td width="15%" style="border-bottom: 1px solid black; border-right: 1px dotted gray; "></td>
                    <td width="15%" style="border-bottom: 1px solid black; border-right: 1px solid black;"></td>

                </tr>

            </table>

            {!selectedSubBrandDescription}
        </apex:outputpanel>

        <br />

        <apex:outputpanel rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c}">
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <thead>
                    <tr>
                        <td colspan="10" bgcolor="#99CCFF" style="border:1px solid black;">Investment by Sub-Brand 品牌投入
                        </td>
                    </tr>
                    <tr>
                        <td
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            &nbsp;</td>
                        <td colspan="3"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Trade Expenses Per Bottle<br />单瓶销售费用</td>
                        <td colspan="3"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">% Gross Sales<br />％ 营业额</td>
                        <td colspan="3"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">ROI (Actual)<br />投资回报率</td>
                    </tr>
                    <tr>
                        <td width="10%"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Sub-Brands 品牌</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Historical 历史</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Estimate 预计</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Actual 实际</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Historical 历史</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Estimate 预计</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Actual 实际</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Historical 历史</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Estimate 预计</td>
                        <td width="8%" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Actual 实际</td>
                    </tr>
                </thead>
                <apex:variable value="{!0}" var="TotalHistoricalBottles" />
                <apex:variable value="{!0}" var="TotalEstimateBottles" />
                <apex:variable value="{!0}" var="TotalContractBottles" />
                <apex:variable value="{!0}" var="TotalHistoricalFees" />
                <apex:variable value="{!0}" var="TotalEstimateFees" />
                <apex:variable value="{!0}" var="TotalContractFees" />
                <apex:variable value="{!0}" var="AllHistoricalTotalFees" />
                <apex:variable value="{!0}" var="AllEstimateTotalFees" />
                <apex:variable value="{!0}" var="AllContractTotalFees" />

                <apex:variable value="{!0}" var="HistoricalTotalFees" />
                <apex:variable value="{!0}" var="EstimateTotalFees" />
                <apex:variable value="{!0}" var="ContractTotalFees" />

                <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="subBrandId">
                    <tr>
                        <td align="left" valign="top"
                            style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText
                                value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].subBrandName,investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].subBrandName)}"
                                escape="false" />
                        </td>
                        <td align="right" valign="top" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['historical'].tradeExpensePerBottle, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}%">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['historical'].GSPercent, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}%">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GSPercent, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}%">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GSPercent, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['historical'].ROI, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].ROI, 0)}" />
                            </apex:outputText>
                        </td>
                        <td align="right" valign="top"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}">
                                <apex:param
                                    value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].ROI, 0)}" />
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
            </table>
        </apex:outputpanel>

        <br /> -->

        <apex:outputpanel id="ReviewPart" rendered="{!thisPR.ASI_CRM_CN_Last_Payment__c}" >
            <table width="100%" border="0" cellpadding="3" cellspacing="0" >
                <thead>
                    <tr>
                        <apex:outputText value="{!MainTableHeader1}" rendered="{!ExistHistoricalData}" escape="false" />
                        <apex:outputText value="{!MainTableHeader2}" rendered="{!!ExistHistoricalData}"
                            escape="false" />
                    </tr>
                    <tr>
                        <td style="border-left: 1px solid black; border-bottom: 1px solid
                        black;" width="30%">&nbsp;</td>
                        <td width="14%" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">
                            Contract<br />合同</td>
                        <td width="14%" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Estimate V0.0<br /> 预估 V0.0</td>
                        <td width="14%" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Actual
                            Performance<br />实际</td>
                        <td width="14%" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">vs Estimation %<br />vs 预估V0.0 %</td>
                        <td width="14%" style="border-right: 1px solid black;border-bottom: 1px solid black;" align="center">vs
                            Contract
                            %</td>
                    </tr>
                </thead>

                <tr>
                    <td
                        style="border-bottom: 1px solid black; border-left: 1px solid black;">
                        Volumes 销量 (in 9L cs)
                    </td>
                    <td style="border-bottom: 1px solid black; border-left: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.Volumes!=0 && NewContactV0Contract2nd.Volumes!=null}">
                            <apex:param value="{!NewContactV0Contract2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.Volumes==0||NewContactV0Contract2nd.Volumes==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; " align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.Volumes!=0&&NewContractV0Esitimate2nd.Volumes!=null}">
                            <apex:param value="{!NewContractV0Esitimate2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.Volumes==0||NewContractV0Esitimate2nd.Volumes==null}" />
                    </td>


                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.Volumes!=0 && ActualPerformance2nd.Volumes!=null}">
                            <apex:param value="{!ActualPerformance2nd.Volumes}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.Volumes==0||ActualPerformance2nd.Volumes==null}" />
                    </td>

                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.Volumes!=0 && ActualPerformance2nd.Volumes!=null }">
                            <apex:param value="{!((ActualPerformance2nd.Volumes/NewContractV0Esitimate2nd.Volumes)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.Volumes==0||ActualPerformance2nd.Volumes==null}" />
                    </td>

                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.Volumes!=0 && ActualPerformance2nd.Volumes!=null}">
                            <apex:param value="{!(ActualPerformance2nd.Volumes/NewContactV0Contract2nd.Volumes-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.Volumes==0||ActualPerformance2nd.Volumes==null}" />
                    </td>
                </tr>
                <apex:variable value="{!0}" var="index" />
                <apex:repeat value="{!sortCategoryMap}" var="sbgroup">
                    <apex:variable value="{!0+1}" var="index" />
                    <tr>
                        <td style="border-left: 1px solid black;">
                            <!-- {!sbGroup_ByCategoryVFMap[sbgroup]} -->
                            <!-- <apex:outputText value="{!BLANKVALUE(investmentByCategeryByContract[sbgroup]['estimate'].categoryName,BLANKVALUE(investmentByCategeryByContract[sbgroup]['contractData'].categoryName,investmentByCategeryByContract[sbgroup]['lastPayment'].categoryName))}" escape="false" /> -->
                            <apex:outputText value="{!sortCategoryMap[sbgroup]}" escape="false" />

                        </td>
                        <td style="border-left: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContactV0ContractMap[sbgroup]!=0}">
                                <apex:param value="{!NewContactV0ContractMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContactV0ContractMap[sbgroup]==0}" />
                        </td>
                        <td align="right" style="border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContractV0EsitimateMap[sbgroup]!=0}">
                                <apex:param value="{!NewContractV0EsitimateMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContractV0EsitimateMap[sbgroup]==0}" />
                        </td>
                        <td style="border-left: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!ActualPerformanceMap[sbgroup]!=0}">
                                <apex:param value="{!ActualPerformanceMap[sbgroup]}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!ActualPerformanceMap[sbgroup]==0}" />
                        </td>
                        <td align="right" style="border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}%"
                                rendered="{!NewContractV0EsitimateMap[sbgroup]!=0 && NewContractV0EsitimateMap[sbgroup]!=null
                                 && ActualPerformanceMap[sbgroup] != null}">
                                <apex:param value="{!((ActualPerformanceMap[sbgroup]/NewContractV0EsitimateMap[sbgroup])-1)*100}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!ActualPerformanceMap[sbgroup] == null || NewContractV0EsitimateMap[sbgroup] == 0 || NewContractV0EsitimateMap[sbgroup] == null}" />
                        </td>

                        <td style="border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}%"
                                rendered="{!NewContactV0ContractMap[sbgroup]!=0 && NewContactV0ContractMap[sbgroup]!=null && ActualPerformanceMap[sbgroup] != null}">
                                <apex:param value="{!(ActualPerformanceMap[sbgroup]/NewContactV0ContractMap[sbgroup]-1)*100}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!ActualPerformanceMap[sbgroup] == null || NewContactV0ContractMap[sbgroup] == 0 || NewContactV0ContractMap[sbgroup] == null}" />
                        </td>
                    </tr>
                </apex:repeat>

                 <!-- <apex:variable rendered="{!contains(BelongGroup,'C')}" value="" var="">
                    <tr
                        style="{!IF(contains(BelongGroup,'C'),'','display:none;')}">
                        <td
                            style="border-top: 1px solid black;border-left: 1px solid black;">
                            <strong>Gross Sales 营业额</strong>
                        </td>
                        <td style="border-top: 1px solid black;border-left: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContactV0Contract2nd.GrossSalesTotal!=0}">
                                <apex:param value="{!NewContactV0Contract2nd.GrossSalesTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesTotal==0}" />
                        </td>
                        <td align="right" style="border-top: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContractV0Esitimate2nd.GrossSalesTotal!=0}">
                                <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.GrossSalesTotal==0}" />
                        </td>
                        <td style="border-top: 1px solid black;border-left: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!ActualPerformance2nd.GrossSalesTotal!=0}">
                                <apex:param value="{!ActualPerformance2nd.GrossSalesTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!ActualPerformance2nd.GrossSalesTotal==0}" />
                        </td>
                        <td align="right" style="border-top: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}%"
                                rendered="{!ActualPerformance2nd.GrossSalesTotal!=null && NewContractV0Esitimate2nd.GrossSalesTotal!=0 && NewContractV0Esitimate2nd.GrossSalesTotal!=null}">
                                <apex:param value="{!(ActualPerformance2nd.GrossSalesTotal - NewContractV0Esitimate2nd.GrossSalesTotal)/NewContractV0Esitimate2nd.GrossSalesTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!NewContractV0Esitimate2nd.GrossSalesTotal==0||NewContractV0Esitimate2nd.GrossSalesTotal==null}" />
                        </td>
                        <td style="border-top: 1px solid black;border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,###}%"
                                rendered="{!ActualPerformance2nd.GrossSalesTotal!=null && NewContactV0Contract2nd.GrossSalesTotal!=0 && NewContactV0Contract2nd.GrossSalesTotal!=null}">
                                <apex:param value="{!(ActualPerformance2nd.GrossSalesTotal - NewContactV0Contract2nd.GrossSalesTotal)/NewContactV0Contract2nd.GrossSalesTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!NewContactV0Contract2nd.GrossSalesTotal==0||NewContactV0Contract2nd.GrossSalesTotal==null}" />
                        </td>
                    </tr>
                </apex:variable> -->
                <tr>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;border-top: 1px solid black;"
                        bgcolor="#E3DFDA">
                        <strong>Trade expenses 销售费用</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;border-top: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContactV0Contract2nd.TradeExpenses!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.TradeExpenses==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-top: 1px solid black;border-left: 1px solid black;"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContractV0Esitimate2nd.TradeExpenses!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.TradeExpenses==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;border-top: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!ActualPerformance2nd.TradeExpenses!=0}">
                            <apex:param value="{!ActualPerformance2nd.TradeExpenses}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.TradeExpenses==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;border-top: 1px solid black;"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.TradeExpenses!=0 && ActualPerformance2nd.TradeExpenses!=null }">
                            <apex:param value="{!((ActualPerformance2nd.TradeExpenses/NewContractV0Esitimate2nd.TradeExpenses)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.TradeExpenses==0||ActualPerformance2nd.TradeExpenses==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;border-top: 1px solid black;"
                        align="right" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.TradeExpenses!=0 && ActualPerformance2nd.TradeExpenses!=null}">
                            <apex:param value="{!(ActualPerformance2nd.TradeExpenses/NewContactV0Contract2nd.TradeExpenses-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.TradeExpenses==0||ActualPerformance2nd.TradeExpenses==null}" />
                    </td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black; ">
                        Variable expense 变动费用
                    </td>
                    <td style="border-left: 1px solid black;" align="right">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContactV0Contract2nd.VariableExpense!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VariableExpense==0}" />
                    </td>
                    <td align="right" style="border-left: 1px solid black;">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContractV0Esitimate2nd.VariableExpense!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.VariableExpense==0}" />
                    </td>
                    <td style="border-left: 1px solid black;" align="right">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!ActualPerformance2nd.VariableExpense!=0}">
                            <apex:param value="{!ActualPerformance2nd.VariableExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.VariableExpense==0}" />
                    </td>
                    <td align="right" style="border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.VariableExpense!=0 && ActualPerformance2nd.VariableExpense!=null }">
                            <apex:param value="{!((ActualPerformance2nd.VariableExpense/NewContractV0Esitimate2nd.VariableExpense)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VariableExpense==0||ActualPerformance2nd.VariableExpense==null}" />
                    </td>

                    <td style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.VariableExpense!=0 && ActualPerformance2nd.VariableExpense!=null}">
                            <apex:param value="{!(ActualPerformance2nd.VariableExpense/NewContactV0Contract2nd.VariableExpense-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VariableExpense==0||ActualPerformance2nd.VariableExpense==null}" />
                    </td>
                </tr>
                <tr>
                    <td style="border-left: 1px solid black;">
                        Fixed Expense 固定费用
                    </td>
                    <td style="border-left: 1px solid black;" align="right">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContactV0Contract2nd.FixedExpense!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.FixedExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpense==0}" />
                    </td>
                    <td align="right" style="border-left: 1px solid black;">
                        <apex:outputText value="({0,number,#,###,###})"
                            rendered="{!NewContractV0Esitimate2nd.FixedExpense!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.FixedExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpense==0}" />
                    </td>
                    <td style="border-left: 1px solid black;" align="right">
                        <apex:outputText value="({0,number,#,###,###})" rendered="{!ActualPerformance2nd.FixedExpense!=0}">
                            <apex:param value="{!ActualPerformance2nd.FixedExpense}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.FixedExpense==0}" />
                    </td>
                    <td align="right" style="border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.FixedExpense!=0 && ActualPerformance2nd.FixedExpense!=null }">
                            <apex:param value="{!((ActualPerformance2nd.FixedExpense/NewContractV0Esitimate2nd.FixedExpense)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.FixedExpense==0||ActualPerformance2nd.FixedExpense==null}" />
                    </td>

                    <td style="border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.FixedExpense!=0 && ActualPerformance2nd.FixedExpense!=null}">
                            <apex:param value="{!(ActualPerformance2nd.FixedExpense/NewContactV0Contract2nd.FixedExpense-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.FixedExpense==0||ActualPerformance2nd.FixedExpense==null}" />
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        Fixed expense % 固定费用比例%
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContactV0Contract2nd.FixedExpenseRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.FixedExpenseRate==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.FixedExpenseRate==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.FixedExpenseRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.FixedExpenseRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.FixedExpenseRate==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.FixedExpenseRate!=null && NewContractV0Esitimate2nd.FixedExpenseRate!=null }">
                            <apex:param value="{!(ActualPerformance2nd.FixedExpenseRate-NewContractV0Esitimate2nd.FixedExpenseRate)}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!(ActualPerformance2nd.FixedExpenseRate-NewContractV0Esitimate2nd.FixedExpenseRate) == 0}" />
                    </td>

                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.FixedExpenseRate!=null}">
                            <apex:param value="{!(ActualPerformance2nd.FixedExpenseRate-NewContactV0Contract2nd.FixedExpenseRate)}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!(ActualPerformance2nd.FixedExpenseRate-NewContactV0Contract2nd.FixedExpenseRate) == 0}" />
                    </td>
                </tr>
                <!-- <tr>
                    <td
                        style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">
                        <strong>% Gross Sales % 营业额</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContactV0Contract2nd.GrossSalesRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRate==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!NewContractV0Esitimate2nd.GrossSalesRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.GrossSalesRate==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.GrossSalesRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.GrossSalesRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.GrossSalesRate==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.GrossSalesRate!=null && NewContractV0Esitimate2nd.GrossSalesRate!=null}">
                            <apex:param value="{!(ActualPerformance2nd.GrossSalesRate - NewContractV0Esitimate2nd.GrossSalesRate) }" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!(ActualPerformance2nd.GrossSalesRate - NewContractV0Esitimate2nd.GrossSalesRate) ==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.GrossSalesRate!=null &&  NewContactV0Contract2nd.GrossSalesRate!=null}">
                            <apex:param value="{!(ActualPerformance2nd.GrossSalesRate - NewContactV0Contract2nd.GrossSalesRate)}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!(ActualPerformance2nd.GrossSalesRate - NewContactV0Contract2nd.GrossSalesRate)==0}" />
                    </td>
                </tr> -->
                 <apex:variable rendered="{!contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C')}" value="" var="">
                    <tr
                        style="{!IF(contains(BelongGroup,'B') || contains(BelongGroup,'C') || contains(BelongGroup,'A'),'','display:none;')}">
                        <td
                            style="border-bottom: 1px solid black;border-left: 1px solid black;">
                            <strong>% Gross Sales % 营业额</strong>
                        </td>
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma!=0}">
                                <apex:param value="{!NewContactV0Contract2nd.GrossSalesRateProForma}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.GrossSalesRateProForma==0}" />
                        </td>
                        <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma!=0}">
                                <apex:param value="{!NewContractV0Esitimate2nd.GrossSalesRateProForma}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.GrossSalesRateProForma==0}" />
                        </td>
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ActualPerformance2nd.GrossSalesRateProForma!=0}">
                                <apex:param value="{!ActualPerformance2nd.GrossSalesRateProForma}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!ActualPerformance2nd.GrossSalesRateProForma==0}" />
                        </td>
                        <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ActualPerformance2nd.GrossSalesRateProForma!=null && NewContractV0Esitimate2nd.GrossSalesRateProForma!=null}">
                                <apex:param value="{!(ActualPerformance2nd.GrossSalesRateProForma - NewContractV0Esitimate2nd.GrossSalesRateProForma) }" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!(ActualPerformance2nd.GrossSalesRateProForma - NewContractV0Esitimate2nd.GrossSalesRateProForma) ==0}" />
                        </td>
                        <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ActualPerformance2nd.GrossSalesRateProForma!=null &&  NewContactV0Contract2nd.GrossSalesRateProForma!=null}">
                                <apex:param value="{!(ActualPerformance2nd.GrossSalesRateProForma - NewContactV0Contract2nd.GrossSalesRateProForma)}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!(ActualPerformance2nd.GrossSalesRateProForma - NewContactV0Contract2nd.GrossSalesRateProForma)==0}" />
                        </td>
                    </tr>
                </apex:variable>
                <!-- <tr
                    style="{!IF(contains(BelongGroup,'B') || contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    <apex:outputText value="{!MarginafterTableHeader}" rendered="{!ExistHistoricalData}"
                        escape="false" />
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginAfterAnP==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.MarginAfterAnP==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}" rendered="{!ActualPerformance2nd.MarginAfterAnP!=0}">
                            <apex:param value="{!ActualPerformance2nd.MarginAfterAnP}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.MarginAfterAnP==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.MarginAfterAnP!=0 && ActualPerformance2nd.MarginAfterAnP!=null }">
                            <apex:param value="{!((ActualPerformance2nd.MarginAfterAnP/NewContractV0Esitimate2nd.MarginAfterAnP)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.MarginAfterAnP==0||ActualPerformance2nd.MarginAfterAnP==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.MarginAfterAnP!=0 && ActualPerformance2nd.MarginAfterAnP!=null}">
                            <apex:param value="{!(ActualPerformance2nd.MarginAfterAnP/NewContactV0Contract2nd.MarginAfterAnP-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.MarginAfterAnP==0||ActualPerformance2nd.MarginAfterAnP==null}" />
                    </td>
                </tr> -->
                <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D')}" value="" var="">
                    <tr style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black; "
                            bgcolor="#FFFF99">
                            <!-- <strong>Cont. Margin per Bottle 单瓶净利润</strong> -->
                            <strong>Cont. Margin per Case 单箱净利润</strong>
                        </td>
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                            bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContactV0Contract2nd.MarginPerCase!=0}">
                                <apex:param value="{!NewContactV0Contract2nd.MarginPerCase}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.MarginPerCase==0}" />
                        </td>
                        <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!NewContractV0Esitimate2nd.MarginPerCase!=0}">
                                <apex:param value="{!NewContractV0Esitimate2nd.MarginPerCase}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.MarginPerCase==0}" />
                        </td>
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                            bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!ActualPerformance2nd.MarginPerCase!=0}">
                                <apex:param value="{!ActualPerformance2nd.MarginPerCase}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!ActualPerformance2nd.MarginPerCase==0}" />
                        </td>
                        <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,###}%"
                                rendered="{!ActualPerformance2nd.MarginPerCase!=0 && ActualPerformance2nd.MarginPerCase!=null }">
                                <apex:param value="{!((ActualPerformance2nd.MarginPerCase/NewContractV0Esitimate2nd.MarginPerCase)-1)*100}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!ActualPerformance2nd.MarginPerCase==0||ActualPerformance2nd.MarginPerCase==null}" />
                        </td>
                        <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                            bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,###}%"
                                rendered="{!ActualPerformance2nd.MarginPerCase!=0 && ActualPerformance2nd.MarginPerCase!=null}">
                                <apex:param value="{!(ActualPerformance2nd.MarginPerCase/NewContactV0Contract2nd.MarginPerCase-1)*100}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!ActualPerformance2nd.MarginPerCase==0||ActualPerformance2nd.MarginPerCase==null}" />
                        </td>
                    </tr>
                </apex:variable>
                <!-- <tr
                    style="{!IF(contains(BelongGroup,'B') || contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;"
                        >
                        <strong>CM/NS% 净销售利润率</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContactV0Contract2nd.CMNSRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.CMNSRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CMNSRate==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!NewContractV0Esitimate2nd.CMNSRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.CMNSRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.CMNSRate==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!ActualPerformance2nd.CMNSRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.CMNSRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.CMNSRate==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.CMNSRate!=null && NewContractV0Esitimate2nd.CMNSRate!=null}">
                            <apex:param value="{!(ActualPerformance2nd.CMNSRate - NewContractV0Esitimate2nd.CMNSRate) }" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!(ActualPerformance2nd.CMNSRate - NewContractV0Esitimate2nd.CMNSRate) ==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.CMNSRate!=null &&  NewContactV0Contract2nd.CMNSRate!=null}">
                            <apex:param value="{!(ActualPerformance2nd.CMNSRate - NewContactV0Contract2nd.CMNSRate)}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!(ActualPerformance2nd.CMNSRate - NewContactV0Contract2nd.CMNSRate)==0}" />
                    </td>
                </tr> -->
                <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D')}" value="" var="">
                    <tr style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;"
                            bgcolor="#FFFF99">
                            <strong>CM/NS% 净销售利润率</strong>
                        </td>
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                            bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!NewContactV0Contract2nd.CMNSRateProForma!=0}">
                                <apex:param value="{!NewContactV0Contract2nd.CMNSRateProForma}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.CMNSRateProForma==0}" />
                        </td>
                        <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!NewContractV0Esitimate2nd.CMNSRateProForma!=0}">
                                <apex:param value="{!NewContractV0Esitimate2nd.CMNSRateProForma}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.CMNSRateProForma==0}" />
                        </td>
                        <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                            bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ActualPerformance2nd.CMNSRateProForma!=0}">
                                <apex:param value="{!ActualPerformance2nd.CMNSRateProForma}" />
                            </apex:outputText>
                            <apex:outputText value=" - " rendered="{!ActualPerformance2nd.CMNSRateProForma==0}" />
                        </td>
                        <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ActualPerformance2nd.CMNSRateProForma!=null && NewContractV0Esitimate2nd.CMNSRateProForma!=null}">
                                <apex:param value="{!(ActualPerformance2nd.CMNSRateProForma - NewContractV0Esitimate2nd.CMNSRateProForma) }" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!(ActualPerformance2nd.CMNSRateProForma - NewContractV0Esitimate2nd.CMNSRateProForma) ==0}" />
                        </td>
                        <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                            bgcolor="#FFFF99">
                            <apex:outputText value="{0,number,#,###,##0.0}%"
                                rendered="{!ActualPerformance2nd.CMNSRateProForma!=null &&  NewContactV0Contract2nd.CMNSRateProForma!=null}">
                                <apex:param value="{!(ActualPerformance2nd.CMNSRateProForma - NewContactV0Contract2nd.CMNSRateProForma)}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!(ActualPerformance2nd.CMNSRateProForma - NewContactV0Contract2nd.CMNSRateProForma)==0}" />
                        </td>
                    </tr>
                </apex:variable>
                <!-- <tr style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;"
                        >
                        <strong>Contract Index - Domestic</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.DomesticContractIndex!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.DomesticContractIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.DomesticContractIndex==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.DomesticContractIndex!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.DomesticContractIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.DomesticContractIndex==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.DomesticContractIndex!=0}">
                            <apex:param value="{!ActualPerformance2nd.DomesticContractIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.DomesticContractIndex==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.DomesticContractIndex!=0 && ActualPerformance2nd.DomesticContractIndex!=null }">
                            <apex:param value="{!((ActualPerformance2nd.DomesticContractIndex/NewContractV0Esitimate2nd.DomesticContractIndex)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.DomesticContractIndex==0||ActualPerformance2nd.DomesticContractIndex==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.DomesticContractIndex!=0 && ActualPerformance2nd.DomesticContractIndex!=null}">
                            <apex:param value="{!(ActualPerformance2nd.DomesticContractIndex/NewContactV0Contract2nd.DomesticContractIndex-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.DomesticContractIndex==0||ActualPerformance2nd.DomesticContractIndex==null}" />
                    </td>
                </tr> -->
                <!-- <tr style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;"
                        >
                        <strong>Domestic Index</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.DomesticContractIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.DomesticContractIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.DomesticContractIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma!=0 && ActualPerformance2nd.DomesticContractIndexProForma!=null }">
                            <apex:param value="{!((ActualPerformance2nd.DomesticContractIndexProForma/NewContractV0Esitimate2nd.DomesticContractIndexProForma)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma==0||ActualPerformance2nd.DomesticContractIndexProForma==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma!=0 && ActualPerformance2nd.DomesticContractIndexProForma!=null}">
                            <apex:param value="{!(ActualPerformance2nd.DomesticContractIndexProForma/NewContactV0Contract2nd.DomesticContractIndexProForma-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma==0||ActualPerformance2nd.DomesticContractIndexProForma==null}" />
                    </td>
                </tr> -->
                <!-- <tr style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;"
                        >
                        <strong>vs. Regional Average Index</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndex!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndex==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.VsRegionalAverageIndex!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.VsRegionalAverageIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.VsRegionalAverageIndex==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndex!=0}">
                            <apex:param value="{!ActualPerformance2nd.VsRegionalAverageIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.VsRegionalAverageIndex==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndex!=0 && ActualPerformance2nd.VsRegionalAverageIndex!=null }">
                            <apex:param value="{!((ActualPerformance2nd.VsRegionalAverageIndex/NewContractV0Esitimate2nd.VsRegionalAverageIndex)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndex==0||ActualPerformance2nd.VsRegionalAverageIndex==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndex!=0 && ActualPerformance2nd.VsRegionalAverageIndex!=null}">
                            <apex:param value="{!(ActualPerformance2nd.VsRegionalAverageIndex/NewContactV0Contract2nd.VsRegionalAverageIndex-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndex==0||ActualPerformance2nd.VsRegionalAverageIndex==null}" />
                    </td>
                </tr> -->
                <!-- <tr style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;"
                        >
                        <strong>vs. Regional Average Index(Pro-Forma)</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.VsRegionalAverageIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma!=0 && ActualPerformance2nd.VsRegionalAverageIndexProForma!=null }">
                            <apex:param value="{!((ActualPerformance2nd.VsRegionalAverageIndexProForma/NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma==0||ActualPerformance2nd.VsRegionalAverageIndexProForma==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma!=0 && ActualPerformance2nd.VsRegionalAverageIndexProForma!=null}">
                            <apex:param value="{!(ActualPerformance2nd.VsRegionalAverageIndexProForma/NewContactV0Contract2nd.VsRegionalAverageIndexProForma-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma==0||ActualPerformance2nd.VsRegionalAverageIndexProForma==null}" />
                    </td>
                </tr> -->
                <!-- <tr
                    style="{!IF(contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C'),'','display:none;')}">
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;"
                        >
                        <strong>Regional Target Index</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.RegionalTargetIndex!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.RegionalTargetIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.RegionalTargetIndex==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.RegionalTargetIndex!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.RegionalTargetIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContractV0Esitimate2nd.RegionalTargetIndex==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.RegionalTargetIndex!=0}">
                            <apex:param value="{!ActualPerformance2nd.RegionalTargetIndex}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.RegionalTargetIndex==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;" >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.RegionalTargetIndex!=0 && ActualPerformance2nd.RegionalTargetIndex!=null }">
                            <apex:param value="{!((ActualPerformance2nd.RegionalTargetIndex/NewContractV0Esitimate2nd.RegionalTargetIndex)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.RegionalTargetIndex==0||ActualPerformance2nd.RegionalTargetIndex==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        >
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ActualPerformance2nd.RegionalTargetIndex!=0 && ActualPerformance2nd.RegionalTargetIndex!=null}">
                            <apex:param value="{!(ActualPerformance2nd.RegionalTargetIndex/NewContactV0Contract2nd.RegionalTargetIndex-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.RegionalTargetIndex==0||ActualPerformance2nd.RegionalTargetIndex==null}" />
                    </td>
                </tr> -->
                
                <tr >
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black; "
                        bgcolor="#E3DFDA">
                        <strong>Contract index</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.DomesticContractIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.DomesticContractIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.DomesticContractIndexProForma==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.DomesticContractIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.DomesticContractIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma!=0 && ActualPerformance2nd.DomesticContractIndexProForma!=null }">
                            <apex:param value="{!((ActualPerformance2nd.DomesticContractIndexProForma/NewContractV0Esitimate2nd.DomesticContractIndexProForma)-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma==0||ActualPerformance2nd.DomesticContractIndexProForma==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}%"
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma!=0 && ActualPerformance2nd.DomesticContractIndexProForma!=null}">
                            <apex:param value="{!(ActualPerformance2nd.DomesticContractIndexProForma/NewContactV0Contract2nd.DomesticContractIndexProForma-1)*100}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.DomesticContractIndexProForma==0||ActualPerformance2nd.DomesticContractIndexProForma==null}" />
                    </td>
                </tr>

                
                <tr >
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;"
                        bgcolor="#E3DFDA">
                        <strong>vs . Regional Average Index</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText style="{!IF(NewContactV0Contract2nd.VsRegionalAverageIndexProForma != null && NewContactV0Contract2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}"
                            rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.VsRegionalAverageIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#E3DFDA">
                        <apex:outputText style="{!IF(NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma != null && NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}"
                            rendered="{!NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText style="{!IF(ActualPerformance2nd.VsRegionalAverageIndexProForma != null && ActualPerformance2nd.VsRegionalAverageIndexProForma >= 0,'color: green;','color: red;')}" value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma!=0}">
                            <apex:param value="{!ActualPerformance2nd.VsRegionalAverageIndexProForma}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma==0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;" bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma!=0 && ActualPerformance2nd.VsRegionalAverageIndexProForma!=null }">
                            <apex:param value="{!(ActualPerformance2nd.VsRegionalAverageIndexProForma-NewContractV0Esitimate2nd.VsRegionalAverageIndexProForma)}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma==0||ActualPerformance2nd.VsRegionalAverageIndexProForma==null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right"
                        bgcolor="#E3DFDA">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma!=0 && ActualPerformance2nd.VsRegionalAverageIndexProForma!=null}">
                            <apex:param value="{!(ActualPerformance2nd.VsRegionalAverageIndexProForma-NewContactV0Contract2nd.VsRegionalAverageIndexProForma)}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.VsRegionalAverageIndexProForma==0||ActualPerformance2nd.VsRegionalAverageIndexProForma==null}" />
                    </td>
                </tr>

                <tr>
                    <td
                        style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <strong>Total BC% 空瓶回收率（Martell BC%）</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                        <!-- <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.BCRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.BCRate}"/>
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!NewContactV0Contract2nd.BCRate==0}"/> -->



                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.BCRate!=null && NewContactV0Contract2nd.BCRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.BCRate==null || NewContactV0Contract2nd.BCRate==0}" />



                        <apex:outputText value="("
                            rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}" />

                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.TotalMBCRate}" />
                        </apex:outputText>

                        <apex:outputText value=")"
                            rendered="{!NewContactV0Contract2nd.TotalMBCRate!=null && NewContactV0Contract2nd.TotalMBCRate!=0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.BCRate!=null && NewContractV0Esitimate2nd.BCRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.BCRate==null || NewContractV0Esitimate2nd.BCRate==0}" />



                        <apex:outputText value="("
                            rendered="{!NewContractV0Esitimate2nd.TotalMBCRate!=null && NewContractV0Esitimate2nd.TotalMBCRate!=0}" />

                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.TotalMBCRate!=null && NewContractV0Esitimate2nd.TotalMBCRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.TotalMBCRate}" />
                        </apex:outputText>

                        <apex:outputText value=")"
                            rendered="{!NewContractV0Esitimate2nd.TotalMBCRate!=null && NewContractV0Esitimate2nd.TotalMBCRate!=0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-left: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.BCRate!=null && ActualPerformance2nd.BCRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.BCRate==null || ActualPerformance2nd.BCRate==0}" />



                        <apex:outputText value="("
                            rendered="{!ActualPerformance2nd.TotalMBCRate!=null && ActualPerformance2nd.TotalMBCRate!=0}" />

                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.TotalMBCRate!=null && ActualPerformance2nd.TotalMBCRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.TotalMBCRate}" />
                        </apex:outputText>

                        <apex:outputText value=")"
                            rendered="{!ActualPerformance2nd.TotalMBCRate!=null && ActualPerformance2nd.TotalMBCRate!=0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.BCRate!=null && ActualPerformance2nd.BCRate!=null }">
                            <apex:param value="{!ActualPerformance2nd.BCRate-NewContractV0Esitimate2nd.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.BCRate-NewContractV0Esitimate2nd.BCRate == 0 || ActualPerformance2nd.BCRate-NewContractV0Esitimate2nd.BCRate == null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.BCRate!=null && ActualPerformance2nd.BCRate!=null}">
                            <apex:param value="{!ActualPerformance2nd.BCRate-NewContactV0Contract2nd.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.BCRate-NewContactV0Contract2nd.BCRate == 0 || ActualPerformance2nd.BCRate-NewContactV0Contract2nd.BCRate == null}" />
                    </td>
                </tr>
                <!-- <tr>
                    <td
                        style="border-bottom: 1px solid black;border-left: 1px solid black; border-right: 1px solid black;">
                        <strong>Net BC% 净空瓶回收率（Martell BC%）</strong>
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.NetBCRate!=null && NewContactV0Contract2nd.NetBCRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.NetBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContactV0Contract2nd.NetBCRate==null || NewContactV0Contract2nd.NetBCRate==0}" />
                        <apex:outputText value="("
                            rendered="{!NewContactV0Contract2nd.NetMBCRate!=null && NewContactV0Contract2nd.NetMBCRate!=0}" />

                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.NetMBCRate!=null && NewContactV0Contract2nd.NetMBCRate!=0}">
                            <apex:param value="{!NewContactV0Contract2nd.NetMBCRate}" />
                        </apex:outputText>

                        <apex:outputText value=")"
                            rendered="{!NewContactV0Contract2nd.NetMBCRate!=null && NewContactV0Contract2nd.NetMBCRate!=0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.NetBCRate!=null && NewContractV0Esitimate2nd.NetBCRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.NetBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!NewContractV0Esitimate2nd.NetBCRate==null || NewContractV0Esitimate2nd.NetBCRate==0}" />
                        <apex:outputText value="("
                            rendered="{!NewContractV0Esitimate2nd.NetMBCRate!=null && NewContractV0Esitimate2nd.NetMBCRate!=0}" />

                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.NetMBCRate!=null && NewContractV0Esitimate2nd.NetMBCRate!=0}">
                            <apex:param value="{!NewContractV0Esitimate2nd.NetMBCRate}" />
                        </apex:outputText>

                        <apex:outputText value=")"
                            rendered="{!NewContractV0Esitimate2nd.NetMBCRate!=null && NewContractV0Esitimate2nd.NetMBCRate!=0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.NetBCRate!=null && ActualPerformance2nd.NetBCRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.NetBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.NetBCRate==null || ActualPerformance2nd.NetBCRate==0}" />
                        <apex:outputText value="("
                            rendered="{!ActualPerformance2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=0}" />

                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!ActualPerformance2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=0}">
                            <apex:param value="{!ActualPerformance2nd.NetMBCRate}" />
                        </apex:outputText>

                        <apex:outputText value=")"
                            rendered="{!ActualPerformance2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=0}" />
                    </td>
                    <td align="right" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContractV0Esitimate2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=null }">
                            <apex:param value="{!ActualPerformance2nd.NetMBCRate-NewContractV0Esitimate2nd.NetMBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!ActualPerformance2nd.NetMBCRate-NewContractV0Esitimate2nd.NetMBCRate == 0 || ActualPerformance2nd.NetMBCRate-NewContractV0Esitimate2nd.NetMBCRate == null}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0}%"
                            rendered="{!NewContactV0Contract2nd.NetMBCRate!=null && ActualPerformance2nd.NetMBCRate!=null}">
                            <apex:param value="{!ActualPerformance2nd.NetMBCRate-NewContactV0Contract2nd.NetMBCRate}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{ActualPerformance2nd.NetMBCRate-NewContactV0Contract2nd.NetMBCRate == 0 || ActualPerformance2nd.NetMBCRate-NewContactV0Contract2nd.NetMBCRate == null}" />
                    </td>
                </tr> -->
            </table>
            <br />

            <table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-size: 10px">
                <thead>
                    <tr>
                        <td colspan="{!IF(ExistHistoricalData,'7','5')}" bgcolor="#99CCFF"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;">
                            <!-- <font color="white"> --><strong>Volume (std) 销量(标准瓶)</strong><!-- </font> -->
                        </td>
                    </tr>
                    <tr>
                        <td rowspan="2" width="25%"
                            style="border-left: 1px solid black; border-bottom: 1px solid black;"
                            align="center">
                            Sub-brands 品牌</td>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}" width="37%"
                            style="border-left: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Bottles /Total Volume<br />瓶/总销量</td>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}" width="37%"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;border-left: 1px solid black;"
                            align="center">weight of volume by sub-brand<br />各品牌销量占比</td>
                    </tr>
                    <tr>
                        <td width="13%" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Contract <br />合同</td>
                        <td width="13%" style="border-bottom: 1px solid black;" align="center">Estimate V0.0<br />预估 V0.0
                        </td>
                        <td width="13%" style="border-bottom: 1px solid black;"
                            align="center">Actual Performance<br />实际</td>

                        <td width="13%" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Actual Performance<br />实际
                        </td>
                        <td width="13%" style="border-bottom: 1px solid black;" align="center">vs Estimation%
                            vs<br />预估V0.0%
                        </td>
                        <td width="13%" style="border-bottom: 1px solid black;border-right: 1px solid black; "
                            align="center">vs Contract% vs<br />合同%</td>
                    </tr>
                </thead>

                <apex:variable value="{!0}" var="TotalContractBottles" />
                <apex:variable value="{!0}" var="TotalEstimateBottles" />
                <apex:variable value="{!0}" var="TotalVFinalBottles" />
                <apex:repeat value="{!investmentBySubBrandByContractByLastVolume}" var="subBrandId">
                    <apex:variable var="TotalContractBottles"
                        value="{!TotalContractBottles+investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD}" />
                    <apex:variable var="TotalEstimateBottles"
                        value="{!TotalEstimateBottles+investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD}" />
                    <apex:variable var="TotalVFinalBottles"
                        value="{!TotalVFinalBottles+investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD}" />
                </apex:repeat>

                <apex:repeat value="{!investmentBySubBrandByContractByLastVolume}" var="subBrandId" rows="20">
                <apex:variable rendered="{!(subBrandNameMap[subBrandId] !='999') && !((investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==null || investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==0) && (investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==0 || investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==null) && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==0 || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==null) && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 == 0 || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 == null))}" value="" var="">
                    <tr style="{!IF(subBrandNameMap[subBrandId] =='999','display:none;','')};
                                {!IF((investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==null || investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==0) && (investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==0 || investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==null) && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==0 || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==null) && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 == 0 || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 == null), 'display:none;','')}">
                        <td 
                            style="border-left: 1px solid black;border-bottom: 1px solid black;font-size: 11px">
                            
                            <apex:outputText value="{!subBrandNameMap[subBrandId]}" escape="false" />
                            
                        </td>

                        <td align="center"
                            style="border-bottom: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD!=null && investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD!=0}">
                                <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==null || investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==0}" />
                        </td>
                        <td align="center" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD!=null}">
                                <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==null || investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==0}" />
                        </td>
                        <td align="center" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD!=null}">
                                <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==null || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==0}" />
                        </td>

                        <td align="center" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100!=null}">
                                <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100==null || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100==0}" />
                        </td>
                        <td align="center" style="border-bottom: 1px solid black;">
                            <apex:outputText value="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].propByStdTotal*100 < 0,'{0,number,#,###,##0}%','+{0,number,#,###,##0}%')}"
                                style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].propByStdTotal*100 < 0,'color: red;','color:green;')}"
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].DomesticIndexTarget!=null}">
                                <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value=" "
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].propByStdTotal*100 ==null ||investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].propByStdTotal*100==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;border-bottom: 1px solid black;">
                            <apex:outputText value="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].propByStdTotal*100 < 0,'{0,number,#,###,##0}%','+{0,number,#,###,##0}%')}"
                                style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].propByStdTotal*100 < 0,'color: red;','color:green;')}"
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].DomesticIndexTarget!=null}">
                                <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].propByStdTotal*100 ==null || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].propByStdTotal*100==0}" />
                        </td>
                    </tr>
                </apex:variable>
                </apex:repeat>
                <tr>
                    <td align="left" bgcolor="#E3DFDA"
                        style="border-left: 1px solid black;border-bottom: 1px solid black;">
                        All products 品牌合计
                    </td>

                    <td align="center" bgcolor="#E3DFDA"
                        style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}">
                            <apex:param value="{!TotalContractBottles}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalContractBottles==null || TotalContractBottles==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}">
                            <apex:param value="{!TotalEstimateBottles}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA"
                        style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalVFinalBottles!=0 && TotalVFinalBottles!=null}">
                            <apex:param value="{!TotalVFinalBottles}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalVFinalBottles==null || TotalVFinalBottles==0}" />
                    </td>

                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;">
                    </td>
                    <td align="center" bgcolor="#E3DFDA"
                        style="border-right:1px solid black;border-bottom: 1px solid black;">
                    </td>
                </tr>
            </table>
            <br />
            <table width="100%" border="0" cellpadding="0" cellspacing="0" style="font-size: 10px">
                <apex:variable value="{!0}" var="TotalContractFree" />
                <apex:variable value="{!0}" var="TotalEstimateFree" />
                <apex:variable value="{!0}" var="TotalLastPayFree" />
                <apex:repeat value="{!investmentBySubBrandByContractByLastVolume}" var="subBrandId">
                    <apex:variable var="TotalContractFree"
                        value="{!TotalContractFree+investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].totalTradeExpense}" />
                    <apex:variable var="TotalEstimateFree"
                        value="{!TotalEstimateFree+investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].totalTradeExpense}" />
                    <apex:variable var="TotalLastPayFree"
                        value="{!TotalLastPayFree+investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].totalTradeExpense}" />
                </apex:repeat>
                <thead>
                    <tr>
                        <td colspan="{!IF(ExistHistoricalData,IF(contains(BelongGroup,'C'),'11',IF(contains(BelongGroup,'B') || contains(BelongGroup,'D'),'9',IF(contains(BelongGroup,'A') ,'8','7'))),IF(contains(BelongGroup,'C'),'9',IF(contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'D'),'7','5')))}"
                            bgcolor="#99CCFF" style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;">
                            <!-- <font color="white"> --><strong>EXPENSES (in RMB) 支出（元）</strong><!-- </font> -->
                        </td>
                    </tr>
                    <tr>
                        <td rowspan="2" width="25%"
                            style="border-bottom: 1px solid black;border-left: 1px solid black;"
                            align="center">
                            Sub-brands 品牌</td>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}"
                            style="border-left: 1px solid black; border-bottom: 1px solid black;" align="center">Trade
                            Expenses Per Bottle <br />单瓶销售费用
                        </td>

                        <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D')}" value="" var="">
                            <td style="border-left: 1px solid black; border-bottom: 1px solid black;{!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D'),'','display:none;')}"
                                align="center">
                                <!-- Domestic <br />Investment Gap -->
                                <!-- vs Domestic investment/Btl -->
                                vs National Investment /Btl
                            </td>
                        </apex:variable>
                        
                        <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D') || contains(BelongGroup,'B')}" value="" var="">
                            <td style="border-left: 1px solid black; border-bottom: 1px solid black;{!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D') || contains(BelongGroup,'B'),'','display:none;')}"
                                align="center">
                                <!-- Domestic <br />Index Gap -->
                                <!-- vs National Index -->
                                Contract index by sub-brand
                            </td>
                        </apex:variable>

                        <apex:variable rendered="{!contains(BelongGroup,'C')}" value="" var="">
                            <td style="border-left: 1px solid black; border-bottom: 1px solid black;{!if(contains(BelongGroup,'C'),'','display:none;')}"
                                align="center">
                                <!-- Regional <br />Investment Gap -->
                                <!-- vs Regional Investment /Btl -->
                                vs Regional Investment/Btl
                            </td>
                        </apex:variable>

                        <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'A') || contains(BelongGroup,'B')}" value="" var="">
                            <td style="border-left: 1px solid black; border-bottom: 1px solid black;{!if(contains(BelongGroup,'C') ||contains(BelongGroup,'B')||contains(BelongGroup,'A'),'','display:none;')}"
                                align="center">
                                <!-- Regional <br />Index Gap -->
                                <!-- vs Regional Index -->
                                vs Estimated V0.0 investment/Btl
                            </td>
                        </apex:variable>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Total
                            Fees <br />费用合计

                        </td>
                    </tr>
                    <tr>
                        <td width="" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Contract 合同</td>
                        <td width="" style="border-bottom: 1px solid black;" align="center">Estimate V0.0<br />预估 V0.0
                        </td>
                        <td width="" style="border-bottom: 1px solid black;  "
                            align="center">Actual Performance<br />实际</td>

                        <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D')}" value="" var="">
                            <td width=""
                                style="border-bottom: 1px solid black;border-left: 1px solid black;{!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D'),'','display:none;')}"
                                align="center">Actual Performance<br />实际
                            </td>
                        </apex:variable>

                        <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D') || contains(BelongGroup,'B')}" value="" var="">
                            <td width=""
                                style="border-bottom: 1px solid black;border-left: 1px solid black;{!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D') || contains(BelongGroup,'B'),'','display:none;')}"
                                align="center">Actual Performance<br />实际
                            </td>
                        </apex:variable>

                        <apex:variable rendered="{!contains(BelongGroup,'C') }" value="" var="">
                            <td width=""
                                style="border-bottom: 1px solid black;border-left: 1px solid black;{!if(contains(BelongGroup,'C') ,'','display:none;')}"
                                align="center">Actual Performance<br />实际</td>
                        </apex:variable>

                         <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'A') || contains(BelongGroup,'B')}" value="" var="">
                            <td width=""
                                style="border-bottom: 1px solid black;border-left: 1px solid black;{!if(contains(BelongGroup,'C') ||contains(BelongGroup,'B')||contains(BelongGroup,'A'),'','display:none;')}"
                                align="center">Actual Performance<br />实际
                            </td>
                        </apex:variable>

                        <td width="" style="border-bottom: 1px solid black;border-left: 1px solid black;" align="center">Contract 合同</td>
                        <td width="" style="border-bottom: 1px solid black;" align="center">Estimate V0.0<br />预估 V0.0
                        </td>
                        <td width="" style="border-bottom: 1px solid black; border-right: 1px solid black; "
                            align="center">Actual Performance<br />实际</td>
                    </tr>
                </thead>
                <apex:repeat value="{!investmentBySubBrandByContractByLastVolume}" var="subBrandId" rows="{!IF(Ishave999,'21','20')}">
                    <apex:variable rendered="{!(subBrandNameMap[subBrandId] =='999') || !((investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==null || investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].volumeSTD==0) && (investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==0 || investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].volumeSTD==null) && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==0 || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD==null) && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 == 0 || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].propByStdTotal*100 == null))}" value="" var="">
                        <tr>
                            <td 
                                style="border-left: 1px solid black;border-bottom: 1px solid black;font-size: 11px">
                                
                                    <apex:outputText value="{!subBrandNameMap[subBrandId]}" escape="false" />
                                
                            </td>
                            <!-- Trade Expenses Per Bottle -->
                            <td align="center" style="border-bottom: 1px solid black;border-left: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}"
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].tradeExpensePerBottle2nd!=null}">
                                    <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].tradeExpensePerBottle2nd}" />
                                </apex:outputText>
                                <apex:outputText value=" - "
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].tradeExpensePerBottle2nd==0}" />
                            </td>
                            <td align="center" style="border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}"
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd!=null}">
                                    <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd}" />
                                </apex:outputText>
                                <apex:outputText value=" - "
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd==0}" />
                            </td>
                            <td align="center" style="border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}"
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd!=null}">
                                    <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd}" />
                                </apex:outputText>
                                <apex:outputText value=" - "
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd==0}" />
                            </td>

                            <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D')}" value="" var="">
                                <td align="center"
                                    style="border-bottom: 1px solid black;border-left: 1px solid black; {!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D'),'','display:none;')}">
                                    <!-- <apex:outputText value="{0,number,#,###,###}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment > 0,'color: red;','color:green;')}"
                                        rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0}">
                                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment, 0)}" />
                                    </apex:outputText>
                                    <apex:outputText rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd == 0}"
                                        value=" - "></apex:outputText> -->
                                    <apex:outputText value="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment < 0,'{0,number,#,###,###}','+{0,number,#,###,###}')}"
                                        rendered="{!subBrandNameMap[subBrandId]!='999'}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment < 0,'color: green;','color:red;')}">
                                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment, 0)}" />
                                        <!-- <apex:param value="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment != null &&
                                                                investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment > -1 && 
                                                                investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment < 0,'0',investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticInvestment)}" /> -->
                                    </apex:outputText>
                                    <apex:outputText value=" - "
                                    rendered="{!subBrandNameMap[subBrandId]=='999'}" />
                                </td>
                            </apex:variable>

                            <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D') || contains(BelongGroup,'B') }" value="" var="">
                                <td align="center"
                                    style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D') || contains(BelongGroup,'B'),'','display:none;')}">
                                    <!-- <apex:outputText value="{0,number,#,###,###}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}"
                                        rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD != 0}">
                                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget, 0)}" />
                                    </apex:outputText>
                                    <apex:outputText rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].volumeSTD == 0}"
                                        value=" - "></apex:outputText> -->
                                    <!-- <apex:outputText value="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget < 0,'{0,number,#,###,###}','+{0,number,#,###,###}')}"
                                        rendered="{!subBrandNameMap[subBrandId]!='999'}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}">
                                        <apex:param value="{!BLANKVALUE(CEILING(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget), 0)}" 
                                         />
                                    </apex:outputText> -->
                                    <apex:outputText value="{0,number,#,###,###}"
                                        rendered="{!subBrandNameMap[subBrandId]!='999'}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithDomesticIndexTarget < 0,'color: red;','color:green;')}">
                                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].DomesticContractIndex, 0)}" 
                                         />
                                    </apex:outputText>
                                    <apex:outputText value=" - "
                                        rendered="{!subBrandNameMap[subBrandId]=='999'}" />
                                </td>
                            </apex:variable>

                            <apex:variable rendered="{!contains(BelongGroup,'C')}" value="" var="">
                                <td align="center"
                                    style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C'),'','display:none;')}">

                                    <!-- <apex:outputText value="{0,number,#,###,###}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment > 0,'color: red;','color:green;')}"
                                        rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0}">
                                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment, 0)}" />
                                    </apex:outputText>
                                    <apex:outputText rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd == 0}"
                                        value=" - "></apex:outputText> -->
                                    <apex:outputText value="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment < 0,'{0,number,#,###,###}','+{0,number,#,###,###}')}"
                                        rendered="{!subBrandNameMap[subBrandId]!='999'}"
                                        style="{!IF(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment != null && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment < 0,'color: green;','color:red;')}">
                                        <apex:param value="{!BLANKVALUE(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment, 0)}" />
                                    </apex:outputText>
                                    <apex:outputText value=" - "
                                        rendered="{!subBrandNameMap[subBrandId]=='999'}" />
                                </td>
                            </apex:variable>

                            <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'A') || contains(BelongGroup,'B')}" value="" var="">
                                <td align="center"
                                    style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C') ||contains(BelongGroup,'B')||contains(BelongGroup,'A'),'','display:none;')}">

                                    <apex:variable rendered="{!
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != null && 
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != null && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd > 0)}" value="" var="">
                                        <apex:outputText style="color: red;" value="+"/>
                                        <apex:outputText value="{0,number,#,###,###}" rendered="{!
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != null && 
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != null && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd > 0)}" style="color:red;" >
                                            <apex:param value="{!(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd)}"/>
                                        </apex:outputText>
                                    </apex:variable>
                                    
                                    <apex:variable rendered="{!
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != null && 
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != null && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd <= 0)}" value="" var="">
                                        <apex:outputText rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd == 0}" style="color: green;"  value="-"/>
                                        <apex:outputText value="{0,number,#,###,###}" rendered="{!
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != null && 
                                        investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != null && (investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd <= 0)}" style="color:green;" >
                                            <apex:param value="{!(investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd-investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd)}"/>
                                        </apex:outputText>
                                    </apex:variable>

                                    <apex:outputText rendered="{!!(investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].tradeExpensePerBottle2nd != null && 
                                    investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != 0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].tradeExpensePerBottle2nd != null)}" value=" - "></apex:outputText>
                                </td>
                            </apex:variable>

                            <td align="center"
                                style="border-bottom: 1px solid black;border-left: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}"
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].totalTradeExpense!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].totalTradeExpense!=null}">
                                    <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].totalTradeExpense}" />
                                </apex:outputText>
                                <apex:outputText value=" - "
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].totalTradeExpense==null || investmentBySubBrandByContractByLastVolume[subBrandId]['contractData'].totalTradeExpense==0}" />
                            </td>
                            <td align="center" style="border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}"
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].totalTradeExpense!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].totalTradeExpense!=null}">
                                    <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].totalTradeExpense}" />
                                </apex:outputText>
                                <apex:outputText value=" - "
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].totalTradeExpense==null || investmentBySubBrandByContractByLastVolume[subBrandId]['estimate'].totalTradeExpense==0}" />
                            </td>
                            <td align="center" style="border-right:1px solid black;border-bottom: 1px solid black;">
                                <apex:outputText value="{0,number,#,###,###}"
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].totalTradeExpense!=0 && investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].totalTradeExpense!=null}">
                                    <apex:param value="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].totalTradeExpense}" />
                                </apex:outputText>
                                <apex:outputText value=" - "
                                    rendered="{!investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].totalTradeExpense==null || investmentBySubBrandByContractByLastVolume[subBrandId]['lastPayment'].totalTradeExpense==0}" />
                            </td>
                        </tr>
                    </apex:variable>
                </apex:repeat>
                <tr>
                    <td align="left" bgcolor="#E3DFDA"
                        style="border-left: 1px solid black;border-bottom: 1px solid black;">
                        All products 品牌合计
                    </td>
                    <!-- Trade Expenses Per Bottle -->
                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;border-left: 1px solid black;">

                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;">

                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;">

                    </td>

                    <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D')}" value="" var="">
                        <td align="center" bgcolor="#E3DFDA"
                            style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D'),'','display:none;')}">

                        </td>
                    </apex:variable>

                    <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'D') || contains(BelongGroup,'B')}" value="" var="">
                        <td align="center" bgcolor="#E3DFDA"
                            style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C') ||contains(BelongGroup,'D') || contains(BelongGroup,'B'),'','display:none;')}">

                        </td>
                    </apex:variable>

                    <apex:variable rendered="{!contains(BelongGroup,'C')}" value="" var="">
                        <td align="center" bgcolor="#E3DFDA"
                            style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C') ,'','display:none;')}">

                        </td>
                    </apex:variable>

                     <apex:variable rendered="{!contains(BelongGroup,'C') || contains(BelongGroup,'A') || contains(BelongGroup,'B')}" value="" var="">
                        <td align="center" bgcolor="#E3DFDA"
                            style="border-left: 1px solid black;border-bottom: 1px solid black; {!if(contains(BelongGroup,'C') ||contains(BelongGroup,'B')||contains(BelongGroup,'A'),'','display:none;')}">

                        </td>
                    </apex:variable>

                    <td align="center" bgcolor="#E3DFDA"
                        style="border-bottom: 1px solid black;border-left: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalContractFree!=0 && TotalContractFree!=null}">
                            <apex:param value="{!TotalContractFree}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalContractFree==null || TotalContractFree==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA" style="border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalEstimateFree!=0 && TotalEstimateFree!=null}">
                            <apex:param value="{!TotalEstimateFree}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalEstimateFree==null || TotalEstimateFree==0}" />
                    </td>
                    <td align="center" bgcolor="#E3DFDA"
                        style="border-right:1px solid black;border-bottom: 1px solid black;">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalLastPayFree!=0 && TotalLastPayFree!=null}">
                            <apex:param value="{!TotalLastPayFree}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalLastPayFree==null || TotalLastPayFree==0}" />
                    </td>
                </tr>
            </table>
            <!-- <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <thead>
                    <tr>
                        <td colspan="{!IF(ExistHistoricalData,'11','8')}" bgcolor="#99CCFF"
                            style="border:1px solid black;">
                            <font color="white"><strong>EXPENSES (in RMB) 支出（元）</strong></font>
                        </td>
                    </tr>
                    <tr>
                        <td rowspan="2" width="10%"
                            style="border-left: 1px solid black; border-bottom: 1px solid black;" align="center">
                            Category 类别</td>
                        <td rowspan="2" width="18%"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                            Sub-brands 品牌</td>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Bottles /Total Volume<br />瓶/总销量</td>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Trade Expenses Per Bottle<br />单瓶销售费用</td>
                        <td colspan="{!IF(ExistHistoricalData,'3','2')}"
                            style="border-right: 1px solid black; border-bottom: 1px solid black;"
                            align="center">Total Fees<br />费用合计</td>
                    </tr>
                    <tr>
                        <td width="8%" style="border-bottom: 1px solid black;" align="center">Contract 合同</td>
                        <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate V0.0<br />预估 V0.0
                        </td>
                        <td width="8%" style="border-bottom: 1px solid black; border-right: 1px solid black; "
                            align="center">Actual Performance<br />实际</td>

                        <td width="8%" style="border-bottom: 1px solid black;" align="center">Contract 合同</td>
                        <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate V0.0<br />预估 V0.0
                        </td>
                        <td width="8%" style="border-bottom: 1px solid black;border-right: 1px solid black; "
                            align="center">Actual Performance<br />实际</td>

                        <td width="8%" style="border-bottom: 1px solid black;" align="center">Contract 合同</td>
                        <td width="8%" style="border-bottom: 1px solid black;" align="center">Estimate V0.0<br />预估 V0.0
                        </td>
                        <td width="8%" style="border-bottom: 1px solid black;border-right: 1px solid black; "
                            align="center">Actual Performance<br />实际</td>
                    </tr>
                </thead>

                <apex:variable value="{!0}" var="TotalContractBottles" />
                <apex:variable value="{!0}" var="TotalEstimateBottles" />
                <apex:variable value="{!0}" var="TotalVFinalBottles" />

                <apex:variable value="{!0}" var="TotalContractTotalFees" />
                <apex:variable value="{!0}" var="TotalEstimateTotalFees" />
                <apex:variable value="{!0}" var="TotalVFinalTotalFees" />
                <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="subBrandId">
                    <apex:variable var="TotalContractBottles"
                        value="{!TotalContractBottles+investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].volumeSTD}" />
                    <apex:variable var="TotalEstimateBottles"
                        value="{!TotalEstimateBottles+investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].volumeSTD}" />
                    <apex:variable var="TotalVFinalBottles"
                        value="{!TotalVFinalBottles+investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].volumeSTD}" />

                    <apex:variable var="TotalContractTotalFees"
                        value="{!TotalContractTotalFees+investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].totalTradeExpense}" />
                    <apex:variable var="TotalEstimateTotalFees"
                        value="{!TotalEstimateTotalFees+investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].totalTradeExpense}" />
                    <apex:variable var="TotalVFinalTotalFees"
                        value="{!TotalVFinalTotalFees+investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].totalTradeExpense}" />
                </apex:repeat>

                <tr>
                    <td style="border-left: 1px solid black; border-bottom: 1px solid black;" align="center">Total</td>
                    <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">&nbsp;
                    </td>

                    <td style="border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalContractBottles!=0 && TotalContractBottles!=null}">
                            <apex:param value="{!TotalContractBottles}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalContractBottles==null || TotalContractBottles==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalEstimateBottles!=0 && TotalEstimateBottles!=null}">
                            <apex:param value="{!TotalEstimateBottles}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalEstimateBottles==null || TotalEstimateBottles==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black; border-right: 1px solid black; " align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalVFinalBottles!=0 && TotalVFinalBottles!=null}">
                            <apex:param value="{!TotalVFinalBottles}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalVFinalBottles==null || TotalVFinalBottles==0}" />
                    </td>

                    <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black;" align="right">&nbsp;</td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black; " align="right">&nbsp;</td>

                    <td style="border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalContractTotalFees!=0 && TotalContractTotalFees!=null}">
                            <apex:param value="{!TotalContractTotalFees}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalContractTotalFees==null || TotalContractTotalFees==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalEstimateTotalFees!=0 && TotalEstimateTotalFees!=null}">
                            <apex:param value="{!TotalEstimateTotalFees}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalEstimateTotalFees==null || TotalEstimateTotalFees==0}" />
                    </td>
                    <td style="border-bottom: 1px solid black;border-right: 1px solid black; " align="right">
                        <apex:outputText value="{0,number,#,###,###}"
                            rendered="{!TotalVFinalTotalFees!=0 && TotalVFinalTotalFees!=null}">
                            <apex:param value="{!TotalVFinalTotalFees}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!TotalVFinalTotalFees==null || TotalVFinalTotalFees==0}" />
                    </td>
                </tr>

                <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="subBrandId">
                    <tr>
                        <td align="left" style="border-left: 1px solid black; ">
                            <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].categoryName,BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].categoryName,investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].categoryName))}" escape="false" />
                        </td>
                        
                        <td align="left" style=" border-right: 1px solid black;">
                            <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].subBrandName,investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].subBrandName))}" escape="false" />
                        </td>

                        <td align="right" style="{!IF(ExistHistoricalData,'','display:none;')}">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].volumeSTD!=null && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].volumeSTD!=0}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].volumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].volumeSTD==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].volumeSTD==0}" />
                        </td>
                        <td align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].volumeSTD!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].volumeSTD!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].volumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].volumeSTD==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].volumeSTD==0}" />
                        </td>
                        <td align="right" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].volumeSTD!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].volumeSTD!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].volumeSTD}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].volumeSTD==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].volumeSTD==0}" />
                        </td>

                        <td align="right" style="{!IF(ExistHistoricalData,'','display:none;')}">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd==0}" />
                        </td>
                        <td align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd==0}" />
                        </td>
                        <td align="right" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd==0}" />
                        </td>

                        <td align="right" style="{!IF(ExistHistoricalData,'','display:none;')}">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].totalTradeExpense!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].totalTradeExpense}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].totalTradeExpense==0}" />
                        </td>
                        <td align="right">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].totalTradeExpense!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].totalTradeExpense}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].totalTradeExpense==0}" />
                        </td>
                        <td align="right" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].totalTradeExpense!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].totalTradeExpense!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].totalTradeExpense}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].totalTradeExpense==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].totalTradeExpense==0}" />
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td colspan="11" style="border-left: 1px solid black; border-bottom: 1px solid black;"></td>
                </tr>
            </table>
            <br />
            <table width="100%" border="0" cellpadding="0" cellspacing="0"
                style="{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                <thead>
                    <tr>
                        <td rowspan="2"
                            style="border-top: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;"
                            align="center" width="10%">
                            Sub-Brands 品牌
                        </td>
                        <td colspan="4" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                            <font color="white"><strong>Gap of Target Index - Domestic 对比全国指标差异</strong></font>
                        </td>
                        <td colspan="4" bgcolor="#99CCFF"
                            style="border:1px solid black;border-left: none;text-align: center;">
                            <font color="white"><strong>Gap of Average Index - Regional 对比区域平均目标</strong></font>
                        </td>
                    </tr>
                    <tr>
                        <td style="border-bottom: 1px solid black;border-right: 1px solid black;" align="center">
                            National Target 全国目标
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Contract 合同
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Estimate V0.0 <br /> 预估 V0.0
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                            Actual Performance <br /> 实际
                        </td>
                        <td style="border: 1px solid black;border-top: none;border-left: none;" align="center">
                            Regional Average 区域平均目标
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Contract 合同
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Estimate V0.0 <br /> 预估 V0.0
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                            Actual Performance <br /> 实际
                        </td>
                    </tr>
                </thead>
                <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="subBrandId">
                    <tr>
                        <td align="left" style="border-left: 1px solid black; border-right: 1px solid black;">
                            <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].subBrandName,investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].subBrandName))}" escape="false" />
                        </td>
                        <td align="center" style="border-right: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].DomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].DomesticIndexTarget!=null) || (investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].DomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].DomesticIndexTarget!=null) || (investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget!=null)}"
                                escape="false">
                                <apex:param value="{!BLANKVALUE(
                                    investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget,BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].DomesticIndexTarget,
                                    investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].DomesticIndexTarget)
                                )}">
                                </apex:param>
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].DomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].DomesticIndexTarget==0) &&(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].DomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].DomesticIndexTarget==0)&&(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget==0)}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticIndexTarget < 0, 'red', 'green')};"
                            rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticIndexTarget!=null &&
                                investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticIndexTarget!=0
                                }">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticIndexTarget}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticIndexTarget==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticIndexTarget < 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticIndexTarget!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticIndexTarget}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticIndexTarget==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticIndexTarget < 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticIndexTarget!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticIndexTarget!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticIndexTarget}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticIndexTarget==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticIndexTarget==0}" />
                        </td>


                        <td align="center" style="border-right: 1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].RegionalAverageIndex!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].RegionalAverageIndex!=null) || (investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].RegionalAverageIndex!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].RegionalAverageIndex!=null) || (investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].RegionalAverageIndex!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].RegionalAverageIndex!=null)}"
                                escape="false">
                                <apex:param value="{!BLANKVALUE(
                                    investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].RegionalAverageIndex,BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].DomesticIndexTarget,
                                    investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].DomesticIndexTarget))}">
                                </apex:param>
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].RegionalAverageIndex==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].RegionalAverageIndex==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageIndex < 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageIndex!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageIndex!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageIndex}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageIndex==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageIndex==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageIndex < 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageIndex!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageIndex!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageIndex}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageIndex==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageIndex==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageIndex < 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageIndex!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageIndex!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageIndex}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageIndex==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageIndex==0}" />
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td colspan="9" style="border-left: 1px solid black; border-bottom: 1px solid black;"></td>
                </tr>
            </table>
            <br />
            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <thead>
                    <tr>
                        <td rowspan="2"
                            style="border-top: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;"
                            align="center" width="10%">
                            Sub-Brands 品牌
                        </td>
                        <td colspan="5" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                            <font color="white"><strong>weight of volume by sub -brand 各品牌销量占比</strong></font>
                        </td>
                    </tr>
                    <tr>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Contract <br /> 合同
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Estimate V0.0 <br /> 预估 V0.0
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Actual Performance <br /> 实际
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            %对比Contract / 合同
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                            %对比Estimate V0.0 / 预估 V0.0
                        </td>
                    </tr>
                </thead>
                <apex:repeat value="{!sortBySubBrandByContractBySubBrand}" var="subBrandId">
                    <tr>
                        <td align="left" style="border-left: 1px solid black; border-right: 1px solid black;">
                            <apex:outputText value="{!BLANKVALUE(sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].subBrandName,BLANKVALUE(sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].subBrandName,sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].subBrandName))}" escape="false" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100!=null}"
                                escape="false">
                                <apex:param value="{!
                                    sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100
                                    }">
                                </apex:param>
                            </apex:outputText>
                            <apex:outputText value=" "
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100==null || sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100!=null}">
                                <apex:param value="{!sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value=""
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100==null || sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100!=null}">
                                <apex:param value="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100==null || sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget!=null}">
                                <apex:param value="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100 ==null || sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            sortBySubBrandByContractBySubBrand[subBrandId]['contractData'].propByStdTotal*100==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0}%"
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].DomesticIndexTarget!=null}">
                                <apex:param value="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100}" />
                            </apex:outputText>
                            <apex:outputText value=" "
                                rendered="{!sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100 ==null ||sortBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].propByStdTotal*100 - 
                                            sortBySubBrandByContractBySubBrand[subBrandId]['estimate'].propByStdTotal*100==0}" />
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td colspan="9" style="border-left: 1px solid black; border-bottom: 1px solid black;"></td>
                </tr>
            </table>
            <br />
            <table width="100%" border="0" style="" cellspacing="0" cellpadding="0">
                <thead>
                    <tr>
                        <td rowspan="2"
                            style="border-top: 1px solid black; border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;"
                            align="center" width="10%">
                            Sub-Brands 品牌
                        </td>
                        <td colspan="3" bgcolor="#99CCFF" style="border:1px solid black;text-align: center;">
                            <font color="white"><strong>Trade Expenses Per Bottle</strong></font>
                        </td>
                        <td colspan="3" bgcolor="#99CCFF"
                            style="border:1px solid black;text-align: center;{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                            <font color="white"><strong>Gap with Investment - Domestic Target</strong></font>
                        </td>
                        <td colspan="3" bgcolor="#99CCFF"
                            style="border:1px solid black;border-left: none;text-align: center;">
                            <font color="white"><strong>Gap with Investment - Regional Average</strong></font>
                        </td>
                    </tr>
                    <tr>

                        <td style="border-bottom: 1px solid black;" align="center">
                            Contract 合同
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Estimate V0.0 <br /> 预估 V0.0
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                            Actual Performance <br /> 实际
                        </td>
                        <td style="border: 1px solid black;border-top: none;border-left: none;border-right: none;{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}"
                            align="center">
                            Contract 合同
                        </td>
                        <td style="border-bottom: 1px solid black;{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}"
                            align="center">
                            Estimate V0.0 <br /> 预估 V0.0
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}"
                            align="center">
                            Actual Performance <br /> 实际
                        </td>
                        <td style="border: 1px solid black;border-top: none;border-left: none;border-right: none;"
                            align="center">
                            Contract 合同
                        </td>
                        <td style="border-bottom: 1px solid black;" align="center">
                            Estimate V0.0 <br /> 预估 V0.0
                        </td>
                        <td style="border-right: 1px solid black; border-bottom: 1px solid black;" align="center">
                            Actual Performance <br /> 实际
                        </td>
                    </tr>
                </thead>
                <apex:repeat value="{!investmentBySubBrandByContractBySubBrand}" var="subBrandId">
                    <tr>
                        <td align="left" style=" border-right: 1px solid black;border-left: 1px solid black;">
                            <apex:outputText value="{!BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].subBrandName,BLANKVALUE(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].subBrandName,investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].subBrandName))}" escape="false" />
                        </td>

                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].tradeExpensePerBottle2nd==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].tradeExpensePerBottle2nd==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd!=null && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd!=0}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].tradeExpensePerBottle2nd==0}" />
                        </td>

                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticInvestment!=null && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticInvestment!=0}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticInvestment}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithDomesticInvestment==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticInvestment!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticInvestment!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticInvestment}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithDomesticInvestment==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticInvestment > 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticInvestment!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticInvestment!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticInvestment}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticInvestment==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithDomesticInvestment==0}" />
                        </td>


                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageInvestment > 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageInvestment!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageInvestment!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageInvestment}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageInvestment==null || investmentBySubBrandByContractBySubBrand[subBrandId]['contractData'].GapWithRegionalAverageInvestment==0}" />
                        </td>
                        <td align="center">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageInvestment > 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageInvestment!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageInvestment!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageInvestment}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageInvestment==null || investmentBySubBrandByContractBySubBrand[subBrandId]['estimate'].GapWithRegionalAverageInvestment==0}" />
                        </td>
                        <td align="center" style="border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}" style="color:{!IF(investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment > 0, 'red', 'green')};"
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment!=0 && investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment!=null}">
                                <apex:param value="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment}" />
                            </apex:outputText>
                            <apex:outputText value="  "
                                rendered="{!investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment==null || investmentBySubBrandByContractBySubBrand[subBrandId]['lastPayment'].GapWithRegionalAverageInvestment==0}" />
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td colspan="10"
                        style="border-left: 1px solid black; border-bottom: 1px solid black;{!IF(contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    </td>
                    <td colspan="7"
                        style="border-left: 1px solid black; border-bottom: 1px solid black;{!IF(!contains(BelongGroup,'C') || contains(BelongGroup,'D'),'','display:none;')}">
                    </td>
                </tr>
            </table> -->


            <br />


            <!-- <apex:outputPanel> -->

        </apex:outputpanel>

        <table width="100%">
            <tr>
                <td valign="top"
                    style="font-weight: bold; font-size: 11px; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputText value="Finance Comments" />
                </td>
            </tr>
            <tr>
                <td valign="top"
                    style="font-size: 11px; line-height: 15px; border-bottom: 1px solid black; border-top: 1px solid black; border-left: 1px solid black; border-right: 1px solid black;">
                    <apex:outputField value="{!lstApprovalComment[0].ASI_CRM_BA_comments__c}"
                        rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c!=null}" />
                    <apex:outputText value=" - " rendered="{!lstApprovalComment[0].ASI_CRM_BA_comments__c==null}" />
                </td>
            </tr>
        </table>

        <apex:variable rendered="{!contains(BelongGroup,'D')}" value="" var="">
            <br/>
            <table width="100%" cellspacing="0" border="0" cellpadding="2" >
                <tr>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Payment Methods / 付款方式</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payee Name / 一级批发商</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>WS Name / 二级批发商</b></td>
                    <td width="20%" bgcolor="#99CCFF" valign="top"
                        style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Amount / 付款金额</b></td>
                </tr>
                <apex:variable value="{!0}" var="TotalPayeeAmount" />
                <apex:repeat value="{!PayeeList}" var="pe">
                    <apex:variable var="TotalPayeeAmount" value="{!TotalPayeeAmount+pe.ASI_CRM_CN_Amount__c}"
                        rendered="{!pe.ASI_CRM_CN_Amount__c!=null}" />
                    <tr>
                        <td valign="top"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                            {!pe.ASI_CRM_CN_Type__c}</td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{!pe.ASI_CRM_CN_Payee_Name_T1__r.Name}" />
                            <apex:outputText value="{!pe.ASI_CRM_CN_Cash_Payee_Name_T1__r.Name}" />
                        </td>
                        <td valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            {!pe.ASI_CRM_CN_Payee_Name_T2_lookup__r.Name}
                            <apex:outputText value=" - " rendered="{!pe.ASI_CRM_CN_Payee_Name_T2_lookup__c==null}" />
                        </td>
                        <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!pe.ASI_CRM_CN_Amount__c!=0}">
                                <apex:param value="{!pe.ASI_CRM_CN_Amount__c}" />
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td align="right" valign="top" colspan="3" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        <b>Total&nbsp;</b></td>
                    <td align="right" valign="top" bgcolor="#FFFFCC"
                        style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                        <apex:outputText value="{0,number,#,###,##0.00}" rendered="{!TotalPayeeAmount!=0}">
                            <apex:param value="{!TotalPayeeAmount}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!TotalPayeeAmount==null||TotalPayeeAmount==0}" />
                    </td>
                </tr>
            </table>

            <br />

            <table width="100%" cellspacing="0" border="0" cellpadding="2" >
                <thead>
                    <tr>
                        <td colspan="4"><b>Payment Summary / 付款金额汇总</b></td>
                    </tr>
                    <tr>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                        </td>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-right:1px solid black;"><b>PO Estimated Amount /
                                预估金额</b></td>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-right:1px solid black;"><b>PO Remaining Amount /
                                剩余金额</b></td>
                        <td width="25%" bgcolor="#99CCFF" valign="top"
                            style="border-top:1px solid black;border-right:1px solid black;"><b>Payment Request Amount /
                                申请金额</b></td>
                    </tr>
                </thead>
                <apex:variable value="{!0}" var="POEstimatedAmountTotal" />
                <apex:variable value="{!0}" var="PORemainingAmountTotal" />
                <apex:variable value="{!0}" var="PaymentRequestAmountTotal" />
                <tbody>
                    <apex:repeat value="{!PaymentSummaryList}" var="PaymentSummary" id="PaymentSummaryListItem">
                        <apex:variable var="POEstimatedAmountTotal"
                            value="{!POEstimatedAmountTotal+PaymentSummary.POEstimatedAmount}" />
                        <apex:variable var="PORemainingAmountTotal"
                            value="{!PORemainingAmountTotal+PaymentSummary.POEstimatedAmount - PaymentSummary.PaidAmount}" />
                        <apex:variable var="PaymentRequestAmountTotal"
                            value="{!PaymentRequestAmountTotal+PaymentSummary.PaymentRequestAmount}" />
                        <tr>
                            <td valign="top"
                                style="border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                                {!PaymentSummary.Name}
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!PaymentSummary.POEstimatedAmount}" />
                                </apex:outputText>
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!PaymentSummary.POEstimatedAmount - PaymentSummary.PaidAmount}" />
                                </apex:outputText>
                            </td>
                            <td align="right" valign="top" style="border-top:1px solid black;border-right:1px solid black;">
                                <apex:outputText value="{0, number, ###,###,###,###,###}">
                                    <apex:param value="{!PaymentSummary.PaymentRequestAmount}" />
                                </apex:outputText>
                            </td>
                        </tr>
                    </apex:repeat>
                    <tr>
                        <td valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">
                            <b>Total / 付款总额&nbsp;</b>
                        </td>

                        <td align="right" valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!POEstimatedAmountTotal!=null&&POEstimatedAmountTotal!=0}">
                                <apex:param value="{!POEstimatedAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!POEstimatedAmountTotal==null||POEstimatedAmountTotal==0}" />
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!PORemainingAmountTotal!=null&&PORemainingAmountTotal!=0}">
                                <apex:param value="{!PORemainingAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!PORemainingAmountTotal==null||PORemainingAmountTotal==0}" />
                        </td>
                        <td align="right" valign="top" bgcolor="#FFFFCC"
                            style="border-bottom:1px solid black;border-top:1px solid black;border-right:1px solid black;">
                            <apex:outputText value="{0,number,#,###,###}"
                                rendered="{!PaymentRequestAmountTotal!=null&&PaymentRequestAmountTotal!=0}">
                                <apex:param value="{!PaymentRequestAmountTotal}" />
                            </apex:outputText>
                            <apex:outputText value=" - "
                                rendered="{!PaymentRequestAmountTotal==null||PaymentRequestAmountTotal==0}" />
                        </td>

                    </tr>
                </tbody>
            </table>



            <table width="100%" cellspacing="0" cellpadding="2" >
                <tr>
                    <td colspan="4"><b>Financial Indicator / 财务指标</b></td>
                </tr>
                <tr>
                    <td colspan="2" valign="top" bgcolor="#99CCFF" align="center" style="border: 1px solid black;">
                        Contract to
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay<=thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!CutOffDay}" />
                        </apex:outputText>
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay>thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}" />
                        </apex:outputText>
                        Volume Completion % VS % Payment Speed<br />合同开始至
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay<=thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!CutOffDay}" />
                        </apex:outputText>
                        <apex:outputText value=" {0,date,dd/MM/yyyy} "
                            rendered="{!CutOffDay>thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}">
                            <apex:param value="{!thisPR.ASI_TH_CRM_Contract__r.ASI_CRM_CN_PO_End_Date__c}" />
                        </apex:outputText>
                        销售完成情况VS付款进度
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black;">
                        <b>VOL % / 销量完成率 (CR12)</b></td>
                    <td width="50%" valign="top" style="border-right: 1px solid black; border-bottom: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!Other_VOL_CR12!=0}">
                            <apex:param value="{!Other_VOL_CR12}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!Other_VOL_CR12==null||Other_VOL_CR12==0}" />
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        <b>Payment Speed % / 付款进度</b></td>
                    <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%" rendered="{!PaymentSpeed!=null&&PaymentSpeed!=0}">
                            <apex:param value="{!PaymentSpeed}" />
                        </apex:outputText>
                        <apex:outputText value=" - " rendered="{!PaymentSpeed==null||PaymentSpeed==0}" />
                    </td>
                </tr>
                <!-- <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        <b>Payment Speed excl. Fixed Cost% /<br /> 付款进度(除固定费用）</b>
                    </td>
                    <td width="50%" valign="top" style="border-bottom: 1px solid black; border-right: 1px solid black;"
                        align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!PaymentSpeedexcFixCost!=null&&PaymentSpeedexcFixCost!=0}">
                            <apex:param value="{!PaymentSpeedexcFixCost}" />
                        </apex:outputText>
                        <apex:outputText value=" - "
                            rendered="{!PaymentSpeedexcFixCost==null||PaymentSpeedexcFixCost==0}" />
                    </td>
                </tr> -->
            </table>
        </apex:variable>

        <apex:outputpanel id="BRSFPartLastPay" rendered="{!DisplayBRSFPart && thisPR.ASI_CRM_CN_Last_Payment__c}">
        <apex:variable rendered="{!contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C')}" value="" var="">
            <br />
            <table width="100%" cellspacing="0" cellpadding="2"
                style="font-size: 11px;{!IF(contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C'),'','display:none;')}">

                <tr>
                    <td colspan="2" valign="top" bgcolor="#99CCFF" align="left" style="border: 1px solid black;">
                        BRSF / 空瓶付款
                    </td>
                </tr>
                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        BRSF Methodology / 空瓶回收费付款方式
                    </td>
                    <td width="50%" valign="top"
                        style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                        {!BRSFItemMap.Module.ASI_CRM_Methodology__r.Name}<br />
                        {!BRSFItemMap.Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c}
                    </td>
                </tr>

                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        CTD BRSF Payment Period
                    </td>
                    <td width="50%" valign="top"
                        style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                        <apex:outputText value="{0,date,MM/dd/yy}">
                            <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c}" />
                        </apex:outputText>
                        -<apex:outputText value="{0,date,MM/dd/yy}">
                            <apex:param value="{!BRSFItemMap.Module.ASI_CRM_End_Date__c}" />
                        </apex:outputText>
                        [{!BRSFmonthsBetween} month(s)]
                    </td>
                </tr>


                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        CTD BC% / 合同销量至今空瓶回收率
                    </td>
                    <td width="50%" valign="top"
                        style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!BRSFItemMap.BCRate!=null && BRSFItemMap.BCRate!=0}">
                            <apex:param value="{!BRSFItemMap.BCRate}" />
                        </apex:outputText>
                        <apex:outputText value="0%" rendered="{!BRSFItemMap.BCRate=null || BRSFItemMap.BCRate=0}" />

                    </td>
                </tr>


                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        BC % Contract / 合同签约空瓶回收率
                    </td>
                    <td width="50%" valign="top"
                        style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">

                        <apex:outputText value="{0,number,#,###,##0.0}%"
                            rendered="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c!=null && ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c!=0}">
                            <apex:param value="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c}" />
                        </apex:outputText>
                        <apex:outputText value="0%"
                            rendered="{!ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c=null || ContractSelected.ASI_CRM_CN_Bottle_Collection_Rate__c=0}" />

                    </td>
                </tr>

                <tr>
                    <td width="50%" valign="top"
                        style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                        BRSF Over Payment Reason / 原因说明
                    </td>
                    <td width="50%" valign="top"
                        style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                        {!BRSFItemMap.Module.ASI_CRM_Overpayment_Reason__c}
                    </td>
                </tr>

            </table>
        </apex:variable>
        </apex:outputpanel>
        
        <apex:outputpanel id="PSFPartLastPay" rendered="{!DisplayPSFPart && thisPR.ASI_CRM_CN_Last_Payment__c}">
        <apex:variable rendered="{!contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C')}" value="" var="">
            <br />
            <table width="100%" cellspacing="0" cellpadding="2"
                style="font-size: 11px;{!IF(contains(BelongGroup,'A') || contains(BelongGroup,'B') || contains(BelongGroup,'C'),'','display:none;')}">

                <tr>
                    <td colspan="3" valign="top" bgcolor="#99CCFF" align="left" style="border: 1px solid black;">
                        PSF / 合同奖励
                    </td>
                </tr>
                <apex:variable value="{!0}" var="i" />
                <apex:repeat value="{!PSF_Item_Map}" var="itm" id="PSFitemLastPay">
                    <apex:variable var="i" value="{!i+1}" />
                    <tr>
                        <td colspan="3" valign="top" bgcolor="#FFFFCC" align="left"
                            style="border: 1px solid black;">
                            PSF Module {!i}
                        </td>
                    </tr>
                    <tr>
                        <td width="30%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            PSF Methodology / 空瓶回收服务费付款方式
                        </td>
                        <td colspan="2" width="50%" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                            {!PSF_Item_Map[itm].Module.ASI_CRM_Methodology__r.Name}<br />
                            {!PSF_Item_Map[itm].Module.ASI_CRM_Methodology__r.ASI_CRM_Chinese_Name__c}
                        </td>
                    </tr>

                    <tr>
                        <td width="30%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            Volume Option &amp; Unit/ 销量方式 &amp; 单位
                        </td>
                        <td colspan="2" width="50%" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Volume_Base__c}" />
                            (
                            <apex:outputField value="{!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Unit__c}" />)
                        </td>
                    </tr>

                    <tr>
                        <td width="30%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            PSF Payment Period
                        </td>
                        <td width="33.33%" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                            Payment Amount / 付款总额
                        </td>

                        <td width="33.33%" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                            Description / 付款说明
                        </td>

                    </tr>
                    <tr>
                        <td width="30%" valign="top"
                            style="border-left: 1px solid black; border-bottom: 1px solid black; border-right: 1px solid black;">
                            <apex:outputText value="{0,date,MM/dd/yy}">
                                <apex:param value="{!ContractSelected.ASI_CRM_CN_PO_Start_Date__c}" />
                            </apex:outputText>
                            -<apex:outputText value="{0,date,MM/dd/yy}">
                                <apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_End_Date__c}" />
                            </apex:outputText>
                        </td>
                        <td width="33.33%" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="right">
                            <apex:outputText value="{0,number,#,###,##0.00}"
                                rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c!=null&& PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c!=0}">
                                <apex:param value="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c}" />
                            </apex:outputText>
                            <apex:outputText value="0"
                                rendered="{!PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c=null||PSF_Item_Map[itm].Module.ASI_CRM_Actual_Payment__c=0}" />
                        </td>

                        <td width="33.33%" valign="top"
                            style="border-bottom: 1px solid black; border-right: 1px solid black;" align="left">
                            {!PSF_Item_Map[itm].Module.ASI_CRM_Parent_Module__r.ASI_CRM_Remark__c}
                        </td>

                    </tr>

                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </apex:repeat>

            </table>
        </apex:variable>
        </apex:outputpanel>
        <!-- </apex:outputPanel> -->
    </body>
</apex:component>