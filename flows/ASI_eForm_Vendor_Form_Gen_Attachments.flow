<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>49.0</apiVersion>
    <assignments>
        <name>Assign_Bank</name>
        <label>Assign Bank</label>
        <locationX>460</locationX>
        <locationY>547</locationY>
        <assignmentItems>
            <assignToReference>Varl_FileCategory</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Bank</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Customer_Form_Attachment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Category_Company_Registration</name>
        <label>Assign Category Company Registration</label>
        <locationX>460</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>Varl_FileCategory</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Company Registration</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Customer_Form_Attachment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_FileId</name>
        <label>Assign FileId</label>
        <locationX>538</locationX>
        <locationY>340</locationY>
        <assignmentItems>
            <assignToReference>Var_ContentDocumentId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Var_ContentDocumentLink.ContentDocumentId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Find_Form_File</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Others</name>
        <label>Assign Others</label>
        <locationX>460</locationX>
        <locationY>643</locationY>
        <assignmentItems>
            <assignToReference>Varl_FileCategory</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Others</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Customer_Form_Attachment</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Attachment_Exist</name>
        <label>Attachment Exist?</label>
        <locationX>362</locationX>
        <locationY>344</locationY>
        <defaultConnector>
            <targetReference>Assign_FileId</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>N</defaultConnectorLabel>
        <rules>
            <name>Y</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Var_ExistingAttachment</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Find_Each_ContentDocumentLink</targetReference>
            </connector>
            <label>Y</label>
        </rules>
    </decisions>
    <decisions>
        <name>File_Category</name>
        <label>File_Category?</label>
        <locationX>760</locationX>
        <locationY>463</locationY>
        <defaultConnector>
            <targetReference>Assign_Others</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Others</defaultConnectorLabel>
        <rules>
            <name>Company_Registration</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Varl_FileName</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>Company Registration</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Category_Company_Registration</targetReference>
            </connector>
            <label>Company Registration</label>
        </rules>
        <rules>
            <name>Bank</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Varl_FileName</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>Bank</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Bank</targetReference>
            </connector>
            <label>Bank</label>
        </rules>
    </decisions>
    <decisions>
        <name>Source_Form</name>
        <label>Source Form</label>
        <locationX>387</locationX>
        <locationY>78</locationY>
        <defaultConnector>
            <targetReference>Waiat_From_Arrive</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Webform</defaultConnectorLabel>
        <rules>
            <name>SFDC</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Var_Source</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SFDC</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Find_From_Files_Links</targetReference>
            </connector>
            <label>SFDC</label>
        </rules>
    </decisions>
    <description>add others</description>
    <interviewLabel>ASI eForm Vendor Form Gen Attachments {!$Flow.CurrentDateTime}</interviewLabel>
    <label>ASI eForm HK Vendor Form Gen Attachments</label>
    <loops>
        <name>Find_Each_ContentDocumentLink</name>
        <label>Find Each ContentDocumentLink</label>
        <locationX>197</locationX>
        <locationY>263</locationY>
        <assignNextValueToReference>Var_ContentDocumentLink</assignNextValueToReference>
        <collectionReference>Var_ContentDocumentLinks</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Find_Existing_Attachment</targetReference>
        </nextValueConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Customer_Form_Attachment</name>
        <label>Create Customer Form Attachment</label>
        <locationX>136</locationX>
        <locationY>515</locationY>
        <connector>
            <targetReference>Find_Each_ContentDocumentLink</targetReference>
        </connector>
        <inputAssignments>
            <field>ASI_eForm_Category__c</field>
            <value>
                <elementReference>Varl_FileCategory</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ASI_eForm_FileId__c</field>
            <value>
                <elementReference>Varl_FileId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ASI_eForm_File_Ext__c</field>
            <value>
                <elementReference>Varl_FileExtension</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ASI_eForm_File_Name__c</field>
            <value>
                <elementReference>Varl_FileName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ASI_eForm_File_Size__c</field>
            <value>
                <elementReference>Varl_FileSize</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ASI_eForm_Vendor_Form__c</field>
            <value>
                <elementReference>Var_FormId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <stringValue>012D0000000t2EgIAI</stringValue>
            </value>
        </inputAssignments>
        <object>ASI_eForm_Vendor_Form_Attachment__c</object>
    </recordCreates>
    <recordLookups>
        <name>Find_Existing_Attachment</name>
        <label>Find Existing Attachment</label>
        <locationX>408</locationX>
        <locationY>255</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Attachment_Exist</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ASI_eForm_FileId__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Var_ContentDocumentLink.ContentDocumentId</elementReference>
            </value>
        </filters>
        <filters>
            <field>ASI_eForm_Vendor_Form__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Var_FormId</elementReference>
            </value>
        </filters>
        <object>ASI_eForm_Vendor_Form_Attachment__c</object>
        <outputAssignments>
            <assignToReference>Var_ExistingAttachment</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Find_Form_File</name>
        <label>Find Form File</label>
        <locationX>746</locationX>
        <locationY>339</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>File_Category</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Var_ContentDocumentId</elementReference>
            </value>
        </filters>
        <object>ContentDocument</object>
        <outputAssignments>
            <assignToReference>Varl_FileSize</assignToReference>
            <field>ContentSize</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>Varl_FileExtension</assignToReference>
            <field>FileExtension</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>Varl_FileType</assignToReference>
            <field>FileType</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>Varl_FileId</assignToReference>
            <field>Id</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>Varl_FileName</assignToReference>
            <field>Title</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Find_From_Files_Links</name>
        <label>Find From Files Links</label>
        <locationX>196</locationX>
        <locationY>170</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Find_Each_ContentDocumentLink</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>LinkedEntityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Var_FormId</elementReference>
            </value>
        </filters>
        <object>ContentDocumentLink</object>
        <outputReference>Var_ContentDocumentLinks</outputReference>
        <queriedFields>ContentDocumentId</queriedFields>
    </recordLookups>
    <start>
        <locationX>50</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>Source_Form</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>Var_ContentDocumentId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
    <variables>
        <name>Var_ContentDocumentLink</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>Var_ContentDocumentLinks</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>Var_ExistingAttachment</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
    <variables>
        <name>Var_FormId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
    <variables>
        <name>Var_FromArriveTime</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Var_Source</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Varl_FileCategory</name>
        <dataType>Picklist</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Varl_FileExtension</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Varl_FileId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
    <variables>
        <name>Varl_FileName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
    <variables>
        <name>Varl_FileSize</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>Varl_FileType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
    <waits>
        <name>Waiat_From_Arrive</name>
        <label>Waiat From Arrive</label>
        <locationX>197</locationX>
        <locationY>69</locationY>
        <defaultConnectorLabel>[Default Path]</defaultConnectorLabel>
        <waitEvents>
            <name>X5m_After</name>
            <conditionLogic>and</conditionLogic>
            <connector>
                <targetReference>Find_From_Files_Links</targetReference>
            </connector>
            <eventType>AlarmEvent</eventType>
            <inputParameters>
                <name>AlarmTime</name>
                <value>
                    <elementReference>Var_FromArriveTime</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>TimeOffset</name>
                <value>
                    <numberValue>0.1</numberValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>TimeOffsetUnit</name>
                <value>
                    <stringValue>Hours</stringValue>
                </value>
            </inputParameters>
            <label>5m After</label>
        </waitEvents>
    </waits>
</Flow>
