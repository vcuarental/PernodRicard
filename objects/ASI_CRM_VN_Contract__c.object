<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionOverrides>
        <actionName>Accept</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Accept</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Accept</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <content>ASI_CRM_VN_ContractPage</content>
        <skipRecordTypeSelect>false</skipRecordTypeSelect>
        <type>Visualforce</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <allowInChatterGroups>false</allowInChatterGroups>
    <compactLayoutAssignment>SYSTEM</compactLayoutAssignment>
    <deploymentStatus>Deployed</deploymentStatus>
    <description>This contract object is only for PRVN</description>
    <enableActivities>false</enableActivities>
    <enableBulkApi>true</enableBulkApi>
    <enableEnhancedLookup>true</enableEnhancedLookup>
    <enableFeeds>false</enableFeeds>
    <enableHistory>true</enableHistory>
    <enableLicensing>false</enableLicensing>
    <enableReports>true</enableReports>
    <enableSearch>true</enableSearch>
    <enableSharing>true</enableSharing>
    <enableStreamingApi>true</enableStreamingApi>
    <externalSharingModel>Private</externalSharingModel>
    <fields>
        <fullName>ASI_CRM_AP_Per_Bottle__c</fullName>
        <externalId>false</externalId>
        <formula>IF(
	OR(
		ISBLANK(ASI_CRM_Total_Amount__c), 
		ISBLANK(ASI_CRM_Converted_Total_Sales_Target__c),
		ASI_CRM_Total_Amount__c = 0,
		ASI_CRM_Converted_Total_Sales_Target__c= 0
	), 
	0, 
	IF( 
		TEXT(ASI_CRM_Currency__c) = &apos;USD&apos;, 
		ASI_CRM_Total_Amount__c / ASI_CRM_Converted_Total_Sales_Target__c, 
		(ASI_CRM_Total_Amount__c / ASI_CRM_Converted_Total_Sales_Target__c) * ASI_CRM_To_USD_Exchange_Rate__c 
	)
)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>A&amp;P per Bottle (USD)</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Activation_Support__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Activation Support</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Agreement_with_Outlet__c</fullName>
        <externalId>false</externalId>
        <label>Agreement with Outlet</label>
        <length>32768</length>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>LongTextArea</type>
        <visibleLines>7</visibleLines>
    </fields>
    <fields>
        <fullName>ASI_CRM_Allow_Early_Termination__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Allow Early Termination</label>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Allow_Extend__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Allow Extend</label>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Area_Code__c</fullName>
        <externalId>false</externalId>
        <label>Area Code</label>
        <length>30</length>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Area__c</fullName>
        <externalId>false</externalId>
        <formula>TEXT( ASI_CRM_Outlet_WS__r.ASI_CRM_Area__c )</formula>
        <label>Area</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Balance_Amount__c</fullName>
        <externalId>false</externalId>
        <label>Balance Amount</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_Cal_Balance_Amount__c</summarizedField>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Closed_Date__c</fullName>
        <externalId>false</externalId>
        <label>Closed Date</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Date</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Committed_Amount__c</fullName>
        <externalId>false</externalId>
        <label>Committed Amount</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_Commit_Amount__c</summarizedField>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Contract_Achieved__c</fullName>
        <externalId>false</externalId>
        <label>% Achieved</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Percent</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Contract_Number__c</fullName>
        <externalId>false</externalId>
        <label>Contract No.</label>
        <length>255</length>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Contract_Status__c</fullName>
        <externalId>false</externalId>
        <label>Contract Status</label>
        <required>false</required>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>Draft</fullName>
                    <default>true</default>
                    <label>Draft</label>
                </value>
                <value>
                    <fullName>Submitted</fullName>
                    <default>false</default>
                    <label>Submitted</label>
                </value>
                <value>
                    <fullName>Pending Verification</fullName>
                    <default>false</default>
                    <label>Pending Verification</label>
                </value>
                <value>
                    <fullName>Approved</fullName>
                    <default>false</default>
                    <label>Approved</label>
                </value>
                <value>
                    <fullName>Closed</fullName>
                    <default>false</default>
                    <label>Closed</label>
                </value>
                <value>
                    <fullName>Closed(Terminated)</fullName>
                    <default>false</default>
                    <label>Closed(Terminated)</label>
                </value>
                <value>
                    <fullName>Submit for Termination</fullName>
                    <default>false</default>
                    <label>Submit for Termination</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>ASI_CRM_Contract_Vol_CTD_Bottle__c</fullName>
        <externalId>false</externalId>
        <label>Vol CTD (Bottle)</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Converted_Total_Sales_Target__c</fullName>
        <externalId>false</externalId>
        <label>Total Sales Target</label>
        <precision>18</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Currency__c</fullName>
        <externalId>false</externalId>
        <label>Currency</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>VND</fullName>
                    <default>false</default>
                    <label>VND</label>
                </value>
                <value>
                    <fullName>USD</fullName>
                    <default>false</default>
                    <label>USD</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>ASI_CRM_End_Date__c</fullName>
        <externalId>false</externalId>
        <label>End Date</label>
        <required>false</required>
        <trackHistory>true</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Date</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Exchange_Rate__c</fullName>
        <externalId>false</externalId>
        <label>Exchange Rate</label>
        <precision>18</precision>
        <required>false</required>
        <scale>6</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Extend_Reason__c</fullName>
        <externalId>false</externalId>
        <label>Extend Reason</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>TextArea</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Extend_Times__c</fullName>
        <defaultValue>0</defaultValue>
        <externalId>false</externalId>
        <label>Extend Times</label>
        <precision>1</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Key_Brand__c</fullName>
        <deleteConstraint>SetNull</deleteConstraint>
        <externalId>false</externalId>
        <label>Key Brand</label>
        <lookupFilter>
            <active>true</active>
            <errorMessage>Only can select VN Sub-Brand</errorMessage>
            <filterItems>
                <field>ASI_MFM_Sub_brand__c.RecordTypeId</field>
                <operation>equals</operation>
                <value>VN Sub-Brand</value>
            </filterItems>
            <isOptional>false</isOptional>
        </lookupFilter>
        <referenceTo>ASI_MFM_Sub_brand__c</referenceTo>
        <relationshipLabel>Contracts (VN)</relationshipLabel>
        <relationshipName>Contracts_VN</relationshipName>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_MCF_Type__c</fullName>
        <externalId>false</externalId>
        <label>MCF Type</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <restricted>true</restricted>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>Local</fullName>
                    <default>false</default>
                    <label>Local</label>
                </value>
                <value>
                    <fullName>International</fullName>
                    <default>false</default>
                    <label>International</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>ASI_CRM_New_End_Date__c</fullName>
        <externalId>false</externalId>
        <label>New End Date</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Date</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_No_Of_Months__c</fullName>
        <externalId>false</externalId>
        <formula>IF(NOT(ISBLANK(ASI_CRM_End_Date__c) || ISBLANK(ASI_CRM_Start_Date__c))
,(((YEAR(ASI_CRM_End_Date__c) - YEAR(ASI_CRM_Start_Date__c) - 1) *12) + (12 - MONTH(ASI_CRM_Start_Date__c) +1) + MONTH(ASI_CRM_End_Date__c))
, null
)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>No. of Months</label>
        <precision>18</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Objective__c</fullName>
        <externalId>false</externalId>
        <label>Objective</label>
        <length>32768</length>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>LongTextArea</type>
        <visibleLines>5</visibleLines>
    </fields>
    <fields>
        <fullName>ASI_CRM_Original_End_Date__c</fullName>
        <externalId>false</externalId>
        <label>Original End Date</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Date</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_Address__c</fullName>
        <externalId>false</externalId>
        <formula>ASI_CRM_Outlet_WS__r.ASI_CRM_CN_Address__c</formula>
        <label>Address</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_Contracted_Brand__c</fullName>
        <externalId>false</externalId>
        <formula>TEXT(ASI_CRM_Outlet_WS__r.ASI_CRM_ContractedBrand__c)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Contracted Brand</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_Image__c</fullName>
        <externalId>false</externalId>
        <formula>TEXT(ASI_CRM_Outlet_WS__r.ASI_CRM_Check_Image__c)</formula>
        <label>Check Image</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_Region__c</fullName>
        <externalId>false</externalId>
        <formula>TEXT(ASI_CRM_Outlet_WS__r.ASI_CRM_VN_Region__c)</formula>
        <label>Region</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_Role__c</fullName>
        <externalId>false</externalId>
        <label>Outlet Role</label>
        <length>15</length>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_Type__c</fullName>
        <externalId>false</externalId>
        <formula>TEXT(ASI_CRM_Outlet_WS__r.ASI_CRM_VN_OutletType__c)</formula>
        <label>Channel</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Outlet_WS__c</fullName>
        <deleteConstraint>SetNull</deleteConstraint>
        <externalId>false</externalId>
        <label>Outlet/WS</label>
        <lookupFilter>
            <active>true</active>
            <errorMessage>You can only select parent outlet and active outlet.</errorMessage>
            <filterItems>
                <field>ASI_CRM_AccountsAdditionalField__c.RecordTypeId</field>
                <operation>equals</operation>
                <value>Outlet (VN), Outlet (VN), VN Value On-Trade Outlet</value>
            </filterItems>
            <filterItems>
                <field>ASI_CRM_AccountsAdditionalField__c.ASI_CRM_CN_Parent_Outlet__c</field>
                <operation>equals</operation>
                <value></value>
            </filterItems>
            <isOptional>false</isOptional>
        </lookupFilter>
        <referenceTo>ASI_CRM_AccountsAdditionalField__c</referenceTo>
        <relationshipLabel>Contracts (VN)</relationshipLabel>
        <relationshipName>Contracts</relationshipName>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_PROS_Image__c</fullName>
        <externalId>false</externalId>
        <formula>TEXT(ASI_CRM_Outlet_WS__r.ASI_CRM_CN_New_Image__c)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>PROS Image</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_ROI__c</fullName>
        <externalId>false</externalId>
        <label>ROI</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Spirit_Volume_Potential__c</fullName>
        <externalId>false</externalId>
        <label>Spirit Volume Potential</label>
        <length>15</length>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Start_Date__c</fullName>
        <externalId>false</externalId>
        <label>Start Date</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Date</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Sys_Force_Termination__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Sys Force Termination</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Sys_Owner_Manager__c</fullName>
        <deleteConstraint>SetNull</deleteConstraint>
        <externalId>false</externalId>
        <label>Sys Owner Manager</label>
        <referenceTo>User</referenceTo>
        <relationshipName>Contracts_VN</relationshipName>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Sys_POSM_Balance__c</fullName>
        <externalId>false</externalId>
        <label>Sys_POSM_Balance</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_Sys_Balance_Amount__c</summarizedField>
        <summaryFilterItems>
            <field>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Item__c</field>
            <operation>equals</operation>
            <value>PG &amp; Uniform, Branding (Signage), VIP Rooms, Glassware (Including Ice Buckets), Drink Menus, Podium Stands &amp; Glorifiers</value>
        </summaryFilterItems>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Termination_Reason__c</fullName>
        <externalId>false</externalId>
        <label>Termination Reason</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>TextArea</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_To_USD_Exchange_Rate__c</fullName>
        <externalId>false</externalId>
        <label>VND to USD Exchange Rate</label>
        <precision>18</precision>
        <required>false</required>
        <scale>6</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_To_VND_Exchange_Rate__c</fullName>
        <externalId>false</externalId>
        <label>USD to VND Exchange Rate</label>
        <precision>18</precision>
        <required>false</required>
        <scale>6</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Total_Amount__c</fullName>
        <externalId>false</externalId>
        <label>Total Contract Expenditure</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_Total_Amount__c</summarizedField>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Total_Capsule_Amount__c</fullName>
        <externalId>false</externalId>
        <label>Total Contract Expenditure</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Total_Amount__c</summarizedField>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Total_Lump_Sum__c</fullName>
        <externalId>false</externalId>
        <label>Total Lump Sum</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Amount__c</summarizedField>
        <summaryFilterItems>
            <field>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Item__c</field>
            <operation>equals</operation>
            <value>Lump Sum</value>
        </summaryFilterItems>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Total_Sales_Target_Month__c</fullName>
        <externalId>false</externalId>
        <label>Total Sales Target (Per Month)</label>
        <summarizedField>ASI_CRM_VN_Bottle_Analysis__c.ASI_CRM_Target_Per_Month__c</summarizedField>
        <summaryForeignKey>ASI_CRM_VN_Bottle_Analysis__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Total_Sales_Target__c</fullName>
        <externalId>false</externalId>
        <formula>ASI_CRM_No_Of_Months__c * ASI_CRM_Total_Sales_Target_Month__c</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Total Sales Target</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>ASI_CRM_Type__c</fullName>
        <externalId>false</externalId>
        <label>Type</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>New</fullName>
                    <default>false</default>
                    <label>New</label>
                </value>
                <value>
                    <fullName>Renewal</fullName>
                    <default>false</default>
                    <label>Renewal</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>ASI_CRM_VN_Remaining_Promotion_Amount__c</fullName>
        <externalId>false</externalId>
        <label>Remaining Promotion Amount</label>
        <summarizedField>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_Balance_Amount__c</summarizedField>
        <summaryFilterItems>
            <field>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Item__c</field>
            <operation>equals</operation>
            <value>Promotion</value>
        </summaryFilterItems>
        <summaryForeignKey>ASI_CRM_VN_Contract_Expenditure__c.ASI_CRM_VN_Contract__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_VN_Segment_Type__c</fullName>
        <externalId>false</externalId>
        <label>Segment Type</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <restricted>true</restricted>
            <valueSetName>ASI_CRM_VN_Segment_Type</valueSetName>
        </valueSet>
    </fields>
    <fields>
        <fullName>ASI_CRM_Valid_Claim_Date__c</fullName>
        <externalId>false</externalId>
        <label>Valid Claim Date</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Date</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Verified__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Verified</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>ASI_CRM_Wine_Volume_Potential__c</fullName>
        <externalId>false</externalId>
        <label>Wine Volume Potential</label>
        <length>15</length>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <label>Contract (VN)</label>
    <listViews>
        <fullName>ASI_CRM_VN_All_Capsule_Agreement</fullName>
        <columns>NAME</columns>
        <columns>ASI_CRM_Outlet_WS__c</columns>
        <columns>ASI_CRM_Contract_Status__c</columns>
        <columns>ASI_CRM_Outlet_Contracted_Brand__c</columns>
        <columns>ASI_CRM_Start_Date__c</columns>
        <columns>ASI_CRM_End_Date__c</columns>
        <columns>ASI_CRM_No_Of_Months__c</columns>
        <columns>OWNER.FIRST_NAME</columns>
        <columns>OWNER.LAST_NAME</columns>
        <columns>CREATED_DATE</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>RECORDTYPE</field>
            <operation>equals</operation>
            <value>ASI_CRM_VN_Contract__c.ASI_CRM_VN_Capsule_Agreement_Contract</value>
        </filters>
        <label>All Capsule Agreement</label>
        <language>en_US</language>
        <sharedTo>
            <group>ASI_CRM_VN_all_User</group>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>ASI_CRM_VN_All_MCF_Contract</fullName>
        <columns>NAME</columns>
        <columns>ASI_CRM_Outlet_WS__c</columns>
        <columns>ASI_CRM_Contract_Status__c</columns>
        <columns>ASI_CRM_Outlet_Contracted_Brand__c</columns>
        <columns>ASI_CRM_Start_Date__c</columns>
        <columns>ASI_CRM_End_Date__c</columns>
        <columns>ASI_CRM_No_Of_Months__c</columns>
        <columns>OWNER.FIRST_NAME</columns>
        <columns>OWNER.LAST_NAME</columns>
        <columns>CREATED_DATE</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>RECORDTYPE</field>
            <operation>equals</operation>
            <value>ASI_CRM_VN_Contract__c.ASI_CRM_VN_Contract</value>
        </filters>
        <label>All MCF Contract</label>
        <language>en_US</language>
        <sharedTo>
            <group>ASI_CRM_VN_all_User</group>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>ASI_CRM_VN_Approved_Capsule_Agreement</fullName>
        <columns>NAME</columns>
        <columns>ASI_CRM_Outlet_WS__c</columns>
        <columns>ASI_CRM_Contract_Status__c</columns>
        <columns>ASI_CRM_Outlet_Contracted_Brand__c</columns>
        <columns>ASI_CRM_Start_Date__c</columns>
        <columns>ASI_CRM_End_Date__c</columns>
        <columns>ASI_CRM_No_Of_Months__c</columns>
        <columns>OWNER.FIRST_NAME</columns>
        <columns>OWNER.LAST_NAME</columns>
        <columns>CREATED_DATE</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>RECORDTYPE</field>
            <operation>equals</operation>
            <value>ASI_CRM_VN_Contract__c.ASI_CRM_VN_Capsule_Agreement_Contract</value>
        </filters>
        <filters>
            <field>ASI_CRM_Contract_Status__c</field>
            <operation>equals</operation>
            <value>Approved</value>
        </filters>
        <label>Approved Capsule Agreement</label>
        <language>en_US</language>
        <sharedTo>
            <group>ASI_CRM_VN_Contract_Approver</group>
            <group>ASI_CRM_VN_all_User</group>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>ASI_CRM_VN_Approved_MCF_Contract</fullName>
        <columns>NAME</columns>
        <columns>ASI_CRM_Outlet_WS__c</columns>
        <columns>ASI_CRM_Contract_Status__c</columns>
        <columns>ASI_CRM_Outlet_Contracted_Brand__c</columns>
        <columns>ASI_CRM_Start_Date__c</columns>
        <columns>ASI_CRM_End_Date__c</columns>
        <columns>ASI_CRM_No_Of_Months__c</columns>
        <columns>OWNER.FIRST_NAME</columns>
        <columns>OWNER.LAST_NAME</columns>
        <columns>CREATED_DATE</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>RECORDTYPE</field>
            <operation>equals</operation>
            <value>ASI_CRM_VN_Contract__c.ASI_CRM_VN_Contract</value>
        </filters>
        <filters>
            <field>ASI_CRM_Contract_Status__c</field>
            <operation>equals</operation>
            <value>Approved</value>
        </filters>
        <label>Approved MCF Contract</label>
        <language>en_US</language>
        <sharedTo>
            <group>ASI_CRM_VN_Contract_Approver</group>
            <group>ASI_CRM_VN_all_User</group>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>All</fullName>
        <filterScope>Everything</filterScope>
        <label>All</label>
    </listViews>
    <listViews>
        <fullName>All_Pending_Verification_Capsule</fullName>
        <columns>NAME</columns>
        <columns>ASI_CRM_Outlet_WS__c</columns>
        <columns>ASI_CRM_Contract_Status__c</columns>
        <columns>ASI_CRM_Outlet_Contracted_Brand__c</columns>
        <columns>ASI_CRM_Start_Date__c</columns>
        <columns>ASI_CRM_End_Date__c</columns>
        <columns>ASI_CRM_No_Of_Months__c</columns>
        <columns>OWNER.FIRST_NAME</columns>
        <columns>OWNER.LAST_NAME</columns>
        <columns>CREATED_DATE</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>ASI_CRM_Contract_Status__c</field>
            <operation>equals</operation>
            <value>Pending Verification</value>
        </filters>
        <filters>
            <field>RECORDTYPE</field>
            <operation>equals</operation>
            <value>ASI_CRM_VN_Contract__c.ASI_CRM_VN_Capsule_Agreement_Contract</value>
        </filters>
        <label>All Pending Verification Capsule</label>
        <language>en_US</language>
        <sharedTo>
            <group>ASI_CRM_VN_Contract_Approver</group>
            <group>ASI_CRM_VN_all_User</group>
        </sharedTo>
    </listViews>
    <listViews>
        <fullName>All_Pending_Verification_MCF_Contract</fullName>
        <columns>NAME</columns>
        <columns>ASI_CRM_Outlet_WS__c</columns>
        <columns>ASI_CRM_Contract_Status__c</columns>
        <columns>ASI_CRM_Outlet_Contracted_Brand__c</columns>
        <columns>ASI_CRM_Start_Date__c</columns>
        <columns>ASI_CRM_End_Date__c</columns>
        <columns>ASI_CRM_No_Of_Months__c</columns>
        <columns>OWNER.FIRST_NAME</columns>
        <columns>OWNER.LAST_NAME</columns>
        <columns>CREATED_DATE</columns>
        <filterScope>Everything</filterScope>
        <filters>
            <field>ASI_CRM_Contract_Status__c</field>
            <operation>equals</operation>
            <value>Pending Verification</value>
        </filters>
        <filters>
            <field>RECORDTYPE</field>
            <operation>equals</operation>
            <value>ASI_CRM_VN_Contract__c.ASI_CRM_VN_Contract</value>
        </filters>
        <label>All Pending Verification MCF Contract</label>
        <language>en_US</language>
        <sharedTo>
            <group>ASI_CRM_VN_Contract_Approver</group>
            <group>ASI_CRM_VN_all_User</group>
        </sharedTo>
    </listViews>
    <nameField>
        <displayFormat>{0000}</displayFormat>
        <label>Contract Reference</label>
        <trackHistory>false</trackHistory>
        <type>AutoNumber</type>
    </nameField>
    <pluralLabel>Contracts (VN)</pluralLabel>
    <recordTypeTrackHistory>false</recordTypeTrackHistory>
    <recordTypes>
        <fullName>ASI_CRM_VN_Capsule_Agreement_Contract</fullName>
        <active>true</active>
        <label>ASI CRM VN Capsule Agreement Contract</label>
        <picklistValues>
            <picklist>ASI_CRM_Contract_Status__c</picklist>
            <values>
                <fullName>Draft</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_Currency__c</picklist>
            <values>
                <fullName>USD</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>VND</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_MCF_Type__c</picklist>
            <values>
                <fullName>International</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Local</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_Type__c</picklist>
            <values>
                <fullName>New</fullName>
                <default>true</default>
            </values>
            <values>
                <fullName>Renewal</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_VN_Segment_Type__c</picklist>
            <values>
                <fullName>Premium</fullName>
                <default>true</default>
            </values>
            <values>
                <fullName>Value</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <recordTypes>
        <fullName>ASI_CRM_VN_Contract</fullName>
        <active>true</active>
        <label>ASI CRM VN Contract</label>
        <picklistValues>
            <picklist>ASI_CRM_Contract_Status__c</picklist>
            <values>
                <fullName>Draft</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_Currency__c</picklist>
            <values>
                <fullName>USD</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>VND</fullName>
                <default>true</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_MCF_Type__c</picklist>
            <values>
                <fullName>International</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Local</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_Type__c</picklist>
            <values>
                <fullName>New</fullName>
                <default>true</default>
            </values>
            <values>
                <fullName>Renewal</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>ASI_CRM_VN_Segment_Type__c</picklist>
            <values>
                <fullName>Premium</fullName>
                <default>true</default>
            </values>
            <values>
                <fullName>Value</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <searchLayouts>
        <lookupDialogsAdditionalFields>ASI_CRM_Outlet_WS__c</lookupDialogsAdditionalFields>
        <lookupDialogsAdditionalFields>ASI_CRM_Start_Date__c</lookupDialogsAdditionalFields>
        <lookupDialogsAdditionalFields>ASI_CRM_End_Date__c</lookupDialogsAdditionalFields>
    </searchLayouts>
    <sharingModel>Private</sharingModel>
    <validationRules>
        <fullName>ASI_CRM_Input_before_approved</fullName>
        <active>true</active>
        <description>User must input the Contract Number and Area Code before setting the contract to Approved</description>
        <errorConditionFormula>(ISBLANK(ASI_CRM_Area_Code__c) ||  ISBLANK(ASI_CRM_Contract_Number__c)) &amp;&amp;   ISPICKVAL(ASI_CRM_Contract_Status__c, &apos;Approved&apos;)</errorConditionFormula>
        <errorMessage>Contract Number and Area Code must be inputted when contract status set to Approved</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>ASI_CRM_VN_CheckStartDate</fullName>
        <active>true</active>
        <errorConditionFormula>ASI_CRM_Start_Date__c &gt; ASI_CRM_End_Date__c</errorConditionFormula>
        <errorDisplayField>ASI_CRM_Start_Date__c</errorDisplayField>
        <errorMessage>Start date should be smaller than end date</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>ASI_CRM_VN_Check_Full_Month_Contract</fullName>
        <active>true</active>
        <description>Check if the contract is in full calendar month.</description>
        <errorConditionFormula>OR (
DAY(ASI_CRM_Start_Date__c) &lt;&gt; 1, 
ASI_CRM_End_Date__c &lt;&gt; ( 
  IF( 
    MONTH(ASI_CRM_End_Date__c) = 12,
    DATE(YEAR(ASI_CRM_End_Date__c) + 1, 1, 1 ),
    DATE(YEAR(ASI_CRM_End_Date__c), MONTH(ASI_CRM_End_Date__c) + 1, 1 )
  ) - 1 
)
)</errorConditionFormula>
        <errorMessage>Contract should be in FULL calendar month</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>ASI_CRM_VN_Later_New_End_Date</fullName>
        <active>true</active>
        <errorConditionFormula>CONTAINS(RecordType.DeveloperName,&apos;ASI_CRM_VN&apos;) 
&amp;&amp;
ISCHANGED(ASI_CRM_New_End_Date__c)
&amp;&amp;
ASI_CRM_New_End_Date__c &lt;= ASI_CRM_End_Date__c</errorConditionFormula>
        <errorMessage>Please make sure new end date is later than original end date</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>ASI_CRM_VN_Outlet_Must_Has_ServicePack</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
ISBLANK(ASI_CRM_Outlet_WS__r.ASI_CRM_Service_Pack__c),
RecordType.DeveloperName = &apos;ASI_CRM_VN_Contract&apos;
)</errorConditionFormula>
        <errorDisplayField>ASI_CRM_Activation_Support__c</errorDisplayField>
        <errorMessage>Cannot create MCF when outlet does not have service pack.</errorMessage>
    </validationRules>
    <visibility>Public</visibility>
    <webLinks>
        <fullName>ASI_CRM_Approve</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Approve</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!requireScript(&quot;/soap/ajax/36.0/connection.js&quot;)} 
{!requireScript(&quot;/soap/ajax/36.0/apex.js&quot;)}

try {
if({!ISBLANK(ASI_CRM_VN_Contract__c.ASI_CRM_Contract_Number__c)} == true || {!ISBLANK(ASI_CRM_VN_Contract__c.ASI_CRM_Area_Code__c)} == true) {
alert(&apos;Please input Contract Number and Area Code before update status to &quot;Approved&quot;&apos;);
} else {
var record = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
record.Id = &quot;{!ASI_CRM_VN_Contract__c.Id}&quot;; 
record.ASI_CRM_Contract_Status__c = &apos;Approved&apos;; 
result = sforce.connection.update([record]); 
location.reload();
}
} catch(e) {
alert(&apos;Error occurred : &apos; + e); 
}</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_Set_To_Draft</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Set To Draft</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!requireScript(&quot;/soap/ajax/36.0/connection.js&quot;)} 
{!requireScript(&quot;/soap/ajax/36.0/apex.js&quot;)}

try {
	var requestList = sforce.connection.query(&quot;Select Id from ASI_GiftBox_Request_Header__c where ASI_CRM_VN_Contract__c = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;&quot;); 
	var records = requestList.getArray(&quot;records&quot;);

	if(records.length &gt; 0) {
	alert(&quot;Cannot set contract status to &apos;Draft&apos;. Some request is linked to this contract.&quot;);
	} else {
		var record = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
		record.Id = &quot;{!ASI_CRM_VN_Contract__c.Id}&quot;; 
		record.ASI_CRM_Contract_Status__c = &apos;Draft&apos;; 
		result = sforce.connection.update([record]); 
		location.reload();
	}
} catch(error) { 
	alert(error); 
}</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Actual_Offtake_Report</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Actual Offtake Report</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>window.open(&apos;/apex/ASI_CRM_VN_PDF_Page?id={! ASI_CRM_VN_Contract__c.Id}&amp;pdfType=CSRequestActualOfftake&apos;);</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Capsule_Print_PDF</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Print PDF</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>window.open(&apos;/apex/ASI_CRM_VN_PDF_Page?id={! ASI_CRM_VN_Contract__c.Id}&amp;pdfType=Capsule&apos;);</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Capsule_Submit_For_Approval</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Submit for Approval</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!requireScript(&quot;/soap/ajax/31.0/connection.js&quot;)} 

var contractExpenditureQuery = sforce.connection.query(&quot;Select Id from ASI_CRM_VN_Contract_Expenditure__c where ASI_CRM_VN_Contract__c = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;&quot;); 
var contractExpenditureRecords = contractExpenditureQuery.getArray(&quot;records&quot;); 

if(contractExpenditureRecords.length == 0) { 
alert(&quot;This contract does not contain any contract expenditure record&quot;); 
} else { 
var contractOwner = sforce.connection.query(&quot;Select ManagerId from User where Id = &apos;{!ASI_CRM_VN_Contract__c.OwnerId}&apos;&quot;); 
var records = contractOwner.getArray(&quot;records&quot;); 

var contract = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
contract.Id = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;; 
contract.ASI_CRM_Sys_Owner_Manager__c = records[0].ManagerId; 

try{ 
result = sforce.connection.update([contract]); 
window.open(&quot;/apex/ASI_SubmitApprovalPage?id={!ASI_CRM_VN_Contract__c.Id}&quot;,&quot;_self&quot;); 
}catch(error){ 
alert(error.faultstring); 
} 
}</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Early_Completion</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Early Completion</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!REQUIRESCRIPT(&quot;//code.jquery.com/jquery-1.12.4.min.js&quot;)} 
{!REQUIRESCRIPT(&quot;//code.jquery.com/ui/1.12.1/jquery-ui.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/31.0/connection.js&quot;)}

var query = &quot;SELECT Id, ASI_CRM_VN_Contract__r.RecordType.DeveloperName FROM ASI_GiftBox_Request_Header__c WHERE ASI_CRM_VN_Contract__c = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos; AND ASI_GiftBox_Status__c != &apos;Open&apos; AND ASI_GiftBox_Status__c != &apos;Complete&apos; &quot;;
console.log(query);

var result = sforce.connection.query(query); 
var recordList = result.getArray(&quot;records&quot;);
var recordType = recordList.map(a =&gt; a.ASI_CRM_VN_Contract__r.RecordType.DeveloperName)[0];
if({!ASI_CRM_VN_Contract__c.ASI_CRM_Allow_Early_Termination__c} == false &amp;&amp; recordType!=&apos;ASI_CRM_VN_Capsule_Agreement_Contract&apos;) {
      
	alert(&apos;This contract has not yet achieve the sales target!&apos;);
} else {

	if(recordList.length &gt; 0) {
		window.alert(&quot;Request is during approval, please complete all request first&quot;);
	} else if(&apos;{!ASI_CRM_VN_Contract__c.ASI_CRM_Contract_Status__c}&apos; != &apos;Approved&apos;) {
		window.alert(&quot;Contract is not approved or during approval process!&quot;);
	} else {
		try {
			$(function() { 
				$(&apos;head&apos;).append(&apos;&lt;link rel=&quot;stylesheet&quot; href=&quot;//code.jquery.com/ui/1.12.1/themes/start/jquery-ui.css&quot; type=&quot;text/css&quot; /&gt;&apos;); 

				var html = &apos;&lt;div id=&quot;earlyCompletionDialog&quot; title=&quot;Early Completion&quot;&gt;&apos;;
				html += &apos;Do you confirm to complete this contract?&apos;;
				html += &apos;&lt;br /&gt;&apos;;
				html += &apos;Completion Reason : &apos;;
				html += &apos;&lt;textarea rows=&quot;4&quot; cols=&quot;25&quot; id=&quot;earlyCompletionReason&quot;&gt;&lt;/textarea&gt;&apos;; 

				if(!$(&apos;[id=earlyCompletionDialog]&apos;).size()){ 
					$(&apos;body&apos;).append(html); 
				} 

				$(&quot;#earlyCompletionDialog&quot;).dialog({ 
					buttons : {
						&quot;Yes&quot; : function() {
							if($(&quot;#earlyCompletionReason&quot;).val()) {
								var contract = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
								contract.Id = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;; 
								contract.ASI_CRM_Contract_Status__c = &apos;Closed&apos;; 
								contract.ASI_CRM_Termination_Reason__c = $(&quot;#earlyCompletionReason&quot;).val(); 
								sforce.connection.update([contract]); 

								location.reload();
								$(&quot;#earlyCompletionDialog&quot;).dialog(&quot;close&quot;); 
							} else {
								alert(&apos;Please input the completion reason!&apos;);
							}
						}, 
						&quot;No&quot; : function() { 
							$(&quot;#earlyCompletionDialog&quot;).dialog(&quot;close&quot;); 
						} 
					}	 
				}); 

				$(&quot;#earlyCompletionDialog&quot;).dialog(&quot;open&quot;); 

			});
		} catch(e) {
			alert(&apos;An error has occured. Error: &apos; + e);
		}
	}
}</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Extend_Contract</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Extend Contract</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!REQUIRESCRIPT(&quot;//code.jquery.com/jquery-1.12.4.min.js&quot;)} 
{!REQUIRESCRIPT(&quot;//code.jquery.com/ui/1.12.1/jquery-ui.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/31.0/connection.js&quot;)} 




try { 
	$(function() { 
                $(&apos;head&apos;).append(&apos;&lt;link rel=&quot;stylesheet&quot; href=&quot;//code.jquery.com/ui/1.12.1/themes/start/jquery-ui.css&quot; type=&quot;text/css&quot; /&gt;&apos;); 


		var html = &apos;&lt;div id=&quot;extendDialog&quot; title=&quot;Extend Contract&quot;&gt;&apos;; 
		html += &apos;Do you confirm to extend this contract?&apos;; 
		html += &apos;&lt;br /&gt;&apos;; 
		html += &apos;New End Date : &apos;;
		html += &apos;&lt;input type=&quot;date&quot; id=&quot;newEndDate&quot; /&gt;&apos;;

		/*
		if({!ASI_CRM_VN_Contract__c.ASI_CRM_Extend_Times__c == 2}) {
			alert(&quot;One contract can only extend 2 times&quot;);
		} else {
		}
		*/
			if({!ASI_CRM_VN_Contract__c.ASI_CRM_Allow_Extend__c}) { 

            } 
            else { 
				html += &apos;Extend Reason : &apos;; 
				html += &apos;&lt;textarea rows=&quot;4&quot; cols=&quot;25&quot; id=&quot;extendReason&quot;&gt;&lt;/textarea&gt;&apos;; 
			}	 

			if(!$(&apos;[id=extendDialog]&apos;).size()){ 
				$(&apos;body&apos;).append(html); 
			} 


			$(&quot;#extendDialog&quot;).dialog({ 
				buttons : { 
					&quot;Yes&quot; : function() { 
						var contract = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
						contract.Id = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;; 
                        contract.ASI_CRM_New_End_Date__c = $(&quot;#newEndDate&quot;).val();
												
						var year = {!YEAR( ASI_CRM_VN_Contract__c.ASI_CRM_End_Date__c )};
						var month = &quot;0&quot; + {!MONTH( ASI_CRM_VN_Contract__c.ASI_CRM_End_Date__c )};
						var day = &quot;0&quot; + {!DAY( ASI_CRM_VN_Contract__c.ASI_CRM_End_Date__c )};
						var oldDate = year + &quot;-&quot; + month.substr(month.length - 2) + &quot;-&quot; + day.substr(day.length - 2);
						
						contract.ASI_CRM_End_Date__c = oldDate;	//WL 20190214 INC0071396 
						
						
						// ICM119148098: Vincent Lam 2018-11-19						
						/*
						if($(&quot;#extendReason&quot;).val()) { 
							contract.ASI_CRM_Extend_Reason__c = $(&quot;#extendReason&quot;).val(); 
							sforce.connection.update([contract]); 
							window.open(&quot;/apex/ASI_SubmitApprovalPage?Id={!ASI_CRM_VN_Contract__c.Id}&quot;,&quot;_self&quot;);
							$(&quot;#extendDialog&quot;).dialog(&quot;close&quot;); 
						} else {
							alert(&apos;Please input the extend reason!&apos;);
						}
                        */
                        //Issue #14: Andy Zhang
                        //New end date must be later than original end date
                        if(Date.parse(contract.ASI_CRM_End_Date__c) &gt; Date.parse(contract.ASI_CRM_New_End_Date__c))
                        {
                            alert(&apos;Please make sure new end date is later than original end date&apos;);
                        }
						else if(!{!ASI_CRM_VN_Contract__c.ASI_CRM_Allow_Extend__c} &amp;&amp; !$(&quot;#extendReason&quot;).val()) { 
							alert(&apos;Please input the extend reason!&apos;);
						} else {
							if(!{!ASI_CRM_VN_Contract__c.ASI_CRM_Allow_Extend__c}){
								contract.ASI_CRM_Extend_Reason__c = $(&quot;#extendReason&quot;).val(); 
							}
							
							sforce.connection.update([contract]); 
							window.open(&quot;/apex/ASI_SubmitApprovalPage?Id={!ASI_CRM_VN_Contract__c.Id}&quot;,&quot;_self&quot;);
							$(&quot;#extendDialog&quot;).dialog(&quot;close&quot;); 
						}
					}, 
					&quot;No&quot; : function() { 
						$(&quot;#extendDialog&quot;).dialog(&quot;close&quot;); 
					} 
				}	
			}); 

			$(&quot;#extendDialog&quot;).dialog(&quot;open&quot;); 
	}); 
} catch(e) { 
	alert(&apos;An error has occured. Error: &apos; + e); 
}</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Force_Termination</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Force Termination</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!REQUIRESCRIPT(&quot;//code.jquery.com/jquery-1.12.4.min.js&quot;)} 
{!REQUIRESCRIPT(&quot;//code.jquery.com/ui/1.12.1/jquery-ui.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/31.0/connection.js&quot;)}

var query = &quot;SELECT Id FROM ASI_GiftBox_Request_Header__c WHERE ASI_CRM_VN_Contract__c = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos; &quot;
          + &quot;AND ASI_GiftBox_Status__c != &apos;Open&apos; AND ASI_GiftBox_Status__c != &apos;Complete&apos; &quot;;

var result = sforce.connection.query(query); 
var recordList = result.getArray(&quot;records&quot;);

if(recordList.length &gt; 0) {
	window.alert(&quot;Request is during approval, please complete all request first&quot;);
} else if(&apos;{!ASI_CRM_VN_Contract__c.ASI_CRM_Contract_Status__c}&apos; != &apos;Approved&apos; &amp;&amp; &apos;{ASI_CRM_VN_Contract__c.ASI_CRM_Contract_Status__c}&apos; != &apos;Draft&apos;) {
	window.alert(&quot;Contract is not approved or during approval process!&quot;);
} else {
	try {
		$(function() { 
			$(&apos;head&apos;).append(&apos;&lt;link rel=&quot;stylesheet&quot; href=&quot;//code.jquery.com/ui/1.12.1/themes/start/jquery-ui.css&quot; type=&quot;text/css&quot; /&gt;&apos;); 

			var html = &apos;&lt;div id=&quot;forceTerminationDialog&quot; title=&quot;Force Termination&quot;&gt;&apos;;
			html += &apos;Do you confirm to terminate this contract?&apos;;
			html += &apos;&lt;br /&gt;&apos;;
			html += &apos;Termination Reason : &apos;;
			html += &apos;&lt;textarea rows=&quot;4&quot; cols=&quot;25&quot; id=&quot;forceTerminationReason&quot;&gt;&lt;/textarea&gt;&apos;; 

			if(!$(&apos;[id=forceTerminationDialog]&apos;).size()){ 
				$(&apos;body&apos;).append(html); 
			} 

			$(&quot;#forceTerminationDialog&quot;).dialog({ 
				buttons : {
					&quot;Yes&quot; : function() {
						if($(&quot;#forceTerminationReason&quot;).val()) {
							var contract = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
							contract.Id = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;; 
							contract.ASI_CRM_Sys_Force_Termination__c = true;
                			contract.ASI_CRM_Contract_Status__c = &apos;Submit for Termination&apos;;
							contract.ASI_CRM_Termination_Reason__c = $(&quot;#forceTerminationReason&quot;).val(); 
							sforce.connection.update([contract]); 

							window.open(&quot;/apex/ASI_SubmitApprovalPage?Id={!ASI_CRM_VN_Contract__c.Id}&quot;,&quot;_self&quot;); 
							$(&quot;#forceTerminationDialog&quot;).dialog(&quot;close&quot;); 
						} else {
							alert(&apos;Please input the termination reason!&apos;);
						}
					}, 
					&quot;No&quot; : function() { 
						$(&quot;#forceTerminationDialog&quot;).dialog(&quot;close&quot;); 
					} 
				}	 
			}); 

			$(&quot;#forceTerminationDialog&quot;).dialog(&quot;open&quot;); 
		});

	} catch(e) {
		window.alert(&quot;An error has occured. Error : &quot; + e);
	}
}</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_MCF_Print_PDF</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Print PDF</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>window.open(&apos;/apex/ASI_CRM_VN_PDF_Page?id={! ASI_CRM_VN_Contract__c.Id}&amp;pdfType=MCF&apos;);</url>
    </webLinks>
    <webLinks>
        <fullName>ASI_CRM_VN_Submit_for_Approval</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Submit for Approval</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>{!requireScript(&quot;/soap/ajax/31.0/connection.js&quot;)} 

	if(&apos;{!ASI_CRM_VN_Contract__c.ASI_CRM_ROI__c}&apos; || &apos;{!ASI_CRM_VN_Contract__c.ASI_CRM_Activation_Support__c}&apos; == &apos;1&apos;) { 

		var contractExpenditureQuery = sforce.connection.query(&quot;Select Id from ASI_CRM_VN_Contract_Expenditure__c where ASI_CRM_VN_Contract__c = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;&quot;); 
		var contractExpenditureRecords = contractExpenditureQuery.getArray(&quot;records&quot;);

		var bottleAnalysisQuery = sforce.connection.query(&quot;Select Id from ASI_CRM_VN_Bottle_Analysis__c where ASI_CRM_VN_Contract__c = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;&quot;); 
		var bottleAnalysisRecords = bottleAnalysisQuery.getArray(&quot;records&quot;);

		if(contractExpenditureRecords.length == 0 || (bottleAnalysisRecords.length == 0 &amp;&amp; &apos;{!ASI_CRM_VN_Contract__c.ASI_CRM_Activation_Support__c}&apos; == &apos;0&apos;)) {
			alert(&quot;This contract does not contain any contract expenditure or bottle analysis record&quot;);
		} else {
			var contractOwner = sforce.connection.query(&quot;Select ManagerId from User where Id = &apos;{!ASI_CRM_VN_Contract__c.OwnerId}&apos;&quot;); 
			var records = contractOwner.getArray(&quot;records&quot;); 

			var contract = new sforce.SObject(&apos;ASI_CRM_VN_Contract__c&apos;); 
			contract.Id = &apos;{!ASI_CRM_VN_Contract__c.Id}&apos;; 
			contract.ASI_CRM_Sys_Owner_Manager__c = records[0].ManagerId; 
			
			try{ 
				result = sforce.connection.update([contract]); 
				window.open(&quot;/apex/ASI_SubmitApprovalPage?id={!ASI_CRM_VN_Contract__c.Id}&quot;,&quot;_self&quot;); 
			}catch(error){ 
				alert(error.faultstring); 
			} 
		}

} else { 
	alert(&quot;Please input ROI before submit for approval!&quot;); 
}</url>
    </webLinks>
</CustomObject>
